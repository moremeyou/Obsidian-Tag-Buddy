/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TagBuddy
});
module.exports = __toCommonJS(main_exports);
var import_obsidian10 = require("obsidian");

// settings.ts
var import_obsidian = require("obsidian");
var TBSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    function isValidTag(tag) {
      const tagPattern = /^#[\w]+$/;
      return tagPattern.test(tag);
    }
    function filterAndJoinTags(tagsString) {
      const tagsArray = tagsString.split(", ");
      const validTags = tagsArray.filter(isValidTag);
      return validTags.join(", ");
    }
    containerEl.createEl("h3", { text: "General" });
    new import_obsidian.Setting(containerEl).setName("Recent tags").setDesc("The most recent tags added via Tag Buddy are stored here. These will show up first in the list when adding.").addText((text) => {
      text.setPlaceholder(this.plugin.settings.recentlyAddedTags).setValue(this.plugin.settings.recentlyAddedTags).onChange(async (value) => {
        this.plugin.settings.recentlyAddedTags = filterAndJoinTags(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Lock recent tags").setDesc("Toggle ON to lock the recent tags list. Recent tags will not be updated. Instead, the tags above will act like a favorites list.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.lockRecentTags).onChange(async (value) => {
        this.plugin.settings.lockRecentTags = value;
        await this.plugin.saveSettings();
      })
    );
    containerEl.createEl("h3", { text: "Desktop" });
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag:").setDesc("What should happen when you click a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag with CMD/CTRL modifier key:").setDesc("What should happen when you click a tag while holding the CMD or CTRL key?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopCMDClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopCMDClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag with OPT/ALT modifier key:").setDesc("What should happen when you click a tag while holding the OPT or ALT key?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopOPTClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopOPTClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h3", { text: "Mobile" });
    new import_obsidian.Setting(containerEl).setName("Show mobile notices").setDesc("Toggle OFF to hide notices.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileNotices).onChange(
        async (value) => {
          this.plugin.settings.mobileNotices = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when DOUBLE-TAPPING a tag:").setDesc("What should happen when you DOUBLE-TAP a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.mobileDoubleTapTag).onChange(
        async (value) => {
          this.plugin.settings.mobileDoubleTapTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when LONG-PRESSING a tag:").setDesc("What should happen when you LONG-PRESS a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").setValue(this.plugin.settings.mobileLongPressTag).onChange(
        async (value) => {
          this.plugin.settings.mobileLongPressTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("TRIPLE-TAP non-tag, non-link text to add a tag:").setDesc("Toggle OFF to disable triple-tap.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileTripleTapText).onChange(
        async (value) => {
          this.plugin.settings.mobileTripleTapText = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h3", { text: "Tag Summaries" });
    new import_obsidian.Setting(containerEl).setName("Show tag summary buttons").setDesc("Toggle OFF to hide these buttons.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showSummaryButtons).onChange(
        async (value) => {
          this.plugin.settings.showSummaryButtons = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h5", { text: "Tag Summaries Items" });
    new import_obsidian.Setting(containerEl).setName("Remove tag button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.removeTagBtn).onChange(
        async (value) => {
          this.plugin.settings.removeTagBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to clipboard button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToCBBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToCBBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Move to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.moveToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.moveToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy link to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyLinkToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.copyLinkToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to note button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToNoteBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToNoteBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("hr");
    containerEl.createEl("h1", { text: "Support a buddy" });
    const donateLink = containerEl.createEl("a");
    donateLink.setAttribute("href", "https://www.buymeacoffee.com/moremeyou");
    const donateButton = createEl("img");
    donateButton.setAttribute("src", "https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png");
    donateButton.setAttribute("alt", "Buy Me A Coffee");
    donateButton.style = "height: 40px !important;width: 150px !important;";
    donateLink.appendChild(donateButton);
    containerEl.createEl("br");
    containerEl.createEl("br");
    containerEl.createEl("br");
    new import_obsidian.Setting(containerEl).setName("Debug mode").setDesc("Output to console.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
        this.plugin.settings.debugMode = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// gui.ts
var import_obsidian6 = require("obsidian");

// utils.ts
var import_obsidian2 = require("obsidian");
function getTagElement(paragraphEl2, tagText) {
  const els = paragraphEl2.querySelectorAll(".tag");
  let tagElText = "";
  let tagElHasSub;
  for (let el of els) {
    tagElText = el.innerText.trim();
    if (tagElText === tagText) {
      return el;
    }
  }
  return null;
}
function platformSettingCheck(app2, value) {
  return value == "always" || value == "desktop" && !app2.isMobile || value == "mobile" && app2.isMobile;
}
function platformSettingCheckMultiple(app2, values) {
  for (let value of values) {
    if (platformSettingCheck(app2, value)) {
      return true;
    }
  }
  return false;
}
function isWordNearEnd(str, word, charDistance = 0) {
  const lastIndex = str.lastIndexOf(word);
  if (lastIndex === -1)
    return false;
  const wordEndIndex = lastIndex + word.length;
  const distanceToEnd = str.length - wordEndIndex;
  return distanceToEnd === 0 || distanceToEnd <= charDistance;
}
function getWordObjFromString(sourceText, offset) {
  let wordRegex = /[^\s]+(?=[.,:!?]?(\s|$))/g;
  let match;
  let index;
  let word = null;
  while ((match = wordRegex.exec(sourceText)) !== null) {
    if (match.index <= offset && offset <= match.index + match[0].length) {
      word = match[0];
      index = match.index;
      break;
    }
  }
  return {
    text: word,
    index
  };
}
function getClickedTextObjFromDoc(x, y, minNodeLength = 10) {
  let range, nodeText, offset;
  if (document.caretRangeFromPoint) {
    range = document.caretRangeFromPoint(x, y);
    if (range.startContainer.nodeType === Node.TEXT_NODE) {
      nodeText = range.startContainer.nodeValue.trim();
    } else {
      return null;
    }
    offset = range.startOffset;
  }
  if (nodeText.length < minNodeLength) {
    return null;
  }
  return {
    text: nodeText,
    index: offset,
    el: range.startContainer.parentNode
  };
}
function getMarkdownHeadings(bodyLines, headingFilter = "") {
  const headers = [];
  let accumulatedIndex = 0;
  bodyLines.forEach((line, index) => {
    const match = line.match(/^(#+)[\s]?(.*)$/);
    if (match && (headingFilter == "" || match[2] == headingFilter)) {
      headers.push({
        fullText: match[0],
        level: match[1].length,
        text: match[2],
        line: index,
        startIndex: accumulatedIndex,
        endIndex: accumulatedIndex + match[0].length - 1
      });
    }
    accumulatedIndex += line.length + 1;
  });
  return headers;
}
function findClosestHeaderWithLink(paragraph) {
  const lines = paragraph.split("\n");
  let closestHeader = "";
  for (let i = lines.length - 1; i >= 0; i--) {
    const line = lines[i].trim();
    if (/^#{1,6}\s/.test(line)) {
      closestHeader = line;
      break;
    }
  }
  if (closestHeader) {
    const text = closestHeader.replace(/^#{1,6}\s*/, "").trim();
    const link = `#${text}`;
    return { text, link };
  }
  return { text: "", link: "" };
}
function fileContainsHeading(fileContent, heading) {
  const fileContentLines = getLinesInString(fileContent);
  const mdHeadings = getMarkdownHeadings(fileContentLines, heading);
  return mdHeadings.length > 0;
}
function findFirstLineAfterFrontMatter(markdown) {
  const lines = getLinesInString(markdown);
  let inFrontMatter = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i].trim();
    if (line === "---") {
      inFrontMatter = !inFrontMatter;
      if (!inFrontMatter) {
        return i;
      }
    }
  }
  return 0;
}
function getLinesInString(input) {
  const lines = input.split("\n");
  if (lines.length > 0 && lines[lines.length - 1] === "") {
    lines.pop();
  }
  return lines;
}
function insertTextAfterLine(text, body, line, filePath) {
  const splitContent = body.split("\n");
  const pre = splitContent.slice(0, line + 1).join("\n");
  const post = splitContent.slice(line + 1).join("\n");
  return `${pre}
${text}
${post}`;
}
function getListTypeFromLineNumber(fullText, lineNumber) {
  const lines = fullText.split("\n");
  if (lineNumber >= 0 && lineNumber < lines.length) {
    const line = lines[lineNumber];
    const leadingWhitespace = line.match(/^\s*/)[0];
    if (/^\s*-\s\[\s\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s\[x\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s/.test(line)) {
      return leadingWhitespace + "- ";
    } else if (/^\s*\d+\.\s/.test(line)) {
      const num = parseInt(line.match(/^\s*(\d+)\./)[1], 10);
      return leadingWhitespace + `${num}. `;
    } else if (/^\s*>\s/.test(line)) {
      return leadingWhitespace + "> ";
    }
  } else {
  }
  return "";
}
function removeTagFromString(inputText, hashtagToRemove, all = true) {
  const regex = new RegExp(
    "\\s?" + hashtagToRemove.replace(/#/g, "\\#") + "(?!\\w|\\/)",
    all ? "gi" : "i"
  );
  return inputText.replace(regex, "").trim();
}
function insertTextInString(newText, sourceText, charPos) {
  return sourceText.substring(0, charPos) + newText + " " + sourceText.substring(charPos);
}
function removeTextFromString(removeText, sourceText, all = false) {
  const regex = new RegExp(escapeRegExp(removeText), all ? "gi" : "i");
  return sourceText.replace(regex, "").trim();
}
function replaceTextInString(replaceText, sourceText, newText, all = false) {
  const escapedReplaceText = escapeRegExp(replaceText.trim()).replace(/\n/g, "\\s*\\n\\s*");
  const regex = new RegExp(escapedReplaceText, all ? "gsi" : "si");
  return sourceText.trim().replace(regex, newText.trim()).trim();
}
function truncateStringAtWord(str, maxChars = 16) {
  if (str.length <= maxChars)
    return str;
  let truncated = str.substr(0, maxChars);
  const lastSpace = truncated.lastIndexOf(" ");
  if (lastSpace > 0)
    truncated = truncated.substr(0, lastSpace);
  return truncated;
}
function contentChangedTooMuch(original, modified, tag, buffer = 5) {
  const expectedChange = tag.length;
  const threshold = expectedChange + buffer;
  const actualChange = Math.abs(original.length - modified.length);
  return actualChange > threshold;
}
function fileObjFromTags(tags) {
  let tagsArray = tags.map((tag) => tag.replace(/#/g, "").toLowerCase());
  tagsArray = tagsArray.filter((tag, index, self) => self.indexOf(tag) === index);
  const tagsPart = tagsArray.join("+");
  const currentDate = /* @__PURE__ */ new Date();
  const datePart = currentDate.getDate().toString().padStart(2, "0") + //'-' +
  (currentDate.getMonth() + 1).toString().padStart(2, "0") + //'-' +
  currentDate.getFullYear().toString().slice(-2);
  const timePart = (
    //currentDate.getHours().toString().padStart(2, '0') + '-' +
    //currentDate.getMinutes().toString().padStart(2, '0') + '-' +
    currentDate.getSeconds().toString().padStart(2, "0")
  );
  const fileName = `Tag Summary (${datePart} ${timePart}).md`;
  const titleTagsPart = tagsArray.map((tag) => tag.charAt(0).toUpperCase() + tag.slice(1)).join(" + ");
  const title = `${titleTagsPart} Tag Summary`;
  return {
    fileName,
    title
  };
}
function getActiveFileFolder(activeFile) {
  if (!activeFile)
    return null;
  let folderPath;
  if (activeFile.path.includes("\\") || activeFile.path.includes("/")) {
    const pathSeparator = activeFile.path.includes("\\") ? "\\" : "/";
    const pathParts = activeFile.path.split(pathSeparator);
    pathParts.pop();
    folderPath = pathParts.join(pathSeparator);
    if (!folderPath.endsWith(pathSeparator)) {
      folderPath += pathSeparator;
    }
  } else {
    folderPath = "";
  }
  return folderPath;
}
function getTagsFromApp(app2, recentTags) {
  const tagsObject = app2.metadataCache.getTags();
  const tagsArray = Object.entries(tagsObject);
  tagsArray.sort((a, b) => b[1] - a[1]);
  if (recentTags.length > 0) {
    const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
    const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
    return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
  } else {
    return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
  }
}
async function validateFilePath(filePath) {
  const matchingFiles = await app.vault.getFiles().filter((file) => file.name === filePath);
  if (matchingFiles.length === 1) {
    const filePath2 = matchingFiles[0].path;
    const file = await this.app.vault.getAbstractFileByPath(filePath2);
    return file;
  } else if (matchingFiles.length > 1) {
    new Notice("Tag Buddy: Multiple files found with the same name. Can't safely edit tag.");
    return null;
  } else {
    new Notice("Tag Buddy: No file found. Try again, or this tag might be in an unsupported embed type.");
    return null;
  }
}
function ctrlCmdKey(event) {
  const isMac = import_obsidian2.Platform.isMacOS;
  if (isMac)
    return event.metaKey;
  else
    return event.ctrlKey;
}
function tagsInString(string, tag) {
  let regex;
  if (tag) {
    regex = new RegExp(tag.replace(/\//g, "\\/") + "(?![\\w\\/\\#])", "g");
  } else {
    regex = /#(\w+)(?![\w\/#])/g;
  }
  const matches = string.match(regex);
  return matches || [];
}
function countOccurrences(summaryTags, contentTags) {
  let count = 0;
  for (let tag of summaryTags) {
    count += contentTags.filter((item) => item === tag).length;
  }
  return count;
}
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
async function getEmbedFile(el) {
  let filePath = el.getAttribute("src");
  const linkArray = filePath.split("#");
  filePath = linkArray[0].trim() + ".md";
  const file = await validateFilePath(filePath);
  return file;
}
function isTagValid(tag, fullTag = false) {
  let tagPattern;
  if (fullTag)
    tagPattern = /^#[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  else
    tagPattern = /^[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  return tagPattern.test(tag);
}
function extractValidTags(tagsString) {
  const potentialTags = tagsString.split(",");
  const validTags = potentialTags.map((tag) => tag.trim()).filter((tag) => isTagValid(tag, true));
  return validTags;
}

// Modal.ts
var import_obsidian3 = require("obsidian");
var TagSelector = class extends import_obsidian3.FuzzySuggestModal {
  constructor(app2, plugin, event, onChooseItemCallback) {
    super(app2);
    this.height = 215;
    this.noSelection = false;
    this.app = app2;
    this.plugin = plugin;
    this.tag = "";
    this.onChooseItemCallback = onChooseItemCallback;
    this.inputListener = this.listenInput.bind(this);
    this.tagCache = [];
    if (event != null)
      this.location = { x: event.pageX, y: event.pageY };
  }
  onOpen() {
    this.setPlaceholder("");
    this.inputEl.addEventListener("keyup", this.inputListener);
    if (!this.app.isMobile) {
      this.resultContainerEl.parentNode.style.width = "200px";
      this.resultContainerEl.style.height = "215px";
      this.resultContainerEl.parentNode.style.left = `${this.location.x}px`;
      this.resultContainerEl.parentNode.style.top = `${this.location.y}px`;
    } else {
      setTimeout(() => {
        this.inputEl.focus();
      }, 500);
    }
    super.onOpen();
  }
  onClose() {
    this.inputEl.removeEventListener("keyup", this.inputListener);
    super.onClose();
  }
  listenInput(event) {
    this.noSelection = false;
    if (!this.app.isMobile) {
      const itemsHeight = this.getSuggestions(this.inputEl.value).length * 42;
      const height = Math.min(this.height, Math.max(65, itemsHeight));
      this.resultContainerEl.style.height = `${height}px`;
    }
    if (event.key == "Enter" && !this.noSelection) {
      const text = this.inputEl.value.trim();
      const pattern = /(?=[^\d\s]+)[a-zA-Z0-9_\-\/]+/g;
      if (pattern.test(text)) {
        this.close();
        this.onChooseItem(this.inputEl.value);
      } else {
        new import_obsidian3.Notice("Invalid tag.");
      }
    }
  }
  /*getSuggestions(query: string) : string[]{
          const filteredTags = Utils.getTagsFromApp(
              this.app, 
              this.plugin.getRecentTags()).filter(tag => 
              //tag.toLowerCase().includes(query.toLowerCase())
              query == '' ? true : tag.toLowerCase() == query.toLowerCase()
          );
          return filteredTags;
      }
  
      renderSuggestion(header: string, el: HTMLElement) {
          el.createEl("div", { text: header });
      }*/
  onNoSuggestion() {
    super.onNoSuggestion();
    this.noSelection = true;
  }
  getItems() {
    const filteredTags = getTagsFromApp(
      this.app,
      this.plugin.getRecentTags()
    );
    return filteredTags;
  }
  getItemText(tag) {
    return tag;
  }
  async onChooseItem(result) {
    if (!this.app.isMobile) {
      this.onChooseItemCallback(result);
    } else {
      setTimeout(() => {
        this.onChooseItemCallback(result);
      }, 250);
    }
  }
};

// TagEditorModal.ts
var import_obsidian4 = require("obsidian");
var TBTagEditorModal = class extends import_obsidian4.Modal {
  //constructor(app: App, tag: String, onSubmit: (result: string) => void) {
  constructor(app2, plugin, tag, index, filePath = null, tagEl2 = null) {
    super(app2);
    this.settings = {
      originalTag: "",
      originalIndex: null,
      tagEl: null,
      filePath: null,
      batchAction: "instance",
      newName: "",
      summaryPos: "top",
      action: "rename"
    };
    this.plugin = plugin;
    this.settings.tagEl = tagEl2;
    this.settings.filePath = filePath;
    this.settings.originalTag = tag;
    this.settings.originalIndex = index;
  }
  onOpen() {
    let { contentEl, titleEl, modalEl, containerEl } = this;
    titleEl.setText("Tag Actions");
    this.editDiv = createEl("div");
    this.editDiv.classList.add("tag-editor-edit-div");
    this.optionsDiv = createEl("div");
    this.optionsDiv.classList.add("tag-editor-options");
    this.input = new import_obsidian4.TextComponent(this.editDiv);
    this.input.inputEl.classList.add("tag-editor-input");
    this.tagActionDropdown = new import_obsidian4.DropdownComponent(this.editDiv).addOption("rename", "Rename").addOption("lower", "Convert to lower case").addOption("totext", "Remove hash (#)").addOption("summary", "Create summary");
    this.tagActionDropdown.selectEl.classList.add("tag-editor-dropdown");
    contentEl.appendChild(this.editDiv);
    contentEl.appendChild(this.optionsDiv);
    this.showEditTagOptions("rename");
    const hr = createEl("hr");
    hr.classList.add("tag-editor-hr");
    contentEl.appendChild(hr);
    this.tagActionDropdown.onChange((value) => {
      this.settings.action = value;
      if (value == "summary") {
        this.showSummaryOptions();
      } else {
        this.showEditTagOptions(value);
      }
    });
    const submitBtn = new import_obsidian4.ButtonComponent(contentEl).setClass("tag-editor-submit").setButtonText("Submit").onClick(
      (evt) => {
        this.submitTagEdit();
      }
    );
  }
  submitTagEdit() {
    const isValidTag = isTagValid(this.settings.newName.trim(), true);
    const action = this.settings.action;
    let newName = this.settings.originalTag;
    if (action == "summary") {
      const summaryTags = extractValidTags(this.input.getValue());
      if (summaryTags.length < 1) {
        new import_obsidian4.Notice("Invalid tag format.");
      } else {
        this.plugin.tagSummary.createCodeBlock(summaryTags, this.settings.summaryPos);
        this.close();
      }
    } else if (action == "rename" && !isValidTag) {
      new import_obsidian4.Notice("Invalid tag format.");
    } else {
      if (action == "rename")
        newName = this.settings.newName;
      else if (action == "lower")
        newName = this.settings.originalTag.toLowerCase();
      else if (action == "totext")
        newName = this.settings.originalTag.substring(1);
      this.plugin.tagEditor.renameTag(
        this.settings.originalTag,
        newName,
        this.settings.batchAction == "instance" ? parseInt(this.settings.originalIndex) : this.settings.batchAction,
        this.settings.filePath,
        this.settings.tagEl
        //parseInt(this.settings.originalIndex),
        //((this.settings.batchAction == 'instance') ? parseInt(this.settings.originalIndex) : this.settings.batchAction)
      );
      this.close();
      setTimeout(async () => {
        this.plugin.tagSummary.update(tagEl.closest());
        paragraphEl.remove();
      }, 500);
    }
  }
  showSummaryOptions() {
    this.optionsDiv.empty();
    this.input.setDisabled(false);
    new import_obsidian4.Setting(this.optionsDiv).setName("Where do you want to add the tag summary?").setDesc("Add multiple tags above separated by a comma.").addDropdown(
      (opt) => opt.addOption("top", "Top of this note").addOption("end", "Bottom of this note").addOption("note", "In a new note").onChange(
        (value) => {
          this.settings.summaryPos = value;
        }
      )
    );
  }
  showEditTagOptions(editType) {
    this.optionsDiv.empty();
    this.input.setValue(this.settings.originalTag);
    this.input.setDisabled(true);
    if (editType == "rename") {
      const newName = new import_obsidian4.Setting(this.optionsDiv).setName("New name").setDesc("Tags can include letters, numbers, underscores (_), hyphens (-), and forward slashes (/) for nested tags.").addText(
        (opt) => opt.setValue("").onChange(
          (value) => {
            this.settings.newName = value;
          }
        )
      );
    }
    const whereEditOpt = new import_obsidian4.Setting(this.optionsDiv).setName("Where to make this change?").addDropdown(
      (opt) => opt.addOption("instance", "Just this instance").addOption("note", "All in this note").addOption("vault", "Across entire vault").onChange((value) => {
        if (value == "vault") {
          whereEditOpt.setDesc("WARNING: There is NO UNDO for vault changes. Consider making a backup of your vault first.");
          this.settings.batchAction = "vault";
        } else if (value == "note") {
          whereEditOpt.setDesc("Only tags in this note will be updated. Choose 'Across entire vault' to update this tag everywhere.");
          this.settings.batchAction = "note";
        } else if (value == "instance") {
          whereEditOpt.setDesc("");
          this.settings.batchAction = "instance";
        }
      })
    );
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// FindFileModal.ts
var import_obsidian5 = require("obsidian");
var SelectFileModal2 = class extends import_obsidian5.SuggestModal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
    this.fileList = this.app.vault.getMarkdownFiles();
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    return this.fileList.filter(
      (file) => file.path.includes(query)
    );
  }
  // Renders each suggestion item.
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.name });
    el.createEl("small", { text: file.path });
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(file, evt) {
    this.onSubmit(file);
  }
  //onNoSuggestion(file: TFile, evt: MouseEvent | KeyboardEvent) {
  //new Notice(`No selection`);
  //this.onSubmit(file)
  //}
};

// gui.ts
var GUI = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  showTagEditor(tagEl2) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (this.app.isMobile) {
    } else {
    }
    const index = parseInt(tagEl2.getAttribute("md-index"));
    const tag = tagEl2.innerText;
    const filePath = tagEl2.getAttribute("file-source");
    const tagContainerType = tagEl2.getAttribute("type");
    if (mode == "preview") {
      const tagEditorModal = new TBTagEditorModal(
        this.app,
        this.plugin,
        tag,
        index,
        filePath,
        tagContainerType == "plugin-summary" ? tagEl2 : null
        //tag,
        //index
        //(tag)=>{
        //	console.log(tag) 
        //}
      ).open();
    }
  }
  /*isTagValid (tag:string):boolean { // including the #
  	const tagPattern = /^#[\w]+$/;
  	return tagPattern.test(tag);
  }*/
  makeButton(lable, clickFn, classId = "tagsummary-button") {
    const button = createEl("button");
    (0, import_obsidian6.setIcon)(button, lable);
    button.className = classId;
    this.plugin.registerDomEvent(
      button,
      "click",
      clickFn
    );
    return button;
  }
  makeBlockSelector(index) {
    const checkboxEl = createEl("div");
    checkboxEl.setAttribute("index", index);
    let checkedBtn;
    let uncheckedBtn;
    const checkBox = function(bool) {
      this.plugin.tagSummary.updateSelection(parseInt(checkboxEl.getAttribute("index")), bool);
      if (bool) {
        uncheckedBtn.remove();
        checkboxEl.appendChild(checkedBtn);
      } else {
        checkedBtn.remove();
        checkboxEl.appendChild(uncheckedBtn);
      }
    }.bind(this);
    checkedBtn = this.makeButton("check-square", (e) => {
      e.stopPropagation();
      checkBox(false);
    }, "tagsummary-button tagsummary-checkbox checked");
    checkedBtn.title = "Unselect this paragraph.";
    uncheckedBtn = this.makeButton("square", (e) => {
      e.stopPropagation();
      checkBox(true);
    }, "tagsummary-button tagsummary-checkbox");
    uncheckedBtn.title = "Select this paragraph.";
    checkBox(false);
    return checkboxEl;
  }
  makeRemoveTagButton(clickFn, paragraphEl2, tag) {
    const button = this.makeButton("list-x", (e) => {
      e.stopPropagation();
      clickFn(e, paragraphEl2, tag);
    });
    button.title = "Removed " + tag + " from paragraph.";
    return button;
  }
  makeSummaryRefreshButton(summaryEl) {
    const button = this.makeButton(
      "refresh-ccw",
      (e) => {
        e.stopPropagation();
        this.plugin.tagSummary.update(summaryEl);
        new import_obsidian6.Notice("Tag Summary updated");
        setTimeout(async () => {
        }, 10);
      }
    );
    button.title = "Refresh tag summary";
    return button;
  }
  makeCopyToSection(clickFn, content, sections, tags, filePath, paragraphEl2, summaryEl) {
    const copyToEl = createEl("span");
    const selectEl = createEl("selectEl");
    let dropdown = new import_obsidian6.DropdownComponent(selectEl);
    sections.forEach((sec) => {
      dropdown.addOption(sec, truncateStringAtWord(sec, 16));
    });
    dropdown.addOption("top", "Note top");
    dropdown.addOption("end", "Note end");
    selectEl.querySelector("select").className = "tagsummary-dropdown";
    if (platformSettingCheck(this.app, this.plugin.settings.copyToNoteBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "note",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.copyLinkToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "link",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.copyToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "copy",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.moveToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "move",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheckMultiple(this.app, [
      this.plugin.settings.moveToSectionBtn,
      this.plugin.settings.copyToSectionBtn,
      this.plugin.settings.copyLinkToSectionBtn,
      this.plugin.settings.copyToNoteBtn
    ])) {
      copyToEl.appendChild(selectEl);
    }
    return copyToEl;
  }
  makeCopyToButton(clickFn, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath) {
    let buttonLabel;
    if (mode == "link")
      buttonLabel = "link";
    else if (mode == "copy")
      buttonLabel = "copy-plus";
    else if (mode == "move")
      buttonLabel = "replace";
    else if (mode == "note")
      buttonLabel = "file-plus-2";
    const button = this.makeButton(buttonLabel, async (e) => {
      e.stopPropagation();
      if (mode == "note") {
        new SelectFileModal2(this.app, (file) => {
          clickFn(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath, file);
        }).open();
      } else {
        clickFn(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath);
      }
    });
    let buttonHoverText;
    if (mode == "link")
      buttonHoverText = "Copy paragraph link.";
    else if (mode == "copy")
      buttonHoverText = "Copy paragraph.";
    else if (mode == "move")
      buttonHoverText = "Move paragraph.";
    else if (mode == "note")
      buttonHoverText = "Copy paragraph to section in note.";
    button.title = buttonHoverText;
    return button;
  }
  makeBakeButton(clickFn, summaryMd, summaryEl, filePath) {
    const button = this.makeButton(
      "stamp",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, summaryEl, filePath);
      }
    );
    button.title = "Flatten summary (replaces code block).";
    return button;
  }
  makeCopyButton(clickFn, content) {
    const button = this.makeButton("clipboard-list", (e) => {
      e.stopPropagation();
      clickFn(e, content);
    });
    button.title = "Copy paragraph to clipboard.";
    return button;
  }
  makeCopySummaryButton(summaryMd) {
    const button = this.makeButton(
      "clipboard-list",
      (e) => {
        e.stopPropagation();
        navigator.clipboard.writeText(summaryMd);
        new import_obsidian6.Notice("Summary copied to clipboard.");
      }
    );
    button.title = "Copy summary";
    return button;
  }
  makeSummaryNoteButton(clickFn, summaryMd, tags) {
    const button = this.makeButton(
      "file-plus-2",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, tags);
      }
    );
    button.title = "Create note from summary";
    return button;
  }
  showTagSelector(event) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    let pageX, pageY;
    let nodeType;
    let deepestNode;
    let range;
    if (this.app.isMobile) {
      const touch = event.touches[0] || event.changedTouches[0];
      pageX = Math.round(touch.pageX);
      pageY = Math.round(touch.pageY);
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    } else {
      pageX = event.pageX;
      pageY = event.pageY;
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    }
    if (mode == "preview") {
      if (nodeType === Node.TEXT_NODE) {
        const tagSelector = new TagSelector(
          this.app,
          this.plugin,
          event,
          (tag) => {
            this.plugin.tagEditor.add(
              "#" + tag,
              pageX,
              pageY
              //,
              //{range: range, el: deepestNode}
            );
          }
        ).open();
      }
    }
  }
  removeElementWithAnimation(el, callback) {
    const height = el.offsetHeight;
    el.style.height = `${height}px`;
    setTimeout(() => {
      el.style.height = "0px";
      el.style.opacity = "0";
      el.style.margin = "0";
      el.style.padding = "0";
    }, 0);
    el.addEventListener(
      "transitionend",
      function onEnd() {
        el.removeEventListener("transitionend", onEnd);
        callback();
      }
    );
  }
};

// TagSummary.ts
var import_obsidian7 = require("obsidian");
var TagSummary = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  async bakeSummaryBtnHandler(summaryMd, summaryEl, filePath) {
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    if (mdSource) {
      const file = await this.app.vault.getAbstractFileByPath(filePath);
      const fileContent = await this.app.vault.read(file);
      const newFileContent = replaceTextInString(
        mdSource,
        fileContent,
        summaryMd
      );
      this.app.vault.modify(file, newFileContent);
      const notice = new import_obsidian7.Notice("Tag summary flattened to active note.");
    } else {
      new import_obsidian7.Notice("\u26A0\uFE0F Tag Buddy: Can	 find code block source. This is a BUG. \u{1FAB2}");
    }
  }
  /*public static addSummary(file: TFile, summary: HTMLElement): void {
          if (!this.fileSummaries.has(file)) {
              this.fileSummaries.set(file, new Set([summary]));
          } else {
              const summaries = this.fileSummaries.get(file);
              summaries?.add(summary);
          }
      }
  
      // Method to retrieve an array of unique summary elements for a given file
      public static getSummariesByFile(file: TFile): HTMLElement[] {
          const summaries = this.fileSummaries.get(file);
          return summaries ? Array.from(summaries) : [];
      }*/
  copyBtnHandler(e, content) {
    const selection = window.getSelection().toString();
    let notice;
    if (selection != "") {
      navigator.clipboard.writeText(selection);
      notice = new import_obsidian7.Notice("Selection copied to clipboard.");
    } else {
      navigator.clipboard.writeText(content);
      notice = new import_obsidian7.Notice("Tagged paragraph copied to clipboard.");
    }
  }
  removeTagBtnHandler(e, paragraphEl2, tag) {
    const tagEl2 = getTagElement(paragraphEl2, tag);
    this.plugin.tagEditor.edit(tagEl2);
  }
  async copyToBtnHandler(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath, selectedFile) {
    let newContent;
    const selection = window.getSelection().toString();
    if (selection == "")
      newContent = content;
    else
      newContent = selection;
    let notice;
    if (mode == "link") {
      const fileName = filePath.split("/").pop().replace(/\.md$/, "");
      newContent = "[[" + filePath + "|" + fileName + "]]";
    }
    if (mode != "link" && !selection) {
      tags.forEach((tag, i) => {
        newContent = removeTagFromString(newContent, tag).trim();
      });
    }
    const copySuccess = await this.copyTextToSection(
      //this.plugin.settings.taggedParagraphCopyPrefix + 
      newContent,
      dropdown.getValue(),
      filePath,
      mode != "link",
      selectedFile
    );
    if (copySuccess) {
      if (mode == "note") {
        notice = new import_obsidian7.Notice(
          "Copied to section: " + dropdown.getValue() + " in " + selectedFile.name + " \u{1F517}",
          5e3
        );
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(selectedFile.path + "#" + dropdown.getValue(), "");
        });
      } else if (mode == "move" && !selection) {
        const file = this.app.vault.getAbstractFileByPath(filePath);
        let fileContent = await this.app.vault.read(file);
        fileContent = fileContent.trim();
        const newFileContent = replaceTextInString(
          content.trim(),
          fileContent,
          newContent
        ).trim();
        if (fileContent != newFileContent) {
          this.app.vault.modify(file, newFileContent);
          const copiedToWhere = dropdown.getValue() == "top" ? "top of note" : dropdown.getValue() == "end" ? "end of note" : dropdown.getValue();
          notice = new import_obsidian7.Notice(
            //'Moved to section: ' + dropdown.getValue() +
            //'.\nðŸ”— Open source note.', 
            "Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"),
            5e3
          );
          this.plugin.gui.removeElementWithAnimation(paragraphEl2, () => {
            setTimeout(async () => {
              this.update(summaryEl);
              paragraphEl2.remove();
            }, 500);
            setTimeout(async () => {
            }, 800);
          });
          if (dropdown.getValue() != "top" || dropdown.getValue() != "end") {
            this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
              this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
            });
          }
        } else {
          new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ".\nCan't update source file.");
        }
      } else if (mode == "copy" || mode == "link") {
        notice = new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"));
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
        });
      }
    }
  }
  async makeSummaryBtnHandler(summaryMd, tags, code = false, incrementFile = false) {
    const newNoteObj = fileObjFromTags(tags);
    let fileContent = code ? summaryMd : "## " + newNoteObj.title + "\n\n" + summaryMd;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
    const filePath = getActiveFileFolder(this.app.workspace.getActiveFile());
    const fileName = filePath + newNoteObj.fileName;
    const file = this.app.vault.getAbstractFileByPath(fileName);
    let notice;
    if (!code) {
      tags.forEach((tag) => {
        fileContent = replaceTextInString(tag, fileContent, tag.substring(1), true);
      });
    }
    if (file instanceof import_obsidian7.TFile && !incrementFile) {
      notice = new import_obsidian7.Notice("\u26A0\uFE0F Note already exists.\nClick here to overwrite.", 8e3);
      this.plugin.registerDomEvent(notice.noticeEl, "click", (e) => {
        this.app.vault.modify(file, fileContent);
        notice = new import_obsidian7.Notice("Note updated.\n\u{1F517} Open note.", 5e3);
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(fileName, "");
        });
      });
    } else if (!file) {
      this.app.vault.create(fileName, fileContent);
      const notice2 = new import_obsidian7.Notice("Summary note created. \u{1F4DC}\n\u{1F517} Open note.");
      this.plugin.registerDomEvent(notice2.noticeEl, "click", (e) => {
        this.app.workspace.openLinkText(newNoteObj.fileName, "");
      });
    }
  }
  createCodeBlock(tagsArray, pos) {
    const codeBlockString = "```tag-summary\ntags: " + tagsArray.join(" ") + "\n```";
    if (pos == "note") {
      this.makeSummaryBtnHandler(codeBlockString, tagsArray, true);
    } else {
      this.copyTextToSection(
        codeBlockString,
        pos,
        "",
        false
      );
    }
  }
  async codeBlockProcessor(source, el, ctx) {
    let tags = Array();
    let include = Array();
    let exclude = Array();
    let sections = Array();
    let max = 50;
    const maxPattern = /^\s*max:\s*(\d+)\s*$/;
    let match;
    const rows = source.split("\n").filter((row) => row.length > 0);
    rows.forEach((line) => {
      if (line.match(/^\s*tags:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*tags:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        tags = list;
      }
      if (line.match(/^\s*include:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*include:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        include = list;
      }
      if (line.match(/^\s*exclude:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*exclude:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        exclude = list;
      }
      if (line.match(/^\s*sections:[\p{L}0-9_\-/#, ]+$/gu)) {
        const content = line.replace(/^\s*sections:/, "").trim();
        let list = content.split(",").map((sec) => sec.trim());
        sections = list;
      }
      match = line.match(maxPattern);
      if (match) {
        max = Math.min(50, Number(match[1]));
      }
    });
    const codeBlock = "```tag-summary\n" + source.trim() + "\n```";
    if (tags.length > 0 || include.length > 0) {
      await this.create(
        el,
        tags,
        include,
        exclude,
        sections,
        max,
        ctx.sourcePath,
        codeBlock
      );
    } else {
      this.createEmpty(
        el,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        ctx.sourcePath ? ctx.sourcePath : "",
        codeBlock
      );
    }
  }
  createEmpty(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const container = createEl("div");
    const textDiv = createEl("blockquote");
    textDiv.innerHTML = "There are no notes with tagged paragraphs that match the tags:<br>" + (tags.length > 0 ? tags.join(", ") : "No tags specified.") + "<br>";
    container.appendChild(textDiv);
    container.setAttribute(
      "codeblock-tags",
      tags.length > 0 ? tags.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-include",
      include ? include.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-exclude",
      exclude ? exclude.join(",") : ""
    );
    container.setAttribute(
      "codeblock-sections",
      sections ? sections.join(",") : ""
    );
    container.setAttribute(
      "codeblock-max",
      max
    );
    container.setAttribute(
      "codeblock-code",
      mdSource
    );
    container.appendChild(this.plugin.gui.makeSummaryRefreshButton(container));
    ;
    element.replaceWith(container);
  }
  async create(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const activeFile = await this.app.workspace.getActiveFile();
    const validTags = tags.concat(include);
    const tempComponent = new TempComponent();
    const summaryContainer = createEl("div");
    this.selectedBlocks = [];
    this.blocks = [];
    summaryContainer.setAttribute(
      "class",
      "tag-summary-block"
    );
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian7.getAllTags)(cache);
      if (file.path.includes("_exclude"))
        return false;
      if (activeFile) {
        if (activeFile.path == file.path)
          return false;
      }
      if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    listFiles = listFiles.sort((file1, file2) => {
      return file2.stat.ctime - file1.stat.ctime;
    });
    let listContents = await this.readFiles(listFiles);
    let count = 0;
    let summary = "";
    listContents.forEach((item) => {
      const fileName = item[0].name.replace(/.md$/g, "");
      const filePath = item[0].path;
      let listParagraphs = Array();
      const blocks = item[1].split(/(?:\n\s*\n|(?<=^|\n)[*-]\s|(?<=^|\n)\d+\.\s)/).filter((row) => row.trim().length > 0);
      blocks.forEach((paragraph) => {
        let valid = false;
        let listTags = paragraph.match(/(?<=^|\s)(#[^\s#.,;!?:]+)/g);
        if (listTags != null && listTags.length > 0) {
          if (!paragraph.contains("```") && !paragraph.contains("---")) {
            valid = this.isValidText(listTags, tags, include, exclude);
          }
        }
        if (valid)
          listParagraphs.push(paragraph);
      });
      listParagraphs.forEach(async (paragraph) => {
        if (count++ >= max)
          return;
        paragraph += "\n";
        var regex = new RegExp();
        var tagText = new String();
        var tagSection = null;
        tags.forEach((tag) => {
          tagText = tag.replace("#", "\\#");
          regex = new RegExp(`${tagText}(\\W|$)`, "g");
          if (paragraph.match(regex) != null) {
            tagSection = tag;
          }
        });
        const buttonContainer = createEl("div");
        buttonContainer.setAttribute("class", "tagsummary-buttons");
        const paragraphEl2 = createEl("blockquote");
        paragraphEl2.setAttribute("file-source", filePath);
        paragraphEl2.setAttribute("index", count - 1);
        paragraphEl2.setAttribute("class", "tag-summary-paragraph");
        const blockLink = paragraph.match(/\^[\p{L}0-9_\-/^]+/gu);
        const header = findClosestHeaderWithLink(paragraph);
        let headerLink = removeTextFromString("#", header.link, true);
        headerLink = removeTextFromString("[", headerLink, true);
        headerLink = removeTextFromString("]", headerLink, true);
        console.log("-------------", headerLink);
        let link;
        if (blockLink)
          link = "[[" + filePath + "#" + blockLink + "|" + fileName + "]]";
        else if (header.text != "")
          link = "[[" + filePath + "#" + headerLink + "]]";
        else
          link = "[[" + filePath + "|" + fileName + "]]";
        buttonContainer.appendChild(
          this.plugin.gui.makeCopyToSection(
            this.copyToBtnHandler.bind(this),
            paragraph,
            sections,
            tags,
            blockLink ? filePath + "#" + blockLink[0] : filePath,
            paragraphEl2,
            summaryContainer
          )
        );
        if (platformSettingCheck(this.app, this.plugin.settings.copyToCBBtn)) {
          buttonContainer.appendChild(
            this.plugin.gui.makeCopyButton(
              this.copyBtnHandler.bind(this),
              paragraph.trim()
            )
          );
        }
        if (platformSettingCheck(this.app, this.plugin.settings.removeTagBtn)) {
          buttonContainer.appendChild(
            this.plugin.gui.makeRemoveTagButton(
              this.removeTagBtnHandler.bind(this),
              paragraphEl2,
              tagSection
              //, 
              //(blockLink ? (filePath + '#' + blockLink[0]) : filePath)
            )
          );
        }
        const mdParagraph = paragraph;
        paragraph = "**" + link + "**\n" + paragraph;
        summary += paragraph + "\n";
        paragraphEl2.setAttribute("md-source", mdParagraph);
        blocks.push(mdParagraph);
        await import_obsidian7.MarkdownRenderer.render(this.app, paragraph, paragraphEl2, "", tempComponent);
        const titleEl = createEl("span");
        titleEl.setAttribute("class", "tagsummary-item-title");
        titleEl.appendChild(paragraphEl2.querySelector("strong").cloneNode(true));
        paragraphEl2.appendChild(buttonContainer);
        paragraphEl2.querySelector("strong").replaceWith(titleEl);
        summaryContainer.appendChild(paragraphEl2);
      });
    });
    if (summary != "") {
      setTimeout(async () => {
        if (this.plugin.settings.showSummaryButtons) {
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryRefreshButton(
              summaryContainer
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeCopySummaryButton(
              summary
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryNoteButton(
              this.makeSummaryBtnHandler.bind(this),
              summary,
              tags
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeBakeButton(
              this.bakeSummaryBtnHandler.bind(this),
              summary,
              summaryContainer,
              activeFile.path
            )
          );
          summaryContainer.appendChild(createEl("br"));
        }
      }, 0);
      summaryContainer.setAttribute(
        "codeblock-tags",
        tags.join(",")
      );
      summaryContainer.setAttribute(
        "codeblock-tags-include",
        include.length > 0 ? include.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-tags-exclude",
        exclude.length > 0 ? exclude.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-sections",
        sections.length > 0 ? sections.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-max",
        max
      );
      summaryContainer.setAttribute(
        "codeblock-code",
        mdSource
      );
      element.replaceWith(summaryContainer);
    } else {
      this.createEmpty(
        element,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        "",
        mdSource
      );
    }
  }
  update(summaryEl) {
    const tagsStr = summaryEl.getAttribute(
      "codeblock-tags"
    );
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = summaryEl.getAttribute(
      "codeblock-tags-include"
    );
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    const tagsExcludeStr = summaryEl.getAttribute(
      "codeblock-tags-exclude"
    );
    const tagsExclude = tagsExcludeStr ? tagsExcludeStr.split(",") : [];
    const sectionsStr = summaryEl.getAttribute(
      "codeblock-sections"
    );
    const sections = sectionsStr ? sectionsStr.split(",") : [];
    const max = Number(summaryEl.getAttribute(
      "codeblock-max"
    ));
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    this.create(
      summaryEl,
      tags,
      tagsInclude,
      tagsExclude,
      sections,
      max,
      "",
      mdSource
    );
  }
  // Not factored yet
  async copyTextToSection(text, section, filePath, addLink = true, selectedFile, detectPrefix = true) {
    const file = selectedFile ? selectedFile : await this.app.workspace.getActiveFile();
    let fileContent = await this.app.vault.read(file);
    const fileContentLines = getLinesInString(fileContent);
    const mdHeadings = getMarkdownHeadings(fileContentLines);
    let targetLine;
    if (mdHeadings.length <= 0 || section == "end" || section == "top") {
      if (section == "top") {
        targetLine = findFirstLineAfterFrontMatter(fileContent);
        if (targetLine == 0)
          fileContent = "\n" + fileContent;
      } else if (section == "end") {
        targetLine = fileContentLines.length - 1;
      }
    } else if (mdHeadings.length > 0) {
      const headingObj = mdHeadings.find((heading) => heading.text.trim() === section);
      if (headingObj) {
        targetLine = headingObj.line;
      } else {
        new import_obsidian7.Notice(`${section} not found.`);
        return false;
      }
    }
    const linePrefix = detectPrefix ? getListTypeFromLineNumber(fileContent, targetLine + 1) : "";
    let finalText;
    if (addLink)
      finalText = linePrefix + text + ` [[${filePath}|\u{1F517}]]`;
    else
      finalText = linePrefix + text;
    let newContent = insertTextAfterLine(finalText, fileContent, targetLine);
    await this.app.vault.modify(file, newContent);
    return true;
  }
  async readFiles(listFiles) {
    let list = [];
    for (let t = 0; t < listFiles.length; t += 1) {
      const file = listFiles[t];
      let content = await this.app.vault.cachedRead(file);
      list.push([file, content]);
    }
    return list;
  }
  isValidText(listTags, tags, include, exclude) {
    let valid = true;
    if (tags.length > 0) {
      valid = valid && tags.some((value) => listTags.includes(value));
    }
    if (include.length > 0) {
      valid = valid && include.every((value) => listTags.includes(value));
    }
    if (valid && exclude.length > 0) {
      valid = !exclude.some((value) => listTags.includes(value));
    }
    return valid;
  }
  static getTagsToCheckFromEl(tagSummaryEl) {
    const tagsStr = tagSummaryEl.getAttribute("codeblock-tags");
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = tagSummaryEl.getAttribute("codeblock-tags-include");
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    return tags.concat(tagsInclude);
  }
  async getFile(el) {
    const filePath = el.getAttribute("file-source");
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    return file;
  }
  updateSelection(index, bool) {
    if (bool) {
      if (!this.selectedBlocks.includes(index)) {
        this.selectedBlocks.push(index);
      }
    } else {
      this.selectedBlocks = this.selectedBlocks.filter((itemIndex) => itemIndex !== index);
    }
  }
  getSelectedMarkdownBlocks() {
  }
};
TagSummary.fileSummaries = /* @__PURE__ */ new Map();
var TempComponent = class extends import_obsidian7.Component {
  constructor() {
    super(...arguments);
    this.doNotPostProcess = true;
  }
  onload() {
  }
  onunload() {
  }
};

// TagProcessor.ts
var import_obsidian8 = require("obsidian");
var TagProcessor = class {
  constructor(app2, plugin) {
    this.outOfSync = false;
    this.app = app2;
    this.plugin = plugin;
    this.debouncedProcessActiveFileTagEls = (0, import_obsidian8.debounce)(this.processActiveFileTags.bind(this), 500);
    this.debouncedProcessActiveFileTagEls();
  }
  reset() {
    this.outOfSync = false;
  }
  filterActiveFileTagEls(tags) {
    const filteredTagElements = Array.from(tags).filter((tag) => {
      if (tag.closest(".frontmatter-section-data"))
        return false;
      if (tag.parentElement.closest(".markdown-embed"))
        return false;
      if (tag.closest(".markdown-embed"))
        return false;
      if (tag.parentElement.closest(".tag-summary-block"))
        return false;
      return true;
    });
    return filteredTagElements;
  }
  async renderPostProcessor(el, ctx) {
    const processingFile = this.app.vault.getAbstractFileByPath(ctx.sourcePath);
    const activeFile = this.app.workspace.getActiveFile();
    const activeFilePath = activeFile == null ? void 0 : activeFile.path;
    const nativeEmbedEl = el.querySelector(".internal-embed");
    const tags = el.querySelectorAll(".tag");
    if (nativeEmbedEl && ctx.sourcePath == activeFilePath || ctx.sourcePath == activeFilePath && tags.length > 0 || el.classList.contains("tag-summary-paragraph")) {
    } else {
      return;
    }
    if (nativeEmbedEl) {
      let nativeEmbedObserver;
      nativeEmbedObserver = new MutationObserver((mutationsList) => {
        const target = mutationsList[0].target;
        if (target.querySelectorAll(".tag").length > 0) {
          nativeEmbedObserver.disconnect();
          this.processNativeEmbed(target);
        }
      });
      nativeEmbedObserver.observe(nativeEmbedEl, { childList: true, subtree: true });
    }
    if (el.classList.contains("tag-summary-paragraph")) {
      this.processTagSummaryParagraph(el);
      return;
    }
    this.debouncedProcessActiveFileTagEls();
  }
  async processActiveFileTags() {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processing active file tags");
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian8.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (mode == "preview") {
      const activeFile = await this.app.workspace.getActiveFile();
      const fileContent = await this.app.vault.read(activeFile);
      const sections = view.currentMode.renderer.sections;
      const activeFileTagEls = [];
      const activeFileTags = await this.getMarkdownTags(
        activeFile,
        fileContent
      );
      sections.forEach((section) => {
        Array.from(section.el.querySelectorAll(".tag")).forEach((tag) => {
          activeFileTagEls.push(tag);
        });
      });
      const filteredTagElements = this.filterActiveFileTagEls(activeFileTagEls);
      if (filteredTagElements.length > 0) {
        this.assignMarkdownTags(
          activeFileTags,
          filteredTagElements,
          0,
          //startIndex,
          "active"
        );
      }
    }
  }
  async processTagSummaryParagraph(paragraphEl2) {
    const filePath = paragraphEl2.getAttribute("file-source");
    const markdownBlock = paragraphEl2.getAttribute("md-source").trim();
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    const fileContent = await this.app.vault.read(file);
    const startIndex = fileContent.indexOf(markdownBlock);
    const mdTags = this.getMarkdownTags(
      file,
      fileContent
    );
    this.assignMarkdownTags(
      mdTags,
      paragraphEl2.querySelectorAll(".tag"),
      startIndex,
      "plugin-summary"
    );
  }
  /*
  	// adapt this method to use the cache tag info (line, offset, etc)
  	getMarkdownTags (
  		file: TFile,  
  		fileContent: string 
  	): Array {
  
  		const tagPositions = [];
  		let match;
  		// Obsidian tag spec: https://help.obsidian.md/Editing+and+formatting/Tags#Tag+format
  		//const regex = /(?:^|\s)#[^\s#]+|```/g; // BUG: wrong match.index. matches the space before the tag.
  		//const regex = /(?<=^|\s)#[^\s#]+|```/g // FIX. But still matching punctuation after
  		//const regex = /(?<=^|\s)(#[^\s#.,;!?:]+)(?=[.,;!?:\s]|$)|```/g  // matches punctuation after, but not included in the match
  		//const regex = /(?<=^|\s)(#[^\s#.,;!?:]+)(?=[.,;!?:\s]|$)|(?<!`)```(?!`)/g; // Fix for matching ```` 
  		//const regex = /(?<=^|\s)(#[^\s#.',;!?:]+)(?=[.,;!?:'\s]|$)|(?<!`)```(?!`)/g; // Fix for matching but excluding ''s' in '#tag's'
  		const regex = /(?<=^|\s)(#(?=[^\s#.'â€™,;!?:]*[^\d\s#.'â€™,;!?:])[^\s#.'â€™,;!?:]+)(?=[.,;!?:'â€™\s]|$)|(?<!`)```(?!`)/g; // fix for number-only and typographic apostrophy's
  
  
  
  		let insideCodeBlock = false;
  
  		while ((match = regex.exec(fileContent)) !== null) {
  		    if (match[0].trim() === "```") {
  		        insideCodeBlock = !insideCodeBlock; 
  		        continue; // Reject if tag in a code block
  		    }	    
  		    if (insideCodeBlock) continue;
  		    const tag = match[0].trim();
  		    tagPositions.push({tag:tag, index:match.index, source:file.name}); 
  //console.log(tag)
  		}
  		return tagPositions;
  	}
  */
  getMarkdownTags(file, fileContent) {
    const tagPositions = [];
    const processedPositions = /* @__PURE__ */ new Set();
    let match;
    const regex = /(?<=^|\s)(#(?=[^\s#.'â€™,;!?:]*[^\d\s#.'â€™,;!?:])[^\s#.'â€™,;!?:]+)(?=[.,;!?:'â€™\s]|$)|(?<!`)```(?!`)/g;
    let currentContext = "normal";
    let insideCodeBlock = false;
    let invalidBlockquote = false;
    while ((match = regex.exec(fileContent)) !== null) {
      const matchedString = match[0].trim();
      const matchIndex = match.index;
      if (processedPositions.has(matchIndex)) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping duplicate tag at position ${matchIndex}: ${matchedString}`);
        continue;
      }
      if (matchedString === "```") {
        insideCodeBlock = !insideCodeBlock;
        if (this.plugin.settings.debugMode)
          console.log(`Toggled insideCodeBlock to ${insideCodeBlock}`);
        continue;
      }
      if (insideCodeBlock) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping tag ${matchedString} inside code block.`);
        continue;
      }
      const lineStart = fileContent.lastIndexOf("\n", matchIndex) + 1;
      const lineEnd = fileContent.indexOf("\n", matchIndex);
      const line = fileContent.slice(lineStart, lineEnd !== -1 ? lineEnd : void 0);
      if (line.trim().startsWith(">")) {
        currentContext = "blockquote";
        if (line.startsWith("> 	") || line.startsWith(">	") || line.includes("(not a tag)")) {
          invalidBlockquote = true;
          if (this.plugin.settings.debugMode)
            console.log(`Invalid blockquote triggered at line: ${fileContent.substring(0, matchIndex).split("\n").length}`);
        }
      } else if (line.trim().startsWith("-") || line.trim().match(/^\d+\./)) {
        currentContext = "list";
        invalidBlockquote = false;
      } else if (line.startsWith("	")) {
        currentContext = "indented";
        invalidBlockquote = false;
      } else {
        currentContext = "normal";
        invalidBlockquote = false;
      }
      if (this.plugin.settings.debugMode)
        console.log(`Line ${fileContent.substring(0, matchIndex).split("\n").length}: ${currentContext} - ${line.trim()}`);
      if (invalidBlockquote) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping tag ${matchedString} due to invalid blockquote context.`);
        continue;
      }
      const isValid = currentContext !== "indented" && // Exclude lines starting with tabs
      !(currentContext === "list" && line.includes("(not a tag)")) && // Exclude invalid list tags
      !(currentContext === "blockquote" && invalidBlockquote);
      if (isValid) {
        tagPositions.push({
          tag: matchedString,
          index: matchIndex,
          source: file.name,
          context: currentContext,
          line: fileContent.substring(0, matchIndex).split("\n").length
          // Calculate line number
        });
        if (this.plugin.settings.debugMode)
          console.log(`Found tag: ${matchedString} in context: ${currentContext}`);
        processedPositions.add(matchIndex);
      } else {
        if (this.plugin.settings.debugMode)
          console.log(`Excluded tag: ${matchedString} in invalid context: ${currentContext}`);
      }
    }
    return tagPositions;
  }
  async assignMarkdownTags(tagPositions, tagElements, startIndex, type) {
    if (type == "active") {
      if (this.plugin.settings.debugMode) {
        const activeFilePath = this.app.workspace.getActiveFile().path;
        console.log(tagPositions.length, tagElements.length);
        const temp1 = [];
        tagPositions.forEach((nodeObj) => {
          temp1.push(nodeObj.tag);
        });
        const temp2 = [];
        tagElements.forEach((nodeObj) => {
          temp2.push(nodeObj.innerText);
        });
        console.log(temp1, temp2);
      }
      if (tagPositions.length != tagElements.length) {
        this.outOfSync = true;
        new import_obsidian8.Notice("Tag Buddy: Markdown source and preview tags out of sync. Try refreshing this summary. Then check for tag syntax errors or conflicts in metadata. Please report if this error persists.", 1e4);
        if (this.plugin.settings.debugMode)
          this.logDifferences(tagPositions, tagElements);
        return;
      }
    }
    let tagEl2;
    const tagElArray = Array.from(tagElements);
    let tagElIndex = 0;
    let tagPos;
    for (let i = 0; i < tagPositions.length; i++) {
      tagPos = tagPositions[i];
      if (tagPos.index >= startIndex) {
        tagEl2 = tagElArray[tagElIndex];
        if (tagEl2) {
          if (tagEl2.innerText.trim() == tagPos.tag.trim()) {
            tagEl2.setAttribute("md-index", tagPos.index);
            tagEl2.setAttribute("file-source", tagPos.source);
            tagEl2.setAttribute("type", type);
            tagEl2.setAttribute("pos", i);
            tagElIndex++;
          } else {
            this.outOfSync = true;
            new import_obsidian8.Notice("Tag Buddy: Markdown source and preview tags out of sync. Try refreshing this summary. Then check for tag syntax errors or conflicts in metadata. Please report if this error persists.");
            this.logDifferences(tagPositions, tagElements);
            return;
          }
        }
      }
    }
    ;
    return tagElArray;
  }
  async processNativeEmbed(embed, checkDuplicates = false) {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processNativeEmbed");
    embed = embed.closest(".markdown-embed");
    if (embed == null ? void 0 : embed.getAttribute("src")) {
      const linkElement = embed.getAttribute("src");
      let filePath = embed.getAttribute("src");
      const linkArray = filePath.split("#");
      const hasAnchorLink = linkArray.length > 1;
      let anchorLinkType = "";
      let anchorLink;
      if (hasAnchorLink) {
        anchorLink = linkArray[1];
        anchorLinkType = anchorLink.startsWith("^") ? "block" : "header";
      }
      filePath = linkArray[0].trim() + ".md";
      const file = await validateFilePath(filePath);
      if (file) {
        const fileContent = await this.app.vault.read(file);
        const embededTagFile = await this.getMarkdownTags(file, fileContent);
        if (hasAnchorLink && anchorLinkType != "") {
          if (anchorLinkType == "header" && !fileContainsHeading(fileContent, anchorLink)) {
            embed.setAttribute("embed-success", "false");
            return;
          } else {
            embed.setAttribute("embed-success", "true");
          }
        }
        const tempComponent = new TempComponent2();
        const tempContainerHTML = createEl("div");
        await import_obsidian8.MarkdownRenderer.renderMarkdown(
          fileContent,
          tempContainerHTML,
          "noFile",
          //file.path, 
          tempComponent
        );
        const innerText = await embed.querySelector(".markdown-embed-content").innerText;
        const startIndex = tempContainerHTML.innerText.indexOf(innerText);
        this.assignMarkdownTags(
          embededTagFile,
          embed.querySelectorAll(".tag"),
          startIndex,
          "native-embed"
        );
      }
    }
  }
  logDifferences(tagPositions, tagElements) {
    const tags = tagPositions.map((item) => item.tag);
    const innerTexts1 = tagElements.map((item) => item.innerText);
    let uniqueToTagPositions = [];
    let uniqueToTagElements = [];
    const findUnique = (arr1, arr2) => {
      return arr1.filter((item) => !arr2.includes(item));
    };
    uniqueToTagPositions = findUnique(tags, innerTexts1);
    uniqueToTagElements = findUnique(innerTexts1, tags);
    console.log("differences:", uniqueToTagPositions.length, uniqueToTagElements.length);
    if (uniqueToTagPositions.length) {
      console.log("Unique to tagPositions based on tag:", uniqueToTagPositions);
    }
    if (uniqueToTagElements.length) {
      console.log("Unique to tagElements based on innerText:", uniqueToTagElements);
    }
  }
};
var TempComponent2 = class extends import_obsidian8.Component {
  onload() {
  }
  onunload() {
  }
};

// ReadingModeTagEditor.ts
var import_obsidian9 = require("obsidian");
var ReadingModeTagEditor = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  //async renameTag (tag, newName, batchAction: string | number, specificFile:TFile = null) {
  async renameTag(tag, newName, batchAction, filePath = null, tagEl2) {
    const activeFile = await this.app.workspace.getActiveFile();
    const file = filePath == null ? activeFile : await validateFilePath(filePath);
    if (!file)
      return;
    const fileContent = await this.app.vault.read(file);
    if (typeof batchAction === "number") {
      const newFileContent = this.renameTagInStringByIndex(
        tag,
        newName,
        parseInt(batchAction),
        fileContent
      );
      this.app.vault.modify(file, newFileContent);
    } else if (batchAction == "note") {
      this.renameTagsInFileByIndex(
        tag,
        newName,
        file
      );
    } else if (batchAction == "vault") {
      this.renameTagsInVaultByIndex(
        tag,
        newName
      );
    }
    if (activeFile != file && tagEl2) {
      new import_obsidian9.Notice("Refresh this summary to see changes.", 5e3);
    }
  }
  async renameTagsInVaultByIndex(tag, newName) {
    const validTags = [tag];
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian9.getAllTags)(cache);
      if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    let listContents = await this.plugin.tagSummary.readFiles(listFiles);
    listContents.forEach(async (note) => {
      this.renameTagsInFileByIndex(
        tag,
        newName,
        note[0]
      );
    });
  }
  async renameTagsInFileByIndex(tag, newName, file) {
    const fileContent = await this.app.vault.read(file);
    let newFileContent = fileContent;
    const tagPositions = this.plugin.tagProcessor.getMarkdownTags(file, fileContent);
    let filteredTagObjs = tagPositions.filter((tagObj) => tagObj.tag === tag);
    if (filteredTagObjs.length > 0) {
      filteredTagObjs.sort((a, b) => a.index - b.index);
      let offset = 0;
      filteredTagObjs.forEach((tagObj) => {
        const newIndex = tagObj.index + offset;
        newFileContent = newFileContent.substring(0, newIndex) + newName + newFileContent.substring(newIndex + tagObj.tag.length);
        offset += newName.length - tagObj.tag.length;
      });
      this.app.vault.modify(file, newFileContent);
    } else {
    }
  }
  renameTagInStringByIndex(tag, newName, index, fileContent) {
    const newContent = fileContent.substring(0, parseInt(index)) + newName + fileContent.substring(parseInt(index) + parseInt(tag.length));
    return newContent;
  }
  async add(tag, x, y) {
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy add " + tag + " at (" + x + ", " + y + ")");
    }
    let fileContent;
    let file;
    const clickedTextObj = getClickedTextObjFromDoc(x, y);
    const clickedText = clickedTextObj == null ? void 0 : clickedTextObj.text;
    const clickedTextIndex = clickedTextObj == null ? void 0 : clickedTextObj.index;
    const clickedTextEl = clickedTextObj == null ? void 0 : clickedTextObj.el;
    let contentSourceType = null;
    let summaryEl = void 0;
    let embedEl = void 0;
    if (clickedTextObj) {
      try {
        summaryEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".tag-summary-paragraph");
        embedEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".markdown-embed");
      } catch (e) {
      }
      if (summaryEl) {
        file = await this.plugin.tagSummary.getFile(summaryEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "plugin-summary";
      } else if (embedEl) {
        file = await getEmbedFile(embedEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "native-embed";
      } else {
        file = await this.app.workspace.getActiveFile();
        fileContent = await this.app.vault.read(file);
        contentSourceType = "active";
      }
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (clickedText) {
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag.\nTry a different text area.");
      return;
    }
    const escapedClickedText = escapeRegExp(clickedText);
    const regex = new RegExp(escapedClickedText, "g");
    const matches = fileContent.match(regex);
    if (matches && matches.length > 1) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag: Clicked text repeated in note. Try a another text block.");
      return;
    } else if (matches && matches.length === 0 || !matches) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (!this.plugin.settings.lockRecentTags)
      this.plugin.saveRecentTag(tag);
    const startIndex = regex.exec(fileContent).index;
    const endIndex = startIndex + clickedText.length;
    const clickedWordObj = getWordObjFromString(clickedText, clickedTextIndex);
    const clickedWord = clickedWordObj.text;
    const clickedWordIndex = clickedWordObj.index;
    let newContent;
    if (clickedWord) {
      if (isWordNearEnd(clickedText, clickedWord))
        newContent = insertTextInString(" " + tag, fileContent, endIndex);
      else
        newContent = insertTextInString(tag, fileContent, startIndex + clickedWordIndex);
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find clicked word.\nPlease try again.");
      return;
    }
    await this.app.vault.modify(file, newContent);
    if (contentSourceType == "plugin-summary") {
      const summaryContainer = summaryEl.closest(".tag-summary-block");
      this.plugin.tagSummary.update(summaryContainer);
    } else if (contentSourceType == "native-embed") {
      setTimeout(async () => {
        this.plugin.tagProcessor.processNativeEmbed(embedEl, true);
      }, 200);
    }
  }
  async edit(tagEl2, event, pragraphEl, editType, newName) {
    let tagContainer;
    const tagContainerType = tagEl2.getAttribute(
      "type"
    );
    const index = tagEl2.getAttribute(
      "md-index"
    );
    const filePath = tagEl2.getAttribute(
      "file-source"
    );
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy edit tag: " + tagEl2.innerText + "\nIn file: " + filePath);
    }
    if (tagContainerType == "native-embed")
      tagContainer = tagEl2.closest(".markdown-embed");
    else if (tagContainerType == "plugin-summary")
      tagContainer = tagEl2.closest(".tag-summary-paragraph");
    else
      tagContainer = this.app.workspace.activeLeaf.containerEl.querySelector(".markdown-reading-view");
    if (filePath) {
      const file = await validateFilePath(filePath);
      let fileContent;
      let fileContentBackup;
      const tag = tagEl2.innerText.trim();
      try {
        fileContent = await this.app.vault.read(file);
        fileContentBackup = fileContent;
      } catch (error) {
        new import_obsidian9.Notice("Tag Buddy file read error:\n" + error.message);
        return;
      }
      let safeToEmptyFile = false;
      const tagRegex = /^\s*#(\w+)\s*$/;
      if (tagRegex.test(fileContent.trim())) {
        safeToEmptyFile = true;
      }
      let beforeTag = fileContent.substring(0, index);
      let afterTag = fileContent.substring(
        Number(index) + Number(tag.length)
      );
      let afterTagChr = "";
      if (fileContent[index] === "\n")
        beforeTag += "\n";
      let newContent = "";
      if (editType == "rename") {
      } else if (!event) {
        newContent = beforeTag + afterTagChr + afterTag;
      } else if (editType == "hash") {
        const noHash = tag.substring(1);
        newContent = beforeTag + noHash + afterTagChr + afterTag;
        if (this.app.isMobile && this.plugin.settings.mobileNotices) {
          new import_obsidian9.Notice("Tag Buddy: " + tag + " converted to text.");
        }
      } else if (event.type == "touchend" || this.plugin.settings.mobileTagSearch || editType == "remove") {
        let parentTag = "";
        if (tag.includes("/")) {
          let parts = tag.split("/");
          const removedChild = parts.pop();
          parentTag = parts.join("/");
          newContent = beforeTag + parentTag + afterTagChr + afterTag;
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: '" + removedChild + "' removed from parent tag.");
          }
        } else {
          const startsWithPunctuation = /^[.,!:?;]/.test(afterTag.trimStart()[0]);
          if (beforeTag.endsWith(" ") && afterTag.startsWith(" ")) {
            newContent = beforeTag + afterTag.substring(1);
          } else if (startsWithPunctuation) {
            newContent = beforeTag.trimEnd() + afterTag.trimStart();
          } else {
            newContent = beforeTag + afterTag;
          }
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: " + tag + " removed.");
          }
        }
      }
      if (tagEl2.getAttribute("type") == "plugin-summary") {
        const summaryEl = tagEl2.closest(".tag-summary-paragraph");
        const mdSource = summaryEl.getAttribute("md-source").trim();
        const escapedText = escapeRegExp(mdSource);
        const regex = new RegExp(escapedText, "g");
        const matches = fileContent.match(regex);
        if (matches && matches.length > 1) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't safely remove/edit tag:\nSurrounding text repeated in source note.");
          return;
        } else if (matches && matches.length === 0 || !matches) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't find tag in source note.\n");
          return;
        }
        if (newContent == "" && !safeToEmptyFile || contentChangedTooMuch(
          fileContentBackup,
          newContent,
          tag,
          2
        )) {
          new import_obsidian9.Notice("Tag Buddy: File change error.");
          newContent = fileContentBackup;
        } else if (newContent == "" && safeToEmptyFile) {
          new import_obsidian9.Notice("Tag Buddy: Tag removed. The note is empty.");
        }
        setTimeout(async () => {
          const tagParagraphEl = tagEl2.closest(".tag-summary-paragraph");
          const tagSummaryBlock = tagEl2.closest(".tag-summary-block");
          const tagsToCheck = TagSummary.getTagsToCheckFromEl(tagSummaryBlock);
          const tagsInContent = tagsInString(tagParagraphEl.innerText);
          if (tagsToCheck.includes(tag)) {
            const tagCount = countOccurrences(tagsToCheck, tagsInContent);
            if (tagCount >= 2) {
              this.plugin.tagSummary.update(tagSummaryBlock);
            } else {
              const notice = new import_obsidian9.Notice(tag + " removed from paragraph.\n\u{1F517} Open source note.", 5e3);
              this.plugin.gui.removeElementWithAnimation(
                tagParagraphEl,
                () => {
                  setTimeout(async () => {
                    this.plugin.tagSummary.update(tagSummaryBlock);
                    tagParagraphEl.remove();
                  }, 500);
                }
              );
              this.plugin.registerDomEvent(
                notice.noticeEl,
                "click",
                (e) => {
                  this.app.workspace.openLinkText(filePath, "");
                }
              );
            }
          } else {
            this.plugin.tagSummary.update(tagSummaryBlock);
          }
        }, 200);
      } else if (tagEl2.getAttribute("type") == "native-embed") {
        setTimeout(async () => {
          this.plugin.tagProcessor.processNativeEmbed(tagContainer, true);
        }, 200);
      }
      try {
        await this.app.vault.modify(file, newContent);
      } catch (error) {
        try {
          const backupFileName = String(file.name.substring(0, file.name.indexOf(".md")) + " BACKUP.md");
          this.app.vault.create(backupFileName, fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error.message + "\n" + backupFileName + " saved to vault root.", 1e4);
        } catch (error2) {
          navigator.clipboard.writeText(fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error2.message + "\nNote content copied to clipboard.", 1e4);
        }
      }
      this.plugin.tagProcessor.debouncedProcessActiveFileTagEls();
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't identify tag location. Please try again.");
    }
  }
};

// Mobile.ts
var DoubleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.callback(event);
    } else {
      this.timeout = setTimeout(() => {
        clearTimeout(this.timeout);
      }, 500);
    }
    this.lastTap = currentTime;
  }
};
var TripleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.tapCount = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.tapCount++;
      if (this.tapCount === 2) {
        this.callback(event);
        this.tapCount = 0;
      }
    } else {
      this.tapCount = 0;
    }
    this.timeout = setTimeout(() => {
      clearTimeout(this.timeout);
      this.tapCount = 0;
    }, 500);
    this.lastTap = currentTime;
  }
};
var PressAndHoldHandler = class {
  constructor(plugin, element, callback, duration = 600) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.duration = duration;
    this.timeout = null;
    this.plugin.registerDomEvent(
      this.element,
      "touchstart",
      this.handleTouchStart.bind(this),
      true
    );
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchStart(event) {
    this.timeout = setTimeout(() => {
      this.callback(event);
      this.timeout = null;
    }, this.duration);
  }
  handleTouchEnd(event) {
    if (this.timeout) {
      clearTimeout(this.timeout);
      this.timeout = null;
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  removeOnClick: true,
  removeChildTagsFirst: true,
  optToConvert: true,
  mobileTagSearch: false,
  tagSummaryBlockButtons: false,
  taggedParagraphCopyPrefix: "",
  // new
  desktopClickTag: "remove",
  desktopCMDClickTag: "edit",
  desktopOPTClickTag: "native",
  mobileDoubleTapTag: "remove",
  mobileLongPressTag: "edit",
  mobileTripleTapText: true,
  removeTagBtn: "always",
  copyToCBBtn: "hide",
  moveToSectionBtn: "always",
  copyToSectionBtn: "always",
  copyLinkToSectionBtn: "hide",
  copyToNoteBtn: "always",
  mobileNotices: true,
  recentlyAddedTags: "",
  lockRecentTags: false,
  showSummaryButtons: false,
  debugMode: false
};
var TagBuddy = class extends import_obsidian10.Plugin {
  onunload() {
  }
  // this is needed for hotreload. Actual cleanup is done throughout.
  async onload() {
    console.log("Tag Buddy Plugin loaded on " + (this.app.isMobile ? "mobile at " : "desktop at ") + (/* @__PURE__ */ new Date()).toUTCString().substring(17));
    this.addSettingTab(new TBSettingsTab(this.app, this));
    await this.loadSettings();
    this.app.workspace.onLayoutReady(async () => {
      this.gui = new GUI(this.app, this);
      this.tagSummary = new TagSummary(this.app, this);
      this.tagProcessor = new TagProcessor(this.app, this);
      this.tagEditor = new ReadingModeTagEditor(this.app, this);
      this.registerMarkdownPostProcessor(
        this.tagProcessor.renderPostProcessor.bind(this.tagProcessor)
      );
      try {
        this.registerMarkdownCodeBlockProcessor(
          "tag-summary",
          this.tagSummary.codeBlockProcessor.bind(this.tagSummary)
        );
      } catch (e) {
      }
      this.registerDomEvent(
        document,
        "contextmenu",
        async (event) => {
          const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
          if (view && ctrlCmdKey(event) && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
            event.preventDefault();
            this.gui.showTagSelector(event);
          }
        }
      );
      this.registerEvent(this.app.on(
        "layout-change",
        async (event) => {
          var _a;
          const mode = (_a = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView)) == null ? void 0 : _a.getMode();
          if (this.settings.debugMode)
            console.log("Tag Buddy: layout-change:", mode);
          if (mode == "preview") {
            this.tagProcessor.reset();
            this.tagProcessor.debouncedProcessActiveFileTagEls();
          } else if (mode == "source") {
          }
        }
      ));
      this.registerEvent(this.app.workspace.on(
        "file-open",
        //debounce(
        async (event) => {
          var _a, _b;
          const activeFile = await this.app.workspace.getActiveFile();
          if (this.settings.debugMode)
            console.log("Tag Buddy: last active file:", (_a = this.activeFile) == null ? void 0 : _a.name);
          if (this.settings.debugMode)
            console.log("Tag Buddy: file open:", activeFile == null ? void 0 : activeFile.name);
          if ((activeFile == null ? void 0 : activeFile.path) != ((_b = this.activeFile) == null ? void 0 : _b.path)) {
            this.tagProcessor.reset();
            this.activeFile = this.app.workspace.getActiveFile();
            if (this.tagProcessor) {
              this.tagProcessor.processActiveFileTags();
            }
          }
        }
        //, 3000, true)
      ));
      if (!this.app.isMobile) {
        this.registerDomEvent(
          document,
          "click",
          this.onClickEvent.bind(this),
          true
        );
      } else {
        this.registerDomEvent(
          document,
          "click",
          (e) => {
            const isTag = e.target.classList.contains("tag");
            const tag = e.target.closest(".tag");
            if (isTag && this.settings.mobileDoubleTapTag != "native") {
              e.stopPropagation();
            } else if (!isTag) {
            } else {
            }
          },
          true
        );
        new DoubleTapHandler(
          this,
          document,
          (event) => {
            if (event.target.classList.contains("tag")) {
              this.mobileTapHandler(event, this.settings.mobileDoubleTapTag);
            }
          },
          true
          //this.onClickEvent.bind(this)
        );
        new PressAndHoldHandler(
          this,
          document,
          (event) => {
            if (event.target.classList.contains("tag")) {
              this.mobileTapHandler(event, this.settings.mobileLongPressTag);
            }
          }
          /*async (event: MouseEvent) => {	
           			const view = await this.app.workspace.getActiveViewOfType(MarkdownView);
                 if (view && 
                 	(view.getMode() == 'preview') &&
                 	(view.containerEl.contains(event.target))
                	) {         
                 	event.preventDefault();
                 	this.gui.showTagEditor(event.target.closest('.tag').innerText)
                 }
           		}, true*/
          //(event) => {
          //	this.gui.showTagEditor(event.target.closest('.tag').innerText)
          //}
          //this.onClickEvent.bind(this)
        );
        new TripleTapHandler(
          this,
          document,
          async (event) => {
            const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
            if (view && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
              this.gui.showTagSelector(event);
            }
          },
          true
          //this.gui.showTagSelector.bind(this.gui)
        );
      }
    });
  }
  async mobileTapHandler(event, setting) {
    if (setting == "edit") {
      const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      if (view && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
        this.gui.showTagEditor(event.target.closest(".tag"));
      }
    } else if (setting == "remove") {
      this.tagEditor.edit(event.target, event, null, "remove");
    } else if (setting == "hash") {
      this.tagEditor.edit(event.target, event, null, "hash");
    }
  }
  async onClickEvent(event) {
    const target = event.target;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    const modKey = ctrlCmdKey(event) ? "CMD" : event.altKey ? "OPT" : "";
    if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Unsupported view type. Try again within the source note.");
      return;
    }
    if (view) {
      if (view.getMode() != "preview" || !view.containerEl.contains(event.target))
        return;
    }
    if (!this.app.isMobile) {
      if (this.settings.desktopClickTag == "native" && modKey == "" || this.settings.desktopCMDClickTag == "native" && modKey == "CMD" || this.settings.desktopOPTClickTag == "native" && modKey == "OPT") {
        return;
      } else if (this.settings.desktopClickTag == "edit" && modKey == "" || this.settings.desktopCMDClickTag == "edit" && modKey == "CMD" || this.settings.desktopOPTClickTag == "edit" && modKey == "OPT") {
        if (!target.matches(".tag"))
          return;
        event.stopPropagation();
        event.preventDefault();
        this.gui.showTagEditor(event.target.closest(".tag"));
        return;
      }
    } else {
      setTimeout(() => {
        const selection = window.getSelection();
        if (selection)
          selection.removeAllRanges();
      }, 400);
      if (this.settings.mobileTagSearch && event.type == "touchend") {
        return;
      }
    }
    if (target && target.matches(".tag")) {
      if (this.tagProcessor.outOfSync) {
        new import_obsidian10.Notice("Markdown source and HTML tags are out of sync. Check for tag syntax errors.");
        return;
      }
      let editType;
      if (modKey == "")
        editType = this.settings.desktopClickTag;
      else if (modKey == "CMD")
        editType = this.settings.desktopCMDClickTag;
      else if (modKey == "OPT")
        editType = this.settings.desktopOPTClickTag;
      event.stopPropagation();
      event.preventDefault();
      const clickedTag = target.closest(".tag");
      const tag = clickedTag.innerText;
      let tagIndex = clickedTag.getAttribute("md-index");
      let tagFile = clickedTag.getAttribute("file-source");
      if (tagFile) {
        this.tagEditor.edit(
          target,
          event,
          null,
          editType
        );
      } else {
        setTimeout(async () => {
          tagIndex = clickedTag.getAttribute("md-index");
          tagFile = clickedTag.getAttribute("file-source");
          this.tagEditor.edit(
            target,
            event,
            null,
            editType
          );
        }, 300);
      }
    } else if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Might be in an unsupported view type.");
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getTagsFromApp() {
    const tagsObject = this.app.metadataCache.getTags();
    const tagsArray = Object.entries(tagsObject);
    tagsArray.sort((a, b) => b[1] - a[1]);
    const recentTags = this.getRecentTags();
    if (recentTags.length > 0) {
      const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
      const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
      return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
    } else {
      return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
    }
  }
  saveRecentTag(tag) {
    if (isTagValid(tag, true)) {
      const recentTagsString = this.settings.recentlyAddedTags;
      let recentTags;
      if (recentTagsString == "") {
        recentTags = [];
      } else if (recentTagsString.indexOf(", ")) {
        recentTags = this.settings.recentlyAddedTags.split(", ");
      } else {
        recentTags = [this.settings.recentlyAddedTags];
      }
      if (recentTags.includes(tag)) {
        recentTags.splice(recentTags.indexOf(tag), 1);
      }
      recentTags.unshift(tag.trim());
      recentTags = recentTags.slice(0, 3);
      this.settings.recentlyAddedTags = recentTags.join(", ");
      this.saveSettings();
    } else {
    }
  }
  getRecentTags() {
    const recentTags = this.settings.recentlyAddedTags == "" ? [] : this.settings.recentlyAddedTags.split(", ");
    return recentTags;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJndWkudHMiLCAidXRpbHMudHMiLCAiTW9kYWwudHMiLCAiVGFnRWRpdG9yTW9kYWwudHMiLCAiRmluZEZpbGVNb2RhbC50cyIsICJUYWdTdW1tYXJ5LnRzIiwgIlRhZ1Byb2Nlc3Nvci50cyIsICJSZWFkaW5nTW9kZVRhZ0VkaXRvci50cyIsICJNb2JpbGUudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blJlbmRlcmVyLCBkZWJvdW5jZSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFRCU2V0dGluZ3NUYWIgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuaW1wb3J0IHsgR1VJIH0gZnJvbSBcIi4vZ3VpXCI7XG5pbXBvcnQgeyBUYWdTdW1tYXJ5IH0gZnJvbSAnLi9UYWdTdW1tYXJ5JztcbmltcG9ydCB7IFRhZ1Byb2Nlc3NvciB9IGZyb20gJy4vVGFnUHJvY2Vzc29yJztcbmltcG9ydCB7IFJlYWRpbmdNb2RlVGFnRWRpdG9yIH0gZnJvbSAnLi9SZWFkaW5nTW9kZVRhZ0VkaXRvcic7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcbmltcG9ydCAqIGFzIE1vYmlsZSBmcm9tICcuL01vYmlsZSc7XG5cbmludGVyZmFjZSBUQlNldHRpbmdzIHtcblx0Ly9yZW1vdmVPbkNsaWNrOiBib29sZWFuOyAvLyBjdHJsXG5cdC8vcmVtb3ZlQ2hpbGRUYWdzRmlyc3Q7IC8vIFxuXHQvL29wdFRvQ29udmVydDogYm9vbGVhbjsgLy9hbHRcblx0Ly9tb2JpbGVUYWdTZWFyY2g6IGJvb2xlYW47IFxuXHQvL3RhZ1N1bW1hcnlCbG9ja0J1dHRvbnM6IGJvb2xlYW47IFxuXHQvL3RhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXg6IHN0cmluZztcblxuXG5cdC8vIG5ldyBzZXR0aW5nc1xuXHRkZXNrdG9wQ2xpY2tUYWc6IFN0cmluZztcblx0ZGVza3RvcENNRENsaWNrVGFnOiBTdHJpbmc7XG5cdGRlc2t0b3BPUFRDbGlja1RhZzogU3RyaW5nO1xuXHRtb2JpbGVEb3VibGVUYXBUYWc6IFN0cmluZztcblx0bW9iaWxlTG9uZ1ByZXNzVGFnOiBTdHJpbmc7XG5cdG1vYmlsZVRyaXBsZVRhcFRleHQ6IEJvb2xlYW47XG5cblx0cmVtb3ZlVGFnQnRuOiBTdHJpbmc7XG5cdGNvcHlUb0NCQnRuOiBTdHJpbmc7XG5cdG1vdmVUb1NlY3Rpb25CdG46IFN0cmluZztcblx0Y29weVRvU2VjdGlvbkJ0bjogU3RyaW5nO1xuXHRjb3B5TGlua1RvU2VjdGlvbkJ0bjogU3RyaW5nO1xuXHRjb3B5VG9Ob3RlQnRuOiBTdHJpbmc7XG5cblx0bW9iaWxlTm90aWNlczogYm9vbGVhbjsgXG5cdHJlY2VudGx5QWRkZWRUYWdzOiBzdHJpbmc7XG5cdGxvY2tSZWNlbnRUYWdzOiBib29sZWFuO1xuXHRzaG93U3VtbWFyeUJ1dHRvbnM6Ym9vbGVhbjtcblx0ZGVidWdNb2RlOiBib29sZWFuOyBcblxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPFRCU2V0dGluZ3M+ID0ge1xuXHRyZW1vdmVPbkNsaWNrOiB0cnVlLCBcblx0cmVtb3ZlQ2hpbGRUYWdzRmlyc3Q6IHRydWUsIFxuXHRvcHRUb0NvbnZlcnQ6IHRydWUsIFxuXHRtb2JpbGVUYWdTZWFyY2g6IGZhbHNlLCBcblx0dGFnU3VtbWFyeUJsb2NrQnV0dG9uczogZmFsc2UsXG5cdHRhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXg6ICcnLFxuXG5cblx0Ly8gbmV3XG5cdGRlc2t0b3BDbGlja1RhZzogJ3JlbW92ZScsXG5cdGRlc2t0b3BDTURDbGlja1RhZzogJ2VkaXQnLFxuXHRkZXNrdG9wT1BUQ2xpY2tUYWc6ICduYXRpdmUnLFxuXHRtb2JpbGVEb3VibGVUYXBUYWc6ICdyZW1vdmUnLFxuXHRtb2JpbGVMb25nUHJlc3NUYWc6ICdlZGl0Jyxcblx0bW9iaWxlVHJpcGxlVGFwVGV4dDogdHJ1ZSxcblxuXHRyZW1vdmVUYWdCdG46ICdhbHdheXMnLFxuXHRjb3B5VG9DQkJ0bjogJ2hpZGUnLFxuXHRtb3ZlVG9TZWN0aW9uQnRuOiAnYWx3YXlzJyxcblx0Y29weVRvU2VjdGlvbkJ0bjogJ2Fsd2F5cycsXG5cdGNvcHlMaW5rVG9TZWN0aW9uQnRuOiAnaGlkZScsXG5cdGNvcHlUb05vdGVCdG46ICdhbHdheXMnLFxuXG5cdG1vYmlsZU5vdGljZXM6IHRydWUsXG5cdHJlY2VudGx5QWRkZWRUYWdzOiAnJyxcblx0bG9ja1JlY2VudFRhZ3M6IGZhbHNlLFxuXHRzaG93U3VtbWFyeUJ1dHRvbnM6ZmFsc2UsXG5cdGRlYnVnTW9kZTogZmFsc2Vcbn07IFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWdCdWRkeSBleHRlbmRzIFBsdWdpbiB7ICBcblx0c2V0dGluZ3M6IFRCU2V0dGluZ3M7XG5cdGd1aTogR1VJO1xuXHR0YWdTdW1tYXJ5OiBUYWdTdW1tYXJ5O1xuXHR0YWdQcm9jZXNzb3I6IFRhZ1Byb2Nlc3Nvcjtcblx0dGFnRWRpdG9yOiBSZWFkaW5nTW9kZVRhZ0VkaXRvcjtcblx0cHJpdmF0ZSBhY3RpdmVGaWxlOiBURmlsZTtcblxuXHRvbnVubG9hZCgpIHsgfSAvLyB0aGlzIGlzIG5lZWRlZCBmb3IgaG90cmVsb2FkLiBBY3R1YWwgY2xlYW51cCBpcyBkb25lIHRocm91Z2hvdXQuXG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgUGx1Z2luIGxvYWRlZCBvbiAnIFxuXHRcdFx0KyAodGhpcy5hcHAuaXNNb2JpbGUgPyAnbW9iaWxlIGF0ICc6J2Rlc2t0b3AgYXQgJykgXG5cdFx0XHQrIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKS5zdWJzdHJpbmcoMTcpKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVEJTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHRcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblxuXHRcdFx0dGhpcy5ndWkgPSBuZXcgR1VJKHRoaXMuYXBwLCB0aGlzKVxuXHRcdFx0dGhpcy50YWdTdW1tYXJ5ID0gbmV3IFRhZ1N1bW1hcnkgKHRoaXMuYXBwLCB0aGlzKTtcblx0XHRcdHRoaXMudGFnUHJvY2Vzc29yID0gbmV3IFRhZ1Byb2Nlc3NvciAodGhpcy5hcHAsIHRoaXMpO1xuXHRcdFx0dGhpcy50YWdFZGl0b3IgPSBuZXcgUmVhZGluZ01vZGVUYWdFZGl0b3IgKHRoaXMuYXBwLCB0aGlzKTtcdFxuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKFxuXHRcdFx0dGhpcy50YWdQcm9jZXNzb3IucmVuZGVyUG9zdFByb2Nlc3Nvci5iaW5kKHRoaXMudGFnUHJvY2Vzc29yKVxuXHRcdFx0KVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFxuXHRcdFx0XHRcdCd0YWctc3VtbWFyeScsIFxuXHRcdFx0XHRcdHRoaXMudGFnU3VtbWFyeS5jb2RlQmxvY2tQcm9jZXNzb3IuYmluZCh0aGlzLnRhZ1N1bW1hcnkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGNhdGNoIHt9XG5cdFx0ICAgIFxuXHRcdCAgICAvL3RoaXMucmVnaXN0ZXJFdmVudCggdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCBhc3luYyAoKSA9PiB7IGNvbnNvbGUubG9nKCdhY3RpdmUgbGVhZiBjaGFuZ2UnKSB9KSk7XG5cdFx0ICAgIC8vdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWNoYW5nZScsIGFzeW5jICgpID0+IHsgY29uc29sZS5sb2coJ2VkaXRvciBjaGFuZ2UnKTsgIH0sIHRydWUpKTtcblx0XHQgICAgLy90aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpKSk7XG5cdFx0ICAgIFxuXHRcdCAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0ICAgIFx0ZG9jdW1lbnQsIFxuXHRcdCAgICBcdCdjb250ZXh0bWVudScsIFxuXHRcdCAgICBcdGFzeW5jIChldmVudDogTW91c2VFdmVudCkgPT4ge1x0XG5cdCAgICBcdFx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdCAgICAgICAgXG5cdFx0XHQgICAgICAgIGlmICh2aWV3ICYmIFxuXHRcdFx0ICAgICAgICBcdFV0aWxzLmN0cmxDbWRLZXkgKGV2ZW50KSAmJlxuXHRcdFx0ICAgICAgICBcdCh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmXG5cdFx0XHQgICAgICAgIFx0KHZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSlcblx0XHQgICAgICAgIFx0KSB7ICAgICAgICAgXG5cdFx0XHQgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0ICAgICAgICAgICAgLy90aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcblx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHQgICAgICAgIH1cblx0XHQgICAgfSk7IFxuXHRcdCAgIFxuXHRcdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm9uKFxuXHRcdFx0XHQnbGF5b3V0LWNoYW5nZScsIFxuXHRcdFx0XHRhc3luYyAoZXZlbnQ6IEVkaXRvckV2ZW50KSA9PiB7ICBcblx0XHRcdFx0XHRjb25zdCBtb2RlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZ2V0TW9kZSgpO1xuXHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogbGF5b3V0LWNoYW5nZTonLCBtb2RlKTtcblx0XHRcdFx0XHRpZiAobW9kZSA9PSAncHJldmlldycpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnJlc2V0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLnRhZ1Byb2Nlc3Nvci5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscygpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnc291cmNlJykge1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0KSk7XG5cdFx0XHRcblx0XHRcdC8vZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFxuXHRcdFx0XHQnZmlsZS1vcGVuJywgXG5cdFx0XHRcdC8vZGVib3VuY2UoXG5cdFx0XHRcdGFzeW5jIChldmVudDogRWRpdG9yRXZlbnQpID0+IHsgXG5cdFx0XHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBsYXN0IGFjdGl2ZSBmaWxlOicsIHRoaXMuYWN0aXZlRmlsZT8ubmFtZSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBmaWxlIG9wZW46JywgYWN0aXZlRmlsZT8ubmFtZSlcblx0XHRcdFx0XHRpZiAoYWN0aXZlRmlsZT8ucGF0aCAhPSB0aGlzLmFjdGl2ZUZpbGU/LnBhdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnJlc2V0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLmFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMudGFnUHJvY2Vzc29yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnByb2Nlc3NBY3RpdmVGaWxlVGFncygpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZygnZmlsZSBvcGVuOicsIGFjdGl2ZUZpbGUubmFtZSlcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLywgMzAwMCwgdHJ1ZSlcblx0XHRcdCkpO1xuXG5cdFx0XHQvLyBOb3QgZG9pbmcgdGhpcyBiZWNhdXNlIHRoZXkgbmVlZCB0byBvcHQrY2xpY2sgb24gYSB0YWcgdG8gcGFzcyBpdFxuXHRcdFx0Ly8gSSBkb24ndCB3YW50IHRvIGhhdmUgdG8gYWRkIGEgdGFnIHNlbGVjdG9yIGluIHRoZSBlZGl0b3Jcblx0XHRcdC8vIHRoaW5rIG9uIG1vYmlsZS4uLiB0b28gbWFueSBsYXllcnMgb2YgbW9kYWxzLlxuXHRcdFx0Lyp0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogXCJ0YWdidWRkeS10YWctYWN0aW9uc1wiLFxuXHRcdFx0XHRuYW1lOiBcIlRhZyBBY3Rpb25cIixcblx0XHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0XHQvL3RoaXMuZ3VpLnNob3dUYWdFZGl0b3IoKVxuXHRcdFx0XHRcdHRoaXMuZ3VpLnNob3dUYWdFZGl0b3IoKVxuXHRcdFx0XHR9LFxuXHRcdFx0fSk7Ki9cblxuXHRcdFx0Ly90aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQuYm9keSwgJ3Njcm9sbCcsIChldmVudCkgPT4ge30sIHRydWUpO1xuXG5cdFx0XHRpZiAoIXRoaXMuYXBwLmlzTW9iaWxlKSB7XG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgaGFuZGxlcyBhbGwgdGhlIGludGVyYWN0aW9ucyBvbiBkZXNrdG9wXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0J2NsaWNrJywgXG5cdFx0XHRcdFx0dGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSwgXG5cdFx0XHRcdFx0dHJ1ZVxuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHsgLy8gTW9iaWxlIGludGVyYWN0aW9uXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgY2F0Y2hlcyBhbGwgdGFwcyBvbiBtb2JpbGUgYmVjYXVzZSB3ZSBoYXZlIGN1c3RvbSBkb3VibGUtdGFwIGFuZCBwcmVzcy1ob2xkIGV2ZW50cy5cblx0XHRcdFx0Ly8gQnV0IHdlIG9ubHkgc3RvcCBhbGwgb3RoZXIgbW9iaWxlIGV2ZW50cyBpZiB0aGlzIGNsaWNrIHdhcyBvbiBhIHRhZy4gXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0J2NsaWNrJywgXG5cdFx0XHRcdFx0KGU6RXZlbnQpID0+IHsgXG5cdFx0XHRcdFx0XHRjb25zdCBpc1RhZyA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndGFnJyk7XG5cdFx0XHRcdFx0XHRjb25zdCB0YWcgPSBlLnRhcmdldC5jbG9zZXN0KCcudGFnJylcblx0XHRcdFx0XHRcdC8vdGFyZ2V0LmNsb3Nlc3QoJy50YWcnKVxuLy9uZXcgTm90aWNlIChpc1RhZylcdFx0XHRcdFx0XHRcbi8vbmV3IE5vdGljZSAodGFnLmlubmVyVGV4dClcbi8vbmV3IE5vdGljZSAodGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcpXG5cdFx0XHRcdFx0XHQvL2lmIChpc1RhZyAmJiAhdGhpcy5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2gpIHtcblx0XHRcdFx0XHRcdC8vaWYgKHRoaXMuc2V0dGluZ3MubW9iaWxlRG91YmxlVGFwVGFnID09ICduYXRpdmUnKSB7XG5cdFx0XHRcdFx0XHRpZiAoaXNUYWcgJiYgdGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcgIT0gJ25hdGl2ZScpIHtcblx0XHRcdFx0XHRcdC8vaWYgKGlzVGFnKSB7IFxuLy9uZXcgTm90aWNlIChpc1RhZylcdFx0XHRcdFx0XHRcbi8vbmV3IE5vdGljZSAodGFnLmlubmVyVGV4dClcbi8vbmV3IE5vdGljZSAodGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcpXG4vL25ldyBOb3RpY2UgKCdpcyB0YWcnKVxuXHRcdFx0XHRcdFx0Ly9pZiAoaXNUYWcgJiYgKHRoaXMuc2V0dGluZy5tb2JpbGVEb3VibGVUYXBUYWcgIT0gJ25hdGl2ZScvLyB8fFxuXHRcdFx0XHRcdFx0XHRcdFx0ICAvL3RoaXMucGx1Z2luLnNldHRpbmcubW9iaWxlTG9uZ1ByZXNzVGFnICE9ICduYXRpdmUnXG5cdFx0XHRcdFx0XHQvL1x0XHRcdCAgKSkge1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHQvL2UucHJldmVudERlZmF1bHQoKTtcblxuLy9uZXcgTm90aWNlICgndGFwcGVkIHRhZyBhbmQgc3RvcCBhbGwgb3RoZXIgbW9iaWxlIHRvdWNoZXMgZXhjZXB0IG91ciBjdXN0b20gb25lcycpXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCFpc1RhZykge1xuXHRcdFx0XHRcdFx0XHQvL2UucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0Ly9lLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHQvL2Uuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sIHRydWVcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRcblx0XHRcdFx0bmV3IE1vYmlsZS5Eb3VibGVUYXBIYW5kbGVyKFxuXHRcdFx0XHRcdHRoaXMsIFxuXHRcdFx0XHRcdGRvY3VtZW50LCAgXG5cdFx0XHRcdFx0KGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHQvL25ldyBOb3RpY2UgKCdkb3VibGUgdGFwJylcblx0XHRcdFx0XHRcdC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWcnKSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vYmlsZVRhcEhhbmRsZXIgKGV2ZW50LCB0aGlzLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LCB0cnVlXG5cdFx0XHRcdFx0Ly90aGlzLm9uQ2xpY2tFdmVudC5iaW5kKHRoaXMpXG5cdFx0XHRcdCk7XG5cdFx0XHRcdG5ldyBNb2JpbGUuUHJlc3NBbmRIb2xkSGFuZGxlcihcblx0XHRcdFx0XHR0aGlzLCBcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0KGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHQvL25ldyBOb3RpY2UgKCdob2xkJylcblx0XHRcdFx0XHRcdGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWcnKSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vYmlsZVRhcEhhbmRsZXIgKGV2ZW50LCB0aGlzLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc1RhZylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Lyphc3luYyAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcdFxuXHRcdCAgICBcdFx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdFx0ICAgICAgICBpZiAodmlldyAmJiBcblx0XHRcdFx0ICAgICAgICBcdCh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmXG5cdFx0XHRcdCAgICAgICAgXHQodmlldy5jb250YWluZXJFbC5jb250YWlucyhldmVudC50YXJnZXQpKVxuXHRcdFx0ICAgICAgICBcdCkgeyAgICAgICAgIFxuXHRcdFx0XHQgICAgICAgIFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ICAgICAgICBcdHRoaXMuZ3VpLnNob3dUYWdFZGl0b3IoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy50YWcnKS5pbm5lclRleHQpXG5cdFx0XHRcdCAgICAgICAgfVxuXHRcdCAgICBcdFx0fSwgdHJ1ZSovXG5cdFx0XHRcdFx0Ly8oZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvL1x0dGhpcy5ndWkuc2hvd1RhZ0VkaXRvcihldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFx0XHQvL31cblx0XHRcdFx0XHQvL3RoaXMub25DbGlja0V2ZW50LmJpbmQodGhpcylcblx0XHRcdFx0KTtcblx0XHRcdFx0bmV3IE1vYmlsZS5UcmlwbGVUYXBIYW5kbGVyKFxuXHRcdFx0XHRcdHRoaXMsXG5cdFx0XHRcdFx0ZG9jdW1lbnQsIFxuXHRcdFx0XHRcdGFzeW5jIChldmVudDogTW91c2VFdmVudCkgPT4ge1x0XG5cdFx0ICAgIFx0XHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0XHQgICAgICAgIGlmICh2aWV3ICYmIFxuXHRcdFx0XHQgICAgICAgIFx0KHZpZXcuZ2V0TW9kZSgpID09ICdwcmV2aWV3JykgJiZcblx0XHRcdFx0ICAgICAgICBcdCh2aWV3LmNvbnRhaW5lckVsLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpXG5cdFx0XHQgICAgICAgIFx0KSB7ICAgICAgICAgXG5cdFx0XHRcdCAgICAgICAgXHQvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHRcdCAgICAgICAgfVxuXHRcdCAgICBcdFx0fSwgdHJ1ZVxuXHRcdFx0XHRcdC8vdGhpcy5ndWkuc2hvd1RhZ1NlbGVjdG9yLmJpbmQodGhpcy5ndWkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9XHRcblxuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgbW9iaWxlVGFwSGFuZGxlciAoZXZlbnQsIHNldHRpbmcpIHtcbi8vbmV3IE5vdGljZSAoc2V0dGluZylcblx0XHRpZiAoc2V0dGluZyA9PSAnZWRpdCcpIHtcblx0XHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQgICAgICAgIGlmICh2aWV3ICYmICh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmICh2aWV3LmNvbnRhaW5lckVsLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpKSBcblx0ICAgICAgICB7ICAgICAgICAgXG5cdCAgICAgICAgXHQvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgXHQvL2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG5cdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykpXG5cdCAgICAgICAgfVxuXHRcdH0gZWxzZSBpZiAoc2V0dGluZyA9PSAncmVtb3ZlJykge1xuXHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdChldmVudC50YXJnZXQsIGV2ZW50LCBudWxsLCAncmVtb3ZlJylcblx0XHR9IGVsc2UgaWYgKHNldHRpbmcgPT0gJ2hhc2gnKSB7XG5cdFx0XHR0aGlzLnRhZ0VkaXRvci5lZGl0KGV2ZW50LnRhcmdldCwgZXZlbnQsIG51bGwsICdoYXNoJylcblx0XHR9XG5cdH1cblxuXHRhc3luYyBvbkNsaWNrRXZlbnQgKFxuXHRcdGV2ZW50OiBFdmVudFxuXHQpOnZvaWQge1xuXHRcdC8vIFN1cHBvcnQgZm9yIGRpZmZlcmVudCB2aWV3cz8gXG5cdFx0Ly8gSWYgdGFnIGhhcyBubyBjb250ZXh0IHByb3BlcnRpZXMsIHRoZW4gdHJ5IHRvIGZpZ3VyZSBvdXQgd2hlcmUgaXQgaXM/XG5cdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblxuXHRcdGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBtb2RLZXk6IFN0cmluZyA9IFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpID8gJ0NNRCcgOiAoZXZlbnQuYWx0S2V5ID8gJ09QVCcgOiAnJyk7XG5cblx0XHQvLyBUaGlzIGNvbmRpdGlvbiBpdCBpbiBjYXNlIHdlIGNsaWNrIG9uIGEgdGFnIGluIGFub3RoZXIgcGx1Z2luIGxpa2UgcmVwZWF0IG9yIGNoZWNrbGlzdFxuXHRcdC8vIENhbid0IGVkaXQgdGFncyBpbiB0aGVzZSBjYXNlcy4gRm9yIG5vdy5cblx0XHRpZiAoIXZpZXcgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkgeyBcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gVW5zdXBwb3J0ZWQgdmlldyB0eXBlLiBUcnkgYWdhaW4gd2l0aGluIHRoZSBzb3VyY2Ugbm90ZS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmlldykgeyBcblx0XHRcdGlmICh2aWV3LmdldE1vZGUoKSAhPSAncHJldmlldycgfHwgIXZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkgcmV0dXJuO1xuXHRcdH0gXG5cdFxuXG5cdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblx0XHRcdC8vY29uc29sZS5sb2coZXZlbnQudHlwZSlcblx0XHRcdC8qaWYgKCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAnbmF0aXZlJyAmJiAoIVV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmICFldmVudC5hbHRLZXkpKSB8fFxuXHRcdFx0XHQodGhpcy5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcgPT0gJ25hdGl2ZScgJiYgVXRpbHMuY3RybENtZEtleShldmVudCkpIHx8XG5cdFx0XHRcdCh0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyA9PSAnbmF0aXZlJyAmJiBldmVudC5hbHRLZXkpKSB7ICovXG5cdFx0XHRpZiAoKHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnJykgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnQ01EJykgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcE9QVENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnT1BUJykpIHsgXG4vL2NvbnNvbGUubG9nKCduYXRpdmUgdGFnIGNsaWNrJylcblx0XHRcdFx0cmV0dXJuOyBcbiBcblx0XHRcdC8vfSBlbHNlIGlmIChldmVudC5hbHRLZXkgJiYgdGFyZ2V0ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHsgIFxuXHRcdFx0Lyp9IGVsc2UgaWYgKCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAnZWRpdCcgJiYgKCFVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSAmJiAhZXZlbnQuYWx0S2V5KSkgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnID09ICdlZGl0JyAmJiBVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSkgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcE9QVENsaWNrVGFnID09ICdlZGl0JyAmJiBldmVudC5hbHRLZXkpKSB7Ki9cblx0XHRcdH0gZWxzZSBpZiAoKHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID09ICdlZGl0JyAmJiBtb2RLZXkgPT0gJycpIHx8XG5cdFx0XHRcdCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDTURDbGlja1RhZyA9PSAnZWRpdCcgJiYgbW9kS2V5ID09ICdDTUQnKSB8fFxuXHRcdFx0XHQodGhpcy5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcgPT0gJ2VkaXQnICYmIG1vZEtleSA9PSAnT1BUJykpIHtcblx0XHRcdFx0aWYgKCF0YXJnZXQubWF0Y2hlcygnLnRhZycpKSByZXR1cm5cbi8vY29uc29sZS5sb2coJ2VkaXQgdGFnJylcblx0XHRcdFx0Ly8gZ2V0IHRoZSB0YWcgdmlhOiBldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dFxuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0Ly90aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykuaW5uZXJUZXh0KVxuXHRcdFx0XHR0aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykpXG5cdFx0XHRcblx0XHRcdFx0cmV0dXJuOyBcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIFJlbW92ZXMgdGhlIGF1dG9tYXRpYyBzeXN0ZW0gc2VsZWN0aW9uIG9uIG1vYmlsZS4gXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHsgXG5cdFx0XHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdFx0aWYgKHNlbGVjdGlvbikgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuXHRcdFx0fSwgNDAwKVxuXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggJiYgZXZlbnQudHlwZSA9PSAndG91Y2hlbmQnKSB7XG5cdFx0XHRcdC8vIGlmIHdlIGdldCB0aGlzIGZhciwgdGhpcyBpcyBhIGRvdWJsZSB0YXBcblx0XHRcdFx0Ly9jb25zb2xlLmxvZygnaGFuZGxlIHRvdWNoIGVuZCcpXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH0gXG5cdFx0fVxuIFxuXHRcdGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkge1x0XG5cdFx0XHQvLyBjb25zdCBzY3JvbGxTdGF0ZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmN1cnJlbnRNb2RlPy5nZXRTY3JvbGwoKTtcblxuXHRcdFx0aWYgKHRoaXMudGFnUHJvY2Vzc29yLm91dE9mU3luYykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdNYXJrZG93biBzb3VyY2UgYW5kIEhUTUwgdGFncyBhcmUgb3V0IG9mIHN5bmMuIENoZWNrIGZvciB0YWcgc3ludGF4IGVycm9ycy4nKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2xldCBlZGl0VHlwZSA9IFxuXHRcdFx0Ly9pZiAodGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrIFxuXHRcdFx0Ly9cdHx8ICghdGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrICYmIFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpKSkge1xuXHRcdFx0Ly9bJ3JlbW92ZScsICdoYXNoJ10uaW5jbHVkZXModGhpcy5zZXR0aW5ncy5kZXNrdG9wQ2xpY2tUYWcpXG5cdFx0XHQvL2lmIChbdGhpcy5zZXR0aW5ncy5kZXNrdG9wQ2xpY2tUYWcsIHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnLCB0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZ10uaW5jbHVkZXMoJ3JlbW92ZScpKVxuXHRcdFx0XG5cdFx0XHRsZXQgZWRpdFR5cGU7XG5cdFx0XHRpZiAobW9kS2V5ID09ICcnKSBlZGl0VHlwZSA9IHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnXG5cdFx0XHRlbHNlIGlmIChtb2RLZXkgPT0gJ0NNRCcpIGVkaXRUeXBlID0gdGhpcy5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWdcblx0XHRcdGVsc2UgaWYgKG1vZEtleSA9PSAnT1BUJykgZWRpdFR5cGUgPSB0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyBcblxuLy8gYXQgdGhpcyBwb2ludCB3ZSBzaG91bGQgb25seSBiZSBkZWFsaW5nIHdpdGggJ3JlbW92ZScgb3IgJ2hhc2gnLiBzbyB3ZSBjYW4gYWx3YXlzIHN0b3AgdGhlIGRlZmF1bHQgbm93LlxuLy9jb25zb2xlLmxvZyAoZWRpdFR5cGUpXG5cdFx0XHQvKmlmICh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAncmVtb3ZlJyB8fFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmRlc2t0b3BDTURDbGlja1RhZyA9PSAncmVtb3ZlJyB8fFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyA9PSAncmVtb3ZlJykgeyovXG5cdFx0XHQvL2lmIChlZGl0VHlwZSA9PSAncmVtb3ZlJykge1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vfVxuXG5cdFx0XHRjb25zdCBjbGlja2VkVGFnID0gdGFyZ2V0LmNsb3Nlc3QoJy50YWcnKTsgXG5cdFx0XHRjb25zdCB0YWcgPSBjbGlja2VkVGFnLmlubmVyVGV4dDtcblxuXHRcdFx0bGV0IHRhZ0luZGV4ID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4Jyk7XG5cdFx0XHRsZXQgdGFnRmlsZSA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpO1xuXG5cdFx0XHRpZiAodGFnRmlsZSkge1xuXHRcdFx0XHQvLyBUcnlcblx0XHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdChcblx0XHRcdFx0XHR0YXJnZXQsIFxuXHRcdFx0XHRcdGV2ZW50LFxuXHRcdFx0XHRcdG51bGwsXG5cdFx0XHRcdFx0ZWRpdFR5cGVcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFRyeSBhZ2FpblxuXHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHR0YWdJbmRleCA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdtZC1pbmRleCcpO1xuXHRcdFx0XHRcdHRhZ0ZpbGUgPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKTtcblx0XHRcdFx0XHR0aGlzLnRhZ0VkaXRvci5lZGl0IChcblx0XHRcdFx0XHRcdHRhcmdldCwgXG5cdFx0XHRcdFx0XHRldmVudCxcblx0XHRcdFx0XHRcdG51bGwsXG5cdFx0XHRcdFx0XHRlZGl0VHlwZVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2UgaWYgKCF2aWV3ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHtcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gTWlnaHQgYmUgaW4gYW4gdW5zdXBwb3J0ZWQgdmlldyB0eXBlLicpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cdFxuXHRnZXRUYWdzRnJvbUFwcCgpOiBzdHJpbmdbXSB7XG5cdCAgICBjb25zdCB0YWdzT2JqZWN0ID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCk7XG5cblx0ICAgIC8vIENvbnZlcnQgdGFnc09iamVjdCB0byBhbiBhcnJheSBvZiBbdGFnLCBjb3VudF0gdHVwbGVzXG5cdCAgICBjb25zdCB0YWdzQXJyYXkgPSBPYmplY3QuZW50cmllcyh0YWdzT2JqZWN0KTtcblxuXHQgICAgLy8gU29ydCBieSB1c2UgY291bnRcblx0ICAgIHRhZ3NBcnJheS5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSk7XG5cblx0ICAgIGNvbnN0IHJlY2VudFRhZ3MgPSB0aGlzLmdldFJlY2VudFRhZ3MoKTtcblx0ICAgLy8gY29uc29sZS5sb2coJ3JlY2VudCB0YWcgbGVuZ3RoOiAnICsgcmVjZW50VGFncy5sZW5ndGgpXG5cblx0ICAgIGlmIChyZWNlbnRUYWdzLmxlbmd0aD4wKSB7XG5cdCAgICBcdC8vY29uc29sZS5sb2cocmVjZW50VGFncylcblx0ICAgIFx0Ly8gY29udmVydCB0aGVtIHRvIFt0YWcsIGNvdW50XSB0dXBsZXMgZm9yIGNvbnNpc3RlbmN5XG5cdCAgIFx0XHRjb25zdCByZWNlbnRUYWdzQXNUdXBsZXMgPSByZWNlbnRUYWdzLm1hcCh0YWcgPT4gW3RhZywgMF0pO1xuXHQgICAgXHQvLyBDb25jYXRlbmF0ZSB0aGUgdHdvIGFycmF5c1xuXHQgICAgXHRjb25zdCByZWNlbnRBbmRBbGxUYWdzID0gcmVjZW50VGFnc0FzVHVwbGVzLmNvbmNhdCh0YWdzQXJyYXkpO1xuXHQgICAgXHQvLyBFeHRyYWN0IHRhZyBuYW1lcyBhZnRlciByZW1vdmluZyB0aGUgI1xuXHQgICAgXHRyZXR1cm4gcmVjZW50QW5kQWxsVGFncy5tYXAoKFt0YWcsIF9dKSA9PiB0YWcucmVwbGFjZSgvXiMvLCBcIlwiKSk7XG4gICAgICAgXHR9IGVsc2Uge1xuICAgICAgIFx0XHRyZXR1cm4gdGFnc0FycmF5Lm1hcCgoW3RhZywgX10pID0+IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpKTtcbiAgICAgICBcdH1cblx0fVxuXG5cdHNhdmVSZWNlbnRUYWcgKFxuXHRcdHRhZzpzdHJpbmdcblx0KTp2b2lkIHtcbi8vY29uc29sZS5sb2coJ3NhdmUgcmVjZW50IHRhZzonLCB0YWcpXG5cdFx0aWYgKFV0aWxzLmlzVGFnVmFsaWQodGFnLCB0cnVlKSkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYWNjZXB0ZWQ6JywgdGFnKVxuLy9jb25zb2xlLmxvZyhcImFzZGZhc2RmYXNkZnNkZlwiKVxuXHRcdFx0Y29uc3QgcmVjZW50VGFnc1N0cmluZyA9IHRoaXMuc2V0dGluZ3MucmVjZW50bHlBZGRlZFRhZ3M7XG5cdFx0XHRsZXQgcmVjZW50VGFnczpBcnJheTtcblx0XHRcdGlmIChyZWNlbnRUYWdzU3RyaW5nID09ICcnKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSBbXTtcblx0XHRcdH0gZWxzZSBpZiAocmVjZW50VGFnc1N0cmluZy5pbmRleE9mKCcsICcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSB0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzLnNwbGl0KCcsICcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVjZW50VGFncyA9IFt0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzXVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAocmVjZW50VGFncy5pbmNsdWRlcyh0YWcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3Muc3BsaWNlKHJlY2VudFRhZ3MuaW5kZXhPZih0YWcpLCAxKTtcblx0XHRcdH1cblxuXHRcdFx0cmVjZW50VGFncy51bnNoaWZ0KHRhZy50cmltKCkpO1xuXHRcdFx0cmVjZW50VGFncyA9IHJlY2VudFRhZ3Muc2xpY2UoMCwgMyk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzID0gcmVjZW50VGFncy5qb2luKCcsICcpO1xuXHRcdFx0dGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygncmVqZWN0ZWQ6JywgdGFnKVxuXHRcdH1cblx0fVxuXG5cdGdldFJlY2VudFRhZ3MgKCk6QXJyYXkge1xuXHRcdGNvbnN0IHJlY2VudFRhZ3MgPSBcblx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzPT0nJyA/IFtdIDogdGhpcy5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncy5zcGxpdCgnLCAnKTtcblx0XHRyZXR1cm4gcmVjZW50VGFncztcblx0fVxufVxuIiwgImltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBUQlNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5KSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuICAgIFxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpOyBcblxuXG4gICAgICAgIGZ1bmN0aW9uIGlzVmFsaWRUYWcodGFnKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdQYXR0ZXJuID0gL14jW1xcd10rJC87XG4gICAgICAgICAgICByZXR1cm4gdGFnUGF0dGVybi50ZXN0KHRhZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaWx0ZXJBbmRKb2luVGFncyh0YWdzU3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdzQXJyYXkgPSB0YWdzU3RyaW5nLnNwbGl0KFwiLCBcIik7XG4gICAgICAgICAgICBjb25zdCB2YWxpZFRhZ3MgPSB0YWdzQXJyYXkuZmlsdGVyKGlzVmFsaWRUYWcpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkVGFncy5qb2luKFwiLCBcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJHZW5lcmFsXCIgfSk7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgLy8gQWRkaW5nIHdpbGwgYWx3YXlzIGxpbWl0IHRvIDMuIEJ1dCBpZiB0aGV5IGVkaXQgaXQgaGVyZSwgaXQgY2FuIGJlIGFueSBsZW5ndGguXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVGhlIG1vc3QgcmVjZW50IHRhZ3MgYWRkZWQgdmlhIFRhZyBCdWRkeSBhcmUgc3RvcmVkIGhlcmUuIFRoZXNlIHdpbGwgc2hvdyB1cCBmaXJzdCBpbiB0aGUgbGlzdCB3aGVuIGFkZGluZy5cIilcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncyA9IGZpbHRlckFuZEpvaW5UYWdzKHZhbHVlKTsgLy92YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJMb2NrIHJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9OIHRvIGxvY2sgdGhlIHJlY2VudCB0YWdzIGxpc3QuIFJlY2VudCB0YWdzIHdpbGwgbm90IGJlIHVwZGF0ZWQuIEluc3RlYWQsIHRoZSB0YWdzIGFib3ZlIHdpbGwgYWN0IGxpa2UgYSBmYXZvcml0ZXMgbGlzdC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiRGVza3RvcFwiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWN0aW9uIHdoZW4gY2xpY2tpbmcgYSB0YWc6XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIldoYXQgc2hvdWxkIGhhcHBlbiB3aGVuIHlvdSBjbGljayBhIHRhZz9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3JlbW92ZScsIFwiUmVtb3ZlIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hhc2gnLCBcIlJlbW92ZSBoYXNoXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZWRpdCcsIFwiRWRpdCB0YWdcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCduYXRpdmUnLCBcIlNlYXJjaCB0YWdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkFjdGlvbiB3aGVuIGNsaWNraW5nIGEgdGFnIHdpdGggQ01EL0NUUkwgbW9kaWZpZXIga2V5OlwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgQ01EIG9yIENUUkwga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbigncmVtb3ZlJywgXCJSZW1vdmUgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGFzaCcsIFwiUmVtb3ZlIGhhc2hcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlZGl0JywgXCJFZGl0IHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ25hdGl2ZScsIFwiU2VhcmNoIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWN0aW9uIHdoZW4gY2xpY2tpbmcgYSB0YWcgd2l0aCBPUFQvQUxUIG1vZGlmaWVyIGtleTpcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbigncmVtb3ZlJywgXCJSZW1vdmUgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGFzaCcsIFwiUmVtb3ZlIGhhc2hcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlZGl0JywgXCJFZGl0IHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ25hdGl2ZScsIFwiU2VhcmNoIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIk1vYmlsZVwiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJTaG93IG1vYmlsZSBub3RpY2VzXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gaGlkZSBub3RpY2VzLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBY3Rpb24gd2hlbiBET1VCTEUtVEFQUElORyBhIHRhZzpcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IERPVUJMRS1UQVAgYSB0YWc/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdyZW1vdmUnLCBcIlJlbW92ZSB0YWdcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoYXNoJywgXCJSZW1vdmUgaGFzaFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2VkaXQnLCBcIkVkaXQgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbmF0aXZlJywgXCJTZWFyY2ggdGFnXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBY3Rpb24gd2hlbiBMT05HLVBSRVNTSU5HIGEgdGFnOlwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgTE9ORy1QUkVTUyBhIHRhZz9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3JlbW92ZScsIFwiUmVtb3ZlIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hhc2gnLCBcIlJlbW92ZSBoYXNoXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZWRpdCcsIFwiRWRpdCB0YWdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTG9uZ1ByZXNzVGFnKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTG9uZ1ByZXNzVGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlRSSVBMRS1UQVAgbm9uLXRhZywgbm9uLWxpbmsgdGV4dCB0byBhZGQgYSB0YWc6XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gZGlzYWJsZSB0cmlwbGUtdGFwLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUcmlwbGVUYXBUZXh0KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlVHJpcGxlVGFwVGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiVGFnIFN1bW1hcmllc1wiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJTaG93IHRhZyBzdW1tYXJ5IGJ1dHRvbnNcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9GRiB0byBoaWRlIHRoZXNlIGJ1dHRvbnMuXCIpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNVwiLCB7IHRleHQ6IFwiVGFnIFN1bW1hcmllcyBJdGVtc1wiIH0pO1xuXG4gICAgICAgIC8vIHNob3cgYnV0dG9uIDogYm90aCwgZGVza3RvcCBvbmx5LCBtb2JpbGUgb25seSwgbm9uZVxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlJlbW92ZSB0YWcgYnV0dG9uOlwiKVxuICAgICAgICAgICAgLy8uc2V0RGVzYyhcIldoYXQgc2hvdWxkIGhhcHBlbiB3aGVuIHlvdSBjbGljayBhIHRhZyB3aGlsZSBob2xkaW5nIHRoZSBPUFQgb3IgQUxUIGtleT9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Fsd2F5cycsIFwiRGVza3RvcCBhbmQgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZGVza3RvcCcsIFwiT25seSBkZXNrdG9wXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbW9iaWxlJywgXCJPbmx5IG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hpZGUnLCBcIkhpZGVcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gY2xpcGJvYXJkIGJ1dHRvbjpcIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgT1BUIG9yIEFMVCBrZXk/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdhbHdheXMnLCBcIkRlc2t0b3AgYW5kIG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Rlc2t0b3AnLCBcIk9ubHkgZGVza3RvcFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ21vYmlsZScsIFwiT25seSBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoaWRlJywgXCJIaWRlXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlUb0NCQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvQ0JCdG4gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTW92ZSB0byBzZWN0aW9uIGJ1dHRvbjpcIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgT1BUIG9yIEFMVCBrZXk/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdhbHdheXMnLCBcIkRlc2t0b3AgYW5kIG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Rlc2t0b3AnLCBcIk9ubHkgZGVza3RvcFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ21vYmlsZScsIFwiT25seSBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoaWRlJywgXCJIaWRlXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4pXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb3ZlVG9TZWN0aW9uQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gc2VjdGlvbiBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9TZWN0aW9uQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvU2VjdGlvbkJ0biA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJDb3B5IGxpbmsgdG8gc2VjdGlvbiBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5TGlua1RvU2VjdGlvbkJ0bilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlMaW5rVG9TZWN0aW9uQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gbm90ZSBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvTm90ZUJ0biA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gaWYgYW55IG9mIHRoZSBvdGhlciBidXR0b25zIGFyZSBzaG93biwgd2Ugc2hvdyB0aGUgZHJvcCBkb3duXG4gICAgICAgICAgICAvLyBkbyB0aGlzIGluIHRoZSB0YWcgc3VtbWFyeVxuXG5cblxuICAgICAgICAvKlxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJPdmVycmlkZSBuYXRpdmUgdGFnIHNlYXJjaCBvbiBjbGlja1wiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gdXNlIENUUkwvQ01EK0NMSUNLIHRvIHJlbW92ZSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlT25DbGljayA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJDb252ZXJ0IHRvIHRhZyB0ZXh0IChyZW1vdmVzICMpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9GRiB0byB1c2UgT1BUL0FMVCtDTElDSyB0byBwZXJmb3JtIG5hdGl2ZSB0YWcgc2VhcmNoLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcHRUb0NvbnZlcnQpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3B0VG9Db252ZXJ0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlJlbW92ZSBuZXN0ZWQgdGFncyBmaXJzdFwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gdXNlIFNISUZUK0NMSUNLIHRvIHJlbW92ZSBuZXN0ZWQgdGFncyBmaXJzdC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiTW9iaWxlIHRhZyBzZWFyY2hcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgT04gdG8gcmVzdG9yZSBtb2JpbGUgbmF0aXZlIHRhZyBzZWFyY2ggb24gdGFwLiBUYWcgcmVtb3ZhbCB3aWxsIHRoZW4gdXNlIExPTkcgUFJFU1MuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiU2hvdyB0YWcgc3VtbWFyeSBwYXJhZ3JhcGggYnV0dG9uc1wiKVxuICAgICAgICAuc2V0RGVzYyhcIlNob3cgYnV0dG9ucyBiZWxvdyBlYWNoIHRhZ2dlZCBwYXJhZ3JhcGggdGhhdCBsZXQgeW91IGNvcHksIHJlbW92ZSwgYW5kIG1vdmUgdGhlIHBhcmFncmFwaC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnU3VtbWFyeUJsb2NrQnV0dG9ucylcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdTdW1tYXJ5QmxvY2tCdXR0b25zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICAqL1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdocicpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJTdXBwb3J0IGEgYnVkZHlcIiB9KTtcbiAgICAgICAgY29uc3QgZG9uYXRlTGluayA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdhJyk7XG4gICAgICAgIGRvbmF0ZUxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgJ2h0dHBzOi8vd3d3LmJ1eW1lYWNvZmZlZS5jb20vbW9yZW1leW91Jyk7XG4gICAgICAgIGNvbnN0IGRvbmF0ZUJ1dHRvbiA9IGNyZWF0ZUVsKCdpbWcnKTtcbiAgICAgICAgZG9uYXRlQnV0dG9uLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2h0dHBzOi8vY2RuLmJ1eW1lYWNvZmZlZS5jb20vYnV0dG9ucy92Mi9kZWZhdWx0LXllbGxvdy5wbmcnKTtcbiAgICAgICAgZG9uYXRlQnV0dG9uLnNldEF0dHJpYnV0ZSgnYWx0JywgJ0J1eSBNZSBBIENvZmZlZScpO1xuICAgICAgICBkb25hdGVCdXR0b24uc3R5bGUgPSAnaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQ7d2lkdGg6IDE1MHB4ICFpbXBvcnRhbnQ7J1xuICAgICAgICBkb25hdGVMaW5rLmFwcGVuZENoaWxkKGRvbmF0ZUJ1dHRvbilcbiAgICAgICAgLy8uaW5uZXJIVE1MID0gYDxpbWcgc3JjPVwiaHR0cHM6Ly9jZG4uYnV5bWVhY29mZmVlLmNvbS9idXR0b25zL3YyL2RlZmF1bHQteWVsbG93LnBuZ1wiIGFsdD1cIkJ1eSBNZSBBIENvZmZlZVwiIHN0eWxlPVwiaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQ7d2lkdGg6IDE1MHB4ICFpbXBvcnRhbnQ7XCIgPjwvYT5gO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdicicpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnYnInKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2JyJyk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiRGVidWcgbW9kZVwiKVxuICAgICAgICAuc2V0RGVzYyhcIk91dHB1dCB0byBjb25zb2xlLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cbn1cblxuIiwgImltcG9ydCB7IEFwcCwgRHJvcGRvd25Db21wb25lbnQsIHNldEljb24sIE1hcmtkb3duUmVuZGVyZXIsIERyb3Bkb3duQ29tcG9uZW50LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFRhZ0J1ZGR5IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgdHlwZSB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBUYWdTZWxlY3RvciB9IGZyb20gJy4vTW9kYWwnXG5pbXBvcnQgeyBUQlRhZ0VkaXRvck1vZGFsIH0gZnJvbSAnLi9UYWdFZGl0b3JNb2RhbCdcbmltcG9ydCB7IFNlbGVjdEZpbGVNb2RhbCB9IGZyb20gJy4vRmluZEZpbGVNb2RhbCdcblxuZXhwb3J0IGNsYXNzIEdVSSB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRhcHA6IEFwcCwgXG5cdFx0cGx1Z2luOiBUYWdCdWRkeSkge1xuXG5cdFx0dGhpcy5hcHAgPSBhcHA7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cbiBcblx0c2hvd1RhZ0VkaXRvciAodGFnRWwpIHtcblxuXHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFxuXHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0XG5cdFx0fSBlbHNlIHtcblx0XHRcblx0XHR9XG5cblx0XHRjb25zdCBpbmRleCA9IHBhcnNlSW50ICh0YWdFbC5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4JykpO1xuXHRcdGNvbnN0IHRhZyA9IHRhZ0VsLmlubmVyVGV4dDtcblx0XHRjb25zdCBmaWxlUGF0aCA9IHRhZ0VsLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKVxuXHRcdGNvbnN0IHRhZ0NvbnRhaW5lclR5cGUgPSB0YWdFbC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKTtcblxuICAgICAgIFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHRhZ0VkaXRvck1vZGFsOiBUQlRhZ0VkaXRvck1vZGFsID0gbmV3IFRCVGFnRWRpdG9yTW9kYWwgKFxuXHRcdFx0XHR0aGlzLmFwcCwgXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0YWcsXG5cdFx0XHRcdGluZGV4LFxuXHRcdFx0XHRmaWxlUGF0aCxcblx0XHRcdFx0KHRhZ0NvbnRhaW5lclR5cGUgPT0gJ3BsdWdpbi1zdW1tYXJ5JykgPyB0YWdFbCA6IG51bGwsXG5cdFx0XHRcdC8vdGFnLFxuXHRcdFx0XHQvL2luZGV4XG5cdFx0XHRcdC8vKHRhZyk9Pntcblx0XHRcdFx0Ly9cdGNvbnNvbGUubG9nKHRhZykgXG5cdFx0XHRcdC8vfVxuXHRcdFx0KS5vcGVuKCk7XG5cblx0XHR9XG5cblxuXHR9XG5cblx0Lyppc1RhZ1ZhbGlkICh0YWc6c3RyaW5nKTpib29sZWFuIHsgLy8gaW5jbHVkaW5nIHRoZSAjXG5cdFx0Y29uc3QgdGFnUGF0dGVybiA9IC9eI1tcXHddKyQvO1xuXHRcdHJldHVybiB0YWdQYXR0ZXJuLnRlc3QodGFnKTtcblx0fSovXG5cblx0bWFrZUJ1dHRvbiAoXG5cdFx0bGFibGU6IHN0cmluZywgXG5cdFx0Y2xpY2tGbjogKGU6IEV2ZW50KSA9PiB2b2lkLCBcblx0XHRjbGFzc0lkPSd0YWdzdW1tYXJ5LWJ1dHRvbidcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gY3JlYXRlRWwoJ2J1dHRvbicpO1xuXHQgICAgLy9idXR0b24uaW5uZXJUZXh0ID0gbGFibGU7XG4gICAgXHRzZXRJY29uKGJ1dHRvbiwgbGFibGUpO1xuXHQgICAgYnV0dG9uLmNsYXNzTmFtZSA9IGNsYXNzSWQ7XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0YnV0dG9uLCBcblx0XHRcdCdjbGljaycsIFxuXHRcdFx0Y2xpY2tGblxuXHRcdCk7XG5cblx0ICAgIHJldHVybiBidXR0b247XG5cdH1cblxuXG5cdG1ha2VCbG9ja1NlbGVjdG9yIChcblx0XHRpbmRleDogTnVtYmVyXG5cdCk6IEhUTUxFbGVtZW50IHtcblx0XHRcblx0XHRjb25zdCBjaGVja2JveEVsID0gY3JlYXRlRWwgKCdkaXYnKTtcblx0XHQvL2NoZWNrYm94RWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWNoZWNrYm94Jylcblx0XHRjaGVja2JveEVsLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBpbmRleClcblxuXHRcdGxldCBjaGVja2VkQnRuO1xuXHRcdGxldCB1bmNoZWNrZWRCdG47XG5cblx0XHRjb25zdCBjaGVja0JveCA9IGZ1bmN0aW9uIChib29sOiBCb29sZWFuKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGNoZWNrYm94RWwuZ2V0QXR0cmlidXRlKCdpbmRleCcpKVxuXG5cdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZVNlbGVjdGlvbiAocGFyc2VJbnQoY2hlY2tib3hFbC5nZXRBdHRyaWJ1dGUoJ2luZGV4JykpLCBib29sKTtcblx0XHRcdGlmIChib29sKSB7XG5cdFx0XHRcdHVuY2hlY2tlZEJ0bi5yZW1vdmUoKTtcblx0XHRcdFx0Y2hlY2tib3hFbC5hcHBlbmRDaGlsZChjaGVja2VkQnRuKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoZWNrZWRCdG4ucmVtb3ZlKCk7XG5cdFx0XHRcdGNoZWNrYm94RWwuYXBwZW5kQ2hpbGQodW5jaGVja2VkQnRuKTtcblx0XHRcdH0gXG5cdFx0fS5iaW5kKHRoaXMpO1xuXG5cdFx0Y2hlY2tlZEJ0biA9IHRoaXMubWFrZUJ1dHRvbiAoJ2NoZWNrLXNxdWFyZScsIChlKSA9PiB7IFxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGNoZWNrQm94KGZhbHNlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3ggY2hlY2tlZCcpO1xuXHRcdGNoZWNrZWRCdG4udGl0bGUgPSAnVW5zZWxlY3QgdGhpcyBwYXJhZ3JhcGguJztcblx0XHRcblx0XHR1bmNoZWNrZWRCdG4gPSB0aGlzLm1ha2VCdXR0b24gKCdzcXVhcmUnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjaGVja0JveCh0cnVlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3gnKTtcblx0XHR1bmNoZWNrZWRCdG4udGl0bGUgPSAnU2VsZWN0IHRoaXMgcGFyYWdyYXBoLic7XG5cblx0XHRjaGVja0JveCAoZmFsc2UpXG5cblx0XHRyZXR1cm4gY2hlY2tib3hFbDtcblxuXHR9XG5cblx0bWFrZVJlbW92ZVRhZ0J1dHRvbiAoXG5cdFx0Y2xpY2tGbjogRnVuY3Rpb24sXG5cdFx0cGFyYWdyYXBoRWw6IEVsZW1lbnQsIFxuXHRcdHRhZzogc3RyaW5nLy8sIFxuXHRcdC8vZmlsZVBhdGg6IHN0cmluZ1xuXHQpOkhUTUxCdXR0b25FbGVtZW50IHtcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24gKCdsaXN0LXgnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdGNsaWNrRm4oZSwgcGFyYWdyYXBoRWwsIHRhZylcblxuXHRcdFx0Ly9jb25zdCB0YWdFbCA9IFV0aWxzLmdldFRhZ0VsZW1lbnQocGFyYWdyYXBoRWwsIHRhZyk7XG5cdFx0XHQvL3RoaXMucGx1Z2luLnRhZ0VkaXRvci5lZGl0KHRhZ0VsKTtcblx0XHR9KTtcblx0XHRidXR0b24udGl0bGUgPSAnUmVtb3ZlZCAnICsgdGFnICsgJyBmcm9tIHBhcmFncmFwaC4nO1xuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlU3VtbWFyeVJlZnJlc2hCdXR0b24gKFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudFxuXHQpOiBIVE1MRWxlbWVudCB7XHRcblx0XHRcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24oXG5cdFx0XHQncmVmcmVzaC1jY3cnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUoc3VtbWFyeUVsKTtcblx0XHRcdFx0Ly90aGlzLnVwZGF0ZVN1bW1hcnkoc3VtbWFyeUVsKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1RhZyBTdW1tYXJ5IHVwZGF0ZWQnKTtcblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHRcdC8vdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnJ1bigpOyBcblx0XHRcdFx0fSwgMTApO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnUmVmcmVzaCB0YWcgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlUb1NlY3Rpb24gKFxuXHRcdGNsaWNrRm46RnVuY3Rpb24sXG5cdFx0Y29udGVudDogc3RyaW5nLCBcblx0XHRzZWN0aW9uczogc3RyaW5nW10sIFxuXHRcdHRhZ3M6IEFycmF5LCBcblx0XHRmaWxlUGF0aDogc3RyaW5nLCBcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnRcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgY29weVRvRWw6IEhUTUxFbGVtZW50ID0gY3JlYXRlRWwoJ3NwYW4nKTtcblx0XHRjb25zdCBzZWxlY3RFbDogSFRNTFNlbGVjdEVsZW1lbnQgPSBjcmVhdGVFbCgnc2VsZWN0RWwnKTtcblx0XHRsZXQgZHJvcGRvd24gPSBuZXcgRHJvcGRvd25Db21wb25lbnQoc2VsZWN0RWwpO1xuXHRcdHNlY3Rpb25zLmZvckVhY2goKHNlYykgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHNlYywgVXRpbHMudHJ1bmNhdGVTdHJpbmdBdFdvcmQoc2VjLCAxNikpOyBcblx0XHR9KTtcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ3RvcCcsICdOb3RlIHRvcCcpOyBcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ2VuZCcsICdOb3RlIGVuZCcpOyBcblx0XHQvL2Ryb3Bkb3duLmFkZE9wdGlvbignbm90ZScsICdOb3RlJyk7IFxuXHRcdC8vZHJvcGRvd24uYWRkT3B0aW9uKCduZXdOb3RlJywgJ05ldyBub3RlJyk7IFxuXHRcdFxuXHRcdHNlbGVjdEVsLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpLmNsYXNzTmFtZSA9ICd0YWdzdW1tYXJ5LWRyb3Bkb3duJztcblx0XHRcblx0XHRpZiAoVXRpbHMucGxhdGZvcm1TZXR0aW5nQ2hlY2sgKHRoaXMuYXBwLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuKSkge1xuXHRcdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdFx0Y2xpY2tGbixcblx0XHRcdFx0XHQnbm90ZScsXHRcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlMaW5rVG9TZWN0aW9uQnRuKSkge1xuXHRcdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdFx0Y2xpY2tGbixcblx0XHRcdFx0XHQnbGluaycsXHRcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlUb1NlY3Rpb25CdG4pKSB7XG5cdFx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdFx0dGhpcy5tYWtlQ29weVRvQnV0dG9uIChcblx0XHRcdFx0XHRjbGlja0ZuLFxuXHRcdFx0XHRcdCdjb3B5Jyxcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4pKSB7XG5cdFx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdFx0dGhpcy5tYWtlQ29weVRvQnV0dG9uIChcblx0XHRcdFx0XHRjbGlja0ZuLFxuXHRcdFx0XHRcdCdtb3ZlJyxcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVja011bHRpcGxlICh0aGlzLmFwcCwgW3RoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4sXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvU2VjdGlvbkJ0bixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5TGlua1RvU2VjdGlvbkJ0bixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuXSkpIHtcblx0XHRcdGNvcHlUb0VsLmFwcGVuZENoaWxkKHNlbGVjdEVsKTtcblx0XHR9XG5cblxuXHRcdHJldHVybiBjb3B5VG9FbDtcblx0fVxuXG5cdG1ha2VDb3B5VG9CdXR0b24gKFxuXHRcdGNsaWNrRm46IEZ1bmN0aW9uLFxuXHRcdG1vZGU6IFN0cmluZyxcblx0XHRkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQsXG5cdFx0cGFyYWdyYXBoRWw6IEhUTUxFbGVtZW50LCBcblx0XHRzdW1tYXJ5RWw6IEhUTUxFbGVtZW50LFxuXHRcdGNvbnRlbnQ6IHN0cmluZywgIFxuXHRcdHRhZ3M6IEFycmF5LCBcblx0XHRmaWxlUGF0aDogc3RyaW5nIFxuXHQpOiBIVE1MRWxlbWVudCB7XG5cblx0XHRsZXQgYnV0dG9uTGFiZWw7XG5cdFx0aWYgKG1vZGUgPT0gJ2xpbmsnKSBidXR0b25MYWJlbCA9ICdsaW5rJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdjb3B5JykgYnV0dG9uTGFiZWwgPSAnY29weS1wbHVzJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdtb3ZlJykgYnV0dG9uTGFiZWwgPSAncmVwbGFjZSc7IC8vJ2NvcHktY2hlY2snO1xuXHRcdGVsc2UgaWYgKG1vZGUgPT0gJ25vdGUnKSBidXR0b25MYWJlbCA9ICdmaWxlLXBsdXMtMic7XG5cblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24gKGJ1dHRvbkxhYmVsLCBhc3luYyAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdGlmIChtb2RlID09ICdub3RlJykge1xuXHRcdFx0Ly9pZiAoZHJvcGRvd24uZ2V0VmFsdWUoKSA9PSAnbm90ZScpIHtcblxuXHRcdFx0XHRuZXcgU2VsZWN0RmlsZU1vZGFsKHRoaXMuYXBwLCAoZmlsZSkgPT4ge1xuXG4gIFx0XHRcdFx0XHQvL25ldyBOb3RpY2UoYEZpbGU6ICR7cmVzdWx0Lm5hbWV9YCk7XG5cbiAgXHRcdFx0XHRcdGNsaWNrRm4oZSwgbW9kZSwgZHJvcGRvd24sIHBhcmFncmFwaEVsLCBzdW1tYXJ5RWwsIGNvbnRlbnQsIHRhZ3MsIGZpbGVQYXRoLCBmaWxlKTtcblxuXHRcdFx0XHR9KS5vcGVuKCk7XG5cblx0XHRcdC8qfSBlbHNlIGlmIChkcm9wZG93bi5nZXRWYWx1ZSgpID09ICduZXdOb3RlJykge1xuXG4vL2NvbnNvbGUubG9nKHZpZXcsIGZpbGVOYW1lKVxuXHRcdFx0XHRjbGlja0ZuKGUsIG1vZGUsIGRyb3Bkb3duLCBwYXJhZ3JhcGhFbCwgc3VtbWFyeUVsLCBjb250ZW50LCB0YWdzLCBmaWxlUGF0aCk7XG4qL1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRjbGlja0ZuKGUsIG1vZGUsIGRyb3Bkb3duLCBwYXJhZ3JhcGhFbCwgc3VtbWFyeUVsLCBjb250ZW50LCB0YWdzLCBmaWxlUGF0aCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0bGV0IGJ1dHRvbkhvdmVyVGV4dDtcblx0XHRpZiAobW9kZSA9PSAnbGluaycpIGJ1dHRvbkhvdmVyVGV4dCA9ICdDb3B5IHBhcmFncmFwaCBsaW5rLicgO1xuXHRcdGVsc2UgaWYgKG1vZGUgPT0gJ2NvcHknKSBidXR0b25Ib3ZlclRleHQgPSAnQ29weSBwYXJhZ3JhcGguJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdtb3ZlJykgYnV0dG9uSG92ZXJUZXh0ID0gJ01vdmUgcGFyYWdyYXBoLic7XG5cdFx0ZWxzZSBpZiAobW9kZSA9PSAnbm90ZScpIGJ1dHRvbkhvdmVyVGV4dCA9ICdDb3B5IHBhcmFncmFwaCB0byBzZWN0aW9uIGluIG5vdGUuJztcblxuXHRcdGJ1dHRvbi50aXRsZSA9IGJ1dHRvbkhvdmVyVGV4dDtcblxuXHRcdHJldHVybiBidXR0b247XG5cdFx0XG5cdH1cblxuXHRtYWtlQmFrZUJ1dHRvbiAoXG5cdFx0Y2xpY2tGbjogRnVuY3Rpb24sXG5cdFx0c3VtbWFyeU1kOiBzdHJpbmcsIFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudCwgXG5cdFx0ZmlsZVBhdGg6c3RyaW5nXG5cdCk6IEhUTUxFbGVtZW50IHtcdFxuXHRcdFxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoXG5cdFx0XHQnc3RhbXAnLCBcblx0XHRcdGFzeW5jKGUpID0+IHsgXG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjbGlja0ZuIChzdW1tYXJ5TWQsIHN1bW1hcnlFbCwgZmlsZVBhdGgpXG5cblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0ZsYXR0ZW4gc3VtbWFyeSAocmVwbGFjZXMgY29kZSBibG9jaykuJztcblxuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlQ29weUJ1dHRvbiAoXG5cdFx0Y2xpY2tGbixcblx0XHRjb250ZW50XG5cdCk6IEhUTUxFbGVtZW50IHtcdFxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoJ2NsaXBib2FyZC1saXN0JywgKGUpID0+IHsgXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0Y2xpY2tGbihlLCBjb250ZW50KTtcblx0XHR9KTtcblx0XHRidXR0b24udGl0bGUgPSAnQ29weSBwYXJhZ3JhcGggdG8gY2xpcGJvYXJkLic7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlTdW1tYXJ5QnV0dG9uIChcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZylcblx0OkhUTUxFbGVtZW50IHtcblxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoXG5cdFx0XHQnY2xpcGJvYXJkLWxpc3QnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc3VtbWFyeU1kKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1N1bW1hcnkgY29waWVkIHRvIGNsaXBib2FyZC4nKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0NvcHkgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZVN1bW1hcnlOb3RlQnV0dG9uIChcblx0XHRjbGlja0ZuOiBGdW5jdGlvbixcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZywgXG5cdFx0dGFnczogQXJyYXlcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uIChcblx0XHRcdCdmaWxlLXBsdXMtMicsIFxuXHRcdFx0YXN5bmMgKGUpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcbi8vbmV3IE5vdGljZSAoJ21ha2VTdW1tYXJ5Tm90ZUJ1dHRvbicsIDEwMDAwKVxuXHRcdFx0XHRjbGlja0ZuIChzdW1tYXJ5TWQsIHRhZ3MpO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnQ3JlYXRlIG5vdGUgZnJvbSBzdW1tYXJ5JztcblxuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRzaG93VGFnU2VsZWN0b3IoZXZlbnQpe1xuXHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFx0bGV0IHBhZ2VYLCBwYWdlWVxuXHRcdGxldCBub2RlVHlwZVxuXHRcdGxldCBkZWVwZXN0Tm9kZTtcblx0XHRsZXQgcmFuZ2Vcblx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUpIHtcblx0XHRcdGNvbnN0IHRvdWNoID0gZXZlbnQudG91Y2hlc1swXSB8fCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTtcblx0XHRcdHBhZ2VYID0gTWF0aC5yb3VuZCh0b3VjaC5wYWdlWCk7XG5cdFx0XHRwYWdlWSA9IE1hdGgucm91bmQodG91Y2gucGFnZVkpO1xuXHRcdFx0Ly9jb25zdCBlbCA9IFV0aWxzLmdldERlZXBlc3RUZXh0Tm9kZShkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHBhZ2VYLCBwYWdlWSkpXG5cdFx0XHQvL2NvbnN0IGVsID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChwYWdlWCwgcGFnZVkpO1xuXHRcdFx0Ly9kZWVwZXN0Tm9kZSA9IFV0aWxzLmdldERlZXBlc3ROb2RlKGVsKTtcblx0XHRcdHJhbmdlID0gZG9jdW1lbnQuY2FyZXRSYW5nZUZyb21Qb2ludChwYWdlWCwgcGFnZVkpXG5cdFx0XHRub2RlVHlwZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlIC8vZGVlcGVzdE5vZGUubm9kZVR5cGU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHBhZ2VYID0gZXZlbnQucGFnZVg7XG5cdFx0XHRwYWdlWSA9IGV2ZW50LnBhZ2VZO1xuXHRcdFx0cmFuZ2UgPSBkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KHBhZ2VYLCBwYWdlWSlcblx0XHRcdG5vZGVUeXBlID0gcmFuZ2Uuc3RhcnRDb250YWluZXIubm9kZVR5cGU7XG5cdFx0fVxuXG5cdFx0Ly9jb25zdCB0YXJnZXRDbGFzc2VzID0gWyd0YWcnXTtcbiAgICAgICAgLy9pZiAobW9kZSA9PSAncHJldmlldycgJiYgIXRhcmdldENsYXNzZXMuc29tZShjbHMgPT4gZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhjbHMpKSkge1xuICAgICAgIFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRpZiAobm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG5cdFx0XHRcdGNvbnN0IHRhZ1NlbGVjdG9yOiBUYWdTZWxlY3RvciA9IG5ldyBUYWdTZWxlY3Rvcihcblx0XHRcdFx0XHR0aGlzLmFwcCwgXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sIFxuXHRcdFx0XHRcdGV2ZW50LCAodGFnKT0+e1xuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh0YWcpXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdFZGl0b3IuYWRkKFxuXHRcdFx0ICAgICAgICBcdFx0JyMnICsgdGFnLCBcblx0XHRcdCAgICAgICAgXHRcdHBhZ2VYLCBcblx0XHRcdCAgICAgICAgXHRcdHBhZ2VZLy8sXG5cdFx0XHQgICAgICAgIFx0XHQvL3tyYW5nZTogcmFuZ2UsIGVsOiBkZWVwZXN0Tm9kZX1cblx0ICAgICAgICBcdFx0XHQpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHQpLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZW1vdmVFbGVtZW50V2l0aEFuaW1hdGlvbiggXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcblx0XHRjYWxsYmFjazogKGU6IEV2ZW50KSA9PiB2b2lkLCBcblx0KTp2b2lkIHtcblxuXHQgIC8vIEdldCB0aGUgYWN0dWFsIGhlaWdodCBvZiB0aGUgZWxlbWVudFxuXHQgIGNvbnN0IGhlaWdodCA9IGVsLm9mZnNldEhlaWdodDtcblxuXHQgIC8vIFNldCBoZWlnaHQgdG8gdGhlIGN1cnJlbnQgdmFsdWUgZm9yIENTUyB0cmFuc2l0aW9uXG5cdCAgZWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcblxuXHQgIC8vIEFsbG93IHRoZSBicm93c2VyIHRvIHVwZGF0ZSwgdGhlbiBzZXQgdG8gMCB0byB0cmlnZ2VyIHRoZSB0cmFuc2l0aW9uXG5cdCAgLy9zZXRUaW1lb3V0KCgpID0+IHsgZWwuc3R5bGUuaGVpZ2h0ID0gJzBweCc7IH0sIDApO1xuXHQgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcbiAgICAgICAgZWwuc3R5bGUub3BhY2l0eSA9ICcwJztcbiAgICAgICAgZWwuc3R5bGUubWFyZ2luID0gJzAnO1xuICAgICAgICBlbC5zdHlsZS5wYWRkaW5nID0gJzAnO1xuICAgIFx0fSwgMCk7XG5cdCAgXG5cdCAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcblx0ICBcdCd0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24gb25FbmQoKSB7XG4gICAgXHRcdGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBvbkVuZCk7XG4gICAgXHRcdGNhbGxiYWNrKCk7XG5cdCAgICBcdC8vc2V0VGltZW91dCgoKSA9PiB7IGVsLnJlbW92ZSgpOyB9LCAxMCk7IC8vIHJlbW92ZSBpbiB0aGUgY2FsbGJhY2tcblx0ICB9KTtcblx0fVxuXG5cdFxuXG59IiwgImltcG9ydCB7IFRGaWxlLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhZ0VsZW1lbnQoXG4gICAgcGFyYWdyYXBoRWw6IEhUTUxFbGVtZW50LCBcbiAgICB0YWdUZXh0OiBzdHJpbmdcbik6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBlbHMgPSBwYXJhZ3JhcGhFbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyk7IFxuICAgIGxldCB0YWdFbFRleHQgPSAnJztcbiAgICBsZXQgdGFnRWxIYXNTdWI6Ym9vbGVhbjtcbiAgICBmb3IgKGxldCBlbCBvZiBlbHMpIHtcbiAgICAgICAgdGFnRWxUZXh0ID0gZWwuaW5uZXJUZXh0LnRyaW0oKTtcbiAgICAgICAgaWYgKHRhZ0VsVGV4dCA9PT0gdGFnVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGVsXG4gICAgICAgIH1cbiAgICB9ICAgIFxuICAgIC8vY29uc29sZS53YXJuKGBFbGVtZW50IHdpdGggdGV4dCBcIiR7dGFnVGV4dH1cIiBub3QgZm91bmRgKTtcbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBsYXRmb3JtU2V0dGluZ0NoZWNrIChhcHA6IEFwcCwgdmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlID09ICdhbHdheXMnIHx8ICh2YWx1ZSA9PSAnZGVza3RvcCcgJiYgIWFwcC5pc01vYmlsZSkgfHwgKHZhbHVlID09ICdtb2JpbGUnICYmIGFwcC5pc01vYmlsZSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwbGF0Zm9ybVNldHRpbmdDaGVja011bHRpcGxlIChhcHA6IEFwcCwgdmFsdWVzOiBBcnJheSBbXSkge1xuICAgIGZvciAobGV0IHZhbHVlIG9mIHZhbHVlcykge1xuICAgICAgICBpZiAocGxhdGZvcm1TZXR0aW5nQ2hlY2soYXBwLCB2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyBcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1dvcmROZWFyRW5kKFxuICAgIHN0cjogc3RyaW5nLCBcbiAgICB3b3JkOiBzdHJpbmcsIFxuICAgIGNoYXJEaXN0YW5jZTogbnVtYmVyID0gMFxuKTogYm9vbGVhbiB7XG4gICAgLy8gRmluZCB0aGUgbGFzdCBvY2N1cnJlbmNlIG9mIHRoZSB3b3JkXG4gICAgY29uc3QgbGFzdEluZGV4ID0gc3RyLmxhc3RJbmRleE9mKHdvcmQpO1xuXG4gICAgLy8gSWYgdGhlIHdvcmQgaXNuJ3QgZm91bmQsIHJldHVybiBmYWxzZVxuICAgIGlmIChsYXN0SW5kZXggPT09IC0xKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHdoZXJlIHRoZSB3b3JkIGVuZHNcbiAgICBjb25zdCB3b3JkRW5kSW5kZXggPSBsYXN0SW5kZXggKyB3b3JkLmxlbmd0aDtcblxuICAgIC8vIENoZWNrIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSB3b3JkJ3MgZW5kIHRvIHRoZSBzdHJpbmcncyBlbmRcbiAgICBjb25zdCBkaXN0YW5jZVRvRW5kID0gc3RyLmxlbmd0aCAtIHdvcmRFbmRJbmRleDtcblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSB3b3JkIGlzIHRoZSBsYXN0IHdvcmQgb3IgaWYgdGhlIGRpc3RhbmNlIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjaGFyRGlzdGFuY2VcbiAgICByZXR1cm4gZGlzdGFuY2VUb0VuZCA9PT0gMCB8fCBkaXN0YW5jZVRvRW5kIDw9IGNoYXJEaXN0YW5jZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdvcmRPYmpGcm9tU3RyaW5nKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZywgXG4gICAgb2Zmc2V0OiBudW1iZXJcbik6T2JqZWN0IHtcbiAgICBcbiAgICBsZXQgd29yZFJlZ2V4ID0gL1teXFxzXSsoPz1bLiw6IT9dPyhcXHN8JCkpL2c7XG4gICAgbGV0IG1hdGNoO1xuICAgIGxldCBpbmRleDtcbiAgICBsZXQgd29yZCA9IG51bGw7XG4gICAgd2hpbGUgKChtYXRjaCA9IHdvcmRSZWdleC5leGVjKHNvdXJjZVRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAobWF0Y2guaW5kZXggPD0gb2Zmc2V0ICYmIG9mZnNldCA8PSBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCkge1xuICAgICAgICAgICAgIHdvcmQgPSBtYXRjaFswXTtcbiAgICAgICAgICAgIGluZGV4ID0gbWF0Y2guaW5kZXg7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB0ZXh0OiB3b3JkLCBcbiAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENsaWNrZWRUZXh0T2JqRnJvbURvYyhcbiAgICB4LCBcbiAgICB5LCBcbiAgICBtaW5Ob2RlTGVuZ3RoOiBzdHJpbmc9MTBcbik6c3RyaW5nIHtcbiAgICBcbiAgICAvLyBHZXQgdGhlIHdvcmQgdW5kZXIgdGhlIGNsaWNrIHBvc2l0aW9uXG4gICAgbGV0IHJhbmdlLCBub2RlVGV4dCwgb2Zmc2V0O1xuXG4gICAgaWYgKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpIHtcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KHgsIHkpO1xuLy9jb25zb2xlLmxvZyh4LCB5LCByYW5nZSlcbiAgICAgICAgaWYgKHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICAgICAgbm9kZVRleHQgPSByYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVmFsdWUudHJpbSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgb2Zmc2V0ID0gcmFuZ2Uuc3RhcnRPZmZzZXQ7XG4gICAgfVxuXG4gICAgaWYgKG5vZGVUZXh0Lmxlbmd0aCA8IG1pbk5vZGVMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuLy9jb25zb2xlLmxvZyhub2RlVGV4dCwgb2Zmc2V0LCByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlKVxuICAgIHJldHVybiB7XG4gICAgICAgIHRleHQ6IG5vZGVUZXh0LCBcbiAgICAgICAgaW5kZXg6IG9mZnNldCwgXG4gICAgICAgIGVsOiByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtkb3duSGVhZGluZ3MoXG4gICAgYm9keUxpbmVzOiBzdHJpbmdbXSxcbiAgICBoZWFkaW5nRmlsdGVyOiBzdHJpbmcgPSAnJ1xuKTogSGVhZGluZ1tdIHtcbiAgICBcbiAgICBjb25zdCBoZWFkZXJzOiBIZWFkaW5nW10gPSBbXTtcbiAgICBsZXQgYWNjdW11bGF0ZWRJbmRleCA9IDA7XG5cbiAgICBib2R5TGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCMrKVtcXHNdPyguKikkLyk7XG5cbiAgICAgICAgaWYgKG1hdGNoICYmIFxuICAgICAgICAgICAgKGhlYWRpbmdGaWx0ZXIgPT0gJycgfHwgbWF0Y2hbMl0gPT0gaGVhZGluZ0ZpbHRlcikpIHtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgZnVsbFRleHQ6IG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgIGxldmVsOiBtYXRjaFsxXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdGV4dDogbWF0Y2hbMl0sXG4gICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgc3RhcnRJbmRleDogYWNjdW11bGF0ZWRJbmRleCxcbiAgICAgICAgICAgICAgICBlbmRJbmRleDogKGFjY3VtdWxhdGVkSW5kZXggKyBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYWNjdW11bGF0ZWRJbmRleCArPSBsaW5lLmxlbmd0aCArIDE7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaGVhZGVycztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRDbG9zZXN0SGVhZGVyV2l0aExpbmsocGFyYWdyYXBoOiBzdHJpbmcpOiB7IHRleHQ6IHN0cmluZzsgbGluazogc3RyaW5nIH0ge1xuICAgIC8vIFNwbGl0IHRoZSBpbnB1dCBtYXJrZG93biBpbnRvIGxpbmVzXG4gICAgY29uc3QgbGluZXMgPSBwYXJhZ3JhcGguc3BsaXQoJ1xcbicpO1xuICAgIGxldCBjbG9zZXN0SGVhZGVyID0gJyc7XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGxpbmVzIGluIHJldmVyc2Ugb3JkZXIgdG8gZmluZCB0aGUgY2xvc2VzdCBwcmVjZWRpbmcgaGVhZGVyXG4gICAgZm9yIChsZXQgaSA9IGxpbmVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgbGluZSBpcyBhIGhlYWRlclxuICAgICAgICBpZiAoL14jezEsNn1cXHMvLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgIGNsb3Nlc3RIZWFkZXIgPSBsaW5lO1xuICAgICAgICAgICAgYnJlYWs7IC8vIFN0b3Agc2VhcmNoaW5nIG9uY2UgYSBoZWFkZXIgaXMgZm91bmRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjbG9zZXN0SGVhZGVyKSB7XG4gICAgICAgIC8vIEV4dHJhY3QgdGhlIGhlYWRlciB0ZXh0IChyZW1vdmUgaGFzaGVzIGFuZCB0cmltIHNwYWNlcylcbiAgICAgICAgY29uc3QgdGV4dCA9IGNsb3Nlc3RIZWFkZXIucmVwbGFjZSgvXiN7MSw2fVxccyovLCAnJykudHJpbSgpO1xuXG4gICAgICAgIC8vIEdlbmVyYXRlIGEgbGluayBpbiB0aGUgZm9ybWF0IG9mICNoZWFkZXIgdGV4dFxuICAgICAgICBjb25zdCBsaW5rID0gYCMke3RleHR9YDtcblxuICAgICAgICByZXR1cm4geyB0ZXh0LCBsaW5rIH07XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGVtcHR5IHZhbHVlcyBpZiBubyBoZWFkZXIgaXMgZm91bmRcbiAgICByZXR1cm4geyB0ZXh0OiAnJywgbGluazogJycgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbGVDb250YWluc0hlYWRpbmcoXG4gICAgZmlsZUNvbnRlbnQ6IHN0cmluZyxcbiAgICBoZWFkaW5nOiBzdHJpbmdcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGZpbGVDb250ZW50TGluZXM6IHN0cmluZ1tdID0gZ2V0TGluZXNJblN0cmluZyhmaWxlQ29udGVudCk7XG4gICAgY29uc3QgbWRIZWFkaW5ncyA9IGdldE1hcmtkb3duSGVhZGluZ3MoZmlsZUNvbnRlbnRMaW5lcywgaGVhZGluZyk7XG4gICAgcmV0dXJuIChtZEhlYWRpbmdzLmxlbmd0aCA+IDApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3RMaW5lQWZ0ZXJGcm9udE1hdHRlcihtYXJrZG93bjogU3RyaW5nKTogTnVtYmVyIHtcbiAgICAvLyBTcGxpdCB0aGUgbWFya2Rvd24gc3RyaW5nIGludG8gbGluZXMuXG4gICAgY29uc3QgbGluZXMgPSBnZXRMaW5lc0luU3RyaW5nKG1hcmtkb3duKTsgLy9tYXJrZG93bi5zcGxpdCgnXFxuJyk7XG5cbiAgICBsZXQgaW5Gcm9udE1hdHRlciA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBsaW5lIGlzIGEgZnJvbnQgbWF0dGVyIGRlbGltaXRlci5cbiAgICAgICAgaWYgKGxpbmUgPT09ICctLS0nKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgdGhlIHN0YXJ0IG9mIHRoZSBmcm9udCBtYXR0ZXIsIHNldCB0aGUgZmxhZy5cbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgaW4gdGhlIGZyb250IG1hdHRlciwgdGhpcyBtYXJrcyBpdHMgZW5kLlxuICAgICAgICAgICAgaW5Gcm9udE1hdHRlciA9ICFpbkZyb250TWF0dGVyO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSBqdXN0IGVuZGVkIHRoZSBmcm9udCBtYXR0ZXIsIHJldHVybiB0aGUgbmV4dCBsaW5lJ3MgbnVtYmVyLlxuICAgICAgICAgICAgaWYgKCFpbkZyb250TWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgLy8rIDI7IC8vICsyIHRvIGFkanVzdCBmb3IgemVyby1iYXNlZCBpbmRleGluZyBhbmQgdG8gZ2V0IHRoZSBsaW5lIGFmdGVyIHRoZSBjbG9zaW5nIGRlbGltaXRlci5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3Mgbm8gZnJvbnQgbWF0dGVyIG9yIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2luZyBkZWxpbWl0ZXIsIHJldHVybiAxICh0aGUgZmlyc3QgbGluZSkuXG4gICAgcmV0dXJuIDA7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpbmVzSW5TdHJpbmcoXG4gICAgaW5wdXQ6IHN0cmluZ1xuKTogQXJyYXkge1xuICAgIC8qY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHRlbXBTdHJpbmcgPSBpbnB1dDtcblxuICAgIHdoaWxlICh0ZW1wU3RyaW5nLmluY2x1ZGVzKFwiXFxuXCIpKSB7XG4gICAgICAgIGNvbnN0IGxpbmVFbmRJbmRleCA9IHRlbXBTdHJpbmcuaW5kZXhPZihcIlxcblwiKTtcbiAgICAgICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nLnNsaWNlKDAsIGxpbmVFbmRJbmRleCkpO1xuICAgICAgICB0ZW1wU3RyaW5nID0gdGVtcFN0cmluZy5zbGljZShsaW5lRW5kSW5kZXggKyAxKTtcbiAgICB9XG4gICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nKTtcblxuICAgIHJldHVybiBsaW5lczsqL1xuXG4gICAgY29uc3QgbGluZXMgPSBpbnB1dC5zcGxpdCgnXFxuJyk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgbGFzdCBsaW5lIGlzIGVtcHR5IGFuZCByZW1vdmUgaXQgaWYgbmVjZXNzYXJ5LlxuICAgIGlmIChsaW5lcy5sZW5ndGggPiAwICYmIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdID09PSAnJykge1xuICAgICAgICBsaW5lcy5wb3AoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGluZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaW5lQ2hySW5kZXgoY29udGVudCwgbGluZU51bWJlcikge1xuICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICBpZiAobGluZU51bWJlciA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICBsZXQgY2hhcmFjdGVySW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVOdW1iZXI7IGkrKykge1xuICAgIC8vIEFkZCB0aGUgbGVuZ3RoIG9mIGVhY2ggbGluZSBwbHVzIDEgZm9yIHRoZSAnXFxuJyBjaGFyYWN0ZXIgdGhhdCB3YXMgcmVtb3ZlZCBieSBzcGxpdFxuICAgIGNoYXJhY3RlckluZGV4ICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7XG4gIH1cblxuICByZXR1cm4gY2hhcmFjdGVySW5kZXg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0QWZ0ZXJMaW5lKFxuICAgIHRleHQ6IHN0cmluZywgXG4gICAgYm9keTogc3RyaW5nLCBcbiAgICBsaW5lOiBudW1iZXIsIFxuICAgIGZpbGVQYXRoXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIGNvbnN0IHNwbGl0Q29udGVudCA9IGJvZHkuc3BsaXQoXCJcXG5cIik7XG4gICAgY29uc3QgcHJlID0gc3BsaXRDb250ZW50LnNsaWNlKDAsIGxpbmUgKyAxKS5qb2luKFwiXFxuXCIpO1xuICAgIGNvbnN0IHBvc3QgPSBzcGxpdENvbnRlbnQuc2xpY2UobGluZSArIDEpLmpvaW4oXCJcXG5cIik7XG5cbiAgICByZXR1cm4gYCR7cHJlfVxcbiR7dGV4dH1cXG4ke3Bvc3R9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RUeXBlRnJvbUxpbmVOdW1iZXIoZnVsbFRleHQ6IHN0cmluZywgbGluZU51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IGZ1bGxUZXh0LnNwbGl0KFwiXFxuXCIpO1xuICAgIGlmIChsaW5lTnVtYmVyID49IDAgJiYgbGluZU51bWJlciA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbbGluZU51bWJlcl07XG5cbiAgICAgICAgY29uc3QgbGVhZGluZ1doaXRlc3BhY2UgPSBsaW5lLm1hdGNoKC9eXFxzKi8pWzBdO1xuXG4gICAgICAgIC8vIENoZWNrIGZvciB1bmNoZWNrZWQgY2hlY2tib3ggbGlzdCBpdGVtcyBmaXJzdFxuICAgICAgICBpZiAoL15cXHMqLVxcc1xcW1xcc1xcXVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGFuIHVuY2hlY2tlZCBjaGVja2JveFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhIFwiY2hlY2tlZFwiIGNoZWNrYm94XG4gICAgICAgIGVsc2UgaWYgKC9eXFxzKi1cXHNcXFt4XFxdXFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiRGV0ZWN0ZWQgYSBjaGVja2VkIGNoZWNrYm94LCBjb252ZXJ0aW5nIHRvIHVuY2hlY2tlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIFRoZW4gY2hlY2sgZm9yIG5vcm1hbCBkYXNoIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqLVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGEgbm9ybWFsIGJ1bGxldFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBcIjtcbiAgICAgICAgfSBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG51bWJlcmVkIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqXFxkK1xcLlxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQobGluZS5tYXRjaCgvXlxccyooXFxkKylcXC4vKVsxXSwgMTApO1xuICAgICAgICAgICAgcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtfS4gYDtcbiAgICAgICAgICAgIC8vcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtICsgMX0uIGA7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhcnJvdyBpdGVtc1xuICAgICAgICBlbHNlIGlmICgvXlxccyo+XFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbGVhZGluZ1doaXRlc3BhY2UgKyBcIj4gXCI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgIH1cbiAgICByZXR1cm4gXCJcIjsgXG59XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGFnRnJvbVN0cmluZyhcbiAgICBpbnB1dFRleHQsIFxuICAgIGhhc2h0YWdUb1JlbW92ZSwgXG4gICAgYWxsOmJvb2xlYW49dHJ1ZVxuKTogc3RyaW5nIHsgIFxuICAgIFxuICAgIC8vY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxcXHM/XCIgKyBoYXNodGFnVG9SZW1vdmUgKyBcIlxcXFxiXCIsIGFsbD9cImdpXCI6XCJpXCIpO1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcbiAgICAgICAgXCJcXFxccz9cIiArIFxuICAgICAgICBoYXNodGFnVG9SZW1vdmUucmVwbGFjZSgvIy9nLCAnXFxcXCMnKSArIFxuICAgICAgICBcIig/IVxcXFx3fFxcXFwvKVwiLCBcbiAgICAgICAgYWxsP1wiZ2lcIjpcImlcIlxuICAgICk7XG5cbiAgICByZXR1cm4gaW5wdXRUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0SW5TdHJpbmcgKFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBjaGFyUG9zOiBudW1iZXJcbik6c3RyaW5nIHsgLy8gcGFzcyAwIGZvciB0aGUgc3RhcnQgb3Igc291cmNlVGV4dC5sZW5ndGgtMSBmb3IgdGhlIGVuZFxuICAgIC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkobmV3VGV4dCkpO1xuICAgIHJldHVybiAoc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgY2hhclBvcykgKyBuZXdUZXh0ICsgJyAnICsgc291cmNlVGV4dC5zdWJzdHJpbmcoY2hhclBvcykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGV4dEZyb21TdHJpbmcgKFxuICAgIHJlbW92ZVRleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBhbGw6Ym9vbGVhbj1mYWxzZVxuKTpzdHJpbmcge1xuICAgIC8vY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHRoaXMuZXNjYXBlUmVnRXhwKHJlbW92ZVRleHQpLCBhbGwgPyBcImdpXCIgOiBcImlcIik7XG4gICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZVJlZ0V4cChyZW1vdmVUZXh0KSwgYWxsID8gXCJnaVwiIDogXCJpXCIpO1xuICAgIHJldHVybiBzb3VyY2VUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlVGV4dEluU3RyaW5nIChcbiAgICByZXBsYWNlVGV4dDogc3RyaW5nLCBcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsIFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgYWxsOiBib29sZWFuID0gZmFsc2Vcbik6c3RyaW5nIHtcbi8qY29uc29sZS5sb2coJ1JFUExBQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKSsnPDwnKTtcbmNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbmNvbnNvbGUubG9nKCdTT1VSQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytzb3VyY2VUZXh0Kyc8PCcpXG5jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG5jb25zb2xlLmxvZygnTkVXIFRFWFQnKTtcbmNvbnNvbGUubG9nKCc+PicrbmV3VGV4dCsnPDwnKSovXG4vL2NvbnNvbGUubG9nKGVzY2FwZVJlZ0V4cChyZXBsYWNlVGV4dC50cmltKCkpKVxuICAgICAgICBjb25zdCBlc2NhcGVkUmVwbGFjZVRleHQgPSBlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG4gICAgICAgIC8vY29uc3QgZXNjYXBlZFJlcGxhY2VUZXh0ID0gZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0KS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG5cbiAgICAgICAgLy9jb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0LnRyaW0oKSksIGFsbCA/IFwiZ2lcIiA6IFwiaVwiKTtcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZWRSZXBsYWNlVGV4dCwgYWxsID8gXCJnc2lcIiA6IFwic2lcIik7XG5cbiAgICAgICAgcmV0dXJuIHNvdXJjZVRleHQudHJpbSgpLnJlcGxhY2UocmVnZXgsIG5ld1RleHQudHJpbSgpKS50cmltKCk7XG4gICAgICAgIC8vcmV0dXJuIHNvdXJjZVRleHQucmVwbGFjZShyZWdleCwgbmV3VGV4dCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZVN0cmluZ0F0V29yZChcbiAgICBzdHI6IHN0cmluZywgXG4gICAgbWF4Q2hhcnM6bnVtYmVyPTE2XG4pOnN0cmluZyB7XG5cbiAgICBpZiAoc3RyLmxlbmd0aCA8PSBtYXhDaGFycykgcmV0dXJuIHN0cjtcbiAgICBsZXQgdHJ1bmNhdGVkID0gc3RyLnN1YnN0cigwLCBtYXhDaGFycyk7ICBcbiAgICBjb25zdCBsYXN0U3BhY2UgPSB0cnVuY2F0ZWQubGFzdEluZGV4T2YoJyAnKTsgXG4gICAgaWYgKGxhc3RTcGFjZSA+IDApIHRydW5jYXRlZCA9IHRydW5jYXRlZC5zdWJzdHIoMCwgbGFzdFNwYWNlKTtcblxuICAgIHJldHVybiB0cnVuY2F0ZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRlbnRDaGFuZ2VkVG9vTXVjaChcbiAgICBvcmlnaW5hbDogc3RyaW5nLCBcbiAgICBtb2RpZmllZDogc3RyaW5nLCBcbiAgICB0YWc6IHN0cmluZywgXG4gICAgYnVmZmVyID0gNVxuKTogYm9vbGVhbiB7XG4gIGNvbnN0IGV4cGVjdGVkQ2hhbmdlID0gdGFnLmxlbmd0aDsgLy8gaW5jbHVkaW5nIHRoZSAnIycgc3ltYm9sXG4gIGNvbnN0IHRocmVzaG9sZCA9IGV4cGVjdGVkQ2hhbmdlICsgYnVmZmVyOyAvLyBhbGxvdyBmb3Igc29tZSBtaW5vciB1bmludGVuZGVkIG1vZGlmaWNhdGlvbnNcbiAgY29uc3QgYWN0dWFsQ2hhbmdlID0gTWF0aC5hYnMob3JpZ2luYWwubGVuZ3RoIC0gbW9kaWZpZWQubGVuZ3RoKTtcblxuICByZXR1cm4gYWN0dWFsQ2hhbmdlID4gdGhyZXNob2xkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZU9iakZyb21UYWdzKFxuICAgIHRhZ3M6IEFycmF5XG4pOiBPYmplY3Qge1xuXG4gICAgLy8gUmVtb3ZlIGhhc2hlcyBhbmQgc3BsaXQgdGFncyBpbnRvIGFuIGFycmF5XG4gICAgbGV0IHRhZ3NBcnJheSA9IHRhZ3MubWFwKHRhZyA9PiB0YWcucmVwbGFjZSgvIy9nLCAnJykudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IGR1cGxpY2F0ZXNcbiAgICB0YWdzQXJyYXkgPSB0YWdzQXJyYXkuZmlsdGVyKCh0YWcsIGluZGV4LCBzZWxmKSA9PiBzZWxmLmluZGV4T2YodGFnKSA9PT0gaW5kZXgpO1xuXG4gICAgLy8gQ29uc3RydWN0IHRoZSBmaWxlIG5hbWVcbiAgICBjb25zdCB0YWdzUGFydCA9IHRhZ3NBcnJheS5qb2luKCcrJyk7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRhdGVQYXJ0ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArIC8vJy0nICtcbiAgICAgICAgICAgICAgICAgICAgIChjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgLy8nLScgK1xuICAgICAgICAgICAgICAgICAgICAgY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpLnNsaWNlKC0yKTtcbiAgICBjb25zdCB0aW1lUGFydCA9IC8vY3VycmVudERhdGUuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnLScgK1xuICAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50RGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgJy0nICtcbiAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlLmdldFNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgLy9jb25zdCBmaWxlTmFtZSA9IGBUYWcgU3VtbWFyeSAoJHt0YWdzUGFydH0pICgke2RhdGVQYXJ0fSkubWRgO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aW1lUGFydClcbiAgICBjb25zdCBmaWxlTmFtZSA9IGBUYWcgU3VtbWFyeSAoJHtkYXRlUGFydH0gJHt0aW1lUGFydH0pLm1kYDtcblxuICAgIC8vIENvbnN0cnVjdCB0aGUgdGl0bGVcbiAgICBjb25zdCB0aXRsZVRhZ3NQYXJ0ID0gdGFnc0FycmF5Lm1hcCh0YWcgPT4gdGFnLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGFnLnNsaWNlKDEpKS5qb2luKCcgKyAnKTtcbiAgICBjb25zdCB0aXRsZSA9IGAke3RpdGxlVGFnc1BhcnR9IFRhZyBTdW1tYXJ5YDtcblxuICAgIC8vIFJldHVybiB0aGUgb2JqZWN0IHdpdGggZmlsZU5hbWUgYW5kIHRpdGxlIHByb3BlcnRpZXNcbiAgICByZXR1cm4ge1xuICAgICAgICBmaWxlTmFtZTogZmlsZU5hbWUsXG4gICAgICAgIHRpdGxlOiB0aXRsZVxuICAgIH07XG59XG5cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY3RpdmVGaWxlRm9sZGVyKFxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIC8vY29uc3QgYWN0aXZlRmlsZSA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi52aWV3LmZpbGU7XG4gICAgLy9jb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBpZiAoIWFjdGl2ZUZpbGUpIHJldHVybiBudWxsO1xuICAgIGxldCBmb2xkZXJQYXRoXG4gICAgaWYgKGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnXFxcXCcpIHx8IGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnLycpKSB7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjb3JyZWN0IHBhdGggc2VwYXJhdG9yXG4gICAgICAgIGNvbnN0IHBhdGhTZXBhcmF0b3IgPSBhY3RpdmVGaWxlLnBhdGguaW5jbHVkZXMoJ1xcXFwnKSA/ICdcXFxcJyA6ICcvJztcblxuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBhY3RpdmVGaWxlLnBhdGguc3BsaXQocGF0aFNlcGFyYXRvcik7XG4gICAgICAgIHBhdGhQYXJ0cy5wb3AoKTsgIC8vIFJlbW92ZSB0aGUgZmlsZSBuYW1lIHBhcnRcbiAgICAgICAgZm9sZGVyUGF0aCA9IHBhdGhQYXJ0cy5qb2luKHBhdGhTZXBhcmF0b3IpO1xuXG4gICAgICAgIC8vIEVuc3VyZSB0aGUgZm9sZGVyIHBhdGggZW5kcyB3aXRoIHRoZSBjb3JyZWN0IHBhdGggc2VwYXJhdG9yXG4gICAgICAgIGlmICghZm9sZGVyUGF0aC5lbmRzV2l0aChwYXRoU2VwYXJhdG9yKSkge1xuICAgICAgICAgICAgZm9sZGVyUGF0aCArPSBwYXRoU2VwYXJhdG9yO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9sZGVyUGF0aCA9ICcnXG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlclBhdGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWdzRnJvbUFwcChcbiAgICBhcHA6IEFwcCxcbiAgICByZWNlbnRUYWdzOiBBcnJheVxuKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRhZ3NPYmplY3QgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCk7XG5cbiAgICAvLyBDb252ZXJ0IHRhZ3NPYmplY3QgdG8gYW4gYXJyYXkgb2YgW3RhZywgY291bnRdIHR1cGxlc1xuICAgIGNvbnN0IHRhZ3NBcnJheSA9IE9iamVjdC5lbnRyaWVzKHRhZ3NPYmplY3QpO1xuXG4gICAgLy8gU29ydCBieSB1c2UgY291bnRcbiAgICB0YWdzQXJyYXkuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pO1xuXG4gICAgLy9jb25zdCByZWNlbnRUYWdzID0gdGhpcy5nZXRSZWNlbnRUYWdzKCk7XG4gICAgLy9jb25zdCByZWNlbnRUYWdzID0gcGx1Z2luLmdldFJlY2VudFRhZ3MoKTtcbiAgICAvL2NvbnNvbGUubG9nKCdyZWNlbnQgdGFnIGxlbmd0aDogJyArIHJlY2VudFRhZ3MubGVuZ3RoKVxuXG4gICAgaWYgKHJlY2VudFRhZ3MubGVuZ3RoPjApIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZWNlbnRUYWdzKVxuICAgICAgICAvLyBjb252ZXJ0IHRoZW0gdG8gW3RhZywgY291bnRdIHR1cGxlcyBmb3IgY29uc2lzdGVuY3lcbiAgICAgICAgY29uc3QgcmVjZW50VGFnc0FzVHVwbGVzID0gcmVjZW50VGFncy5tYXAodGFnID0+IFt0YWcsIDBdKTtcbiAgICAgICAgLy8gQ29uY2F0ZW5hdGUgdGhlIHR3byBhcnJheXNcbiAgICAgICAgY29uc3QgcmVjZW50QW5kQWxsVGFncyA9IHJlY2VudFRhZ3NBc1R1cGxlcy5jb25jYXQodGFnc0FycmF5KTtcbiAgICAgICAgLy8gRXh0cmFjdCB0YWcgbmFtZXMgYWZ0ZXIgcmVtb3ZpbmcgdGhlICNcbiAgICAgICAgcmV0dXJuIHJlY2VudEFuZEFsbFRhZ3MubWFwKChbdGFnLCBfXSkgPT4gdGFnLnJlcGxhY2UoL14jLywgXCJcIikpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0YWdzQXJyYXkubWFwKChbdGFnLCBfXSkgPT4gdGFnLnJlcGxhY2UoL14jLywgXCJcIikpO1xuICAgIH1cbn1cblxuIGV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUZpbGVQYXRoIChcbiAgICBmaWxlUGF0aDogc3RyaW5nXG4pOiBURmlsZSB7XG4gICAgY29uc3QgbWF0Y2hpbmdGaWxlcyA9IGF3YWl0IGFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihmaWxlID0+IGZpbGUubmFtZSA9PT0gZmlsZVBhdGgpO1xuICAgIGlmIChtYXRjaGluZ0ZpbGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IG1hdGNoaW5nRmlsZXNbMF0ucGF0aDtcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1ZhbGlkYXRlIGZpbGU6ICcgKyBlbWJlZEZpbGUubmFtZSk7XG4gICAgICAgIHJldHVybiBmaWxlO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogTXVsdGlwbGUgZmlsZXMgZm91bmQgd2l0aCB0aGUgc2FtZSBuYW1lLiBDYW5cXCd0IHNhZmVseSBlZGl0IHRhZy4nKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBObyBmaWxlIGZvdW5kLiBUcnkgYWdhaW4sIG9yIHRoaXMgdGFnIG1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIGVtYmVkIHR5cGUuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuXG5cbi8vIFVwZGF0ZWQgdG8gYWxsb3cgc2FtZSBmaWxlIG5hbWVzIGFzIGxvbmcgYXMgcGF0aCBpcyBkaWZmZXJlbnRcbi8vIFRvIHVzZSB0aGlzIHdlIG5lZWQgdG8gYmUgc3RvcmluZyB0aGUgd2hvbGUgZmlsZSBwYXRoIGluIHRoZSBIVE1MLCBub3QganVzdCB0aGUgbmFtZVxuLy8gVGhpcyBpcyBhIGJpZ2dlciBjaGFuZ2Ugd2UgbmVlZCB0byBkZWRpY2F0ZSB0aW1lIGZvci4gQW5kIHRlc3RpbmcuIFdoYXQgZG9lcyB0aGlzIGltcGFjdD9cbi8qZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlRmlsZVBhdGgoXG4gICAgZmlsZVBhdGg6IHN0cmluZ1xuKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcbiAgICAvLyBUcnkgdG8gZ2V0IHRoZSBmaWxlIGJ5IHRoZSBmdWxsIHBhdGhcbiAgICBjb25zdCBmaWxlID0gYXdhaXQgYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cbiAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgLy8gUmV0dXJuIHRoZSBmaWxlIGlmIGl0IGV4aXN0cyBhbmQgaXMgYSB2YWxpZCBURmlsZVxuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIGZpbGUgaXMgbm90IGZvdW5kIG9yIGlzIG5vdCBhIFRGaWxlXG4gICAgICAgIG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogRmlsZSBub3QgZm91bmQgb3IgaW52YWxpZC4gUGxlYXNlIGNoZWNrIHRoZSBwYXRoIGFuZCB0cnkgYWdhaW4uJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbiovXG5cbmV4cG9ydCBmdW5jdGlvbiBjdHJsQ21kS2V5IChcbiAgICBldmVudDogRXZlbnRcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGlzTWFjID0gUGxhdGZvcm0uaXNNYWNPUyAvLyAobmF2aWdhdG9yLnBsYXRmb3JtLnRvVXBwZXJDYXNlKCkuaW5kZXhPZignTUFDJykgPj0gMCk7XG5cbiAgICBpZiAoaXNNYWMpIHJldHVybiBldmVudC5tZXRhS2V5O1xuICAgIGVsc2UgcmV0dXJuIGV2ZW50LmN0cmxLZXk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0YWdzSW5TdHJpbmcoXG4gICAgc3RyaW5nOiBzdHJpbmcsIFxuICAgIHRhZz86IHN0cmluZ1xuKTogc3RyaW5nW10ge1xuICAgIGxldCByZWdleDtcbiAgICBpZiAodGFnKSB7XG4gICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0YWcucmVwbGFjZSgvXFwvL2csICdcXFxcLycpICsgXCIoPyFbXFxcXHdcXFxcL1xcXFwjXSlcIiwgXCJnXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1hdGNoIGFueSB0YWctbGlrZSBwYXR0ZXJuIHN0YXJ0aW5nIHdpdGggJyMnXG4gICAgICAgIHJlZ2V4ID0gLyMoXFx3KykoPyFbXFx3XFwvI10pL2c7XG4gICAgfVxuICAgIGNvbnN0IG1hdGNoZXMgPSBzdHJpbmcubWF0Y2gocmVnZXgpO1xuXG4gICAgcmV0dXJuIG1hdGNoZXMgfHwgW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb3VudE9jY3VycmVuY2VzKFxuICAgIHN1bW1hcnlUYWdzOiBBcnJheSwgXG4gICAgY29udGVudFRhZ3Ncbik6IG51bWJlciB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBmb3IgKGxldCB0YWcgb2Ygc3VtbWFyeVRhZ3MpIHtcbiAgICAgICAgY291bnQgKz0gY29udGVudFRhZ3MuZmlsdGVyKGl0ZW0gPT4gaXRlbSA9PT0gdGFnKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gb3V0ZXJIVE1MVG9FbGVtZW50KG91dGVySFRNTDogc3RyaW5nKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbiAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0ZW1wRGl2LmlubmVySFRNTCA9IG91dGVySFRNTDtcbiAgcmV0dXJuIHRlbXBEaXYuZmlyc3RDaGlsZCBhcyBIVE1MRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChcbiAgICBzdHJpbmc6IHN0cmluZ1xuKTpzdHJpbmcge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTsgLy8gJCYgbWVhbnMgdGhlIHdob2xlIG1hdGNoZWQgc3RyaW5nXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbWJlZEZpbGUgKFxuICAgIGVsOiBIVE1MRWxlbWVudFxuKTpURmlsZSB7XG4gICAgbGV0IGZpbGVQYXRoID0gZWwuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICBjb25zdCBsaW5rQXJyYXkgPSBmaWxlUGF0aC5zcGxpdCgnIycpO1xuICAgIGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB2YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKTtcbiAgICByZXR1cm4gZmlsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnVmFsaWQgKFxuICAgIHRhZzogU3RyaW5nLFxuICAgIGZ1bGxUYWc6IEJvb2xlYW4gPSBmYWxzZVxuKTpib29sZWFuIHsgXG4gICAgbGV0IHRhZ1BhdHRlcm4gXG4gICAgaWYgKGZ1bGxUYWcpIHRhZ1BhdHRlcm4gPSAvXiNbYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIC8vZWxzZSB0YWdQYXR0ZXJuID0gLyg/PVteXFxkXFxzXSspW2EtekEtWjAtOV9cXC1cXC9dKy9nXG4gICAgZWxzZSB0YWdQYXR0ZXJuID0gL15bYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIHJldHVybiB0YWdQYXR0ZXJuLnRlc3QodGFnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RWYWxpZFRhZ3ModGFnc1N0cmluZzogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIC8vIFNwbGl0IHRoZSBzdHJpbmcgYnkgY29tbWFzIHRvIGdldCBpbmRpdmlkdWFsIHRhZ3NcbiAgICBjb25zdCBwb3RlbnRpYWxUYWdzID0gdGFnc1N0cmluZy5zcGxpdCgnLCcpO1xuXG4gICAgLy8gRmlsdGVyIG91dCB2YWxpZCB0YWdzXG4gICAgY29uc3QgdmFsaWRUYWdzID0gcG90ZW50aWFsVGFnc1xuICAgICAgICAubWFwKHRhZyA9PiB0YWcudHJpbSgpKSAvLyBUcmltIGVhY2ggdGFnXG4gICAgICAgIC5maWx0ZXIodGFnID0+IGlzVGFnVmFsaWQodGFnLCB0cnVlKSk7IC8vIFVzZSB0aGUgaXNUYWdWYWxpZCBmdW5jdGlvbiB0byBjaGVjayB2YWxpZGl0eVxuXG4gICAgcmV0dXJuIHZhbGlkVGFncztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGN0cmxDbWRTdHIgKCk6IHN0cmluZyB7XG4gICAgY29uc3QgaXNNYWMgPSBQbGF0Zm9ybS5pc01hY09TIC8vKG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpID49IDApO1xuICAgIGlmIChpc01hYykgcmV0dXJuICdDTUQnO1xuICAgIGVsc2UgcmV0dXJuICdDVFJMJztcbn1cbiIsICJpbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBTdWdnZXN0TW9kYWwsIE1vZGFsLCBTZXR0aW5nLCBOb3RpY2UsIFRGaWxlLCByZW5kZXJSZXN1bHRzLCBwcmVwYXJlRnV6enlTZWFyY2gsIEZ1enp5TWF0Y2gsIGZ1enp5U2VhcmNoLCBwcmVwYXJlUXVlcnkgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIFRhZ1NlbGVjdG9yIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeVxuICAgIGFwcDogQXBwO1xuICAgIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWRcbiAgICB0YWc6IHN0cmluZ1xuICAgIGlucHV0TGlzdGVuZXI6IEV2ZW50TGlzdGVuZXJcbiAgICB0YWdDYWNoZTogc3RyaW5nW11cbiAgICBsb2NhdGlvbjogT2JqZWN0O1xuICAgIGhlaWdodCA9IDIxNTtcbiAgICBub1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgIFxuICAgIFxuICAgIGNvbnN0cnVjdG9yIChhcHA6IEFwcCwgcGx1Z2luOiBUYWdCdWRkeSwgZXZlbnQ6RXZlbnQsIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpe1xuICAgICAgICBzdXBlcihhcHApXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxuICAgICAgICB0aGlzLnRhZyA9ICcnXG4gICAgICAgIHRoaXMub25DaG9vc2VJdGVtQ2FsbGJhY2sgPSBvbkNob29zZUl0ZW1DYWxsYmFja1xuICAgICAgICB0aGlzLmlucHV0TGlzdGVuZXIgPSB0aGlzLmxpc3RlbklucHV0LmJpbmQodGhpcylcbiAgICAgICAgdGhpcy50YWdDYWNoZSA9IFtdXG4gICAgICAgIGlmIChldmVudCAhPSBudWxsKSB0aGlzLmxvY2F0aW9uID0ge3g6IGV2ZW50LnBhZ2VYLCB5OiBldmVudC5wYWdlWX1cbiAgICAgICAgLy90aGlzLmxpbWl0ID0gMTBcbiAgICAgICAgLy90aGlzLmVtcHR5U3RhdGVUZXh0ID0gJ0FkZCBuZXcgdGFnJ1xuICAgICAgICAvLyB0byBhZGQgYSBicmFuZCBuZXcgdGFnIHdlJ2QgZWl0aGVyIG5lZWQgdG86XG4gICAgICAgIC8vIC0gU0hJRlQgYWxyZWFkeSB3b3Jrcy4gYnV0IGZvciBtb2JpbGU/XG4gICAgICAgIC8vIC0gaGF2ZSBhbm90aGVyIGJ1dHRvbiBvbiBmYXIgcmlnaHQgb24gaW5wdXQgdG8gYWRkIChmb3IgbW9iaWxlKVxuICAgICAgICAvLyB0aGlzIHNlbGVjdG9yIGlzIGFsc28gd2hlcmUgd2UgY2FuIGFkZCBhbiBlZGl0IGljb24gbmV4dCB0byBlYWNoIHRhZy4gXG4gICAgICAgIC8vIGNsaWNraW5nIHRoaXMgd291bGQgYnJpbmcgdXAgdGhlIGVkaXQgbW9kYWxcbiAgICAgICBcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJcIilcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBpZiAoIXRoaXMuYXBwLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdENvbnRhaW5lckVsLnBhcmVudE5vZGUuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5zdHlsZS5oZWlnaHQgPSAnMjE1cHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLmxlZnQgPSBgJHt0aGlzLmxvY2F0aW9uLnh9cHhgO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLnRvcCA9IGAke3RoaXMubG9jYXRpb24ueX1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57IHRoaXMuaW5wdXRFbC5mb2N1cygpIH0sIDUwMCk7IC8vIG5vdCB3b3JraW5nP1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBzdXBlci5vbkNsb3NlKClcbiAgICB9XG5cbiAgICBsaXN0ZW5JbnB1dChldmVudDogS2V5Ym9hcmRFdmVudCl7XG4gICAgICAgIHRoaXMubm9TZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbXNIZWlnaHQgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuaW5wdXRFbC52YWx1ZSkubGVuZ3RoICogNDI7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1pbih0aGlzLmhlaWdodCwgTWF0aC5tYXgoNjUsIGl0ZW1zSGVpZ2h0KSlcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Q29udGFpbmVyRWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmICF0aGlzLm5vU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnB1dEVsLnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm4gPSAvKD89W15cXGRcXHNdKylbYS16QS1aMC05X1xcLVxcL10rL2dcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QodGV4dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW0odGhpcy5pbnB1dEVsLnZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCB0YWcuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKmdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpIDogc3RyaW5nW117XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkVGFncyA9IFV0aWxzLmdldFRhZ3NGcm9tQXBwKFxuICAgICAgICAgICAgdGhpcy5hcHAsIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZ2V0UmVjZW50VGFncygpKS5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgLy90YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgcXVlcnkgPT0gJycgPyB0cnVlIDogdGFnLnRvTG93ZXJDYXNlKCkgPT0gcXVlcnkudG9Mb3dlckNhc2UoKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZmlsdGVyZWRUYWdzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oaGVhZGVyOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGhlYWRlciB9KTtcbiAgICB9Ki9cblxuICAgIG9uTm9TdWdnZXN0aW9uKCl7XG4gICAgICAgIHN1cGVyLm9uTm9TdWdnZXN0aW9uKClcbiAgICAgICAgdGhpcy5ub1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ25vIHN1Z2dlc3Rpb25zJylcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBzdHJpbmdbXSB7XG4gICAgICAgY29uc3QgZmlsdGVyZWRUYWdzID0gVXRpbHMuZ2V0VGFnc0Zyb21BcHAoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5nZXRSZWNlbnRUYWdzKClcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZFRhZ3M7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQodGFnOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGFnXG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VJdGVtKHJlc3VsdDogc3RyaW5nKSB7XG4vL2NvbnNvbGUubG9nKHJlc3VsdClcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57dGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpfSwgMjUwKVxuICAgICAgICB9XG4gICAgfVxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBURmlsZSwgU2V0dGluZywgU2VsZWN0RmlsZU1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBQcm9ncmVzc0JhckNvbXBvbmVudH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVEJUYWdFZGl0b3JNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICAvL29yaWdpbmFsVGFnOiBTdHJpbmdzXG4gICAgb3B0aW9uc0RpdjogSFRNTEVsZW1lbnQ7XG4gICAgZWRpdERpdjogSFRNTEVsZW1lbnQ7XG4gICAgaW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgLy9zdWJtaXRCdG46IEJ1dHRvbkNvbXBvbmVudDtcbiAgICB0YWdBY3Rpb25Ecm9wZG93bjogRHJvcGRvd25Db21wb25lbnQ7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIHNldHRpbmdzID0ge1xuICAgICAgICBvcmlnaW5hbFRhZzogJycsXG4gICAgICAgIG9yaWdpbmFsSW5kZXg6IG51bGwsXG4gICAgICAgIHRhZ0VsOiBudWxsLFxuICAgICAgICBmaWxlUGF0aDogbnVsbCxcbiAgICAgICAgYmF0Y2hBY3Rpb246ICdpbnN0YW5jZScsXG4gICAgICAgIG5ld05hbWU6ICcnLFxuICAgICAgICBzdW1tYXJ5UG9zOiAndG9wJyxcbiAgICAgICAgYWN0aW9uOiAncmVuYW1lJ1xuICAgIH07XG5cbiAgICAvL2NvbnN0cnVjdG9yKGFwcDogQXBwLCB0YWc6IFN0cmluZywgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5LCB0YWc6IHN0cmluZywgaW5kZXg6IG51bWJlciwgZmlsZVBhdGg6IHN0cmluZyA9IG51bGwsIHRhZ0VsOiBIVE1MRWxlbWVudCA9IG51bGwpIHtcbiAgICAvL2NvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5LCB0YWdFbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4vL2NvbnNvbGUubG9nKHRhZ0VsKVxuICAgICAgICB0aGlzLnNldHRpbmdzLnRhZ0VsID0gdGFnRWw7XG4gICAgICAgIC8vdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4ID0gcGFyc2VJbnQgKHRhZ0VsLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKSk7XG4gICAgICAgIC8vdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyA9IHRhZ0VsLmlubmVyVGV4dDtcbiAgICAgICAgLy90aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9vbiA9IHRhZ0VsLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblxuICAgICAgICB0aGlzLnNldHRpbmdzLmZpbGVQYXRoID0gZmlsZVBhdGhcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyA9IHRhZztcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4ID0gaW5kZXg7XG4gICAgICAgIC8vdGhpcy5vcmlnaW5hbFRhZyA9IHRhZztcbiAgICAgICAgLy90aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgfVxuIFxuICAgIG9uT3BlbiAoKSB7XG4gICAgICAgIGxldCB7IGNvbnRlbnRFbCwgdGl0bGVFbCAsIG1vZGFsRWwsIGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG4gICAgICAgIHRpdGxlRWwuc2V0VGV4dChcIlRhZyBBY3Rpb25zXCIpXG5cbiAgICAgICAgdGhpcy5lZGl0RGl2ID0gY3JlYXRlRWwoJ2RpdicpXG4gICAgICAgIHRoaXMuZWRpdERpdi5jbGFzc0xpc3QuYWRkICgndGFnLWVkaXRvci1lZGl0LWRpdicpXG5cbiAgICAgICAgdGhpcy5vcHRpb25zRGl2ID0gY3JlYXRlRWwgKCdkaXYnKTtcbiAgICAgICAgdGhpcy5vcHRpb25zRGl2LmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLW9wdGlvbnMnKVxuXG4gICAgICAgIHRoaXMuaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh0aGlzLmVkaXREaXYpO1xuICAgICAgICB0aGlzLmlucHV0LmlucHV0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItaW5wdXQnKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHRoaXMuZWRpdERpdilcbiAgICAgICAgLmFkZE9wdGlvbigncmVuYW1lJywgXCJSZW5hbWVcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ2xvd2VyJywgXCJDb252ZXJ0IHRvIGxvd2VyIGNhc2VcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ3RvdGV4dCcsIFwiUmVtb3ZlIGhhc2ggKCMpXCIpIFxuICAgICAgICAuYWRkT3B0aW9uKCdzdW1tYXJ5JywgXCJDcmVhdGUgc3VtbWFyeVwiKTsgXG4gICAgICAgIHRoaXMudGFnQWN0aW9uRHJvcGRvd24uc2VsZWN0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItZHJvcGRvd24nKTtcblxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKHRoaXMuZWRpdERpdilcbiAgICAgICAgY29udGVudEVsLmFwcGVuZENoaWxkKHRoaXMub3B0aW9uc0RpdilcblxuICAgICAgICB0aGlzLnNob3dFZGl0VGFnT3B0aW9ucygncmVuYW1lJyk7ICAgXG4gICAgXG4gICAgICAgIGNvbnN0IGhyID0gY3JlYXRlRWwgKCdocicpXG4gICAgICAgIGhyLmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLWhyJyk7IFxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKGhyKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hY3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBcInN1bW1hcnlcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N1bW1hcnlPcHRpb25zICgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2lmIChlZGl0RGl2LmNvbnRhaW5zKHN1bW1hcnlPcHRTZWxlY3RFbCkpIGVkaXREaXYucmVtb3ZlQ2hpbGQoc3VtbWFyeU9wdFNlbGVjdEVsKVxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0VkaXRUYWdPcHRpb25zICh2YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IFxuXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldENsYXNzICgndGFnLWVkaXRvci1zdWJtaXQnKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1N1Ym1pdCcpXG4gICAgICAgICAgICAub25DbGljayAoKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0VGFnRWRpdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfVxuXG4gICAgc3VibWl0VGFnRWRpdCAoKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzKVxuXG4gICAgICAgIC8vY29uc3Qgc3RhcnRzV2l0aEhhc2g6IEJvb2xlYW4gPSB0aGlzLnNldHRpbmdzLm5ld05hbWUudHJpbSgpWzBdID09ICcjJztcbiAgICAgICAgY29uc3QgaXNWYWxpZFRhZzogQm9vbGVhbiA9IFV0aWxzLmlzVGFnVmFsaWQodGhpcy5zZXR0aW5ncy5uZXdOYW1lLnRyaW0oKSwgdHJ1ZSlcbiAgICAgICAgY29uc3QgYWN0aW9uOiBTdHJpbmcgPSB0aGlzLnNldHRpbmdzLmFjdGlvbjtcbiAgICAgICAgbGV0IG5ld05hbWU6IFN0cmluZyA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWc7XG5cbiAgICAgICAgaWYgKGFjdGlvbiA9PSAnc3VtbWFyeScpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlUYWdzOiBBcnJheSA9IFV0aWxzLmV4dHJhY3RWYWxpZFRhZ3MgKHRoaXMuaW5wdXQuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICBpZiAoc3VtbWFyeVRhZ3MubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UgKCdJbnZhbGlkIHRhZyBmb3JtYXQuJylcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5jcmVhdGVDb2RlQmxvY2soc3VtbWFyeVRhZ3MsIHRoaXMuc2V0dGluZ3Muc3VtbWFyeVBvcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PSAncmVuYW1lJyAmJiAhaXNWYWxpZFRhZykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSAoJ0ludmFsaWQgdGFnIGZvcm1hdC4nKVxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9oZWxwLm9ic2lkaWFuLm1kL0VkaXRpbmcrYW5kK2Zvcm1hdHRpbmcvVGFncyNUYWcrZm9ybWF0XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT0gJ3JlbmFtZScpIG5ld05hbWUgPSB0aGlzLnNldHRpbmdzLm5ld05hbWU7XG4gICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24gPT0gJ2xvd2VyJykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PSAndG90ZXh0JykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcuc3Vic3RyaW5nKDEpO1xuXG4gICAgICAgICAgICAvL2lmICh0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uID09ICdpbnN0YW5jZScpIHtcbi8vIHRoaXMgaXNuJ3Qgd29ya2luZy4gc29lbXRoaW5nIGFib3V0IGhvdyBJJ20gbG9vcGluZyBhcm91bmQgd2l0aCBlZGl0IGFuZCByZW5hbWUuIG1pZ2h0IG5vdCB3b3JrLiBcbiAgICAgICAgICAgICAgICAvLyBhbmQgaWYgbm90IHdlIGNhbid0IG1ha2UgZW1iZGVkIG9yIHN1bW1hcnkgZWRpdHMgZWRpdHMgXG4gICAgICAgICAgICAgICAgLy90aGlzLnBsdWdpbi50YWdFZGl0b3IuZWRpdCAodGhpcy5zZXR0aW5ncy50YWdFbCwgbnVsbCwgbnVsbCwgJ3JlbmFtZScsIG5ld05hbWUpXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnRWRpdG9yLnJlbmFtZVRhZyAoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcsXG4gICAgICAgICAgICAgICAgICAgIG5ld05hbWUsXG4gICAgICAgICAgICAgICAgICAgICgodGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9PSAnaW5zdGFuY2UnKSA/IHBhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCkgOiB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5maWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy50YWdFbFxuICAgICAgICAgICAgICAgICAgICAvL3BhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8oKHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPT0gJ2luc3RhbmNlJykgPyBwYXJzZUludCh0aGlzLnNldHRpbmdzLm9yaWdpbmFsSW5kZXgpIDogdGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbilcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUodGFnRWwuY2xvc2VzdCgpKTsgXG4gICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaEVsLnJlbW92ZSgpOyBcbiAgICAgICAgICAgICAgICB9LCA1MDApOyAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgLyogZWxzZSB7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi50YWdFZGl0b3IucmVuYW1lVGFnIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyxcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNldHRpbmdzLnRhZ0VsLFxuICAgICAgICAgICAgICAgICAgICBuZXdOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC8vcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4KSxcblxuICAgICAgICAgICAgICAgICAgICAvLygodGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9PSAnaW5zdGFuY2UnKSA/IHBhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCkgOiB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uKVxuICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgfSovXG5cbiAgICAgICAgICAgIFxuICAgICAgICAvL31cblxuICAgIH1cblxuICAgIHNob3dTdW1tYXJ5T3B0aW9ucyAoKSB7XG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQoZmFsc2UpXG5cbiAgICAgICAgbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgZG8geW91IHdhbnQgdG8gYWRkIHRoZSB0YWcgc3VtbWFyeT9cIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiQWRkIG11bHRpcGxlIHRhZ3MgYWJvdmUgc2VwYXJhdGVkIGJ5IGEgY29tbWEuXCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCd0b3AnLCBcIlRvcCBvZiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlbmQnLCBcIkJvdHRvbSBvZiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgICAgICAvLy5hZGRPcHRpb24oJ2hlcmUnLCBcIkluIHBsYWNlIG9mIHRoaXMgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbm90ZScsIFwiSW4gYSBuZXcgbm90ZVwiKSBcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdW1tYXJ5UG9zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzLnN1bW1hcnlQb3MpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApOyBcbiAgICB9XG5cblxuICAgIHNob3dFZGl0VGFnT3B0aW9ucyAoZWRpdFR5cGU6IFN0cmluZykge1xuXG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyk7XG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQodHJ1ZSlcblxuICAgICAgICBpZiAoZWRpdFR5cGUgPT0gJ3JlbmFtZScpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBuZXcgU2V0dGluZyh0aGlzLm9wdGlvbnNEaXYpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJOZXcgbmFtZVwiKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKFwiVGFncyBjYW4gaW5jbHVkZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyAoXyksIGh5cGhlbnMgKC0pLCBhbmQgZm9yd2FyZCBzbGFzaGVzICgvKSBmb3IgbmVzdGVkIHRhZ3MuXCIpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQoKG9wdCkgPT5cbiAgICAgICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSgnJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmlucHV0Q2hhbmdlSGFuZGxlciAodmFsdWUsIGVkaXRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5uZXdOYW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgd2hlcmVFZGl0T3B0ID0gbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgdG8gbWFrZSB0aGlzIGNoYW5nZT9cIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXQVJOSU5HOiBUaGVyZSBpcyBOTyBVTkRPIGZvciB0aGlzIHRoaXMgYWN0aW9uLlwiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICBvcHRcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ2luc3RhbmNlJywgXCJKdXN0IHRoaXMgaW5zdGFuY2VcIilcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ25vdGUnLCBcIkFsbCBpbiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ3ZhdWx0JywgXCJBY3Jvc3MgZW50aXJlIHZhdWx0XCIpXG4gICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICd2YXVsdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmVFZGl0T3B0LnNldERlc2MoXCJXQVJOSU5HOiBUaGVyZSBpcyBOTyBVTkRPIGZvciB2YXVsdCBjaGFuZ2VzLiBDb25zaWRlciBtYWtpbmcgYSBiYWNrdXAgb2YgeW91ciB2YXVsdCBmaXJzdC5cIilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9ICd2YXVsdCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSAnbm90ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmVFZGl0T3B0LnNldERlc2MoXCJPbmx5IHRhZ3MgaW4gdGhpcyBub3RlIHdpbGwgYmUgdXBkYXRlZC4gQ2hvb3NlIFxcJ0Fjcm9zcyBlbnRpcmUgdmF1bHRcXCcgdG8gdXBkYXRlIHRoaXMgdGFnIGV2ZXJ5d2hlcmUuXCIpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPSAnbm90ZSc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSAnaW5zdGFuY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlRWRpdE9wdC5zZXREZXNjKFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPSAnaW5zdGFuY2UnO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb29uID0gdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG5cblxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlLCBGdXp6eVN1Z2dlc3RNb2RhbCwgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3RGaWxlTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgcmVzdWx0OiBURmlsZTtcbiAgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkO1xuICBmaWxlTGlzdDogVEZpbGVbXTtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG5cbiAgICB0aGlzLmZpbGVMaXN0ID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhbGwgYXZhaWxhYmxlIHN1Z2dlc3Rpb25zLlxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgLy9pZiAodGhpcy5maWxlTGlzdC5sZW5ndGggPT0gMClcbiAgICByZXR1cm4gdGhpcy5maWxlTGlzdC5maWx0ZXIoKGZpbGUpID0+XG4gICAgICBmaWxlLnBhdGguaW5jbHVkZXMocXVlcnkpXG4gICAgKTtcbiAgfVxuXG4gIC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXG4gIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgIGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZmlsZS5uYW1lIH0pO1xuICAgIGVsLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiBmaWxlLnBhdGggfSk7XG4gIH1cblxuICAvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cbiAgb25DaG9vc2VTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgLy9uZXcgTm90aWNlKGBTZWxlY3RlZCAke2ZpbGUucGF0aH1gKTtcbiAgICAvL2NvbnNvbGUubG9nKGV2dC50YXJnZXQudmFsdWUpXG4gICAgLy9pZiAoZmlsZS5uYW1lKVxuICAgIHRoaXMub25TdWJtaXQoZmlsZSlcbiAgfVxuXG4gIC8vb25Ob1N1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAvL25ldyBOb3RpY2UoYE5vIHNlbGVjdGlvbmApO1xuICAgIC8vdGhpcy5vblN1Ym1pdChmaWxlKVxuICAvL31cbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blJlbmRlcmVyLCBDYWNoZWRNZXRhZGF0YSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgRHJvcGRvd25Db21wb25lbnQsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFnU3VtbWFyeSB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblx0c2VsZWN0ZWRCbG9ja3M6IE51bWJlcltdO1xuXHRibG9ja3M6IFN0cmluZ1tdO1xuXHRwcml2YXRlIHN0YXRpYyBmaWxlU3VtbWFyaWVzOiBNYXA8VEZpbGUsIFNldDxIVE1MRWxlbWVudD4+ID0gbmV3IE1hcCgpO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGFzeW5jIGJha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBzdHJpbmcsIFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudCwgXG5cdFx0ZmlsZVBhdGg6c3RyaW5nXG5cdCkge1xuXHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZSdcblx0XHQpO1xuXHRcdFxuXHRcdGlmIChtZFNvdXJjZSkge1xuXHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBuZXdGaWxlQ29udGVudCA9IFV0aWxzLnJlcGxhY2VUZXh0SW5TdHJpbmcgKFxuXHRcdFx0XHRtZFNvdXJjZSwgXG5cdFx0XHRcdGZpbGVDb250ZW50LCBcblx0XHRcdFx0c3VtbWFyeU1kXG5cdFx0XHQpXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG5cdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnVGFnIHN1bW1hcnkgZmxhdHRlbmVkIHRvIGFjdGl2ZSBub3RlLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIFRhZyBCdWRkeTogQ2FuXFx0IGZpbmQgY29kZSBibG9jayBzb3VyY2UuIFRoaXMgaXMgYSBCVUcuIFx1RDgzRVx1REVCMicpO1xuXHRcdH1cblx0fVxuXG5cdC8qcHVibGljIHN0YXRpYyBhZGRTdW1tYXJ5KGZpbGU6IFRGaWxlLCBzdW1tYXJ5OiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmlsZVN1bW1hcmllcy5oYXMoZmlsZSkpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsZVN1bW1hcmllcy5zZXQoZmlsZSwgbmV3IFNldChbc3VtbWFyeV0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcmllcyA9IHRoaXMuZmlsZVN1bW1hcmllcy5nZXQoZmlsZSk7XG4gICAgICAgICAgICBzdW1tYXJpZXM/LmFkZChzdW1tYXJ5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1ldGhvZCB0byByZXRyaWV2ZSBhbiBhcnJheSBvZiB1bmlxdWUgc3VtbWFyeSBlbGVtZW50cyBmb3IgYSBnaXZlbiBmaWxlXG4gICAgcHVibGljIHN0YXRpYyBnZXRTdW1tYXJpZXNCeUZpbGUoZmlsZTogVEZpbGUpOiBIVE1MRWxlbWVudFtdIHtcbiAgICAgICAgY29uc3Qgc3VtbWFyaWVzID0gdGhpcy5maWxlU3VtbWFyaWVzLmdldChmaWxlKTtcbiAgICAgICAgcmV0dXJuIHN1bW1hcmllcyA/IEFycmF5LmZyb20oc3VtbWFyaWVzKSA6IFtdO1xuICAgIH0qL1xuXG5cdGNvcHlCdG5IYW5kbGVyIChlLCBjb250ZW50KTp2b2lkIHtcblxuXHRcdC8vZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdGxldCBub3RpY2U7XG5cblx0XHRpZiAoc2VsZWN0aW9uICE9ICcnKSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChzZWxlY3Rpb24pO1xuXHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ1NlbGVjdGlvbiBjb3BpZWQgdG8gY2xpcGJvYXJkLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWdnZWQgcGFyYWdyYXBoIGNvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cdFx0fVxuXG5cdFx0Ly9uYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHQvL2NvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IENvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cblx0fVxuXG5cdHJlbW92ZVRhZ0J0bkhhbmRsZXIgKGUsIHBhcmFncmFwaEVsLCB0YWcpOnZvaWQge1xuXHRcdGNvbnN0IHRhZ0VsID0gVXRpbHMuZ2V0VGFnRWxlbWVudChwYXJhZ3JhcGhFbCwgdGFnKTtcblx0XHR0aGlzLnBsdWdpbi50YWdFZGl0b3IuZWRpdCh0YWdFbCk7XG5cdH1cblxuXHRhc3luYyBjb3B5VG9CdG5IYW5kbGVyIChcblx0XHRlOiBFdmVudCwgXG5cdFx0bW9kZTogU3RyaW5nLFxuXHRcdGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCxcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnQsXG5cdFx0Y29udGVudDogc3RyaW5nLCAgXG5cdFx0dGFnczogQXJyYXksIFxuXHRcdGZpbGVQYXRoOiBzdHJpbmcsXG5cdFx0c2VsZWN0ZWRGaWxlOiBURmlsZVxuXHQpIHtcblx0XHRsZXQgbmV3Q29udGVudFxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdFxuXHRcdGlmIChzZWxlY3Rpb24gPT0gJycpIG5ld0NvbnRlbnQgPSBjb250ZW50O1xuXHRcdGVsc2UgbmV3Q29udGVudCA9IHNlbGVjdGlvbjtcblx0XHRsZXQgbm90aWNlO1xuXHRcdFx0XHRcblx0XHRpZiAobW9kZSA9PSAnbGluaycpIHtcblx0XHRcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKS5yZXBsYWNlKC9cXC5tZCQvLCAnJyk7XG5cdFx0XHRuZXdDb250ZW50ID0gJ1tbJyArIGZpbGVQYXRoICsgJ3wnICsgZmlsZU5hbWUgKyAnXV0nO1xuXHRcdFxuXHRcdH0gXG5cblx0XHRpZiAobW9kZSAhPSAnbGluaycgJiYgIXNlbGVjdGlvbikge1xuXHRcdFx0dGFncy5mb3JFYWNoKCh0YWcsIGkpID0+IHtcblx0XHRcdFx0Ly8gbWFrZSB0aGlzIGEgc2V0dGluZy4gd2UnbGwgZGVmYXVsdCB0byBhbHdheXMgZm9yIG5vd1xuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMucmVtb3ZlVGFnRnJvbVN0cmluZyhuZXdDb250ZW50LCB0YWcpLnRyaW0oKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuLy9jb25zb2xlLmxvZyhkcm9wZG93bi5nZXRWYWx1ZSgpKVxuXG5cdFx0Y29uc3QgY29weVN1Y2Nlc3MgPSBhd2FpdCB0aGlzLmNvcHlUZXh0VG9TZWN0aW9uKFxuXHRcdFx0Ly90aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdnZWRQYXJhZ3JhcGhDb3B5UHJlZml4ICsgXG5cdFx0XHRuZXdDb250ZW50LCBcblx0XHRcdGRyb3Bkb3duLmdldFZhbHVlKCksIFxuXHRcdFx0ZmlsZVBhdGgsXG5cdFx0XHQobW9kZSE9J2xpbmsnKSxcblx0XHRcdHNlbGVjdGVkRmlsZVxuXHRcdCk7XG5cblx0XHRpZiAoY29weVN1Y2Nlc3MpIHtcblxuXHRcdFx0aWYgKG1vZGUgPT0gJ25vdGUnKSB7XG5cblx0XHRcdFx0bm90aWNlID0gbmV3IE5vdGljZShcblx0XHRcdFx0XHQnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpICsgJyBpbiAnICsgc2VsZWN0ZWRGaWxlLm5hbWUgKyAnIFx1RDgzRFx1REQxNycsXG5cdFx0XHRcdFx0NTAwMCk7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoc2VsZWN0ZWRGaWxlLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcbiBcdFx0XHRcdH0pO1xuXG5cdFx0XHR9IGVsc2UgaWYgKG1vZGUgPT0gJ21vdmUnICYmICFzZWxlY3Rpb24pIHtcblxuXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0XHRsZXQgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGZpbGVDb250ZW50LnRyaW0oKTtcblx0XHRcdFx0Y29uc3QgbmV3RmlsZUNvbnRlbnQgPSBVdGlscy5yZXBsYWNlVGV4dEluU3RyaW5nKFxuXHRcdFx0XHRcdGNvbnRlbnQudHJpbSgpLCBcblx0XHRcdFx0XHRmaWxlQ29udGVudCwgXG5cdFx0XHRcdFx0bmV3Q29udGVudCkudHJpbSgpO1xuXHRcdFx0XHRpZiAoZmlsZUNvbnRlbnQgIT0gbmV3RmlsZUNvbnRlbnQpIHtcblx0XHRcdFx0XHQvLyByZW5pdmUgdGhlIHRhZyBiZWZvcmUgY29weWluZ1xuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdGaWxlQ29udGVudCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc3QgY29waWVkVG9XaGVyZTogU3RyaW5nID0gZHJvcGRvd24uZ2V0VmFsdWUoKT09J3RvcCcgPyAndG9wIG9mIG5vdGUnIDogZHJvcGRvd24uZ2V0VmFsdWUoKT09J2VuZCcgPyAnZW5kIG9mIG5vdGUnIDogZHJvcGRvd24uZ2V0VmFsdWUoKVxuXHRcdFx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UoXG5cdFx0XHRcdFx0XHQvLydNb3ZlZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArXG5cdFx0XHRcdFx0XHQvLycuXFxuXHVEODNEXHVERDE3IE9wZW4gc291cmNlIG5vdGUuJywgXG5cdFx0XHRcdFx0XHQnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpICsgJy4gJyArICgoZHJvcGRvd24uZ2V0VmFsdWUoKT09J3RvcCcgfHwgZHJvcGRvd24uZ2V0VmFsdWUoKT09J2VuZCcpID8gJycgOiAnXHVEODNEXHVERDE3JyksXG5cdFx0XHRcdFx0XHQ1MDAwKTtcblxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5yZW1vdmVFbGVtZW50V2l0aEFuaW1hdGlvbihwYXJhZ3JhcGhFbCwgKCkgPT4geyBcblx0ICAgIFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHQgICAgXHRcdFx0XHRcdHRoaXMudXBkYXRlKHN1bW1hcnlFbCk7IFxuXHQgICAgXHRcdFx0XHRcdHBhcmFncmFwaEVsLnJlbW92ZSgpOyBcblx0ICAgIFx0XHRcdFx0fSwgNTAwKTtcdFx0XHRcdFx0XHRcblx0XHRcdFx0ICAgIFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHQgICAgXHRcdC8vdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnJ1bigpOyBcblx0XHRcdFx0ICAgIFx0fSwgODAwKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChkcm9wZG93bi5nZXRWYWx1ZSgpICE9ICd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCkgIT0gJ2VuZCcpIHtcblxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlUGF0aCwgJycpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkucGF0aCsnIycrZHJvcGRvd24uZ2V0VmFsdWUoKSwgJycpO1xuXHRcdCBcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gXG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlICgnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpIFxuXHRcdFx0XHRcdFx0KyAnLlxcbkNhblxcJ3QgdXBkYXRlIHNvdXJjZSBmaWxlLicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnY29weScgfHwgbW9kZSA9PSAnbGluaycpIHtcblx0XHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ0NvcGllZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArICcuICcgKyAoKGRyb3Bkb3duLmdldFZhbHVlKCk9PSd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCk9PSdlbmQnKSA/ICcnIDogJ1x1RDgzRFx1REQxNycpKTtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XHRcblx0fVxuXG5cdGFzeW5jIG1ha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBTdHJpbmcsIFxuXHRcdHRhZ3M6IEFycmF5LFxuXHRcdGNvZGU6IEJvb2xlYW4gPSBmYWxzZSxcblx0XHRpbmNyZW1lbnRGaWxlOiBCb29sZWFuID0gZmFsc2Vcblx0KSB7XG5cbi8vbmV3IE5vdGljZSAoJ21ha2VTdW1tYXJ5QnRuSGFuZGxlcicsIDEwMDAwKVxuXG5cdFx0Ly8gdHJ5IHRvIGFic3RyYWN0IHRoZSBoYW5kbGVycyBmcm9tIHRoZWlyIGZ1bmN0aW9uc1xuXHRcdC8vY29uc3QgbmV3Tm90ZU9iaiA9IHRoaXMuZmlsZU9iakZyb21UYWdzKHRhZ3MpO1xuXHRcdGNvbnN0IG5ld05vdGVPYmogPSBVdGlscy5maWxlT2JqRnJvbVRhZ3ModGFncyk7XG5cdFx0bGV0IGZpbGVDb250ZW50ID0gY29kZSA/IHN1bW1hcnlNZCA6ICcjIyAnICsgbmV3Tm90ZU9iai50aXRsZSArICdcXG5cXG4nICsgc3VtbWFyeU1kO1xuXHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdC8vY29uc3QgZmlsZU5hbWUgPSB0aGlzLmdldEFjdGl2ZUZpbGVGb2xkZXIoKStuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdC8vIGNvbnN0IGZpbGVOYW1lID0gVXRpbHMuZ2V0QWN0aXZlRmlsZUZvbGRlcih2aWV3KStuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gVXRpbHMuZ2V0QWN0aXZlRmlsZUZvbGRlcih0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpKVxuXHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZVBhdGggKyBuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU5hbWUpO1xuXHRcdGxldCBub3RpY2U7XG5cblx0XHQvL2NvbnNvbGUubG9nIChuZXdOb3RlT2JqLmZpbGVOYW1lKTtcblxuXHRcdGlmICghY29kZSkge1xuXHRcdFx0dGFncy5mb3JFYWNoICgodGFnKSA9PiB7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gVXRpbHMucmVwbGFjZVRleHRJblN0cmluZyAodGFnLCBmaWxlQ29udGVudCwgdGFnLnN1YnN0cmluZygxKSwgdHJ1ZSlcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgIWluY3JlbWVudEZpbGUpIHtcblxuXHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBOb3RlIGFscmVhZHkgZXhpc3RzLlxcbkNsaWNrIGhlcmUgdG8gb3ZlcndyaXRlLicsIDgwMDApO1xuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBmaWxlQ29udGVudCk7XG5cdFx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdOb3RlIHVwZGF0ZWQuXFxuXHVEODNEXHVERDE3IE9wZW4gbm90ZS4nLCA1MDAwKTtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlTmFtZSwgJycpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0Lyp9IGVsc2UgaWYgKChmaWxlIGluc3RhbmNlb2YgVEZpbGUpICYmIGluY3JlbWVudEZpbGUpIHtcblxuXHRcdFx0Y29uc3QgYmFzZU5hbWUgPSBmaWxlLm5hbWUucmVwbGFjZSgvXFwubWQkLywgXCJcIik7XG5cdFx0XHRjb25zdCBleHRlbnNpb24gPSBcIi5tZFwiO1xuXHRcdFx0Y29uc3QgcmVnZXggPSAvKFxcZCspJC87XG5cdFx0XHRjb25zdCBtYXRjaCA9IGJhc2VOYW1lLm1hdGNoKHJlZ2V4KTtcblx0XHRcdGxldCBpbmNyZW1lbnRlZEZpbGVOYW1lO1xuXHRcdFx0bGV0IHN1ZmZpeCA9IDE7IFxuXHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHQgICAgc3VmZml4ID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKSArIDE7XG5cdFx0XHQgICAgLy8gSWYgdGhlcmUncyBhIG1hdGNoLCB5b3UgbmVlZCB0byByZW1vdmUgdGhlIG1hdGNoZWQgbnVtYmVyIGZyb20gdGhlIGJhc2VOYW1lIGJlZm9yZSBhcHBlbmRpbmcgdGhlIGluY3JlbWVudGVkIG51bWJlclxuXHRcdFx0ICAgIGNvbnN0IG51bWJlckxlbmd0aCA9IG1hdGNoWzFdLmxlbmd0aDtcblx0XHRcdCAgICBjb25zdCBiYXNlTmFtZVdpdGhvdXROdW1iZXIgPSBiYXNlTmFtZS5zbGljZSgwLCAtbnVtYmVyTGVuZ3RoKTtcblx0XHRcdCAgICBpbmNyZW1lbnRlZEZpbGVOYW1lID0gYmFzZU5hbWVXaXRob3V0TnVtYmVyICsgJyAnICsgc3VmZml4ICsgZXh0ZW5zaW9uO1xuXHRcdFx0ICAgIGNvbnNvbGUubG9nKHN1ZmZpeCwgZmlsZVBhdGggKyBpbmNyZW1lbnRlZEZpbGVOYW1lKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHQgICAgLy8gSWYgdGhlcmUncyBubyBudW1iZXIgYXQgdGhlIGVuZCwgdGhlIGFwcHJvYWNoIHJlbWFpbnMgdGhlIHNhbWVcblx0XHRcdCAgICBpbmNyZW1lbnRlZEZpbGVOYW1lID0gYmFzZU5hbWUgKyAnICcgKyBzdWZmaXggKyBleHRlbnNpb247XG5cdFx0XHQgICAgY29uc29sZS5sb2coc3VmZml4LCBmaWxlUGF0aCArIGluY3JlbWVudGVkRmlsZU5hbWUpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoK2luY3JlbWVudGVkRmlsZU5hbWUsIGZpbGVDb250ZW50KTtcblx0XHRcdGNvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UgKCdOb3RlIGNyZWF0ZWQuIFx1RDgzRFx1RENEQ1xcblx1RDgzRFx1REQxNyBPcGVuIG5vdGUuJyk7XG5cdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KG5vdGljZS5ub3RpY2VFbCwgJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChuZXdOb3RlT2JqLmZpbGVOYW1lLCAnJyk7XG5cdFx0XHR9KTtcblx0XHRcdCovXG5cblx0XHR9IGVsc2UgaWYgKCFmaWxlKSB7XG5cblx0XHRcdHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlTmFtZSwgZmlsZUNvbnRlbnQpO1xuXHRcdFx0Y29uc3Qgbm90aWNlID0gbmV3IE5vdGljZSAoJ1N1bW1hcnkgbm90ZSBjcmVhdGVkLiBcdUQ4M0RcdURDRENcXG5cdUQ4M0RcdUREMTcgT3BlbiBub3RlLicpO1xuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobmV3Tm90ZU9iai5maWxlTmFtZSwgJycpO1xuXHRcdFx0fSk7XG5cblxuXHRcdH1cblx0fVxuXG5cdGNyZWF0ZUNvZGVCbG9jayAodGFnc0FycmF5OiBTdHJpbmdbXSwgcG9zOiBTdHJpbmcpIHtcblx0XHQvL2NvbnNvbGUubG9nKHN1bW1hcnlQb3MpXG5cdFx0Y29uc3QgY29kZUJsb2NrU3RyaW5nID0gXG5cdFx0XHQnYGBgdGFnLXN1bW1hcnlcXG4nICtcblx0XHRcdCd0YWdzOiAnICsgdGFnc0FycmF5LmpvaW4oJyAnKSArICdcXG4nICtcblx0XHRcdCdgYGAnO1xuXG5cdFx0aWYgKHBvcyA9PSAnbm90ZScpIHtcblxuXHRcdFx0dGhpcy5tYWtlU3VtbWFyeUJ0bkhhbmRsZXIgKGNvZGVCbG9ja1N0cmluZywgdGFnc0FycmF5LCB0cnVlKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHRoaXMuY29weVRleHRUb1NlY3Rpb24oXG5cdFx0XHQgICAgY29kZUJsb2NrU3RyaW5nLFxuXHRcdFx0ICAgIHBvcywgXG5cdFx0XHQgICAgJycsXG5cdFx0XHQgICAgZmFsc2Vcblx0XHQgICAgKVxuXHRcdH1cblxuXHR9XG5cblx0YXN5bmMgY29kZUJsb2NrUHJvY2Vzc29yIChcblx0XHRzb3VyY2U6IHN0cmluZywgXG5cdFx0ZWw6SFRNTEVsZW1lbnQsIFxuXHRcdGN0eFxuXHQpOiB2b2lkIHtcblx0XHRcblx0XHQvLyBJbml0aWFsaXplIHRhZyBsaXN0XG5cdFx0bGV0IHRhZ3M6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgaW5jbHVkZTogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdGxldCBleGNsdWRlOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IHNlY3Rpb25zOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IG1heDogbnVtYmVyID0gNTA7XG5cdFx0Y29uc3QgbWF4UGF0dGVybiA9IC9eXFxzKm1heDpcXHMqKFxcZCspXFxzKiQvO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdC8vIFByb2Nlc3Mgcm93cyBpbnNpZGUgY29kZWJsb2NrXG5cdFx0Y29uc3Qgcm93cyA9IHNvdXJjZS5zcGxpdChcIlxcblwiKS5maWx0ZXIoKHJvdykgPT4gcm93Lmxlbmd0aCA+IDApO1xuXHRcdHJvd3MuZm9yRWFjaCgobGluZSkgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIChPUilcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKnRhZ3M6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqdGFnczovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSB0YWdzIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR0YWdzID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIHRvIGluY2x1ZGUgKEFORClcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKmluY2x1ZGU6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqaW5jbHVkZTovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBpbmNsdWRlIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpbmNsdWRlID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIHRvIGV4Y2x1ZGUgKE5PVClcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKmV4Y2x1ZGU6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqZXhjbHVkZTovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBleGNsdWRlIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRleGNsdWRlID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHNlY3Rpb25zIG9mIGEgbm90ZVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqc2VjdGlvbnM6W1xccHtMfTAtOV9cXC0vIywgXSskL2d1KSkge1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gbGluZS5yZXBsYWNlKC9eXFxzKnNlY3Rpb25zOi8sIFwiXCIpLnRyaW0oKTtcblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHNlY3Rpb25zIGFuZCBhc3NpZ24gdGhlbSB0byB0aGUgc2VjdGlvbnMgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KCcsJykubWFwKChzZWMpID0+IHNlYy50cmltKCkpO1xuXHRcdFx0XHRzZWN0aW9ucyA9IGxpc3Q7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoZSBsaW5lIHNwZWNpZmllcyBtYXggbnVtYmVyIG9mIGJsb2NrcyB0byBkaXNwbGF5XG5cdFx0XHRtYXRjaCA9IGxpbmUubWF0Y2gobWF4UGF0dGVybik7XG5cdFx0XHRpZiAobWF0Y2gpIHtcbiAgICBcdFx0XHRtYXggPSBNYXRoLm1pbig1MCwgTnVtYmVyKG1hdGNoWzFdKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Y29uc3QgY29kZUJsb2NrID0gJ2BgYHRhZy1zdW1tYXJ5XFxuJytzb3VyY2UudHJpbSgpKydcXG5gYGAnXG5cdFx0Ly8gQ3JlYXRlIHN1bW1hcnkgb25seSBpZiB0aGUgdXNlciBzcGVjaWZpZWQgc29tZSB0YWdzXG5cdFx0aWYgKHRhZ3MubGVuZ3RoID4gMCB8fCBpbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlKFxuXHRcdFx0XHRlbCwgXG5cdFx0XHRcdHRhZ3MsIFxuXHRcdFx0XHRpbmNsdWRlLCBcblx0XHRcdFx0ZXhjbHVkZSwgXG5cdFx0XHRcdHNlY3Rpb25zLCBcblx0XHRcdFx0bWF4LCBcblx0XHRcdFx0Y3R4LnNvdXJjZVBhdGgsIFxuXHRcdFx0XHRjb2RlQmxvY2tcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3JlYXRlRW1wdHkoXG5cdFx0XHRcdGVsLCBcblx0XHRcdFx0dGFncyA/IHRhZ3MgOiBbXSwgXG5cdFx0XHRcdGluY2x1ZGUgPyBpbmNsdWRlIDogW10sIFxuXHRcdFx0XHRleGNsdWRlID8gZXhjbHVkZSA6IFtdLCBcblx0XHRcdFx0c2VjdGlvbnMgPyBzZWN0aW9ucyA6IFtdLCBcblx0XHRcdFx0bWF4ID8gbWF4IDogW10sIFxuXHRcdFx0XHRjdHguc291cmNlUGF0aCA/IGN0eC5zb3VyY2VQYXRoIDogJycsIFxuXHRcdFx0XHRjb2RlQmxvY2tcblx0XHRcdCk7XG5cdFx0fSBcblx0fTsgXG5cblx0Y3JlYXRlRW1wdHkoXG5cdFx0ZWxlbWVudDogSFRNTEVsZW1lbnQsIFxuXHRcdHRhZ3M6IFN0cmluZ1tdLCBcblx0XHRpbmNsdWRlOiBzdHJpbmdbXSwgXG5cdFx0ZXhjbHVkZTogc3RyaW5nW10sIFxuXHRcdHNlY3Rpb25zOiBzdHJpbmdbXSwgXG5cdFx0bWF4OiBudW1iZXIsIFxuXHRcdGZpbGVDdHg6IHN0cmluZywgXG5cdFx0bWRTb3VyY2U6c3RyaW5nXG5cdCk6IHZvaWQge1xuXG5cdFx0Y29uc3QgY29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuXHRcdGNvbnN0IHRleHREaXYgPSBjcmVhdGVFbChcImJsb2NrcXVvdGVcIik7XG5cdFx0dGV4dERpdi5pbm5lckhUTUwgPSBcIlRoZXJlIGFyZSBubyBub3RlcyB3aXRoIHRhZ2dlZCBwYXJhZ3JhcGhzIHRoYXQgbWF0Y2ggdGhlIHRhZ3M6PGJyPlwiXG5cdFx0XHQrICh0YWdzLmxlbmd0aD4wID8gdGFncy5qb2luKCcsICcpIDogXCJObyB0YWdzIHNwZWNpZmllZC5cIikgKyBcIjxicj5cIjtcblx0XHRcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dERpdik7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncycsIFxuXHRcdFx0KCh0YWdzLmxlbmd0aCA+IDApID8gdGFncy5qb2luKCcsJykgOiAnJylcblx0XHQpO1xuXHRcdGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZScsIFxuXHRcdFx0KGluY2x1ZGUgPyBpbmNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdCk7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncy1leGNsdWRlJywgXG5cdFx0XHQoZXhjbHVkZSA/IGV4Y2x1ZGUuam9pbignLCcpIDogJycpXG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1zZWN0aW9ucycsIFxuXHRcdFx0KHNlY3Rpb25zID8gc2VjdGlvbnMuam9pbignLCcpIDogJycpXG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1tYXgnLCBcblx0XHRcdG1heFxuXHRcdCk7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZScsIFxuXHRcdFx0bWRTb3VyY2Vcblx0XHQpO1xuXG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMucGx1Z2luLmd1aS5tYWtlU3VtbWFyeVJlZnJlc2hCdXR0b24oY29udGFpbmVyKSk7O1xuXG5cdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChjb250YWluZXIpO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlKFxuXHRcdGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBcblx0XHR0YWdzOiBzdHJpbmdbXSwgXG5cdFx0aW5jbHVkZTogc3RyaW5nW10sIFxuXHRcdGV4Y2x1ZGU6IHN0cmluZ1tdLCBcblx0XHRzZWN0aW9uczogc3RyaW5nW10sXG5cdFx0bWF4OiBudW1iZXIsIFxuXHRcdGZpbGVDdHg6IHN0cmluZyxcblx0XHRtZFNvdXJjZTpzdHJpbmdcblx0KTogdm9pZCB7XG5cdFx0XG4vL2NvbnNvbGUubG9nKCdjcmVhdGUgc3VtbWFyeScpXG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0Y29uc3QgdmFsaWRUYWdzID0gdGFncy5jb25jYXQoaW5jbHVkZSk7XG5cdFx0Y29uc3QgdGVtcENvbXBvbmVudCA9IG5ldyBUZW1wQ29tcG9uZW50KCk7XG5cdFx0Y29uc3Qgc3VtbWFyeUNvbnRhaW5lciA9IGNyZWF0ZUVsKCdkaXYnKTtcblx0XHQvL3N1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWwoJ2hyJykpO1xuXHRcdHRoaXMuc2VsZWN0ZWRCbG9ja3MgPSBbXTtcblx0XHR0aGlzLmJsb2NrcyA9IFtdO1xuXG5cdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY2xhc3MnLCBcblx0XHRcdCd0YWctc3VtbWFyeS1ibG9jaydcblx0XHQpO1xuXHRcdFxuXHRcdC8vIEdldCBmaWxlc1xuXHRcdGxldCBsaXN0RmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0XHQvLyBGaWx0ZXIgZmlsZXNcblx0XHRsaXN0RmlsZXMgPSBsaXN0RmlsZXMuZmlsdGVyKChmaWxlKSA9PiB7XG5cdFx0XHQvLyBSZW1vdmUgZmlsZXMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgdGFncyBzZWxlY3RlZCBieSB0aGUgdXNlclxuXHRcdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdGNvbnN0IHRhZ3NJbkZpbGUgPSBnZXRBbGxUYWdzKGNhY2hlKTtcblx0XHRcdC8vIFJlbW92ZSBmaWxlcyB3aGVyZSB0aGUgcGF0aCBpbmNsdWRlcyAnX2V4Y2x1ZGUnXG5cdFx0XHRpZiAoZmlsZS5wYXRoLmluY2x1ZGVzKCdfZXhjbHVkZScpKSByZXR1cm4gZmFsc2Vcblx0XHRcdFxuXHRcdFx0Ly8gUmVtb3ZlIHRoZSBmaWxlIGlmIGl0J3MgdGhlIHNhbWUgZmlsZSBhcyB0aGlzIHN1bW1hcnlcblx0XHRcdGlmIChhY3RpdmVGaWxlKSBpZiAoYWN0aXZlRmlsZS5wYXRoID09IGZpbGUucGF0aCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRpZiAodmFsaWRUYWdzLnNvbWUoKHZhbHVlKSA9PiB0YWdzSW5GaWxlPy5pbmNsdWRlcyh2YWx1ZSkpKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuXHRcdC8vIFNvcnQgZmlsZXMgYWxwaGFiZXRpY2FsbHlcblx0XHQvLyBtYWtlIHRoaXMgYSBwcm9wZXJ0eSBvZiB0aGUgY29kZSBibG9jay4gYnV0IGRlZmF1bHQgdG8gbW9kaWZpZWQgZGF0ZVxuXHRcdC8qbGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdFx0aWYgKGZpbGUxLnBhdGggPCBmaWxlMi5wYXRoKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoZmlsZTEucGF0aCA+IGZpbGUyLnBhdGgpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHR9KTsqL1xuIFxuXG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdCAgICAvLyBTaW5jZSBtdGltZSBpcyBhIFVuaXggdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kcywgd2UgY2FuIGRpcmVjdGx5IHN1YnRyYWN0IHRoZW1cblx0XHQgICAgLy9jb25zb2xlLmxvZyhmaWxlMi5zdGF0LmN0aW1lIC0gZmlsZTEuc3RhdC5jdGltZSlcblx0XHQgICAgcmV0dXJuIGZpbGUyLnN0YXQuY3RpbWUgLSBmaWxlMS5zdGF0LmN0aW1lO1xuXHRcdH0pO1xuXG5cdFx0Ly8gR2V0IGZpbGVzIGNvbnRlbnRcblx0XHRsZXQgbGlzdENvbnRlbnRzOiBbVEZpbGUsIHN0cmluZ11bXSA9IGF3YWl0IHRoaXMucmVhZEZpbGVzKGxpc3RGaWxlcyk7XG5cdFx0bGV0IGNvdW50ID0gMDtcblxuXHRcdC8vIENyZWF0ZSBzdW1tYXJ5XG5cdFx0bGV0IHN1bW1hcnk6IHN0cmluZyA9IFwiXCI7XG5cdFx0bGlzdENvbnRlbnRzLmZvckVhY2goKGl0ZW0pID0+IHtcblxuXHRcdFx0Ly8gR2V0IGZpbGVzIG5hbWVcblx0XHRcdC8vIGl0ZW1bMF0gaXMgdGhlIGZpbGUsIGl0ZW1bMV0gaXMgdGhlIGZpbGUgY29udGVudFxuXHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBpdGVtWzBdLm5hbWUucmVwbGFjZSgvLm1kJC9nLCBcIlwiKTtcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gaXRlbVswXS5wYXRoO1xuXHRcdFx0XG5cdFx0XHQvLyBHZXQgcGFyYWdyYXBoc1xuXHRcdFx0Ly9sZXQgbGlzdFBhcmFncmFwaHM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRcdC8vY29uc3QgYmxvY2tzID0gaXRlbVsxXS5zcGxpdCgvXFxuXFxzKlxcbi8pLmZpbHRlcigocm93KSA9PiByb3cudHJpbSgpLmxlbmd0aCA+IDApO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdG8gdHJlYXQgbGlzdCBpdGVtcyBhcyBwYXJhZ3JhcGggYnJlYWtzXG5cdFx0XHRsZXQgbGlzdFBhcmFncmFwaHM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRcdGNvbnN0IGJsb2NrcyA9IGl0ZW1bMV1cblx0XHRcdCAgLnNwbGl0KC8oPzpcXG5cXHMqXFxufCg/PD1efFxcbilbKi1dXFxzfCg/PD1efFxcbilcXGQrXFwuXFxzKS8pXG5cdFx0XHQgIC5maWx0ZXIoKHJvdykgPT4gcm93LnRyaW0oKS5sZW5ndGggPiAwKTtcblxuXG5cdFx0XHQvLyBHZXQgbGlzdCBpdGVtc1xuXHRcdFx0YmxvY2tzLmZvckVhY2goKHBhcmFncmFwaCkgPT4ge1xuXHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHBhcmFncmFwaCBpcyBhbm90aGVyIHBsdWdpblxuXHRcdFx0XHRsZXQgdmFsaWQgPSBmYWxzZTtcblx0XHRcdFx0Ly9sZXQgbGlzdFRhZ3MgPSBwYXJhZ3JhcGgubWF0Y2goLyNbXFxwe0x9MC05X1xcLS8jXSsvZ3UpO1xuXHRcdFx0XHRsZXQgbGlzdFRhZ3MgPSBwYXJhZ3JhcGgubWF0Y2goLyg/PD1efFxccykoI1teXFxzIy4sOyE/Ol0rKS9nKTsgLy8gcmV2aXNlZCB0byBub3QgbWF0Y2ggaGFzaCBpbiBtaWRkbGUgb2Ygd29yZFxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGxpc3RUYWdzICE9IG51bGwgJiYgbGlzdFRhZ3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGlmICghcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpICYmICFwYXJhZ3JhcGguY29udGFpbnMoXCItLS1cIikpIHtcblx0XHRcdFx0XHRcdHZhbGlkID0gdGhpcy5pc1ZhbGlkVGV4dChsaXN0VGFncywgdGFncywgaW5jbHVkZSwgZXhjbHVkZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHZhbGlkKSBsaXN0UGFyYWdyYXBocy5wdXNoKHBhcmFncmFwaCk7ICBcblxuXHRcdFx0fSlcblxuXHRcdFx0Ly8gVGhlcmUgaXMgYWxzbyBzb21lIHJlZHVuZGFuY3kgaGVyZSBiZWNhdXNlIHdlIGFyZSBwcm9jZXNzaW5nIGEgbG90IG9mIGNvbnRlbnQgdGhhdCB3ZSBkb24ndCBuZWVkLCBpZiBhIG1heCBpcyBzZXQuIFxuXHRcdFx0Ly8gYWRqdXN0IHRoZSBjb3VudCBjaGVjayBcblx0XHRcdC8vIFByb2Nlc3MgZWFjaCBibG9jayBvZiB0ZXh0XG5cdFx0XHRsaXN0UGFyYWdyYXBocy5mb3JFYWNoKGFzeW5jKHBhcmFncmFwaCkgPT4ge1xuXHRcdFx0XHRpZiAoY291bnQrKyA+PSBtYXgpIHJldHVybjtcblxuXHRcdFx0XHQvLyBSZXN0b3JlIG5ld2xpbmUgYXQgdGhlIGVuZFxuXHRcdFx0XHRwYXJhZ3JhcGggKz0gXCJcXG5cIjtcblxuXHRcdFx0XHR2YXIgcmVnZXggPSBuZXcgUmVnRXhwO1xuXG5cdFx0XHRcdC8vIENoZWNrIHdoaWNoIHRhZyBtYXRjaGVzIGluIHRoaXMgcGFyYWdyYXBoLlxuXHRcdFx0XHR2YXIgdGFnVGV4dCA9IG5ldyBTdHJpbmc7XG5cdFx0XHRcdHZhciB0YWdTZWN0aW9uID0gbnVsbDtcblx0XHRcdFx0dGFncy5mb3JFYWNoKCh0YWcpID0+IHtcblx0XHRcdFx0XHR0YWdUZXh0ID0gdGFnLnJlcGxhY2UoJyMnLCAnXFxcXCMnKTtcblx0XHRcdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoYCR7dGFnVGV4dH0oXFxcXFd8JClgLCAnZycpO1xuICAgICAgICAgICAgICBcdFx0aWYgKHBhcmFncmFwaC5tYXRjaChyZWdleCkgIT0gbnVsbCkgeyBcbiAgICAgICAgICAgICAgXHRcdFx0dGFnU2VjdGlvbiA9IHRhZ1xuICAgICAgICAgICAgICBcdFx0fSBcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgXHRcdFxuICAgICAgICAgIFx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgICAgXHRcdC8vY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICAgIFx0XHRidXR0b25Db250YWluZXIuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWJ1dHRvbnMnKVxuICAgICAgICAgIFx0XHRjb25zdCBwYXJhZ3JhcGhFbCA9IGNyZWF0ZUVsKFwiYmxvY2txdW90ZVwiKTtcblx0XHRcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScsIGZpbGVQYXRoKTtcblxuXHRcdFx0XHRwYXJhZ3JhcGhFbC5zZXRBdHRyaWJ1dGUoJ2luZGV4JywgY291bnQtMSk7XG5cblx0XHRcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblxuXHRcdFx0XHRjb25zdCBibG9ja0xpbmsgPSBwYXJhZ3JhcGgubWF0Y2goL1xcXltcXHB7TH0wLTlfXFwtL15dKy9ndSk7IFxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhIGhlYWRlciBpbiB0aGlzIHBhcmFnYXBoXG5cdFx0XHRcdGNvbnN0IGhlYWRlciA9IFV0aWxzLmZpbmRDbG9zZXN0SGVhZGVyV2l0aExpbmsocGFyYWdyYXBoKTtcblx0XHRcdFx0bGV0IGhlYWRlckxpbmsgPSBVdGlscy5yZW1vdmVUZXh0RnJvbVN0cmluZyAoXCIjXCIsIGhlYWRlci5saW5rLCB0cnVlKTtcblx0XHRcdFx0Ly9oZWFkZXJMaW5rID0gVXRpbHMucmVtb3ZlVGV4dEZyb21TdHJpbmcgKFwiQFwiLCBoZWFkZXJMaW5rLCB0cnVlKTtcblx0XHRcdFx0aGVhZGVyTGluayA9IFV0aWxzLnJlbW92ZVRleHRGcm9tU3RyaW5nIChcIltcIiwgaGVhZGVyTGluaywgdHJ1ZSk7XG5cdFx0XHRcdGhlYWRlckxpbmsgPSBVdGlscy5yZW1vdmVUZXh0RnJvbVN0cmluZyAoXCJdXCIsIGhlYWRlckxpbmssIHRydWUpO1xuXHRcdFx0XHRjb25zb2xlLmxvZyhcIi0tLS0tLS0tLS0tLS1cIiwgaGVhZGVyTGluaylcblxuXG5cdFx0XHRcdGxldCBsaW5rO1xuICAgICAgICBcdFx0XG4gICAgICAgIFx0XHRpZiAoYmxvY2tMaW5rKSBsaW5rID0gJ1tbJyArIGZpbGVQYXRoICsgJyMnICsgYmxvY2tMaW5rICsgJ3wnICsgZmlsZU5hbWUgKyAnXV0nO1xuXG4gICAgICAgIFx0XHQvL2Vsc2UgaWYgKGhlYWRlci50ZXh0ICE9ICcnKSBsaW5rID0gJ1tbJyArIGZpbGVQYXRoICsgJyMnICsgaGVhZGVyLmxpbmsgKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG4gICAgICAgIFx0XHRlbHNlIGlmIChoZWFkZXIudGV4dCAhPSAnJykgbGluayA9ICdbWycgKyBmaWxlUGF0aCArICcjJyArIGhlYWRlckxpbmsgKyAnXV0nO1xuXG4gICAgICAgIFx0XHRlbHNlIGxpbmsgPSAnW1snICsgZmlsZVBhdGggKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG5cbiAgICBcdFx0XHQvKmJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUJsb2NrU2VsZWN0b3IoXG5cdFx0XHRcdFx0XHRjb3VudC0xXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHQpOyovXG5cblx0XHRcdFx0Ly9pZiAoc2VjdGlvbnMubGVuZ3RoID49IDEpIHtcbiAgICAgICAgXHRcdC8qaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0biA9PSAnYWx3YXlzJyBcbiAgICAgICAgXHRcdFx0fHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuID09ICdkZXNrdG9wJyAmJiAhdGhpcy5hcHAuaXNNb2JpbGVcbiAgICAgICAgXHRcdFx0fHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuID09ICdtb2JpbGUnICYmIHRoaXMuYXBwLmlzTW9iaWxlXG4gICAgICAgIFx0XHRcdClcbiAgICAgICAgXHRcdFx0Ki9cbiAgICAgICAgXHRcdC8vaWYgKFV0aWxzLnBsYXRmb3JtU2V0dGluZ0NoZWNrICh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuKSkge1xuXG5cdFx0XHRcdFx0YnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKFxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VDb3B5VG9TZWN0aW9uKFxuXHRcdFx0XHRcdFx0XHR0aGlzLmNvcHlUb0J0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0XHRcdFx0XHRcdFx0cGFyYWdyYXBoLCBcblx0XHRcdFx0XHRcdFx0c2VjdGlvbnMsIFxuXHRcdFx0XHRcdFx0XHR0YWdzLFxuXHRcdFx0XHRcdFx0XHQoYmxvY2tMaW5rID8gKGZpbGVQYXRoICsgJyMnICsgYmxvY2tMaW5rWzBdKSA6IGZpbGVQYXRoKSwgXG5cdFx0XHRcdFx0XHRcdHBhcmFncmFwaEVsLCBcblx0XHRcdFx0XHRcdFx0c3VtbWFyeUNvbnRhaW5lclxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdC8vfVxuXHRcdFx0XHRpZiAoVXRpbHMucGxhdGZvcm1TZXR0aW5nQ2hlY2sgKHRoaXMuYXBwLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9DQkJ0bikpIHtcblxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5tYWtlQ29weUJ1dHRvbihcblx0XHRcdFx0XHRcdFx0dGhpcy5jb3B5QnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdFx0XHRwYXJhZ3JhcGgudHJpbSgpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KTtcblxuXHRcdFx0XHR9XG4vL2NvbnNvbGUubG9nKFV0aWxzLnBsYXRmb3JtU2V0dGluZ0NoZWNrICh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuKSlcblx0XHRcdFx0aWYgKFV0aWxzLnBsYXRmb3JtU2V0dGluZ0NoZWNrICh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuKSkge1xuXG5cdFx0XHRcdFx0YnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKFxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VSZW1vdmVUYWdCdXR0b24oXG5cdFx0XHRcdFx0XHRcdHRoaXMucmVtb3ZlVGFnQnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0XHRcdHRhZ1NlY3Rpb24vLywgXG5cdFx0XHRcdFx0XHRcdC8vKGJsb2NrTGluayA/IChmaWxlUGF0aCArICcjJyArIGJsb2NrTGlua1swXSkgOiBmaWxlUGF0aClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdH1cblxuXG4gICAgICAgIFx0XHRjb25zdCBtZFBhcmFncmFwaCA9IHBhcmFncmFwaDtcbiAgICAgICAgXHRcdHBhcmFncmFwaCA9ICcqKicgKyBsaW5rICsgJyoqXFxuJyArIHBhcmFncmFwaDtcbiAgICAgICAgICBcdFx0c3VtbWFyeSArPSBwYXJhZ3JhcGggKyAnXFxuJzsgXG5cbiAgICAgICAgICBcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdtZC1zb3VyY2UnLCBtZFBhcmFncmFwaCk7IFxuICAgICAgICAgIFx0XHRibG9ja3MucHVzaChtZFBhcmFncmFwaClcbi8vY29uc29sZS5sb2cobWRQYXJhZ3JhcGgsICdcXG4tLS0tLVxcbicsIHBhcmFncmFwaClcbi8vY29uc29sZS5sb2coYWN0aXZlRmlsZS5wYXRoKVxuXG5cblxuLypjb25zdCBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikgLy8gdXNpbmcgYGNyZWF0ZUVsZW1lbnRgIGluc3RlYWQgb2YgYGNyZWF0ZUVsYCB0byBhdm9pZCBhcHBlbmRpbmcgdG8gdGhlIERPTVxuY29uc3QgY29tcCA9IG5ldyBDb21wb25lbnQoKVxuLy8gQHRzLWV4cGVjdC1lcnJvciBgb2JzaWRpYW5gIHBhY2thZ2Ugbm90IHlldCB1cGRhdGVkXG5hd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlcih0aGlzLmFwcCwgXCIhW1tleGFtcGxlLnBuZ11dXCIsIGVsLCBcIlwiLCBjb21wKVxuY29tcC5sb2FkKCkgLy8gbG9hZHMgZW1iZWRzXG5jb25zb2xlLmxvZyhlbC5jbG9uZU5vZGUodHJ1ZSkpIC8vIGRvIHNvbWV0aGluZyB3aXRoIGVsXG5jb21wLnVubG9hZCgpIC8vIHdoZW4gZG9uZSB3aXRoIGl0IHRvIHJlbGVhc2UgcmVzb3VyY2VzXG4qL1xuYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIodGhpcy5hcHAsIHBhcmFncmFwaCwgcGFyYWdyYXBoRWwsIFwiXCIsIHRlbXBDb21wb25lbnQpXG5cblxuICAgICAgICAgIFx0XHQvKmF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXG4gICAgICAgICAgXHRcdFx0cGFyYWdyYXBoLCBcbiAgICAgICAgICBcdFx0XHRwYXJhZ3JhcGhFbCwgXG4gICAgICAgICAgXHRcdFx0YWN0aXZlRmlsZS5wYXRoLFxuICAgICAgICAgIFx0XHRcdC8vZmlsZVBhdGgsIC8vJycsIFxuICAgICAgICAgIFx0XHRcdHRlbXBDb21wb25lbnRcbiAgICAgIFx0XHRcdCk7Ki9cblxuLy9jb25zb2xlLmxvZygnbWFya2Rvd24gcmVuZGVyIHN1bW1hcnknKVxuICAgICAgICAgIFx0XHRcbiAgICAgICAgICBcdFx0Y29uc3QgdGl0bGVFbCA9IGNyZWF0ZUVsKCdzcGFuJyk7XG4gICAgICAgICAgXHRcdHRpdGxlRWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWl0ZW0tdGl0bGUnKTtcblxuICAgICAgICAgIFx0XHQvLyBOb3QgZG9pbmcgdGhpcyB1bnRpbC93aGVuL2lmIHdlIGV2ZXIgY2xlYW4gdXAgYWxsIHRoZSBjb3B5VG8gbWV0aG9kc1xuICAgICAgICAgIFx0XHQvLyBhcyBkZXNjcmliZWQgaW4gdGhlIGdldFNlbGVjdGlvbiBtZXRob2QuXG5cdFx0XHRcdC8qdGl0bGVFbC5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUJsb2NrU2VsZWN0b3IoXG5cdFx0XHRcdFx0XHRwYXJzZUludCAocGFyYWdyYXBoRWwuZ2V0QXR0cmlidXRlKCdpbmRleCcpKVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KTsqL1xuXG4gICAgICAgICAgXHRcdHRpdGxlRWwuYXBwZW5kQ2hpbGQocGFyYWdyYXBoRWwucXVlcnlTZWxlY3Rvcignc3Ryb25nJykuY2xvbmVOb2RlKHRydWUpKVxuXHQvL2NvbnNvbGUubG9nKHBhcmFncmFwaEVsLm91dGVySFRNTClcbiAgICAgICAgICBcdFx0Ly9pZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnU3VtbWFyeUJsb2NrQnV0dG9ucykgXG4gICAgICAgICAgXHRcdFx0cGFyYWdyYXBoRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgICBcdFx0cGFyYWdyYXBoRWwucXVlcnlTZWxlY3Rvcignc3Ryb25nJykucmVwbGFjZVdpdGgodGl0bGVFbClcbiAgICAgICAgICBcdFx0Ly9wYXJhZ3JhcGhFbC5zZXRBdHRyaWJ1dGUoJ21kLXNvdXJjZScsIG1kUGFyYWdyYXBoKVxuXG4gICAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQocGFyYWdyYXBoRWwpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFxuXHRcdFxuXHRcdC8vIEFkZCBTdW1tYXJ5XG5cdFx0aWYgKHN1bW1hcnkgIT0gJycpIHtcblx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucykge1xuXHRcdFx0XHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZVN1bW1hcnlSZWZyZXNoQnV0dG9uKFxuXHRcdFx0XHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUNvcHlTdW1tYXJ5QnV0dG9uKFxuXHQgICAgICAgIFx0XHRcdFx0c3VtbWFyeVxuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZVN1bW1hcnlOb3RlQnV0dG9uKFxuXHQgICAgICAgIFx0XHRcdFx0dGhpcy5tYWtlU3VtbWFyeUJ0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0ICAgICAgICBcdFx0XHRcdHN1bW1hcnksIFxuXHQgICAgICAgIFx0XHRcdFx0dGFnc1xuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUJha2VCdXR0b24oXG5cdCAgICAgICAgXHRcdFx0XHR0aGlzLmJha2VTdW1tYXJ5QnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHQgICAgICAgIFx0XHRcdFx0c3VtbWFyeSwgXG5cdCAgICAgICAgXHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyLCBcblx0ICAgICAgICBcdFx0XHRcdGFjdGl2ZUZpbGUucGF0aFxuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblxuXHQgICAgICAgIFx0XHRzdW1tYXJ5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUVsKCdicicpKTsgXG5cdFx0XHRcdH0gXG5cdFx0XHRcdC8vc3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVFbCgnaHInKSk7IFxuXHRcdFx0fSwgMCk7XG5cdFx0XHRzdW1tYXJ5Q29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdFx0J2NvZGVibG9jay10YWdzJywgXG5cdFx0XHRcdHRhZ3Muam9pbignLCcpXG5cdFx0XHQpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJywgXG5cdFx0XHRcdCgoaW5jbHVkZS5sZW5ndGggPiAwKSA/IGluY2x1ZGUuam9pbignLCcpIDogJycpXG5cdFx0XHQpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stdGFncy1leGNsdWRlJywgXG5cdFx0XHRcdCgoZXhjbHVkZS5sZW5ndGggPiAwKSA/IGV4Y2x1ZGUuam9pbignLCcpIDogJycpXG5cdFx0XHQpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stc2VjdGlvbnMnLCBcblx0XHRcdFx0KChzZWN0aW9ucy5sZW5ndGggPiAwKSA/IHNlY3Rpb25zLmpvaW4oJywnKSA6ICcnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLW1heCcsIFxuXHRcdFx0XHRtYXhcblx0XHRcdCk7XG5cdFx0XHRzdW1tYXJ5Q29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdFx0J2NvZGVibG9jay1jb2RlJywgXG5cdFx0XHRcdG1kU291cmNlXG5cdFx0XHQpO1xuXG5cdFx0XHRlbGVtZW50LnJlcGxhY2VXaXRoKHN1bW1hcnlDb250YWluZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNyZWF0ZUVtcHR5KFxuXHRcdFx0XHRlbGVtZW50LCBcblx0XHRcdFx0dGFncyA/IHRhZ3MgOiBbXSwgXG5cdFx0XHRcdGluY2x1ZGUgPyBpbmNsdWRlIDogW10sIFxuXHRcdFx0XHRleGNsdWRlID8gZXhjbHVkZSA6IFtdLCBcblx0XHRcdFx0c2VjdGlvbnMgPyBzZWN0aW9ucyA6IFtdLCBcblx0XHRcdFx0bWF4ID8gbWF4IDogW10sIFxuXHRcdFx0XHQnJywgXG5cdFx0XHRcdG1kU291cmNlXG5cdFx0XHQpO1xuXHRcdH1cblx0fVxuXG5cdHVwZGF0ZSAoXG5cdFx0c3VtbWFyeUVsOkhUTUxFbGVtZW50XG5cdCk6IHZvaWQge1xuXHRcdFxuXHRcdGNvbnN0IHRhZ3NTdHIgPSBzdW1tYXJ5RWwuZ2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay10YWdzJ1xuXHRcdCk7XG5cdFx0Y29uc3QgdGFncyA9IHRhZ3NTdHIgPyB0YWdzU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdGNvbnN0IHRhZ3NJbmNsdWRlU3RyID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJ1xuXHRcdCk7XG5cdFx0Y29uc3QgdGFnc0luY2x1ZGUgPSB0YWdzSW5jbHVkZVN0ciA/IHRhZ3NJbmNsdWRlU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdGNvbnN0IHRhZ3NFeGNsdWRlU3RyID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncy1leGNsdWRlJ1xuXHRcdCk7XG5cdFx0Y29uc3QgdGFnc0V4Y2x1ZGUgPSB0YWdzRXhjbHVkZVN0ciA/IHRhZ3NFeGNsdWRlU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdGNvbnN0IHNlY3Rpb25zU3RyID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stc2VjdGlvbnMnXG5cdFx0XHQpO1xuXHRcdGNvbnN0IHNlY3Rpb25zID0gc2VjdGlvbnNTdHIgPyBzZWN0aW9uc1N0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCBtYXggPSBOdW1iZXIoc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stbWF4J1xuXHRcdCkpO1xuXG5cdFx0Y29uc3QgbWRTb3VyY2UgPSBzdW1tYXJ5RWwuZ2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1jb2RlJ1xuXHRcdCk7XG5cblx0XHR0aGlzLmNyZWF0ZShcblx0XHRcdHN1bW1hcnlFbCwgXG5cdFx0XHR0YWdzLCBcblx0XHRcdHRhZ3NJbmNsdWRlLCBcblx0XHRcdHRhZ3NFeGNsdWRlLCBcblx0XHRcdHNlY3Rpb25zLCBcblx0XHRcdG1heCwgXG5cdFx0XHQnJywgXG5cdFx0XHRtZFNvdXJjZSk7XG5cdH1cblxuXG5cdC8vIE5vdCBmYWN0b3JlZCB5ZXRcblx0YXN5bmMgY29weVRleHRUb1NlY3Rpb24oXG5cdCAgICB0ZXh0OiBzdHJpbmcsIFxuXHQgICAgc2VjdGlvbjogc3RyaW5nLCBcblx0ICAgIGZpbGVQYXRoOiBzdHJpbmcsXG5cdCAgICBhZGRMaW5rOiBCb29sZWFuID0gdHJ1ZSxcblx0ICAgIHNlbGVjdGVkRmlsZTogVEZpbGUsXG5cdCAgICBkZXRlY3RQcmVmaXg6IEJvb2xlYW4gPSB0cnVlKVxuXHQ6UHJvbWlzZTxib29sZWFuPntcblxuXHQgICAgY29uc3QgZmlsZSA9IHNlbGVjdGVkRmlsZSA/IHNlbGVjdGVkRmlsZSA6IChhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpKTtcblx0ICAgIGxldCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdCAgICBjb25zdCBmaWxlQ29udGVudExpbmVzOiBzdHJpbmdbXSA9IFV0aWxzLmdldExpbmVzSW5TdHJpbmcoZmlsZUNvbnRlbnQpO1xuXHQgICAgY29uc3QgbWRIZWFkaW5ncyA9IFV0aWxzLmdldE1hcmtkb3duSGVhZGluZ3MoZmlsZUNvbnRlbnRMaW5lcyk7XG5cdCAgICBsZXQgdGFyZ2V0TGluZTtcblxuXHQgICAgLy9pZiAobWRIZWFkaW5ncy5sZW5ndGggPD0gMCB8fCBzZWN0aW9uID09ICdlbmQnIHx8IHNlY3Rpb24gPT0gJ3RvcCcgfHwgc2VjdGlvbiA9PSAnbm90ZScgfHwgc2VjdGlvbiA9PSAnbmV3Tm90ZScpIHtcbiAgICBcdGlmIChtZEhlYWRpbmdzLmxlbmd0aCA8PSAwIHx8IHNlY3Rpb24gPT0gJ2VuZCcgfHwgc2VjdGlvbiA9PSAndG9wJykge1xuXG5cdCAgICBcdGlmIChzZWN0aW9uID09ICd0b3AnKSB7XHQgICAgXHRcblx0XHQgICAgXHR0YXJnZXRMaW5lID0gVXRpbHMuZmluZEZpcnN0TGluZUFmdGVyRnJvbnRNYXR0ZXIoZmlsZUNvbnRlbnQpXG5cdFx0ICAgIFx0aWYgKHRhcmdldExpbmUgPT0gMCkgZmlsZUNvbnRlbnQgPSAnXFxuJyArIGZpbGVDb250ZW50XG5cdFx0XHRcdC8vY29uc29sZS5sb2codGFyZ2V0TGluZSlcbiAgICBcdFx0Lyp9IGVsc2UgaWYgKHNlY3Rpb24gPT0gJ25ld05vdGUnKSB7XG5cdFx0ICAgIFx0dGhpcy5tYWtlU3VtbWFyeUJ0bkhhbmRsZXIgKHRleHQsIFtdLCB0cnVlLCB0cnVlKTtcblx0XHQgICAgXHRyZXR1cm4gdHJ1ZTtcblx0XHQgICAgXHQqL1xuXHRcdCAgICAvL30gZWxzZSBpZiAoc2VjdGlvbiA9PSAnZW5kJyB8fCBtZEhlYWRpbmdzLmxlbmd0aCA8PSAwIHx8IHNlY3Rpb24gPT0gJ25vdGUnKSB7XG5cdCAgICBcdH0gZWxzZSBpZiAoc2VjdGlvbiA9PSAnZW5kJykge1xuXHRcdCAgICBcdHRhcmdldExpbmUgPSBmaWxlQ29udGVudExpbmVzLmxlbmd0aCAtIDE7XG5cdFx0ICAgIC8vfSBlbHNlIGlmIChtZEhlYWRpbmdzLmxlbmd0aCA8PSAwKSB7XG5cdFx0ICAgIH1cblx0ICAgIH0gZWxzZSBpZiAobWRIZWFkaW5ncy5sZW5ndGggPiAwKSB7IC8vIGlmIHRoZXJlIGFyZSBhbnkgaGVhZGluZ3Ncblx0ICAgICAgICBjb25zdCBoZWFkaW5nT2JqID0gbWRIZWFkaW5ncy5maW5kKGhlYWRpbmcgPT4gaGVhZGluZy50ZXh0LnRyaW0oKSA9PT0gc2VjdGlvbik7XG5cdCAgICAgICAgaWYgKGhlYWRpbmdPYmopIHtcblx0ICAgICAgICBcdHRhcmdldExpbmUgPSBoZWFkaW5nT2JqLmxpbmU7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgbmV3IE5vdGljZSAoYCR7c2VjdGlvbn0gbm90IGZvdW5kLmApO1xuXHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBjb25zdCBsaW5lUHJlZml4OiBTdHJpbmcgPSBkZXRlY3RQcmVmaXggPyBVdGlscy5nZXRMaXN0VHlwZUZyb21MaW5lTnVtYmVyKGZpbGVDb250ZW50LCB0YXJnZXRMaW5lKzEpIDogJyc7XG4gICAgICAgIGxldCBmaW5hbFRleHQ7XG4gICAgICAgIGlmIChhZGRMaW5rKSBmaW5hbFRleHQgPSBsaW5lUHJlZml4ICsgdGV4dCArIGAgW1ske2ZpbGVQYXRofXxcdUQ4M0RcdUREMTddXWA7XG4gICAgICAgIGVsc2UgZmluYWxUZXh0ID0gbGluZVByZWZpeCArIHRleHQ7XG4gICAgICAgIC8vbGV0IG5ld0NvbnRlbnQgPSB0aGlzLmluc2VydFRleHRBZnRlckxpbmUodGV4dCwgZmlsZUNvbnRlbnQsIGhlYWRpbmdPYmoubGluZSk7XG4gICAgICAgIGxldCBuZXdDb250ZW50ID0gVXRpbHMuaW5zZXJ0VGV4dEFmdGVyTGluZShmaW5hbFRleHQsIGZpbGVDb250ZW50LCB0YXJnZXRMaW5lKTtcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuICAgICAgICByZXR1cm4gdHJ1ZTtcblx0fVxuXG5cdGFzeW5jIHJlYWRGaWxlcyhcblx0XHRsaXN0RmlsZXM6IFRGaWxlW11cblx0KTogUHJvbWlzZTxbVEZpbGUsIHN0cmluZ11bXT4ge1xuXHRcdFxuXHRcdGxldCBsaXN0OiBbVEZpbGUsIHN0cmluZ11bXSA9IFtdO1xuXHRcdGZvciAobGV0IHQgPSAwOyB0IDwgbGlzdEZpbGVzLmxlbmd0aDsgdCArPSAxKSB7XG5cdFx0XHRjb25zdCBmaWxlID0gbGlzdEZpbGVzW3RdO1xuXHRcdFx0bGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuXHRcdFx0bGlzdC5wdXNoKFtmaWxlLCBjb250ZW50XSk7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIGxpc3Q7XG5cdH1cblxuXHRpc1ZhbGlkVGV4dChcblx0ICAgIGxpc3RUYWdzOiBzdHJpbmdbXSwgXG5cdCAgICB0YWdzOiBzdHJpbmdbXSwgXG5cdCAgICBpbmNsdWRlOiBzdHJpbmdbXSwgXG5cdCAgICBleGNsdWRlOiBzdHJpbmdbXVxuXHQpOiBib29sZWFuIHtcblxuXHQgICAgbGV0IHZhbGlkID0gdHJ1ZTtcblxuXHQgICAgLy8gQ2hlY2sgT1IgKHRhZ3MpXG5cdCAgICBpZiAodGFncy5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgdmFsaWQgPSB2YWxpZCAmJiB0YWdzLnNvbWUoKHZhbHVlKSA9PiBsaXN0VGFncy5pbmNsdWRlcyh2YWx1ZSkpO1xuXHQgICAgfVxuXHQgICAgLy8gQ2hlY2sgQU5EIChpbmNsdWRlKVxuXHQgICAgaWYgKGluY2x1ZGUubGVuZ3RoID4gMCkge1xuXHQgICAgICAgIHZhbGlkID0gdmFsaWQgJiYgaW5jbHVkZS5ldmVyeSgodmFsdWUpID0+IGxpc3RUYWdzLmluY2x1ZGVzKHZhbHVlKSk7XG5cdCAgICB9XG5cdCAgICAvLyBDaGVjayBOT1QgKGV4Y2x1ZGUpXG5cdCAgICBpZiAodmFsaWQgJiYgZXhjbHVkZS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgdmFsaWQgPSAhZXhjbHVkZS5zb21lKCh2YWx1ZSkgPT4gbGlzdFRhZ3MuaW5jbHVkZXModmFsdWUpKTtcblx0ICAgIH1cblx0ICAgIHJldHVybiB2YWxpZDsgICAgICAgXG5cdH1cblxuXHRzdGF0aWMgZ2V0VGFnc1RvQ2hlY2tGcm9tRWwgKFxuXHRcdHRhZ1N1bW1hcnlFbDogSFRNTEVsZW1lbnRcblx0KTogQXJyYXkge1xuXHRcdGNvbnN0IHRhZ3NTdHIgPSB0YWdTdW1tYXJ5RWwuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncycpO1xuXHRcdGNvbnN0IHRhZ3MgPSB0YWdzU3RyID8gdGFnc1N0ci5zcGxpdCgnLCcpIDogW107XG5cdFx0Y29uc3QgdGFnc0luY2x1ZGVTdHIgPSB0YWdTdW1tYXJ5RWwuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJyk7XG5cdFx0Y29uc3QgdGFnc0luY2x1ZGUgPSB0YWdzSW5jbHVkZVN0ciA/IHRhZ3NJbmNsdWRlU3RyLnNwbGl0KCcsJykgOiBbXTtcblx0XHRyZXR1cm4gdGFncy5jb25jYXQodGFnc0luY2x1ZGUpO1xuXHR9XG5cblx0YXN5bmMgZ2V0RmlsZSAoXG5cdFx0ZWw6IEhUTUxFbGVtZW50XG5cdCk6VEZpbGUge1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gZWwuZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpOyBcblx0XHRjb25zdCBmaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblx0XHRyZXR1cm4gZmlsZTtcblx0fVxuXG5cdHVwZGF0ZVNlbGVjdGlvbiAoXG5cdFx0aW5kZXg6IE51bWJlciwgXG5cdFx0Ym9vbDogQm9vbGVhblxuXHQpOiB2b2lkIHtcblxuXHRcdC8vIElmIGlzU2VsZWN0ZWQgaXMgdHJ1ZSwgYWRkIHRoZSBpbmRleCBpZiBpdCdzIG5vdCBhbHJlYWR5IGluIHRoZSBhcnJheVxuXHRcdGlmIChib29sKSB7XG5cdFx0ICAgIGlmICghdGhpcy5zZWxlY3RlZEJsb2Nrcy5pbmNsdWRlcyhpbmRleCkpIHtcblx0XHQgICAgICAgIHRoaXMuc2VsZWN0ZWRCbG9ja3MucHVzaChpbmRleCk7XG5cdFx0ICAgIH1cblx0XHR9IGVsc2Uge1xuXHRcdCAgICAvLyBJZiBpc1NlbGVjdGVkIGlzIGZhbHNlLCByZW1vdmUgdGhlIGluZGV4IGZyb20gdGhlIGFycmF5XG5cdFx0ICAgIHRoaXMuc2VsZWN0ZWRCbG9ja3MgPSB0aGlzLnNlbGVjdGVkQmxvY2tzLmZpbHRlcihpdGVtSW5kZXggPT4gaXRlbUluZGV4ICE9PSBpbmRleCk7XG5cdFx0fVxuXG4vL2NvbnNvbGUubG9nKHRoaXMuc2VsZWN0ZWRCbG9ja3MpXG5cblx0fVxuXG5cblx0Z2V0U2VsZWN0ZWRNYXJrZG93bkJsb2NrcyAoKTogU3RyaW5nW10ge1xuXHRcdFxuXHRcdC8vIFRoaXMgaXMgdG9vIG1lc3N5IHdpdGggY3VycmVudCBpbXBsbWVudGF0aW9uLlxuXHRcdC8vIFRvIG1ha2UgdGhpcyB3b3JrLCB3ZSBuZWVkIHRvIGJyZWFrIG91dCBhbGwgdGhlIGNvcHlUbywgZ2V0UHJlZml4LCBhZGRMaW5rLCBldGMgbWV0aG9kcy9wcm9wc1xuXHRcdC8vIHdlIG5lZWQgdG8gYmUgYnVpbGRpbmcgdGhlIGNvbnRlbnQgYXMgd2Ugc2VsZWN0LlxuXG5cdFx0Ly8gbW92ZTogSSBkb24ndCB0aGluayB3ZSBjYW4gcmVtb3ZlIGluIGJ1bGs/IG1heWJlIGp1c3QgZG8gaXQgd2l0aG91dCBtb3Rpb24uXG5cdFx0Ly8gYmFrZSBzaG91bGQgYmUgZWFzeVxuXHRcdC8vIGNvcHksIGVhc3lcblx0XHQvLyBuZXcgbm90ZVxuXHRcdC8vIGNvcHkgdG86IGVhc3ksIGJ1dCBuZWVkIHRvIGFkZCB0aGUgYnVsbGV0IHRvIGVhY2hcblx0XHQvLyBpIGd1ZXNzIGxpbmsgaXMgdGhlIHNhbWUgZWFzeVxuXHR9XG5cbn1cblxuY2xhc3MgVGVtcENvbXBvbmVudCBleHRlbmRzIENvbXBvbmVudCB7XG5cdGRvTm90UG9zdFByb2Nlc3MgPSB0cnVlO1xuXHRvbmxvYWQoKSB7fVxuXHRvbnVubG9hZCgpIHt9XG59IiwgImltcG9ydCB7IEFwcCwgTWFya2Rvd25SZW5kZXJlciwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBkZWJvdW5jZSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgQ29tcG9uZW50LCBURmlsZSwgZ2V0QWxsVGFncywgTWFya2Rvd25QcmV2aWV3VmlldywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cbmV4cG9ydCBjbGFzcyBUYWdQcm9jZXNzb3Ige1xuXHRhcHA6IEFwcDsgXG5cdHBsdWdpbjogVGFnQnVkZHk7XG5cdHByaXZhdGUgb3V0T2ZTeW5jOiBib29sZWFuID0gZmFsc2U7XG5cdGRlYm91bmNlZFByb2Nlc3NBY3RpdmVGaWxlVGFnRWxzOiBGdW5jdGlvbjtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRhcHA6IEFwcCwgXG5cdFx0cGx1Z2luOiBUYWdCdWRkeVxuXHQpIHtcblxuXHRcdHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXG5cdFx0dGhpcy5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscyA9IGRlYm91bmNlKHRoaXMucHJvY2Vzc0FjdGl2ZUZpbGVUYWdzLmJpbmQodGhpcyksIDUwMClcblxuXHRcdHRoaXMuZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHMoKTtcblxuXHR9XG5cblx0cmVzZXQoKSB7XG4vL2NvbnNvbGUubG9nKCd0YWcgcHJvY2Vzc29yIHJlc2V0Jyk7XG5cdFx0dGhpcy5vdXRPZlN5bmMgPSBmYWxzZTtcblx0fVxuXG5cdGZpbHRlckFjdGl2ZUZpbGVUYWdFbHMgKFxuXHRcdHRhZ3M6IEhUTUxFbGVtZW50W11cblx0KTogQXJyYXkge1x0XHRcbi8vY29uc29sZS5sb2codGFncy5sZW5ndGgpXG5cdFx0Y29uc3QgZmlsdGVyZWRUYWdFbGVtZW50cyA9IEFycmF5LmZyb20odGFncykuZmlsdGVyKHRhZyA9PiB7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC5mcm9udG1hdHRlci1zZWN0aW9uLWRhdGFcblx0XHQgICAgLy8gVGhpcyBpcyBhIGJ1ZyBvbiBtb2JpbGUuIE1vYmlsZSBpbmNsdWRlcyB0aGUgeWFtbCB0YWdzIGluIHJlbmRlcmVkIGh0bWxcblx0XHQgICAgaWYgKHRhZy5jbG9zZXN0KCcuZnJvbnRtYXR0ZXItc2VjdGlvbi1kYXRhJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLm1hcmtkb3duLWVtYmVkXG5cdFx0ICAgIGlmICh0YWcucGFyZW50RWxlbWVudC5jbG9zZXN0KCcubWFya2Rvd24tZW1iZWQnKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAubWFya2Rvd24tZW1iZWRcblx0XHQgICAgaWYgKHRhZy5jbG9zZXN0KCcubWFya2Rvd24tZW1iZWQnKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAubWFya2Rvd24tZW1iZWRcblx0XHQgICAgLy9pZiAodGFnLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmludGVybmFsLWVtYmVkJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLm1hcmtkb3duLWVtYmVkXG5cdFx0ICAgIC8vaWYgKHRhZy5jbG9zZXN0KCcuaW50ZXJuYWwtZW1iZWQnKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAudGFnLXN1bW1hcnktYmxvY2tcblx0XHQgICAgaWYgKHRhZy5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy50YWctc3VtbWFyeS1ibG9jaycpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgcmV0dXJuIHRydWU7XG5cdFx0fSk7XG5cbi8vY29uc29sZS5sb2coZmlsdGVyZWRUYWdFbGVtZW50cy5sZW5ndGgpXG5cdFx0cmV0dXJuIGZpbHRlcmVkVGFnRWxlbWVudHM7XG5cdH1cblxuXHRhc3luYyByZW5kZXJQb3N0UHJvY2Vzc29yIChcblx0XHRlbDogSFRNTEVsZW1lbnQsIFxuXHRcdGN0eDogTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dFxuXHQpOiB2b2lkIHtcdFxuXHRcdGNvbnN0IHByb2Nlc3NpbmdGaWxlOiBURmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChjdHguc291cmNlUGF0aCk7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZTogVEZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGVQYXRoOiBzdHJpbmcgPSBhY3RpdmVGaWxlPy5wYXRoO1xuXHRcdFxuXHRcdGNvbnN0IG5hdGl2ZUVtYmVkRWw6IEhUTUxFbGVtZW50ID0gZWwucXVlcnlTZWxlY3RvcignLmludGVybmFsLWVtYmVkJyk7XG5cdFx0Y29uc3QgdGFnczogSFRNTEVsZW1lbnRbXSA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKTtcblxuXHRcdGlmICgobmF0aXZlRW1iZWRFbCAmJiBjdHguc291cmNlUGF0aCA9PSBhY3RpdmVGaWxlUGF0aCkgLy8gZW1iZWRzXG5cdFx0XHR8fCAoY3R4LnNvdXJjZVBhdGggPT0gYWN0aXZlRmlsZVBhdGggJiYgdGFncy5sZW5ndGggPiAwKSAvLyBhY3RpdmUgZmlsZSB0YWdzXG5cdFx0XHR8fCBlbC5jbGFzc0xpc3QuY29udGFpbnMoJ3RhZy1zdW1tYXJ5LXBhcmFncmFwaCcpIC8vIHN1bW1hcnkgdGFnc1xuXHRcdCkge1xuXHRcdFx0Ly9pZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiByZW5kZXJQb3N0UHJvY2Vzc29yJyk7IFxuXHRcdH1cblx0XHRlbHNlIHsgcmV0dXJuOyB9XG5cdFxuXHRcdGlmIChuYXRpdmVFbWJlZEVsKSB7XG5cdFx0XHQvL3RoaXMubmF0aXZlRW1iZWRzLnB1c2gobmF0aXZlRW1iZWRFbCk7XG5cdFx0XHRsZXQgbmF0aXZlRW1iZWRPYnNlcnZlcjogTXV0YXRpb25PYnNlcnZlcjtcblx0XHRcdG5hdGl2ZUVtYmVkT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zTGlzdCkgPT4ge1x0XHRcdFxuXHRcdFx0XHRjb25zdCB0YXJnZXQ6IEhUTUxFbGVtZW50ID0gbXV0YXRpb25zTGlzdFswXS50YXJnZXQ7XG5cdFx0XHRcdGlmICh0YXJnZXQucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRuYXRpdmVFbWJlZE9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHRcdFx0XHR0aGlzLnByb2Nlc3NOYXRpdmVFbWJlZCh0YXJnZXQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdG5hdGl2ZUVtYmVkT2JzZXJ2ZXIub2JzZXJ2ZShuYXRpdmVFbWJlZEVsLCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcblx0XHR9XG5cdFxuXHRcdGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoJ3RhZy1zdW1tYXJ5LXBhcmFncmFwaCcpKSB7XG5cdFx0XHR0aGlzLnByb2Nlc3NUYWdTdW1tYXJ5UGFyYWdyYXBoKGVsKTtcblx0XHRcdHJldHVybjsgXG5cdFx0fSBcblxuXHRcdHRoaXMuZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHMoKTtcdFxuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc0FjdGl2ZUZpbGVUYWdzIChcblx0XHQvL3RhZ3M6IEhUTUxFbGVtZW50W10sXG5cdCk6IHZvaWQge1x0XHRcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBwcm9jZXNzaW5nIGFjdGl2ZSBmaWxlIHRhZ3MnKVx0XHRcblxuXHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFx0Ly9jb25zdCBwcmVWaWV3ID0gYXdhaXQgdmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubWFya2Rvd24tcmVhZGluZy12aWV3Jyk7XG5cdFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcblx0XHRcdGNvbnN0IHNlY3Rpb25zID0gdmlldy5jdXJyZW50TW9kZS5yZW5kZXJlci5zZWN0aW9ucztcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGVUYWdFbHMgPSBbXTtcblxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZVRhZ3MgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhcblx0XHRcdFx0YWN0aXZlRmlsZSwgXG5cdFx0XHRcdGZpbGVDb250ZW50XG5cdFx0XHQpO1xuXG5cdFx0XHRzZWN0aW9ucy5mb3JFYWNoKHNlY3Rpb24gPT4ge1xuXHRcdFx0XHRBcnJheS5mcm9tKHNlY3Rpb24uZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpKS5mb3JFYWNoKHRhZyA9PiB7XG5cdFx0XHRcdFx0YWN0aXZlRmlsZVRhZ0Vscy5wdXNoKHRhZyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEZpbHRlciB0YWdzIFxuXHRcdFx0Y29uc3QgZmlsdGVyZWRUYWdFbGVtZW50cyA9IHRoaXMuZmlsdGVyQWN0aXZlRmlsZVRhZ0VscyhhY3RpdmVGaWxlVGFnRWxzKTtcblx0XHRcdFxuXHRcdFx0aWYgKGZpbHRlcmVkVGFnRWxlbWVudHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHR0aGlzLmFzc2lnbk1hcmtkb3duVGFncyhcblx0XHRcdFx0XHRhY3RpdmVGaWxlVGFncywgXG5cdFx0XHRcdFx0ZmlsdGVyZWRUYWdFbGVtZW50cywgIFxuXHRcdFx0XHRcdDAsIC8vc3RhcnRJbmRleCxcblx0XHRcdFx0XHQnYWN0aXZlJ1xuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIHByb2Nlc3NUYWdTdW1tYXJ5UGFyYWdyYXBoIChcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsXG5cdCk6dm9pZCB7XG5cdFx0Ly9pZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBwcm9jZXNzVGFnU3VtbWFyeVBhcmFncmFwaCcpXG5cblx0XHRjb25zdCBmaWxlUGF0aCA9IHBhcmFncmFwaEVsLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKTtcblx0XHRjb25zdCBtYXJrZG93bkJsb2NrID0gcGFyYWdyYXBoRWwuZ2V0QXR0cmlidXRlKCdtZC1zb3VyY2UnKS50cmltKCk7XG5cdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdGNvbnN0IHN0YXJ0SW5kZXggPSBmaWxlQ29udGVudC5pbmRleE9mKG1hcmtkb3duQmxvY2spO1xuXHRcdGNvbnN0IG1kVGFncyA9IHRoaXMuZ2V0TWFya2Rvd25UYWdzKFxuXHRcdFx0ZmlsZSwgXG5cdFx0XHRmaWxlQ29udGVudFxuXHRcdCk7XG5cdFx0dGhpcy5hc3NpZ25NYXJrZG93blRhZ3MoXG5cdFx0XHRtZFRhZ3MsIFxuXHRcdFx0cGFyYWdyYXBoRWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpLCBcblx0XHRcdHN0YXJ0SW5kZXgsIFxuXHRcdFx0J3BsdWdpbi1zdW1tYXJ5J1xuXHRcdCk7XG5cdH1cblxuXG4vKlxuXHQvLyBhZGFwdCB0aGlzIG1ldGhvZCB0byB1c2UgdGhlIGNhY2hlIHRhZyBpbmZvIChsaW5lLCBvZmZzZXQsIGV0Yylcblx0Z2V0TWFya2Rvd25UYWdzIChcblx0XHRmaWxlOiBURmlsZSwgIFxuXHRcdGZpbGVDb250ZW50OiBzdHJpbmcgXG5cdCk6IEFycmF5IHtcblxuXHRcdGNvbnN0IHRhZ1Bvc2l0aW9ucyA9IFtdO1xuXHRcdGxldCBtYXRjaDtcblx0XHQvLyBPYnNpZGlhbiB0YWcgc3BlYzogaHR0cHM6Ly9oZWxwLm9ic2lkaWFuLm1kL0VkaXRpbmcrYW5kK2Zvcm1hdHRpbmcvVGFncyNUYWcrZm9ybWF0XG5cdFx0Ly9jb25zdCByZWdleCA9IC8oPzpefFxccykjW15cXHMjXSt8YGBgL2c7IC8vIEJVRzogd3JvbmcgbWF0Y2guaW5kZXguIG1hdGNoZXMgdGhlIHNwYWNlIGJlZm9yZSB0aGUgdGFnLlxuXHRcdC8vY29uc3QgcmVnZXggPSAvKD88PV58XFxzKSNbXlxccyNdK3xgYGAvZyAvLyBGSVguIEJ1dCBzdGlsbCBtYXRjaGluZyBwdW5jdHVhdGlvbiBhZnRlclxuXHRcdC8vY29uc3QgcmVnZXggPSAvKD88PV58XFxzKSgjW15cXHMjLiw7IT86XSspKD89Wy4sOyE/Olxcc118JCl8YGBgL2cgIC8vIG1hdGNoZXMgcHVuY3R1YXRpb24gYWZ0ZXIsIGJ1dCBub3QgaW5jbHVkZWQgaW4gdGhlIG1hdGNoXG5cdFx0Ly9jb25zdCByZWdleCA9IC8oPzw9XnxcXHMpKCNbXlxccyMuLDshPzpdKykoPz1bLiw7IT86XFxzXXwkKXwoPzwhYClgYGAoPyFgKS9nOyAvLyBGaXggZm9yIG1hdGNoaW5nIGBgYGAgXG5cdFx0Ly9jb25zdCByZWdleCA9IC8oPzw9XnxcXHMpKCNbXlxccyMuJyw7IT86XSspKD89Wy4sOyE/OidcXHNdfCQpfCg/PCFgKWBgYCg/IWApL2c7IC8vIEZpeCBmb3IgbWF0Y2hpbmcgYnV0IGV4Y2x1ZGluZyAnJ3MnIGluICcjdGFnJ3MnXG5cdFx0Y29uc3QgcmVnZXggPSAvKD88PV58XFxzKSgjKD89W15cXHMjLidcdTIwMTksOyE/Ol0qW15cXGRcXHMjLidcdTIwMTksOyE/Ol0pW15cXHMjLidcdTIwMTksOyE/Ol0rKSg/PVsuLDshPzonXHUyMDE5XFxzXXwkKXwoPzwhYClgYGAoPyFgKS9nOyAvLyBmaXggZm9yIG51bWJlci1vbmx5IGFuZCB0eXBvZ3JhcGhpYyBhcG9zdHJvcGh5J3NcblxuXG5cblx0XHRsZXQgaW5zaWRlQ29kZUJsb2NrID0gZmFsc2U7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhmaWxlQ29udGVudCkpICE9PSBudWxsKSB7XG5cdFx0ICAgIGlmIChtYXRjaFswXS50cmltKCkgPT09IFwiYGBgXCIpIHtcblx0XHQgICAgICAgIGluc2lkZUNvZGVCbG9jayA9ICFpbnNpZGVDb2RlQmxvY2s7IFxuXHRcdCAgICAgICAgY29udGludWU7IC8vIFJlamVjdCBpZiB0YWcgaW4gYSBjb2RlIGJsb2NrXG5cdFx0ICAgIH1cdCAgICBcblx0XHQgICAgaWYgKGluc2lkZUNvZGVCbG9jaykgY29udGludWU7XG5cdFx0ICAgIGNvbnN0IHRhZyA9IG1hdGNoWzBdLnRyaW0oKTtcblx0XHQgICAgdGFnUG9zaXRpb25zLnB1c2goe3RhZzp0YWcsIGluZGV4Om1hdGNoLmluZGV4LCBzb3VyY2U6ZmlsZS5uYW1lfSk7IFxuLy9jb25zb2xlLmxvZyh0YWcpXG5cdFx0fVxuXHRcdHJldHVybiB0YWdQb3NpdGlvbnM7XG5cdH1cbiovXG5cblxuZ2V0TWFya2Rvd25UYWdzKFxuICAgIGZpbGU6IFRGaWxlLFxuICAgIGZpbGVDb250ZW50OiBzdHJpbmdcbik6IEFycmF5IHtcbiAgICBjb25zdCB0YWdQb3NpdGlvbnMgPSBbXTtcbiAgICBjb25zdCBwcm9jZXNzZWRQb3NpdGlvbnMgPSBuZXcgU2V0KCk7IC8vIFRyYWNrIHBvc2l0aW9ucyB0byBwcmV2ZW50IGR1cGxpY2F0ZSBwcm9jZXNzaW5nXG4gICAgbGV0IG1hdGNoO1xuICAgIGNvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykoIyg/PVteXFxzIy4nXHUyMDE5LDshPzpdKlteXFxkXFxzIy4nXHUyMDE5LDshPzpdKVteXFxzIy4nXHUyMDE5LDshPzpdKykoPz1bLiw7IT86J1x1MjAxOVxcc118JCl8KD88IWApYGBgKD8hYCkvZzsgLy8gT3JpZ2luYWwgcmVnZXhcblxuICAgIC8vIENvbnRleHQgdHJhY2tpbmdcbiAgICBsZXQgY3VycmVudENvbnRleHQgPSBcIm5vcm1hbFwiO1xuICAgIGxldCBpbnNpZGVDb2RlQmxvY2sgPSBmYWxzZTsgLy8gVHJhY2sgaWYgd2UgYXJlIGluc2lkZSBhIGNvZGUgYmxvY2tcbiAgICBsZXQgaW52YWxpZEJsb2NrcXVvdGUgPSBmYWxzZTsgLy8gVHJhY2sgaWYgYSBibG9ja3F1b3RlIGhhcyBiZWVuIGludmFsaWRhdGVkXG5cbiAgICAvLyBNYXRjaCBhbGwgdGFncyBhbmQgc3BlY2lhbCBjb250ZXh0cyBpbiBvbmUgcGFzc1xuICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGZpbGVDb250ZW50KSkgIT09IG51bGwpIHtcbiAgICAgICAgY29uc3QgbWF0Y2hlZFN0cmluZyA9IG1hdGNoWzBdLnRyaW0oKTtcbiAgICAgICAgY29uc3QgbWF0Y2hJbmRleCA9IG1hdGNoLmluZGV4O1xuXG4gICAgICAgIC8vIFNraXAgaWYgdGhpcyBwb3NpdGlvbiBoYXMgYWxyZWFkeSBiZWVuIHByb2Nlc3NlZFxuICAgICAgICBpZiAocHJvY2Vzc2VkUG9zaXRpb25zLmhhcyhtYXRjaEluZGV4KSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coYFNraXBwaW5nIGR1cGxpY2F0ZSB0YWcgYXQgcG9zaXRpb24gJHttYXRjaEluZGV4fTogJHttYXRjaGVkU3RyaW5nfWApO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUb2dnbGUgY29kZSBibG9jayBzdGF0ZSB3aGVuIGVuY291bnRlcmluZyBhIGZlbmNlXG4gICAgICAgIGlmIChtYXRjaGVkU3RyaW5nID09PSBcImBgYFwiKSB7XG4gICAgICAgICAgICBpbnNpZGVDb2RlQmxvY2sgPSAhaW5zaWRlQ29kZUJsb2NrO1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coYFRvZ2dsZWQgaW5zaWRlQ29kZUJsb2NrIHRvICR7aW5zaWRlQ29kZUJsb2NrfWApO1xuICAgICAgICAgICAgY29udGludWU7IC8vIFNraXAgcHJvY2Vzc2luZyB0aGUgZmVuY2UgbGluZSBpdHNlbGZcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNraXAgcHJvY2Vzc2luZyBpZiBpbnNpZGUgYSBjb2RlIGJsb2NrXG4gICAgICAgIGlmIChpbnNpZGVDb2RlQmxvY2spIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBTa2lwcGluZyB0YWcgJHttYXRjaGVkU3RyaW5nfSBpbnNpZGUgY29kZSBibG9jay5gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjb250ZXh0IG9mIHRoZSBjdXJyZW50IGxpbmVcbiAgICAgICAgY29uc3QgbGluZVN0YXJ0ID0gZmlsZUNvbnRlbnQubGFzdEluZGV4T2YoXCJcXG5cIiwgbWF0Y2hJbmRleCkgKyAxOyAvLyBHZXQgc3RhcnQgb2YgdGhlIGxpbmVcbiAgICAgICAgY29uc3QgbGluZUVuZCA9IGZpbGVDb250ZW50LmluZGV4T2YoXCJcXG5cIiwgbWF0Y2hJbmRleCk7IC8vIEdldCBlbmQgb2YgdGhlIGxpbmVcbiAgICAgICAgY29uc3QgbGluZSA9IGZpbGVDb250ZW50LnNsaWNlKGxpbmVTdGFydCwgbGluZUVuZCAhPT0gLTEgPyBsaW5lRW5kIDogdW5kZWZpbmVkKTtcblxuICAgICAgICBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aChcIj5cIikpIHtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0ID0gXCJibG9ja3F1b3RlXCI7XG5cbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBpbnZhbGlkIGJsb2NrcXVvdGUgY29uZGl0aW9uIChlLmcuLCB0YWIgYWZ0ZXIgYD5gKVxuICAgICAgICAgICAgaWYgKGxpbmUuc3RhcnRzV2l0aChcIj4gXFx0XCIpIHx8IGxpbmUuc3RhcnRzV2l0aChcIj5cXHRcIikgfHwgbGluZS5pbmNsdWRlcyhcIihub3QgYSB0YWcpXCIpKSB7XG4gICAgICAgICAgICAgICAgaW52YWxpZEJsb2NrcXVvdGUgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBJbnZhbGlkIGJsb2NrcXVvdGUgdHJpZ2dlcmVkIGF0IGxpbmU6ICR7ZmlsZUNvbnRlbnQuc3Vic3RyaW5nKDAsIG1hdGNoSW5kZXgpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aH1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnRyaW0oKS5zdGFydHNXaXRoKFwiLVwiKSB8fCBsaW5lLnRyaW0oKS5tYXRjaCgvXlxcZCtcXC4vKSkge1xuICAgICAgICAgICAgY3VycmVudENvbnRleHQgPSBcImxpc3RcIjtcbiAgICAgICAgICAgIGludmFsaWRCbG9ja3F1b3RlID0gZmFsc2U7IC8vIFJlc2V0IGludmFsaWQgYmxvY2txdW90ZSBzdGF0ZVxuICAgICAgICB9IGVsc2UgaWYgKGxpbmUuc3RhcnRzV2l0aChcIlxcdFwiKSkge1xuICAgICAgICAgICAgY3VycmVudENvbnRleHQgPSBcImluZGVudGVkXCI7IC8vIENvcnJlY3RseSBtYXJrIHRhYi1pbmRlbnRlZCBsaW5lc1xuICAgICAgICAgICAgaW52YWxpZEJsb2NrcXVvdGUgPSBmYWxzZTsgLy8gUmVzZXQgaW52YWxpZCBibG9ja3F1b3RlIHN0YXRlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjdXJyZW50Q29udGV4dCA9IFwibm9ybWFsXCI7XG4gICAgICAgICAgICBpbnZhbGlkQmxvY2txdW90ZSA9IGZhbHNlOyAvLyBSZXNldCBpbnZhbGlkIGJsb2NrcXVvdGUgc3RhdGVcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlYnVnIGxvZ2dpbmcgZm9yIGNvbnRleHRcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coYExpbmUgJHtmaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgbWF0Y2hJbmRleCkuc3BsaXQoXCJcXG5cIikubGVuZ3RofTogJHtjdXJyZW50Q29udGV4dH0gLSAke2xpbmUudHJpbSgpfWApO1xuXG4gICAgICAgIC8vIFNraXAgcHJvY2Vzc2luZyBpZiBpbiBhbiBpbnZhbGlkIGJsb2NrcXVvdGUgY29udGV4dFxuICAgICAgICBpZiAoaW52YWxpZEJsb2NrcXVvdGUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpY29uc29sZS5sb2coYFNraXBwaW5nIHRhZyAke21hdGNoZWRTdHJpbmd9IGR1ZSB0byBpbnZhbGlkIGJsb2NrcXVvdGUgY29udGV4dC5gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udGV4dC1zcGVjaWZpYyBleGNsdXNpb25zXG4gICAgICAgIGNvbnN0IGlzVmFsaWQgPVxuICAgICAgICAgICAgY3VycmVudENvbnRleHQgIT09IFwiaW5kZW50ZWRcIiAmJiAvLyBFeGNsdWRlIGxpbmVzIHN0YXJ0aW5nIHdpdGggdGFic1xuICAgICAgICAgICAgIShjdXJyZW50Q29udGV4dCA9PT0gXCJsaXN0XCIgJiYgbGluZS5pbmNsdWRlcyhcIihub3QgYSB0YWcpXCIpKSAmJiAvLyBFeGNsdWRlIGludmFsaWQgbGlzdCB0YWdzXG4gICAgICAgICAgICAhKGN1cnJlbnRDb250ZXh0ID09PSBcImJsb2NrcXVvdGVcIiAmJiBpbnZhbGlkQmxvY2txdW90ZSk7IC8vIEV4Y2x1ZGUgYWxsIGludmFsaWQgYmxvY2txdW90ZXNcblxuICAgICAgICBpZiAoaXNWYWxpZCkge1xuICAgICAgICAgICAgdGFnUG9zaXRpb25zLnB1c2goe1xuICAgICAgICAgICAgICAgIHRhZzogbWF0Y2hlZFN0cmluZyxcbiAgICAgICAgICAgICAgICBpbmRleDogbWF0Y2hJbmRleCxcbiAgICAgICAgICAgICAgICBzb3VyY2U6IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICBjb250ZXh0OiBjdXJyZW50Q29udGV4dCxcbiAgICAgICAgICAgICAgICBsaW5lOiBmaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgbWF0Y2hJbmRleCkuc3BsaXQoXCJcXG5cIikubGVuZ3RoLCAvLyBDYWxjdWxhdGUgbGluZSBudW1iZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coYEZvdW5kIHRhZzogJHttYXRjaGVkU3RyaW5nfSBpbiBjb250ZXh0OiAke2N1cnJlbnRDb250ZXh0fWApO1xuICAgICAgICAgICAgcHJvY2Vzc2VkUG9zaXRpb25zLmFkZChtYXRjaEluZGV4KTsgLy8gTWFyayB0aGlzIHBvc2l0aW9uIGFzIHByb2Nlc3NlZFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coYEV4Y2x1ZGVkIHRhZzogJHttYXRjaGVkU3RyaW5nfSBpbiBpbnZhbGlkIGNvbnRleHQ6ICR7Y3VycmVudENvbnRleHR9YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGFnUG9zaXRpb25zO1xufVxuXG5cdFxuXG5cblx0YXN5bmMgYXNzaWduTWFya2Rvd25UYWdzIChcblx0XHR0YWdQb3NpdGlvbnM6QXJyYXksIFxuXHRcdHRhZ0VsZW1lbnRzOiBIVE1MRWxlbWVudFtdLFxuXHRcdHN0YXJ0SW5kZXg6IG51bWJlciwgXG5cdFx0dHlwZTogc3RyaW5nXG5cdCk6IEhUTUxFbGVtZW50W10ge1xuXG5cdFx0aWYgKHR5cGUgPT0gJ2FjdGl2ZScpIHtcblx0XHRcdC8vY29uc29sZS5sb2coc3RhcnRJbmRleCk7XG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSB7XG5cdFx0XHRcdGNvbnN0IGFjdGl2ZUZpbGVQYXRoID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKS5wYXRoO1xuXHRcdFx0XHRjb25zb2xlLmxvZyh0YWdQb3NpdGlvbnMubGVuZ3RoLCB0YWdFbGVtZW50cy5sZW5ndGgpIFxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKHRhZ1Bvc2l0aW9ucywgdGFnRWxlbWVudHMsIHRoaXMudGFnRmlsZU1hbmFnZXIuZ2V0VGFncyhhY3RpdmVGaWxlUGF0aCkpIFxuXHRcdFx0XHRjb25zdCB0ZW1wMSA9IFtdO1xuXHRcdFx0XHR0YWdQb3NpdGlvbnMuZm9yRWFjaChub2RlT2JqID0+IHsgdGVtcDEucHVzaChub2RlT2JqLnRhZykgfSk7XG5cdFx0XHRcdGNvbnN0IHRlbXAyID0gW107XG5cdFx0XHRcdHRhZ0VsZW1lbnRzLmZvckVhY2gobm9kZU9iaiA9PiB7IHRlbXAyLnB1c2gobm9kZU9iai5pbm5lclRleHQpIH0pO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc29sZS5sb2codGVtcDEsIHRlbXAyKVxuXHRcdFx0XHRcblx0XHRcdFx0Ly9pZiAodGFnUG9zaXRpb25zLmxlbmd0aCAhPSB0YWdFbGVtZW50cy5sZW5ndGggfHwgdGFnUG9zaXRpb25zLmxlbmd0aCAhPSB0aGlzLnRhZ0ZpbGVNYW5hZ2VyLmdldFRhZ3MoYWN0aXZlRmlsZVBhdGgpLmxlbmd0aCkge1x0XHRcdFxuXHRcdFx0fVxuXG5cdFx0XHRpZiAodGFnUG9zaXRpb25zLmxlbmd0aCAhPSB0YWdFbGVtZW50cy5sZW5ndGgpIHtcblx0XHRcdFx0dGhpcy5vdXRPZlN5bmMgPSB0cnVlO1xuXHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IE1hcmtkb3duIHNvdXJjZSBhbmQgcHJldmlldyB0YWdzIG91dCBvZiBzeW5jLiBUcnkgcmVmcmVzaGluZyB0aGlzIHN1bW1hcnkuIFRoZW4gY2hlY2sgZm9yIHRhZyBzeW50YXggZXJyb3JzIG9yIGNvbmZsaWN0cyBpbiBtZXRhZGF0YS4gUGxlYXNlIHJlcG9ydCBpZiB0aGlzIGVycm9yIHBlcnNpc3RzLicsMTAwMDApO1xuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSB0aGlzLmxvZ0RpZmZlcmVuY2VzKHRhZ1Bvc2l0aW9ucywgdGFnRWxlbWVudHMpXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRsZXQgdGFnRWw7XG5cdFx0Y29uc3QgdGFnRWxBcnJheSA9IEFycmF5LmZyb20odGFnRWxlbWVudHMpOyBcblx0XHRsZXQgdGFnRWxJbmRleCA9IDA7XG5cdFx0bGV0IHRhZ1Bvcztcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRhZ1Bvc2l0aW9ucy5sZW5ndGg7IGkrKykge1xuXHRcdC8vdGFnUG9zaXRpb25zLmZvckVhY2goKHRhZ1BvcywgaSkgPT4ge1xuXHRcdFx0dGFnUG9zID0gdGFnUG9zaXRpb25zW2ldO1xuLy9jb25zb2xlLmxvZyh0YWdFbEFycmF5W3RhZ0VsSW5kZXhdKVxuXHRcdFx0aWYgKHRhZ1Bvcy5pbmRleCA+PSBzdGFydEluZGV4KSB7XG5cdFx0XHRcdHRhZ0VsID0gdGFnRWxBcnJheVt0YWdFbEluZGV4XSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0aWYgKHRhZ0VsKSB7XG4vL2NvbnNvbGUubG9nKHRhZ0VsLCB0YWdQb3NpdGlvbnNbaV0udGFnLCB0YWdQb3NpdGlvbnNbaV0uaW5kZXgpO1xuXHRcdFx0XHRcdGlmICh0YWdFbC5pbm5lclRleHQudHJpbSgpID09IHRhZ1Bvcy50YWcudHJpbSgpKSB7XG5cdFx0ICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgnbWQtaW5kZXgnLCB0YWdQb3MuaW5kZXgpO1xuXHRcdCAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJywgdGFnUG9zLnNvdXJjZSk7XG5cdFx0ICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgndHlwZScsIHR5cGUpO1xuXHRcdCAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ3BvcycsIGkpO1xuXHRcdCAgICBcdFx0ICAgIHRhZ0VsSW5kZXgrKztcblx0XHQgICAgXHRcdH0gZWxzZSB7XG5cdFx0ICAgIFx0XHRcdC8vY29uc29sZS5sb2codGFnRWwuaW5uZXJUZXh0LnRyaW0oKSwgdGFnUG9zLnRhZy50cmltKCkpXG5cdFx0ICAgIFx0XHRcdHRoaXMub3V0T2ZTeW5jID0gdHJ1ZTtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogTWFya2Rvd24gc291cmNlIGFuZCBwcmV2aWV3IHRhZ3Mgb3V0IG9mIHN5bmMuIFRyeSByZWZyZXNoaW5nIHRoaXMgc3VtbWFyeS4gVGhlbiBjaGVjayBmb3IgdGFnIHN5bnRheCBlcnJvcnMgb3IgY29uZmxpY3RzIGluIG1ldGFkYXRhLiBQbGVhc2UgcmVwb3J0IGlmIHRoaXMgZXJyb3IgcGVyc2lzdHMuJyk7XG4vL2NvbnNvbGUubG9nKHRhZ1Bvc2l0aW9ucywgdGFnRWxlbWVudHMpXG5cblx0XHRcdFx0XHRcdHRoaXMubG9nRGlmZmVyZW5jZXModGFnUG9zaXRpb25zLCB0YWdFbGVtZW50cylcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHQgICAgXHRcdH1cbiAgICBcdFx0XHR9XG4gICAgXHRcdH0gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gdGFnRWxBcnJheTsgXG5cdH1cblxuXHRhc3luYyBwcm9jZXNzTmF0aXZlRW1iZWQgKFxuXHRcdC8vdGFnczogSFRNTEVsZW1lbnRbXSBcblx0XHRlbWJlZDogSFRNTEVsZW1lbnQsXG5cdFx0Y2hlY2tEdXBsaWNhdGVzOiBib29sZWFuID0gZmFsc2Vcblx0KTp2b2lkIHtcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBwcm9jZXNzTmF0aXZlRW1iZWQnKVxuXHRcdGVtYmVkID0gZW1iZWQuY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJyk7XG4gXHRcdGlmIChlbWJlZD8uZ2V0QXR0cmlidXRlKCdzcmMnKSkge1xuXHRcdFx0Y29uc3QgbGlua0VsZW1lbnQgPSBlbWJlZC5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuXHRcdFx0bGV0IGZpbGVQYXRoID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdzcmMnKTtcblx0XHRcdGNvbnN0IGxpbmtBcnJheSA9IGZpbGVQYXRoLnNwbGl0KCcjJyk7XG5cdFx0XHRjb25zdCBoYXNBbmNob3JMaW5rID0gbGlua0FycmF5Lmxlbmd0aCA+IDE7XG5cdFx0XHRsZXQgYW5jaG9yTGlua1R5cGUgPSAnJztcblx0XHRcdGxldCBhbmNob3JMaW5rO1xuXHRcdFx0aWYgKGhhc0FuY2hvckxpbmspIHtcblx0XHRcdFx0YW5jaG9yTGluayA9IGxpbmtBcnJheVsxXTtcblx0XHRcdFx0YW5jaG9yTGlua1R5cGUgPSBhbmNob3JMaW5rLnN0YXJ0c1dpdGgoJ14nKSA/ICdibG9jaycgOiAnaGVhZGVyJztcblx0XHRcdH1cblx0XHRcdGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuXHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IFV0aWxzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpXHRcdFx0XG5cdFx0XHRpZiAoZmlsZSkge1xuXHRcdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGNvbnN0IGVtYmVkZWRUYWdGaWxlID0gYXdhaXQgdGhpcy5nZXRNYXJrZG93blRhZ3MoZmlsZSwgZmlsZUNvbnRlbnQpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGhhc0FuY2hvckxpbmsgJiYgYW5jaG9yTGlua1R5cGUgIT0gJycpIHtcblx0XHRcdFx0XHRpZiAoXG5cdFx0XHRcdFx0XHRhbmNob3JMaW5rVHlwZSA9PSAnaGVhZGVyJyBcblx0XHRcdFx0XHRcdCYmICFVdGlscy5maWxlQ29udGFpbnNIZWFkaW5nKGZpbGVDb250ZW50LCBhbmNob3JMaW5rKVxuXHRcdFx0XHRcdCkge1xuXHRcdFx0XHRcdFx0ZW1iZWQuc2V0QXR0cmlidXRlKCdlbWJlZC1zdWNjZXNzJywgJ2ZhbHNlJyk7XG5cdFx0XHRcdFx0XHRyZXR1cm47IC8vIFJlamVjdCBpZiB0aGlzIGlzIGEgbmF0aXZlIFwiY2FuJ3QgZmluZCAjc2VjdGlvblwiIGVycm9yXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGVtYmVkLnNldEF0dHJpYnV0ZSgnZW1iZWQtc3VjY2VzcycsICd0cnVlJyk7XHRcblx0XHRcdFx0XHR9IFxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgdGVtcENvbXBvbmVudCA9IG5ldyBUZW1wQ29tcG9uZW50KCk7XG5cdFx0XHRcdGNvbnN0IHRlbXBDb250YWluZXJIVE1MID0gY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0XHRcdFxuXHRcdFx0XHRhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKFxuXHRcdFx0XHRcdGZpbGVDb250ZW50LCBcblx0XHRcdFx0XHR0ZW1wQ29udGFpbmVySFRNTCwgXG5cdFx0XHRcdFx0J25vRmlsZScsIC8vZmlsZS5wYXRoLCBcblx0XHRcdFx0XHR0ZW1wQ29tcG9uZW50XG5cdFx0XHRcdCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zdCBpbm5lclRleHQgPSBhd2FpdCBlbWJlZC5xdWVyeVNlbGVjdG9yKCcubWFya2Rvd24tZW1iZWQtY29udGVudCcpLmlubmVyVGV4dDtcblx0XHRcdFx0Y29uc3Qgc3RhcnRJbmRleCA9IHRlbXBDb250YWluZXJIVE1MLmlubmVyVGV4dC5pbmRleE9mKGlubmVyVGV4dCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR0aGlzLmFzc2lnbk1hcmtkb3duVGFncyhcblx0XHRcdFx0XHRlbWJlZGVkVGFnRmlsZSwgXG5cdFx0XHRcdFx0ZW1iZWQucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpLCBcblx0XHRcdFx0XHRzdGFydEluZGV4LCBcblx0XHRcdFx0XHQnbmF0aXZlLWVtYmVkJ1xuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGxvZ0RpZmZlcmVuY2VzKHRhZ1Bvc2l0aW9uczogQXJyYXksIHRhZ0VsZW1lbnRzOiBBcnJheSkge1xuXHRcdC8vIEV4dHJhY3QgdGFncyBhbmQgaW5uZXJUZXh0cyBpbnRvIHNlcGFyYXRlIGFycmF5c1xuXG5cdFx0Y29uc3QgdGFncyA9IHRhZ1Bvc2l0aW9ucy5tYXAoaXRlbSA9PiBpdGVtLnRhZyk7XG5cdFx0Y29uc3QgaW5uZXJUZXh0czEgPSB0YWdFbGVtZW50cy5tYXAoaXRlbSA9PiBpdGVtLmlubmVyVGV4dCk7XG5cblx0XHQvLyBJbml0aWFsaXplIGFycmF5cyB0byBzdG9yZSB1bmlxdWUgZWxlbWVudHNcblx0XHRsZXQgdW5pcXVlVG9UYWdQb3NpdGlvbnMgPSBbXTtcblx0XHRsZXQgdW5pcXVlVG9UYWdFbGVtZW50cyA9IFtdO1xuXG5cdFx0Ly8gSGVscGVyIGZ1bmN0aW9uIHRvIGZpbmQgdW5pcXVlIGVsZW1lbnRzIGluIG9uZSBhcnJheSBjb21wYXJlZCB0byBvdGhlcnNcblx0XHRjb25zdCBmaW5kVW5pcXVlID0gKGFycjEsIGFycjIpID0+IHtcblx0XHRcdHJldHVybiBhcnIxLmZpbHRlcihpdGVtID0+ICFhcnIyLmluY2x1ZGVzKGl0ZW0pKTtcblx0XHR9O1xuXG5cdFx0dW5pcXVlVG9UYWdQb3NpdGlvbnMgPSBmaW5kVW5pcXVlKHRhZ3MsIGlubmVyVGV4dHMxKTtcblx0XHR1bmlxdWVUb1RhZ0VsZW1lbnRzID0gZmluZFVuaXF1ZShpbm5lclRleHRzMSwgdGFncyk7XG5cblx0XHRjb25zb2xlLmxvZygnZGlmZmVyZW5jZXM6JywgdW5pcXVlVG9UYWdQb3NpdGlvbnMubGVuZ3RoLCB1bmlxdWVUb1RhZ0VsZW1lbnRzLmxlbmd0aCk7XG5cdFx0Ly8gTG9nIHRoZSBkaWZmZXJlbmNlc1xuXHRcdGlmICh1bmlxdWVUb1RhZ1Bvc2l0aW9ucy5sZW5ndGgpIHtcblx0XHRcdGNvbnNvbGUubG9nKFwiVW5pcXVlIHRvIHRhZ1Bvc2l0aW9ucyBiYXNlZCBvbiB0YWc6XCIsIHVuaXF1ZVRvVGFnUG9zaXRpb25zKTtcblx0XHR9XG5cdFx0aWYgKHVuaXF1ZVRvVGFnRWxlbWVudHMubGVuZ3RoKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlVuaXF1ZSB0byB0YWdFbGVtZW50cyBiYXNlZCBvbiBpbm5lclRleHQ6XCIsIHVuaXF1ZVRvVGFnRWxlbWVudHMpO1xuXHRcdH1cblx0fVxuXG59XG5cbmNsYXNzIFRlbXBDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuXHRvbmxvYWQoKSB7fVxuXHRvbnVubG9hZCgpIHt9XG59IiwgImltcG9ydCB7IEFwcCwgTWFya2Rvd25SZW5kZXJlciwgQ29tcG9uZW50LCBURmlsZSwgZ2V0QWxsVGFncywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVGFnU3VtbWFyeSB9IGZyb20gJy4vVGFnU3VtbWFyeSc7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcblxuXG5leHBvcnQgY2xhc3MgUmVhZGluZ01vZGVUYWdFZGl0b3Ige1xuXHRhcHA6IEFwcDsgXG5cdHBsdWdpbjogVGFnQnVkZHk7XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0YXBwOiBBcHAsIFxuXHRcdHBsdWdpbjogVGFnQnVkZHkpIHtcblxuXHRcdHRoaXMuYXBwID0gYXBwO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0Ly9hc3luYyByZW5hbWVUYWcgKHRhZywgbmV3TmFtZSwgYmF0Y2hBY3Rpb246IHN0cmluZyB8IG51bWJlciwgc3BlY2lmaWNGaWxlOlRGaWxlID0gbnVsbCkge1xuXHRhc3luYyByZW5hbWVUYWcgKHRhZywgbmV3TmFtZSwgYmF0Y2hBY3Rpb246IHN0cmluZyB8IG51bWJlciwgZmlsZVBhdGg6IHN0cmluZyA9IG51bGwsIHRhZ0VsOiBIVE1MRWxlbWVudCkge1xuXHRcdFxuXHRcdC8vY29uc29sZS5sb2cgKG5ld05hbWUsIGJhdGNoQWN0aW9uLCBmaWxlUGF0aClcblx0XG5cdFx0Ly9jb25zdCB0YWdDb250YWluZXJUeXBlID0gdGFnRWwuZ2V0QXR0cmlidXRlKFxuXHRcdC8vXHQndHlwZSdcblx0XHQvLyk7XG5cdFx0Ly9jb25zdCBpbmRleCA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHQvL1x0J21kLWluZGV4J1xuXHRcdC8vKTtcblx0XHQvL2NvbnN0IGZpbGVQYXRoID0gdGFnRWwuZ2V0QXR0cmlidXRlKFxuXHRcdC8vXHQnZmlsZS1zb3VyY2UnXG5cdFx0Ly8pO1xuXHRcdFxuXHRcdGNvbnN0IGFjdGl2ZUZpbGU6IFRGaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRjb25zdCBmaWxlOiBURmlsZSA9IGZpbGVQYXRoID09IG51bGwgPyBhY3RpdmVGaWxlIDogYXdhaXQgVXRpbHMudmFsaWRhdGVGaWxlUGF0aChmaWxlUGF0aCk7XG5cdFx0XG5cdFx0aWYgKCFmaWxlKSByZXR1cm47XG5cblx0XHRjb25zdCBmaWxlQ29udGVudDogc3RyaW5nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHQvL2NvbnN0IGZpbGU6IFRGaWxlID0gYXdhaXQgVXRpbHMudmFsaWRhdGVGaWxlUGF0aChmaWxlUGF0aCk7XG5cblx0XHRpZiAodHlwZW9mIGJhdGNoQWN0aW9uID09PSAnbnVtYmVyJykge1xuXG4gICAgICAgIFx0Ly9jb25zdCBmaWxlOiBURmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKClcbiAgICAgICAgXHQvL2NvbnN0IGZpbGVDb250ZW50OiBTdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBcdGNvbnN0IG5ld0ZpbGVDb250ZW50ID0gdGhpcy5yZW5hbWVUYWdJblN0cmluZ0J5SW5kZXggKFxuICAgICAgICBcdFx0dGFnLFxuICAgICAgICBcdFx0bmV3TmFtZSxcbiAgICAgICAgXHRcdHBhcnNlSW50KGJhdGNoQWN0aW9uKSxcbiAgICAgICAgXHRcdGZpbGVDb250ZW50XG4gICAgXHRcdClcbiAgICBcdFx0dGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0ZpbGVDb250ZW50KTtcblxuICAgICAgICB9IGVsc2UgaWYgKGJhdGNoQWN0aW9uID09ICdub3RlJykge1xuXG4gICAgICAgIFx0Ly9jb25zdCBmaWxlOiBURmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFx0dGhpcy5yZW5hbWVUYWdzSW5GaWxlQnlJbmRleCAoXG4gICAgICAgIFx0XHR0YWcsXG4gICAgICAgIFx0XHRuZXdOYW1lLFxuICAgICAgICBcdFx0ZmlsZVxuICAgIFx0XHQpXG5cbiAgICBcdFx0XG4gICAgICAgICAgIFxuICAgICAgICB9IGVsc2UgaWYgKGJhdGNoQWN0aW9uID09ICd2YXVsdCcpIHtcbiAgICAgICAgXHRcblx0ICAgIFx0dGhpcy5yZW5hbWVUYWdzSW5WYXVsdEJ5SW5kZXggKFxuXHQgICAgXHRcdHRhZyxcblx0ICAgIFx0XHRuZXdOYW1lXG5cdFx0XHQpXG5cblx0XHRcdC8vaWYgKGFjdGl2ZUZpbGUgIT0gZmlsZSkge1xuICAgICAgICBcdFx0Ly90aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi5yZWJ1aWxkVmlldygpXG4gICAgICAgIFx0XHQvL25ldyBOb3RpY2UgKCdUYWdzIGhhdmUgYmVlbiB1cGRhdGVkIGluIGV4dGVybmFsIG5vdGVzLiBQbGVhc2UgcmVmcmVzaCB0aGlzIHN1bW1hcnkgb3IgcmVsb2FkIHRoaXMgbm90ZS4nKVxuICAgICAgICBcdC8vfVxuICAgICAgICAgICBcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChhY3RpdmVGaWxlICE9IGZpbGUgJiYgdGFnRWwpIHtcbiAgICAgICAgXHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYucmVidWlsZFZpZXcoKVxuICAgICAgICBcdFx0bmV3IE5vdGljZSAoJ1JlZnJlc2ggdGhpcyBzdW1tYXJ5IHRvIHNlZSBjaGFuZ2VzLicsIDUwMDApXG4gICAgICAgIFx0Ly9jb25zb2xlLmxvZyh0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKSlcbiAgICAgICAgXHQvL3RoaXMucGx1Z2luLnRhZ1N1bW1hcnkudXBkYXRlKHRhZ0VsLmNsb3Nlc3QoJy50YWctc3VtbWFyeS1ibG9jaycpKTsgXG4gICAgXHR9XG4gICAgICAgIFxuXG4gICAgfVxuXG4gICAgYXN5bmMgcmVuYW1lVGFnc0luVmF1bHRCeUluZGV4ICh0YWcsIG5ld05hbWUpIHtcblxuICAgIFx0Y29uc3QgdmFsaWRUYWdzID0gW3RhZ11cblx0XHRsZXQgbGlzdEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLmZpbHRlcigoZmlsZSkgPT4ge1xuXHRcdFx0Ly8gUmVtb3ZlIGZpbGVzIHRoYXQgZG8gbm90IGNvbnRhaW4gdGhlIHRhZ3Mgc2VsZWN0ZWQgYnkgdGhlIHVzZXJcblx0XHRcdGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG5cdFx0XHRjb25zdCB0YWdzSW5GaWxlID0gZ2V0QWxsVGFncyhjYWNoZSk7XG5cblx0XHRcdGlmICh2YWxpZFRhZ3Muc29tZSgodmFsdWUpID0+IHRhZ3NJbkZpbGU/LmluY2x1ZGVzKHZhbHVlKSkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGxldCBsaXN0Q29udGVudHM6IFtURmlsZSwgc3RyaW5nXVtdID0gYXdhaXQgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5yZWFkRmlsZXMobGlzdEZpbGVzKTtcbiAgICAgICAgLy8gbGlzdENvbnRlbnRzW25dWzBdIGlzIHRoZSBmaWxlLCBsaXN0Q29udGVudHNbbl1bWzFdIGlzIHRoZSBmaWxlIGNvbnRlbnRcbiAgICAgICAgXG4gICAgICAgIGxpc3RDb250ZW50cy5mb3JFYWNoKGFzeW5jIChub3RlKSA9PiB7XG4gICAgICAgIFx0Ly90aGlzLnJlbmFtZVRhZ0luRmlsZSAodGFnLCBuZXdOYW1lLCBub3RlWzBdKTtcbiAgICAgICAgXHR0aGlzLnJlbmFtZVRhZ3NJbkZpbGVCeUluZGV4IChcbiAgICAgICAgXHRcdHRhZyxcbiAgICAgICAgXHRcdG5ld05hbWUsXG4gICAgICAgIFx0XHRub3RlWzBdXG5cdFx0XHQpXG5cbiAgICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICBhc3luYyByZW5hbWVUYWdzSW5GaWxlQnlJbmRleCAoXG4gICAgXHR0YWc6IFN0cmluZywgXG4gICAgXHRuZXdOYW1lOiBTdHJpbmcsIFxuICAgIFx0ZmlsZTogVEZpbGVcblx0KTpWb2lkIHtcblxuICAgIFx0Y29uc3QgZmlsZUNvbnRlbnQ6IFN0cmluZyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgIGxldCBuZXdGaWxlQ29udGVudDogU3RyaW5nID0gZmlsZUNvbnRlbnQ7XG4gICAgXHRjb25zdCB0YWdQb3NpdGlvbnMgPSB0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IuZ2V0TWFya2Rvd25UYWdzIChmaWxlLCBmaWxlQ29udGVudCk7XG4gICAgXHQvLyB7dGFnOnRhZywgaW5kZXg6bWF0Y2guaW5kZXgsIHNvdXJjZTpmaWxlLm5hbWV9XG5cbiAgICBcdGxldCBmaWx0ZXJlZFRhZ09ianMgPSB0YWdQb3NpdGlvbnMuZmlsdGVyKHRhZ09iaiA9PiB0YWdPYmoudGFnID09PSB0YWcpO1xuXG4gICAgXHRpZiAoZmlsdGVyZWRUYWdPYmpzLmxlbmd0aCA+IDApIHtcblxuICAgIFx0XHRmaWx0ZXJlZFRhZ09ianMuc29ydCgoYSwgYikgPT4gYS5pbmRleCAtIGIuaW5kZXgpO1xuICAgIFx0XHRsZXQgb2Zmc2V0ID0gMDtcblx0XHQgICAgZmlsdGVyZWRUYWdPYmpzLmZvckVhY2godGFnT2JqID0+IHtcblx0XHQgICAgICAgIC8vIENhbGN1bGF0ZSB0aGUgbmV3IGluZGV4IGNvbnNpZGVyaW5nIHRoZSBvZmZzZXRcblx0XHQgICAgICAgIGNvbnN0IG5ld0luZGV4OiBOdW1iZXIgPSB0YWdPYmouaW5kZXggKyBvZmZzZXQ7XG5cdFx0ICAgICAgICAvLyBSZXBsYWNlIHRoZSB0YWcgYXQgdGhlIGNvcnJlY3QgcG9zaXRpb25cblx0XHQgICAgICAgIG5ld0ZpbGVDb250ZW50ID0gbmV3RmlsZUNvbnRlbnQuc3Vic3RyaW5nKDAsIG5ld0luZGV4KSArIG5ld05hbWUgKyBuZXdGaWxlQ29udGVudC5zdWJzdHJpbmcobmV3SW5kZXggKyB0YWdPYmoudGFnLmxlbmd0aCk7XG5cdFx0ICAgICAgICAvL25ld0ZpbGVDb250ZW50ID0gdGhpcy5yZW5hbWVUYWdJblN0cmluZ0J5SW5kZXggKHRhZywgbmV3TmFtZSwgbmV3SW5kZXgsIGZpbGVDb250ZW50KVxuXHRcdCAgICAgICAgLy8gVXBkYXRlIHRoZSBvZmZzZXQgZm9yIHRoZSBuZXh0IGl0ZXJhdGlvblxuXHRcdCAgICAgICAgb2Zmc2V0ICs9IG5ld05hbWUubGVuZ3RoIC0gdGFnT2JqLnRhZy5sZW5ndGg7XG5cdFx0ICAgIH0pO1xuXG4gICAgXHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdGaWxlQ29udGVudCk7XG5cbiAgICBcdH0gZWxzZSB7XG4gICAgXHRcdC8vbmV3IE5vdGljZSAoJ05vIHRhZ3MgdG8gcmVuYW1lLicpXG4gICAgXHR9XG4gICAgfVxuXG4gICAgcmVuYW1lVGFnSW5TdHJpbmdCeUluZGV4IChcbiAgICBcdHRhZzogU3RyaW5nLCBcbiAgICBcdG5ld05hbWU6IFN0cmluZywgXG4gICAgXHRpbmRleDogTnVtYmVyLFxuICAgIFx0ZmlsZUNvbnRlbnQ6IFN0cmluZ1xuXHQpOlN0cmluZyB7XG4gICAgXHQvL2NvbnNvbGUubG9nKGZpbGVDb250ZW50KVxuICAgIFx0Y29uc3QgbmV3Q29udGVudDogU3RyaW5nID0gZmlsZUNvbnRlbnQuc3Vic3RyaW5nICgwLCBwYXJzZUludChpbmRleCkpICsgbmV3TmFtZSArIGZpbGVDb250ZW50LnN1YnN0cmluZygocGFyc2VJbnQoaW5kZXgpICsgcGFyc2VJbnQodGFnLmxlbmd0aCkpKVxuICAgIFx0Ly9jb25zb2xlLmxvZyhuZXdDb250ZW50KVxuICAgIFx0Ly9jb25zb2xlLmxvZyhpbmRleCArIHRhZy5sZW5ndGgpXG4gICAgXHRyZXR1cm4gKG5ld0NvbnRlbnQpO1xuICAgIFx0Ly90aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG4gICAgfVxuXG5cblx0YXN5bmMgYWRkIChcblx0XHR0YWc6IHN0cmluZywgXG5cdFx0eDogbnVtYmVyLCBcblx0XHR5OiBudW1iZXIvLyxcblx0XHQvL21vYmlsZU9iajogT2JqZWN0XG5cdCk6dm9pZCB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgeyBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5IGFkZCAnICsgdGFnICsgJyBhdCAoJyArIHggKyAnLCAnICsgeSArICcpJyk7IH1cblxuXHRcdGxldCBmaWxlQ29udGVudDogc3RyaW5nO1xuXHRcdGxldCBmaWxlOiBURmlsZTtcblx0XHRjb25zdCBjbGlja2VkVGV4dE9iaiA9IFV0aWxzLmdldENsaWNrZWRUZXh0T2JqRnJvbURvYyh4LCB5KTtcblx0XHRjb25zdCBjbGlja2VkVGV4dDogc3RyaW5nID0gY2xpY2tlZFRleHRPYmo/LnRleHQ7XG5cdFx0Y29uc3QgY2xpY2tlZFRleHRJbmRleDpudW1iZXIgPSBjbGlja2VkVGV4dE9iaj8uaW5kZXg7IC8vIHRoaXMgaXMgdGhlIGluZGV4IGluIGRvY3VtZW50LCBmb3IgbmFycm93aW5nIGRvd24gdG8gdGhlIGNsaWNrZWQgd29yZC5cblx0XHRjb25zdCBjbGlja2VkVGV4dEVsOiBIVE1MRWxlbWVudCA9IGNsaWNrZWRUZXh0T2JqPy5lbDtcblx0XHRsZXQgY29udGVudFNvdXJjZVR5cGU6IHN0cmluZyA9IG51bGxcblx0XHRsZXQgc3VtbWFyeUVsOiBIVE1MRWxlbWVudCA9IHVuZGVmaW5lZDtcblx0XHRsZXQgZW1iZWRFbDogSFRNTEVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cbi8vY29uc29sZS5sb2coY2xpY2tlZFRleHRPYmopXHRcdFxuXHRcdGlmIChjbGlja2VkVGV4dE9iaikge1xuXHRcdFx0dHJ5IHtcblx0XHRcdFx0c3VtbWFyeUVsID0gY2xpY2tlZFRleHRFbD8uY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LXBhcmFncmFwaCcpO1xuXHRcdFx0XHRlbWJlZEVsID0gY2xpY2tlZFRleHRFbD8uY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJyk7XG5cdFx0XHR9IGNhdGNoIHtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHN1bW1hcnlFbCkge1xuLy9jb25zb2xlLmxvZygnaXMgc3VtbWFyeScpXG5cdFx0XHRcdGZpbGUgPSBhd2FpdCB0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LmdldEZpbGUoc3VtbWFyeUVsKTtcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRjb250ZW50U291cmNlVHlwZSA9ICdwbHVnaW4tc3VtbWFyeSc7XG5cdFx0XHRcdFxuXHRcdFx0fSBlbHNlIGlmIChlbWJlZEVsKSB7XG4vL2NvbnNvbGUubG9nKCdpcyBlbWJlZCcpXG5cdFx0XHRcdGZpbGUgPSBhd2FpdCBVdGlscy5nZXRFbWJlZEZpbGUoZW1iZWRFbCk7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29udGVudFNvdXJjZVR5cGUgPSAnbmF0aXZlLWVtYmVkJztcblxuXHRcdFx0fSBlbHNlIHsgXG4vL2NvbnNvbGUubG9nKCdpcyBhY3RpdmUgZmlsZScpXG5cdFx0XHRcdGZpbGUgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGNvbnRlbnRTb3VyY2VUeXBlID0gJ2FjdGl2ZSc7XG5cdFx0XHR9IFxuXG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBmaW5kIHRleHQgcG9zaXRpb24gb3IgYXJlYSB0b28gYnVzeS5cXG5UcnkgYSBhbm90aGVyIHRleHQgYXJlYS4nKTtcblx0XHQgICAgcmV0dXJuO1xuXHRcdH1cblxuXG5cdFx0aWYgKGNsaWNrZWRUZXh0KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nIChjbGlja2VkVGV4dCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBhZGQgdGFnLlxcblRyeSBhIGRpZmZlcmVudCB0ZXh0IGFyZWEuJylcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRjb25zdCBlc2NhcGVkQ2xpY2tlZFRleHQgPSBVdGlscy5lc2NhcGVSZWdFeHAoY2xpY2tlZFRleHQpO1xuXHRcdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChlc2NhcGVkQ2xpY2tlZFRleHQsIFwiZ1wiKTsgIFxuXHRcdGNvbnN0IG1hdGNoZXMgPSBmaWxlQ29udGVudC5tYXRjaChyZWdleCk7XG5cblx0XHRpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA+IDEpIHtcblx0XHQgICAgbmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IGFkZCB0YWc6IENsaWNrZWQgdGV4dCByZXBlYXRlZCBpbiBub3RlLiBUcnkgYSBhbm90aGVyIHRleHQgYmxvY2suJyk7XG5cdFx0ICAgIHJldHVybjtcblxuXHRcdH0gZWxzZSBpZiAoKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPT09IDApIHx8ICFtYXRjaGVzKSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCB0ZXh0IHBvc2l0aW9uIG9yIGFyZWEgdG9vIGJ1c3kuXFxuVHJ5IGEgYW5vdGhlciB0ZXh0IGFyZWEuJyk7XG5cdFx0ICAgIHJldHVybjtcblx0XHR9IFxuXG5cdFx0aWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5sb2NrUmVjZW50VGFncykgdGhpcy5wbHVnaW4uc2F2ZVJlY2VudFRhZyh0YWcpOyBcblx0XHRcblx0XHRjb25zdCBzdGFydEluZGV4ID0gcmVnZXguZXhlYyhmaWxlQ29udGVudCkuaW5kZXg7IC8vIHRoaXMgaXMgdGhlIGluZGV4IGluIHRoZSBtZCBzb3VyY2Vcblx0XHRjb25zdCBlbmRJbmRleCA9IHN0YXJ0SW5kZXggKyBjbGlja2VkVGV4dC5sZW5ndGg7IC8vIHVzZSB0aGlzIHRvIGFkZCB0YWcgYXQgZW5kIG9mIGJsb2NrXG5cblx0XHRjb25zdCBjbGlja2VkV29yZE9iaiA9IFV0aWxzLmdldFdvcmRPYmpGcm9tU3RyaW5nIChjbGlja2VkVGV4dCwgY2xpY2tlZFRleHRJbmRleCk7XG5cdFx0Y29uc3QgY2xpY2tlZFdvcmQgPSBjbGlja2VkV29yZE9iai50ZXh0O1xuXHRcdGNvbnN0IGNsaWNrZWRXb3JkSW5kZXggPSBjbGlja2VkV29yZE9iai5pbmRleDtcblx0XHRsZXQgbmV3Q29udGVudDtcblxuXHRcdGlmIChjbGlja2VkV29yZCkge1xuXHRcdFx0aWYgKFV0aWxzLmlzV29yZE5lYXJFbmQoY2xpY2tlZFRleHQsIGNsaWNrZWRXb3JkKSkgXG5cdFx0XHRcdG5ld0NvbnRlbnQgPSBVdGlscy5pbnNlcnRUZXh0SW5TdHJpbmcoJyAnICsgdGFnLCBmaWxlQ29udGVudCwgZW5kSW5kZXgpO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMuaW5zZXJ0VGV4dEluU3RyaW5nKHRhZywgZmlsZUNvbnRlbnQsIHN0YXJ0SW5kZXgrY2xpY2tlZFdvcmRJbmRleCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBmaW5kIGNsaWNrZWQgd29yZC5cXG5QbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdCAgICByZXR1cm47XG5cdFx0fVxuXHRcdFxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcblxuXHRcdGlmIChjb250ZW50U291cmNlVHlwZSA9PSAncGx1Z2luLXN1bW1hcnknKSB7XG5cdFx0XHRjb25zdCBzdW1tYXJ5Q29udGFpbmVyID0gc3VtbWFyeUVsLmNsb3Nlc3QoJy50YWctc3VtbWFyeS1ibG9jaycpXG5cdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZShzdW1tYXJ5Q29udGFpbmVyKTsgXG5cdFx0fSBlbHNlIGlmIChjb250ZW50U291cmNlVHlwZSA9PSAnbmF0aXZlLWVtYmVkJykge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYWRkZWQgdG8gbmF0aXZlIGVtYmVkOicsIGVtYmVkRWwpXG5cdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgXG5cdFx0XHRcdHRoaXMucGx1Z2luLnRhZ1Byb2Nlc3Nvci5wcm9jZXNzTmF0aXZlRW1iZWQoZW1iZWRFbCwgdHJ1ZSk7XG5cdFx0XHR9LCAyMDApO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGVkaXQgKFxuXHRcdHRhZ0VsOiBIVE1MRWxlbWVudCwgXG5cdFx0ZXZlbnQ6IEV2ZW50LCBcblx0XHRwcmFncmFwaEVsOiBIVE1MRWxlbWVudCxcblx0XHRlZGl0VHlwZTogU3RyaW5nLFxuXHRcdG5ld05hbWU6IFN0cmluZ1xuXHQpOnZvaWQge1xuLy9jb25zb2xlLmxvZyh0YWdFbClcblx0XHRsZXQgdGFnQ29udGFpbmVyOiBIVE1MRWxlbWVudDtcblx0XHRjb25zdCB0YWdDb250YWluZXJUeXBlID0gdGFnRWwuZ2V0QXR0cmlidXRlKFxuXHRcdFx0J3R5cGUnXG5cdFx0KTtcblx0XHRjb25zdCBpbmRleCA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdtZC1pbmRleCdcblx0XHQpO1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gdGFnRWwuZ2V0QXR0cmlidXRlKFxuXHRcdFx0J2ZpbGUtc291cmNlJ1xuXHRcdCk7XG5cblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnVGFnIEJ1ZGR5IGVkaXQgdGFnOiAnICsgdGFnRWwuaW5uZXJUZXh0IFxuXHRcdFx0XHQrICdcXG5JbiBmaWxlOiAnICsgZmlsZVBhdGgpO1xuXHRcdH1cblxuXHRcdGlmICh0YWdDb250YWluZXJUeXBlID09ICduYXRpdmUtZW1iZWQnKSB0YWdDb250YWluZXIgPSB0YWdFbC5jbG9zZXN0KCcubWFya2Rvd24tZW1iZWQnKTtcblx0XHRlbHNlIGlmICh0YWdDb250YWluZXJUeXBlID09ICdwbHVnaW4tc3VtbWFyeScpIHRhZ0NvbnRhaW5lciA9IHRhZ0VsLmNsb3Nlc3QoJy50YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblx0XHRlbHNlIHRhZ0NvbnRhaW5lciA9IHRoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5tYXJrZG93bi1yZWFkaW5nLXZpZXcnKTtcblx0XHRcblx0XHRpZiAoZmlsZVBhdGgpIHtcbiBcblx0XHRcdGNvbnN0IGZpbGU6IFRGaWxlID0gYXdhaXQgVXRpbHMudmFsaWRhdGVGaWxlUGF0aChmaWxlUGF0aCk7XG5cdFx0XHRsZXQgZmlsZUNvbnRlbnQ6IFN0cmluZztcblx0XHRcdGxldCBmaWxlQ29udGVudEJhY2t1cDogU3RyaW5nO1xuXHRcdFx0Y29uc3QgdGFnOiBzdHJpbmcgPSB0YWdFbC5pbm5lclRleHQudHJpbSgpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGZpbGVDb250ZW50QmFja3VwID0gZmlsZUNvbnRlbnQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeSBmaWxlIHJlYWQgZXJyb3I6XFxuJyArIGVycm9yLm1lc3NhZ2UpO1xuXHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGZpbGUgaGFzIG9ubHkgb25lIHRhZyBsZWZ0IChhbmQgdGhhdCdzIGFsbCB0aGF0cyBsZWZ0IGluIHRoZSBmaWxlKVxuXHRcdFx0bGV0IHNhZmVUb0VtcHR5RmlsZSA9IGZhbHNlO1xuXHRcdFx0Y29uc3QgdGFnUmVnZXggPSAvXlxccyojKFxcdyspXFxzKiQvO1xuXHRcdFx0aWYgKHRhZ1JlZ2V4LnRlc3QoZmlsZUNvbnRlbnQudHJpbSgpKSkge1xuXHRcdCAgICBcdHNhZmVUb0VtcHR5RmlsZSA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGxldCBiZWZvcmVUYWcgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuXHRcdFx0Ly9sZXQgYWZ0ZXJUYWcgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoKE51bWJlcihpbmRleCkrTnVtYmVyKHRhZy5sZW5ndGgpKzEpKTtcblx0XHRcdGxldCBhZnRlclRhZyA9IGZpbGVDb250ZW50LnN1YnN0cmluZyhcblx0XHRcdFx0TnVtYmVyKGluZGV4KSArIE51bWJlcih0YWcubGVuZ3RoKVxuXHRcdFx0KTtcblxuXHRcdFx0Ly9jb25zb2xlLmxvZyAoSlNPTi5zdHJpbmdpZnkoYmVmb3JlVGFnKSk7XG5cdFx0XHQvL2NvbnNvbGUubG9nIChKU09OLnN0cmluZ2lmeSh0YWcpKTtcblx0XHRcdC8vY29uc29sZS5sb2cgKEpTT04uc3RyaW5naWZ5KGFmdGVyVGFnKSk7XG5cblx0XHRcdGxldCBhZnRlclRhZ0NociA9ICcnO1xuXHRcdFx0XG5cdFx0XHRcblx0XHRcdC8vIENhbid0IHJlbWVtYmVyIHdoeSBJIGhhdmUgdGhpcy4uLlxuXHRcdFx0Ly8gbmVlZCB0byByZWZhY3RvciBhbGwgdGhpcyBsaW5lIGJyZWFrIHNwYWNlIHN0dWZmXG5cdFx0XHRpZiAoZmlsZUNvbnRlbnRbaW5kZXhdID09PSAnXFxuJykgYmVmb3JlVGFnICs9ICdcXG4nO1xuXHRcdFx0bGV0IG5ld0NvbnRlbnQgPSAnJztcblxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcdFx0Ly8gVE8tRE86IFJFRkFDVE9SXG5cdFx0XHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0XHRcdGlmIChlZGl0VHlwZSA9PSAncmVuYW1lJykgeyAvLyB0aGlzIG9ubHkgaGFwcGVucyBmcm9tIGVkaXQgbW9kYWxcblxuXHRcdFx0XHQvL25ld0NvbnRlbnQgPSB0aGlzLnJlbmFtZVRhZ0luU3RyaW5nQnlJbmRleCAoJyMnK3RhZywgbmV3TmFtZSwgaW5kZXgsIGZpbGVDb250ZW50KTtcblxuXHRcdFx0fSBlbHNlIGlmICghZXZlbnQpIHsgLy8gdGhlbiB3ZSdyZSBjYWxsaW5nIHRoaXMgbWV0aG9kIGZyb20gYSBidXR0b24uIG5lZWQgdG8gcmV0aGluayBob3cgdGhpcyBpcyBvcmdhbml6ZWQuXG5cdFx0XHRcdFxuXHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgYWZ0ZXJUYWdDaHIgKyBhZnRlclRhZztcblxuXHRcdFx0fSBlbHNlIGlmIChlZGl0VHlwZSA9PSAnaGFzaCcpIHsgXG5cdFx0XHRcdC8vIFJlbW92ZSB0aGUgaGFzaCBvbmx5XG5cdFx0XHRcdGNvbnN0IG5vSGFzaCA9IHRhZy5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdC8vbmV3Q29udGVudCA9IGJlZm9yZVRhZyArICghYmVmb3JlVGFnLmVuZHNXaXRoKCcgJyk/JyAnOicnKSArIG5vSGFzaCArIGFmdGVyVGFnO1xuXHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgbm9IYXNoICsgYWZ0ZXJUYWdDaHIgKyBhZnRlclRhZztcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKSBcblx0XHRcdFx0XHR7IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6ICcgKyB0YWcgKyAnIGNvbnZlcnRlZCB0byB0ZXh0LicpOyB9XG5cdFx0XHRcblx0XHRcdC8qfSBlbHNlIGlmICgoKGV2ZW50LnR5cGUgPT0gJ3RvdWNoZW5kJykgXG5cdFx0XHRcdHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkgXG5cdFx0XHRcdFx0fHwgKFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKSBcblx0XHRcdFx0XHR8fCAoIVV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG5cdFx0XHRcdCkgXG5cdFx0XHR7Ki9cblx0XHRcdH0gZWxzZSBpZiAoKChldmVudC50eXBlID09ICd0b3VjaGVuZCcpIFxuXHRcdFx0XHR8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2gpIC8vIGRvbid0IG5lZWQgdGhpcyBjaGVjayBhbnkgbW9yZS4gXG5cdFx0XHRcdFx0fHwgKGVkaXRUeXBlID09ICdyZW1vdmUnKSBcblx0XHRcdFx0KSBcblx0XHRcdHtcblxuXHRcdFx0XHQvLyBSZW1vdmUgdGFnIChvciBjaGlsZCBmaXJzdCwgaWYgZXhpc3RzKVxuXHRcdFx0XHRsZXQgcGFyZW50VGFnID0gJyc7XG5cblx0XHRcdFx0aWYgKHRhZy5pbmNsdWRlcygnLycpIFxuXG5cdFx0XHRcdFx0Ly8mJiAodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QgXG5cdFx0XHRcdFx0Ly98fCAoZXZlbnQuc2hpZnRLZXkgXG5cdFx0XHRcdFx0XHQvLyYmICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdClcblx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0IFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bGV0IHBhcnRzID0gdGFnLnNwbGl0KCcvJyk7XG5cdFx0XHRcdFx0Y29uc3QgcmVtb3ZlZENoaWxkID0gcGFydHMucG9wKCk7XG5cdFx0XHRcdFx0cGFyZW50VGFnID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgXG5cdFx0XHRcdFx0XHQrIHBhcmVudFRhZyBcblx0XHRcdFx0XHRcdCsgYWZ0ZXJUYWdDaHIgXG5cdFx0XHRcdFx0XHQrIGFmdGVyVGFnO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlIFxuXHRcdFx0XHRcdFx0JiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcykgXG5cdFx0XHRcdFx0eyBcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IFxcJycgXG5cdFx0XHRcdFx0XHRcdCsgcmVtb3ZlZENoaWxkIFxuXHRcdFx0XHRcdFx0XHQrICdcXCcgcmVtb3ZlZCBmcm9tIHBhcmVudCB0YWcuJyk7IFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gcmVtb3ZlIGV4dHJhIHNwYWNlXG5cdFx0XHRcdFx0XG4vL2NvbnNvbGUubG9nICgnPicgKyBiZWZvcmVUYWcuc3Vic3RyaW5nKGJlZm9yZVRhZy5sZW5ndGgtMSkgKyBhZnRlclRhZy5zdWJzdHJpbmcoMCwxKSArICc8Jylcblx0XHRcdFx0XHQvKmlmIChiZWZvcmVUYWcuc3Vic3RyaW5nKGJlZm9yZVRhZy5sZW5ndGgtMSkgPT0gJyAnICYmIGFmdGVyVGFnLnN1YnN0cmluZygwLDEpID09ICcgJykge1xuXHRcdFx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArIGFmdGVyVGFnLnN1YnN0cmluZygxKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArIGFmdGVyVGFnO1xuXHRcdFx0XHRcdH0qL1xuXG5cdFx0XHRcdFx0Y29uc3Qgc3RhcnRzV2l0aFB1bmN0dWF0aW9uID0gL15bLiwhOj87XS8udGVzdChhZnRlclRhZy50cmltU3RhcnQoKVswXSk7XG4vL2NvbnNvbGUubG9nKCc+JythZnRlclRhZy50cmltU3RhcnQoKVswXSsnPCcpXG5cdFx0XHRcdFx0aWYgKGJlZm9yZVRhZy5lbmRzV2l0aCgnICcpICYmIGFmdGVyVGFnLnN0YXJ0c1dpdGgoJyAnKSkge1xuXHRcdFx0XHQgICAgICAgIG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZy5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdCAgICB9IGVsc2UgaWYgKHN0YXJ0c1dpdGhQdW5jdHVhdGlvbikge1xuXHRcdFx0XHQgICAgXHRuZXdDb250ZW50ID0gYmVmb3JlVGFnLnRyaW1FbmQoKSArIGFmdGVyVGFnLnRyaW1TdGFydCgpO1xuXHRcdFx0XHQgICAgfSBlbHNlIHtcblx0XHRcdFx0ICAgICAgICAvLyBJZiB0aGVyZSdzIG5vIGxlYWRpbmcgc3BhY2UgaW4gYWZ0ZXJUYWcgb3Igc3BlY2lhbCBoYW5kbGluZyBmb3IgcHVuY3R1YXRpb24gaXNuJ3QgbmVlZGVkLCBjb25jYXRlbmF0ZSBkaXJlY3RseVxuXHRcdFx0XHQgICAgICAgIG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZztcblx0XHRcdFx0ICAgIH1cblxuXHRcdFx0XHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSBcblx0XHRcdFx0XHRcdCYmIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpIHsgXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiAnICsgdGFnICsgJyByZW1vdmVkLicpOyBcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gXG5cdFx0XHRcblx0XHRcdGlmICh0YWdFbC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PSAncGx1Z2luLXN1bW1hcnknKSB7XG5cdFx0XHQvLyBjYW4gd2UgYmUgdXNpbmcgdGFnQ29udGFpbmVyVHlwZSBmcm9tIGFib3ZlP1xuXG5cdFx0XHRcdC8vIFNhZmV0eSBjaGVjayAxXG5cdFx0XHRcdGNvbnN0IHN1bW1hcnlFbCA9IHRhZ0VsLmNsb3Nlc3QoJy50YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblx0XHRcdFx0Y29uc3QgbWRTb3VyY2UgPSBzdW1tYXJ5RWwuZ2V0QXR0cmlidXRlKCdtZC1zb3VyY2UnKS50cmltKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGV4dCA9IFV0aWxzLmVzY2FwZVJlZ0V4cChtZFNvdXJjZSk7XG5cdFx0XHRcdGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChlc2NhcGVkVGV4dCwgJ2cnKTtcblx0XHRcdFx0Y29uc3QgbWF0Y2hlcyA9IGZpbGVDb250ZW50Lm1hdGNoKHJlZ2V4KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoID4gMSkge1xuXHRcdFx0XHQgICAgbmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IHNhZmVseSByZW1vdmUvZWRpdCB0YWc6XFxuU3Vycm91bmRpbmcgdGV4dCByZXBlYXRlZCBpbiBzb3VyY2Ugbm90ZS4nKTtcblx0XHRcdFx0ICAgIHJldHVybjtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoID09PSAwKSB8fCAhbWF0Y2hlcykge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBmaW5kIHRhZyBpbiBzb3VyY2Ugbm90ZS5cXG4nKTtcblx0XHRcdFx0ICAgIHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIFNhZmV0eSBjaGVjayAyXG5cdFx0XHRcdGlmICgobmV3Q29udGVudCA9PSAnJyAmJiAhc2FmZVRvRW1wdHlGaWxlKSBcblx0XHRcdFx0XHR8fCBVdGlscy5jb250ZW50Q2hhbmdlZFRvb011Y2goXG5cdFx0XHRcdFx0XHRmaWxlQ29udGVudEJhY2t1cCwgXG5cdFx0XHRcdFx0XHRuZXdDb250ZW50LCBcblx0XHRcdFx0XHRcdHRhZywgXG5cdFx0XHRcdFx0XHQyKVxuXHRcdFx0XHRcdCkgXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IEZpbGUgY2hhbmdlIGVycm9yLicpO1xuXHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBmaWxlQ29udGVudEJhY2t1cDtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKG5ld0NvbnRlbnQgPT0gJycgJiYgc2FmZVRvRW1wdHlGaWxlKSB7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBUYWcgcmVtb3ZlZC4gVGhlIG5vdGUgaXMgZW1wdHkuJyk7XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zdCB0YWdQYXJhZ3JhcGhFbCA9IHRhZ0VsLmNsb3Nlc3QoJy50YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblx0XHRcdFx0XHRjb25zdCB0YWdTdW1tYXJ5QmxvY2sgPSB0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKTtcblx0XHRcdFx0XHRjb25zdCB0YWdzVG9DaGVjayA9IFRhZ1N1bW1hcnkuZ2V0VGFnc1RvQ2hlY2tGcm9tRWwodGFnU3VtbWFyeUJsb2NrKTtcblx0XHRcdFx0XHRjb25zdCB0YWdzSW5Db250ZW50ID0gVXRpbHMudGFnc0luU3RyaW5nKHRhZ1BhcmFncmFwaEVsLmlubmVyVGV4dCk7XG5cblx0XHRcdFx0XHRpZiAodGFnc1RvQ2hlY2suaW5jbHVkZXModGFnKSkge1xuXHRcdFx0XHRcdFx0Y29uc3QgdGFnQ291bnQgPSBVdGlscy5jb3VudE9jY3VycmVuY2VzKHRhZ3NUb0NoZWNrLCB0YWdzSW5Db250ZW50KVxuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRpZiAodGFnQ291bnQgPj0gMikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZSh0YWdTdW1tYXJ5QmxvY2spOyBcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdC8vY29uc29sZS5sb2coJ2xhc3Qgb25lLCB3aWxsIHJlbW92ZSBwYXJhZ3JhcGgnKVxuXHRcdFx0XHRcdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICh0YWcgKyAnIHJlbW92ZWQgZnJvbSBwYXJhZ3JhcGguXFxuXHVEODNEXHVERDE3IE9wZW4gc291cmNlIG5vdGUuJywgNTAwMCk7XG5cdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkucmVtb3ZlRWxlbWVudFdpdGhBbmltYXRpb24oXG5cdFx0XHRcdFx0XHRcdFx0dGFnUGFyYWdyYXBoRWwsIFxuXHRcdFx0XHRcdFx0XHRcdCgpID0+IHtcblx0XHRcdCAgICBcdFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0ICAgIFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnRhZ1N1bW1hcnkudXBkYXRlKHRhZ1N1bW1hcnlCbG9jayk7IFxuXHRcdFx0ICAgIFx0XHRcdFx0XHRcdHRhZ1BhcmFncmFwaEVsLnJlbW92ZSgpOyBcblx0XHQgICAgXHRcdFx0XHRcdFx0fSwgNTAwKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdFx0XHRcdFx0XHRub3RpY2Uubm90aWNlRWwsIFxuXHRcdFx0XHRcdFx0XHRcdCdjbGljaycsIFxuXHRcdFx0XHRcdFx0XHRcdChlOiBFdmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0IFx0IFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGZpbGVQYXRoLCAnJyk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQpO1xuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnRhZ1N1bW1hcnkudXBkYXRlKHRhZ1N1bW1hcnlCbG9jayk7IFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0fSBlbHNlIGlmICh0YWdFbC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PSAnbmF0aXZlLWVtYmVkJykge1xuXG5cdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IucHJvY2Vzc05hdGl2ZUVtYmVkKHRhZ0NvbnRhaW5lciwgdHJ1ZSk7XG5cdFx0XHRcdH0sIDIwMClcblxuXHRcdFx0fVxuXG5cdFx0XHR0cnkge1xuXG4gXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0dHJ5IHtcblxuXHRcdFx0XHRcdGNvbnN0IGJhY2t1cEZpbGVOYW1lID0gU3RyaW5nKGZpbGUubmFtZS5zdWJzdHJpbmcoMCwgZmlsZS5uYW1lLmluZGV4T2YoJy5tZCcpKSArICcgQkFDS1VQLm1kJyk7XG5cdFx0XHRcdFx0dGhpcy5hcHAudmF1bHQuY3JlYXRlKGJhY2t1cEZpbGVOYW1lLCBmaWxlQ29udGVudEJhY2t1cCk7XG5cblx0XHRcdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgVGFnL25vdGUgZWRpdGluZyBlcnJvcjogJyArIGVycm9yLm1lc3NhZ2UgKyAnXFxuJyArIGJhY2t1cEZpbGVOYW1lICsgJyBzYXZlZCB0byB2YXVsdCByb290LicsIDEwMDAwKTtcblx0XHRcdFx0XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmaWxlQ29udGVudEJhY2t1cCk7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIFRhZy9ub3RlIGVkaXRpbmcgZXJyb3I6ICcgKyBlcnJvci5tZXNzYWdlICsgJ1xcbk5vdGUgY29udGVudCBjb3BpZWQgdG8gY2xpcGJvYXJkLicsIDEwMDAwKTtcblxuXHRcdFx0XHR9XG5cdFx0XHR9IFxuXG5cdFx0XHR0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IuZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHMoKTtcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBpZGVudGlmeSB0YWcgbG9jYXRpb24uIFBsZWFzZSB0cnkgYWdhaW4uJyk7XG5cdFx0fVxuXHR9XG5cbn0iLCAiaW1wb3J0IFRhZ0J1ZGR5IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBBcHAsIFBsdWdpbiB9IGZyb20gJ29ic2lkaWFuJztcblxuXG5leHBvcnQgY2xhc3MgRG91YmxlVGFwSGFuZGxlciB7XG5cdFxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IFRhZ0J1ZGR5LCBlbGVtZW50OiBIVE1MRWxlbWVudCwgY2FsbGJhY2s6IEZ1bmN0aW9uKXtcblx0ICAgIHRoaXMucGx1Z2luID0gcGx1Z2luOyAvLyBTdG9yZSB0aGUgcGx1Z2luIGluc3RhbmNlXG5cdCAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHQgICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuXHQgICAgdGhpcy5sYXN0VGFwID0gMDtcblx0ICAgIFxuXHQgICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChcblx0ICAgIFx0dGhpcy5lbGVtZW50LFxuXHQgICAgXHQndG91Y2hlbmQnLCBcblx0ICAgIFx0dGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLCBcblx0ICAgIFx0dHJ1ZVxuICAgIFx0KTtcblx0ICB9XG5cblx0ICBoYW5kbGVUb3VjaEVuZChldmVudDogRXZlbnQpIHtcblx0ICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdCAgICBjb25zdCB0YXBMZW5ndGggPSBjdXJyZW50VGltZSAtIHRoaXMubGFzdFRhcDtcblx0ICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuXHQgICAgaWYgKHRhcExlbmd0aCA8IDUwMCAmJiB0YXBMZW5ndGggPiAwKSB7XG5cdCAgICAgIHRoaXMuY2FsbGJhY2soZXZlbnQpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdCAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG5cdCAgICAgIH0sIDUwMCk7XG5cdCAgICB9XG5cdCAgICB0aGlzLmxhc3RUYXAgPSBjdXJyZW50VGltZTtcblx0ICB9XG59XG5cbmV4cG9ydCBjbGFzcyBUcmlwbGVUYXBIYW5kbGVyIHtcblx0XG4gIHByaXZhdGUgcGx1Z2luOiBhbnk7XG4gIHByaXZhdGUgZWxlbWVudDogSFRNTEVsZW1lbnQ7XG4gIHByaXZhdGUgY2FsbGJhY2s6IEZ1bmN0aW9uO1xuICBwcml2YXRlIGxhc3RUYXA6IG51bWJlcjtcbiAgcHJpdmF0ZSB0aW1lb3V0OiBhbnk7XG4gIHByaXZhdGUgdGFwQ291bnQ6IG51bWJlcjtcblxuICBjb25zdHJ1Y3RvcihwbHVnaW46IGFueSwgZWxlbWVudDogSFRNTEVsZW1lbnQsIGNhbGxiYWNrOiBGdW5jdGlvbil7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47IC8vIFN0b3JlIHRoZSBwbHVnaW4gaW5zdGFuY2VcbiAgICB0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgICB0aGlzLmxhc3RUYXAgPSAwO1xuICAgIHRoaXMudGFwQ291bnQgPSAwOyAvLyBJbml0aWFsaXplIHRhcCBjb3VudFxuICAgIFxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQoXG4gICAgICB0aGlzLmVsZW1lbnQsXG4gICAgICAndG91Y2hlbmQnLCBcbiAgICAgIHRoaXMuaGFuZGxlVG91Y2hFbmQuYmluZCh0aGlzKSwgXG4gICAgICB0cnVlXG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZVRvdWNoRW5kKGV2ZW50OiBFdmVudCkge1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgdGFwTGVuZ3RoID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUYXA7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgXG4gICAgaWYgKHRhcExlbmd0aCA8IDUwMCAmJiB0YXBMZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLnRhcENvdW50Kys7IC8vIEluY3JlbWVudCB0YXAgY291bnRcblxuICAgICAgLy8gSWYgdHJpcGxlIHRhcCBpcyBkZXRlY3RlZCwgdHJpZ2dlciB0aGUgY2FsbGJhY2sgYW5kIHJlc2V0IHRhcENvdW50XG4gICAgICBpZiAodGhpcy50YXBDb3VudCA9PT0gMikge1xuICAgICAgICB0aGlzLmNhbGxiYWNrKGV2ZW50KTtcbiAgICAgICAgdGhpcy50YXBDb3VudCA9IDA7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudGFwQ291bnQgPSAwOyAvLyBSZXNldCB0YXAgY291bnQgaWYgdGltZSBiZXR3ZWVuIHRhcHMgaXMgdG9vIGxvbmdcbiAgICB9XG5cbiAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgdGhpcy50YXBDb3VudCA9IDA7IC8vIFJlc2V0IHRhcCBjb3VudCB3aGVuIHRpbWVvdXQgaXMgcmVhY2hlZFxuICAgIH0sIDUwMCk7XG5cbiAgICB0aGlzLmxhc3RUYXAgPSBjdXJyZW50VGltZTtcbiAgfVxufVxuXG5cbmV4cG9ydCBjbGFzcyBQcmVzc0FuZEhvbGRIYW5kbGVyIHtcblx0XG5cdGNvbnN0cnVjdG9yKFxuXHRcdHBsdWdpbjogVGFnQnVkZHksIFxuXHRcdGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBcblx0XHRjYWxsYmFjazogRnVuY3Rpb24sIFxuXHRcdGR1cmF0aW9uOiBudW1iZXIgPSA2MDBcblx0KXtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmVsZW1lbnQgPSBlbGVtZW50O1xuXHRcdHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcblx0XHR0aGlzLmR1cmF0aW9uID0gZHVyYXRpb247IFxuXHRcdHRoaXMudGltZW91dCA9IG51bGw7XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0dGhpcy5lbGVtZW50LCBcblx0XHRcdCd0b3VjaHN0YXJ0JywgXG5cdFx0XHR0aGlzLmhhbmRsZVRvdWNoU3RhcnQuYmluZCh0aGlzKSwgXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0dGhpcy5lbGVtZW50LCBcblx0XHRcdCd0b3VjaGVuZCcsIFxuXHRcdFx0dGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLCBcblx0XHRcdHRydWVcblx0XHQpO1xuXHR9XG5cblx0aGFuZGxlVG91Y2hTdGFydChldmVudDogRXZlbnQpIHtcblx0XHQvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0Ly9ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHR0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdHRoaXMuY2FsbGJhY2soZXZlbnQpO1xuXHRcdFx0dGhpcy50aW1lb3V0ID0gbnVsbDtcblx0XHR9LCB0aGlzLmR1cmF0aW9uKTtcblx0fVxuXG5cdGhhbmRsZVRvdWNoRW5kKGV2ZW50OiBFdmVudCkge1xuXHRcdGlmICh0aGlzLnRpbWVvdXQpIHtcblx0XHRcdGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuXHRcdFx0dGhpcy50aW1lb3V0ID0gbnVsbDtcblx0XHR9XG5cdH1cbn1cbiJdLAogICJtYXBwaW5ncyI6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Q0Q7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJwYXJhZ3JhcGhFbCIsICJhcHAiLCAiYXBwIiwgImZpbGVQYXRoIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJ0YWdFbCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2VsZWN0RmlsZU1vZGFsIiwgImFwcCIsICJhcHAiLCAidGFnRWwiLCAicGFyYWdyYXBoRWwiLCAiU2VsZWN0RmlsZU1vZGFsIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAicGFyYWdyYXBoRWwiLCAidGFnRWwiLCAiZSIsICJub3RpY2UiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJwYXJhZ3JhcGhFbCIsICJ0YWdFbCIsICJUZW1wQ29tcG9uZW50IiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAidGFnRWwiLCAiZXJyb3IiXQp9Cg==
