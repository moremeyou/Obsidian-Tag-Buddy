/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TagBuddy
});
module.exports = __toCommonJS(main_exports);
var import_obsidian10 = require("obsidian");

// settings.ts
var import_obsidian = require("obsidian");
var TBSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Override native tag search on click").setDesc("Toggle OFF to use CTRL/CMD+CLICK to remove tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeOnClick).onChange(async (value) => {
        this.plugin.settings.removeOnClick = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Convert to tag text (removes #)").setDesc("Toggle OFF to use OPT/ALT+CLICK to perform native tag search.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.optToConvert).onChange(async (value) => {
        this.plugin.settings.optToConvert = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Remove nested tags first").setDesc("Toggle OFF to use SHIFT+CLICK to remove nested tags first.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeChildTagsFirst).onChange(async (value) => {
        this.plugin.settings.removeChildTagsFirst = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Mobile tag search").setDesc("Toggle ON to restore mobile native tag search on tap. Tag removal will then use LONG PRESS.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileTagSearch).onChange(async (value) => {
        this.plugin.settings.mobileTagSearch = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show mobile notices").setDesc("Toggle OFF to hide notices when editing or removing a tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileNotices).onChange(async (value) => {
        this.plugin.settings.mobileNotices = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show tag summary paragraph buttons").setDesc("Show buttons below each tagged paragraph that let you copy, remove, and move the paragraph.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.tagSummaryBlockButtons).onChange(async (value) => {
        this.plugin.settings.tagSummaryBlockButtons = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show tag summary buttons").setDesc("Show buttons below each summary that let you copy or make a note from the summary.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showSummaryButtons).onChange(async (value) => {
        this.plugin.settings.showSummaryButtons = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Copy to section prefix").setDesc("When moving a tagged paragraph from tag summaries below note header sections use this prefix:\nExample: '- ', '> ', '- [ ]'").addText((text) => {
      text.setPlaceholder(this.plugin.settings.taggedParagraphCopyPrefix).setValue(this.plugin.settings.taggedParagraphCopyPrefix).onChange(async (value) => {
        this.plugin.settings.taggedParagraphCopyPrefix = value;
        await this.plugin.saveSettings();
      });
    });
    function isValidTag(tag) {
      const tagPattern = /^#[\w]+$/;
      return tagPattern.test(tag);
    }
    function filterAndJoinTags(tagsString) {
      const tagsArray = tagsString.split(", ");
      const validTags = tagsArray.filter(isValidTag);
      return validTags.join(", ");
    }
    new import_obsidian.Setting(containerEl).setName("Recent tags").setDesc("The most recent tags added via Tag Buddy are stored here. These will show up first in the list when adding.").addText((text) => {
      text.setPlaceholder(this.plugin.settings.recentlyAddedTags).setValue(this.plugin.settings.recentlyAddedTags).onChange(async (value) => {
        this.plugin.settings.recentlyAddedTags = filterAndJoinTags(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Lock recent tags").setDesc("Toggle ON to lock the recent tags list. Recent tags will not be updated. Instead, the tags above will act like a favorites list.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.lockRecentTags).onChange(async (value) => {
        this.plugin.settings.lockRecentTags = value;
        await this.plugin.saveSettings();
      })
    );
    containerEl.createEl("hr");
    containerEl.createEl("h1", { text: "Support a buddy" });
    const donateLink = containerEl.createEl("a");
    donateLink.setAttribute("href", "https://www.buymeacoffee.com/moremeyou");
    const donateButton = createEl("img");
    donateButton.setAttribute("src", "https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png");
    donateButton.setAttribute("alt", "Buy Me A Coffee");
    donateButton.style = "height: 40px !important;width: 150px !important;";
    donateLink.appendChild(donateButton);
    containerEl.createEl("br");
    containerEl.createEl("br");
    containerEl.createEl("br");
    new import_obsidian.Setting(containerEl).setName("Debug mode").setDesc("Output to console.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
        this.plugin.settings.debugMode = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// gui.ts
var import_obsidian6 = require("obsidian");

// utils.ts
var import_obsidian2 = require("obsidian");
function getTagElement(paragraphEl, tagText) {
  const els = paragraphEl.querySelectorAll(".tag");
  let tagElText = "";
  let tagElHasSub;
  for (let el of els) {
    tagElText = el.innerText.trim();
    if (tagElText === tagText) {
      return el;
    }
  }
  return null;
}
function isWordNearEnd(str, word, charDistance = 0) {
  const lastIndex = str.lastIndexOf(word);
  if (lastIndex === -1)
    return false;
  const wordEndIndex = lastIndex + word.length;
  const distanceToEnd = str.length - wordEndIndex;
  return distanceToEnd === 0 || distanceToEnd <= charDistance;
}
function getWordObjFromString(sourceText, offset) {
  let wordRegex = /[^\s]+(?=[.,:!?]?(\s|$))/g;
  let match;
  let index;
  let word = null;
  while ((match = wordRegex.exec(sourceText)) !== null) {
    if (match.index <= offset && offset <= match.index + match[0].length) {
      word = match[0];
      index = match.index;
      break;
    }
  }
  return {
    text: word,
    index
  };
}
function getClickedTextObjFromDoc(x, y, minNodeLength = 10) {
  let range, nodeText, offset;
  if (document.caretRangeFromPoint) {
    range = document.caretRangeFromPoint(x, y);
    if (range.startContainer.nodeType === Node.TEXT_NODE) {
      nodeText = range.startContainer.nodeValue.trim();
    } else {
      return null;
    }
    offset = range.startOffset;
  }
  if (nodeText.length < minNodeLength) {
    return null;
  }
  return {
    text: nodeText,
    index: offset,
    el: range.startContainer.parentNode
  };
}
function getMarkdownHeadings(bodyLines, headingFilter = "") {
  const headers = [];
  let accumulatedIndex = 0;
  bodyLines.forEach((line, index) => {
    const match = line.match(/^(#+)[\s]?(.*)$/);
    if (match && (headingFilter == "" || match[2] == headingFilter)) {
      headers.push({
        fullText: match[0],
        level: match[1].length,
        text: match[2],
        line: index,
        startIndex: accumulatedIndex,
        endIndex: accumulatedIndex + match[0].length - 1
      });
    }
    accumulatedIndex += line.length + 1;
  });
  return headers;
}
function fileContainsHeading(fileContent, heading) {
  const fileContentLines = getLinesInString(fileContent);
  const mdHeadings = getMarkdownHeadings(fileContentLines, heading);
  return mdHeadings.length > 0;
}
function findFirstLineAfterFrontMatter(markdown) {
  const lines = getLinesInString(markdown);
  let inFrontMatter = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i].trim();
    if (line === "---") {
      inFrontMatter = !inFrontMatter;
      if (!inFrontMatter) {
        return i;
      }
    }
  }
  return 0;
}
function getLinesInString(input) {
  const lines = input.split("\n");
  if (lines.length > 0 && lines[lines.length - 1] === "") {
    lines.pop();
  }
  return lines;
}
function insertTextAfterLine(text, body, line, filePath) {
  const splitContent = body.split("\n");
  const pre = splitContent.slice(0, line + 1).join("\n");
  const post = splitContent.slice(line + 1).join("\n");
  return `${pre}
${text}
${post}`;
}
function getListTypeFromLineNumber(fullText, lineNumber) {
  const lines = fullText.split("\n");
  if (lineNumber >= 0 && lineNumber < lines.length) {
    const line = lines[lineNumber];
    const leadingWhitespace = line.match(/^\s*/)[0];
    if (/^\s*-\s\[\s\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s\[x\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s/.test(line)) {
      return leadingWhitespace + "- ";
    } else if (/^\s*\d+\.\s/.test(line)) {
      const num = parseInt(line.match(/^\s*(\d+)\./)[1], 10);
      return leadingWhitespace + `${num}. `;
    } else if (/^\s*>\s/.test(line)) {
      return leadingWhitespace + "> ";
    }
  } else {
  }
  return "";
}
function removeTagFromString(inputText, hashtagToRemove, all = true) {
  const regex = new RegExp(
    "\\s?" + hashtagToRemove.replace(/#/g, "\\#") + "(?!\\w|\\/)",
    all ? "gi" : "i"
  );
  return inputText.replace(regex, "").trim();
}
function insertTextInString(newText, sourceText, charPos) {
  return sourceText.substring(0, charPos) + newText + " " + sourceText.substring(charPos);
}
function replaceTextInString(replaceText, sourceText, newText, all = false) {
  const escapedReplaceText = escapeRegExp(replaceText.trim()).replace(/\n/g, "\\s*\\n\\s*");
  const regex = new RegExp(escapedReplaceText, all ? "gsi" : "si");
  return sourceText.trim().replace(regex, newText.trim()).trim();
}
function truncateStringAtWord(str, maxChars = 16) {
  if (str.length <= maxChars)
    return str;
  let truncated = str.substr(0, maxChars);
  const lastSpace = truncated.lastIndexOf(" ");
  if (lastSpace > 0)
    truncated = truncated.substr(0, lastSpace);
  return truncated;
}
function contentChangedTooMuch(original, modified, tag, buffer = 5) {
  const expectedChange = tag.length;
  const threshold = expectedChange + buffer;
  const actualChange = Math.abs(original.length - modified.length);
  return actualChange > threshold;
}
function fileObjFromTags(tags) {
  let tagsArray = tags.map((tag) => tag.replace(/#/g, "").toLowerCase());
  tagsArray = tagsArray.filter((tag, index, self) => self.indexOf(tag) === index);
  const tagsPart = tagsArray.join("+");
  const currentDate = /* @__PURE__ */ new Date();
  const datePart = currentDate.getDate().toString().padStart(2, "0") + "-" + (currentDate.getMonth() + 1).toString().padStart(2, "0") + "-" + currentDate.getFullYear().toString().slice(-2);
  const fileName = `Tag Summary (${datePart}).md`;
  const titleTagsPart = tagsArray.map((tag) => tag.charAt(0).toUpperCase() + tag.slice(1)).join(" + ");
  const title = `${titleTagsPart} Tag Summary`;
  return {
    fileName,
    title
  };
}
function getActiveFileFolder(activeFile) {
  if (!activeFile)
    return null;
  if (activeFile.path.includes("\\") || activeFile.path.includes("/")) {
    const pathSeparator = activeFile.path.includes("\\") ? "\\" : "/";
    const pathParts = activeFile.path.split(pathSeparator);
    pathParts.pop();
    let folderPath2 = pathParts.join(pathSeparator);
    if (!folderPath2.endsWith(pathSeparator)) {
      folderPath2 += pathSeparator;
    }
  } else {
    folderPath = "";
  }
  return folderPath;
}
function getTagsFromApp(app2, recentTags) {
  const tagsObject = app2.metadataCache.getTags();
  const tagsArray = Object.entries(tagsObject);
  tagsArray.sort((a, b) => b[1] - a[1]);
  if (recentTags.length > 0) {
    const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
    const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
    return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
  } else {
    return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
  }
}
async function validateFilePath(filePath) {
  const matchingFiles = await app.vault.getFiles().filter((file) => file.name === filePath);
  if (matchingFiles.length === 1) {
    const filePath2 = matchingFiles[0].path;
    const file = await this.app.vault.getAbstractFileByPath(filePath2);
    return file;
  } else if (matchingFiles.length > 1) {
    new Notice("Tag Buddy: Multiple files found with the same name. Can't safely edit tag.");
    return null;
  } else {
    new Notice("Tag Buddy: No file found. Try again, or this tag might be in an unsupported embed type.");
    return null;
  }
}
function ctrlCmdKey(event) {
  const isMac = import_obsidian2.Platform.isMacOS;
  if (isMac)
    return event.metaKey;
  else
    return event.ctrlKey;
}
function tagsInString(string, tag) {
  let regex;
  if (tag) {
    regex = new RegExp(tag.replace(/\//g, "\\/") + "(?![\\w\\/\\#])", "g");
  } else {
    regex = /#(\w+)(?![\w\/#])/g;
  }
  const matches = string.match(regex);
  return matches || [];
}
function countOccurrences(summaryTags, contentTags) {
  let count = 0;
  for (let tag of summaryTags) {
    count += contentTags.filter((item) => item === tag).length;
  }
  return count;
}
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
async function getEmbedFile(el) {
  let filePath = el.getAttribute("src");
  const linkArray = filePath.split("#");
  filePath = linkArray[0].trim() + ".md";
  const file = await validateFilePath(filePath);
  return file;
}
function isTagValid(tag, fullTag = false) {
  let tagPattern;
  if (fullTag)
    tagPattern = /^#[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  else
    tagPattern = /^[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  return tagPattern.test(tag);
}
function extractValidTags(tagsString) {
  const potentialTags = tagsString.split(",");
  const validTags = potentialTags.map((tag) => tag.trim()).filter((tag) => isTagValid(tag, true));
  return validTags;
}

// Modal.ts
var import_obsidian3 = require("obsidian");
var TagSelector = class extends import_obsidian3.FuzzySuggestModal {
  constructor(app2, plugin, event, onChooseItemCallback) {
    super(app2);
    this.height = 215;
    this.noSelection = false;
    this.app = app2;
    this.plugin = plugin;
    this.tag = "";
    this.onChooseItemCallback = onChooseItemCallback;
    this.inputListener = this.listenInput.bind(this);
    this.tagCache = [];
    if (event != null)
      this.location = { x: event.pageX, y: event.pageY };
  }
  onOpen() {
    this.setPlaceholder("");
    this.inputEl.addEventListener("keyup", this.inputListener);
    if (!this.app.isMobile) {
      this.resultContainerEl.parentNode.style.width = "200px";
      this.resultContainerEl.style.height = "215px";
      this.resultContainerEl.parentNode.style.left = `${this.location.x}px`;
      this.resultContainerEl.parentNode.style.top = `${this.location.y}px`;
    } else {
      setTimeout(() => {
        this.inputEl.focus();
      }, 500);
    }
    super.onOpen();
  }
  onClose() {
    this.inputEl.removeEventListener("keyup", this.inputListener);
    super.onClose();
  }
  listenInput(event) {
    this.noSelection = false;
    if (!this.app.isMobile) {
      const itemsHeight = this.getSuggestions(this.inputEl.value).length * 42;
      const height = Math.min(this.height, Math.max(65, itemsHeight));
      this.resultContainerEl.style.height = `${height}px`;
    }
    if (event.key == "Enter" && !this.noSelection) {
      const text = this.inputEl.value.trim();
      const pattern = /(?=[^\d\s]+)[a-zA-Z0-9_\-\/]+/g;
      if (pattern.test(text)) {
        this.close();
        this.onChooseItem(this.inputEl.value);
      } else {
        new import_obsidian3.Notice("Invalid tag.");
      }
    }
  }
  /*getSuggestions(query: string) : string[]{
          const filteredTags = Utils.getTagsFromApp(
              this.app, 
              this.plugin.getRecentTags()).filter(tag => 
              //tag.toLowerCase().includes(query.toLowerCase())
              query == '' ? true : tag.toLowerCase() == query.toLowerCase()
          );
          return filteredTags;
      }
  
      renderSuggestion(header: string, el: HTMLElement) {
          el.createEl("div", { text: header });
      }*/
  onNoSuggestion() {
    super.onNoSuggestion();
    this.noSelection = true;
  }
  getItems() {
    const filteredTags = getTagsFromApp(
      this.app,
      this.plugin.getRecentTags()
    );
    return filteredTags;
  }
  getItemText(tag) {
    return tag;
  }
  async onChooseItem(result) {
    if (!this.app.isMobile) {
      this.onChooseItemCallback(result);
    } else {
      setTimeout(() => {
        this.onChooseItemCallback(result);
      }, 250);
    }
  }
};

// TagEditorModal.ts
var import_obsidian4 = require("obsidian");
var TBTagEditorModal = class extends import_obsidian4.Modal {
  //constructor(app: App, tag: String, onSubmit: (result: string) => void) {
  constructor(app2, plugin, tag) {
    super(app2);
    this.settings = {
      originalTag: "",
      vaultToggle: false,
      newName: "",
      summaryPos: "top",
      action: "rename"
    };
    this.plugin = plugin;
    this.settings.originalTag = tag;
  }
  onOpen() {
    let { contentEl, titleEl, modalEl, containerEl } = this;
    titleEl.setText("Tag Actions");
    this.editDiv = createEl("div");
    this.editDiv.classList.add("tag-editor-edit-div");
    this.optionsDiv = createEl("div");
    this.optionsDiv.classList.add("tag-editor-options");
    this.input = new import_obsidian4.TextComponent(this.editDiv);
    this.input.inputEl.classList.add("tag-editor-input");
    this.tagActionDropdown = new import_obsidian4.DropdownComponent(this.editDiv).addOption("rename", "Rename").addOption("lower", "Convert to lower case").addOption("totext", "Remove hash (#)").addOption("summary", "Create summary");
    this.tagActionDropdown.selectEl.classList.add("tag-editor-dropdown");
    contentEl.appendChild(this.editDiv);
    contentEl.appendChild(this.optionsDiv);
    this.showEditTagOptions("rename");
    const hr = createEl("hr");
    hr.classList.add("tag-editor-hr");
    contentEl.appendChild(hr);
    this.tagActionDropdown.onChange((value) => {
      this.settings.action = value;
      if (value == "summary") {
        this.showSummaryOptions();
      } else {
        this.showEditTagOptions(value);
      }
    });
    const submitBtn = new import_obsidian4.ButtonComponent(contentEl).setClass("tag-editor-submit").setButtonText("Submit").onClick(
      (evt) => {
        this.submitTagEdit();
      }
    );
  }
  submitTagEdit() {
    const isValidTag = isTagValid(this.settings.newName.trim(), true);
    const action = this.settings.action;
    let newName = this.settings.originalTag;
    if (action == "summary") {
      const summaryTags = extractValidTags(this.input.getValue());
      if (summaryTags.length < 1) {
        new import_obsidian4.Notice("Invalid tag format.");
      } else {
        this.plugin.tagSummary.createCodeBlock(summaryTags, this.settings.summaryPos);
        this.close();
      }
    } else if (action == "rename" && !isValidTag) {
      new import_obsidian4.Notice("Invalid tag format.");
    } else {
      if (action == "rename")
        newName = this.settings.newName;
      else if (action == "lower")
        newName = this.settings.originalTag.toLowerCase();
      else if (action == "totext")
        newName = this.settings.originalTag.substring(1);
      this.plugin.tagEditor.renameTag(
        this.settings.originalTag,
        newName,
        this.settings.vaultToggle
      );
      this.close();
    }
  }
  /*
      } else if (vaultToggle) {
          
          // make this into a function // call it from the action function
          contentEl.empty();
          titleEl.setText("Applying edit")
          //submitBtn.setDisabled(true)
          const editProgress = new ProgressBarComponent (contentEl)
          editProgress.setValue(75)
  
          const submitBtn = new ButtonComponent(contentEl)
          .setClass ('tag-editor-submit')
          .setButtonText('Cancel')
          .onClick ((evt) => {
                 // validate
                 console.log('cancel');
                 //submitTagEdit()
              }
          )
          // close when done
      } else {
          // do it
          modal.close();
      }*/
  /*inputChangeHandler (value: String, editType: String) {
          console.log(value);
  
          if (editType == 'rename') {
              // validate
              this.settings.newName = value;
              //console.log(this.settings.newName)
          }
      }*/
  showSummaryOptions() {
    this.optionsDiv.empty();
    this.input.setDisabled(false);
    new import_obsidian4.Setting(this.optionsDiv).setName("Where do you want to add the tag summary?").setDesc("Add multiple tags above separated by a comma.").addDropdown(
      (opt) => opt.addOption("top", "Top of this note").addOption("end", "Bottom of this note").addOption("note", "In a new note").onChange(
        (value) => {
          this.settings.summaryPos = value;
        }
      )
    );
  }
  showEditTagOptions(editType) {
    this.optionsDiv.empty();
    this.input.setValue(this.settings.originalTag);
    this.input.setDisabled(true);
    if (editType == "rename") {
      const newName = new import_obsidian4.Setting(this.optionsDiv).setName("New name").setDesc("Tags can include letters, numbers, underscores (_), hyphens (-), and forward slashes (/) for nested tags.").addText(
        (opt) => opt.setValue("").onChange(
          (value) => {
            this.settings.newName = value;
          }
        )
      );
    }
    const whereEditOpt = new import_obsidian4.Setting(this.optionsDiv).setName("Where to make this change?").addDropdown(
      (opt) => opt.addOption("note", "Just within this note").addOption("vault", "Across entire vault").onChange((value) => {
        if (value == "vault") {
          whereEditOpt.setDesc("WARNING: There is NO UNDO for vault changes. Consider making a backup of your vault first.");
          this.settings.vaultToggle = true;
        } else {
          whereEditOpt.setDesc("");
          this.settings.vaultToggle = false;
        }
      })
    );
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// FindFileModal.ts
var import_obsidian5 = require("obsidian");
var SelectFileModal2 = class extends import_obsidian5.SuggestModal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
    this.fileList = this.app.vault.getMarkdownFiles();
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    return this.fileList.filter(
      (file) => file.path.includes(query)
    );
  }
  // Renders each suggestion item.
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.name });
    el.createEl("small", { text: file.path });
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(file, evt) {
    this.onSubmit(file);
  }
  //onNoSuggestion(file: TFile, evt: MouseEvent | KeyboardEvent) {
  //new Notice(`No selection`);
  //this.onSubmit(file)
  //}
};

// gui.ts
var GUI = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  showTagEditor(tag = "") {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (this.app.isMobile) {
    } else {
    }
    if (mode == "preview") {
      const tagEditorModal = new TBTagEditorModal(
        this.app,
        this.plugin,
        tag
        //,
        //(tag)=>{
        //	console.log(tag) 
        //}
      ).open();
    }
  }
  isTagValid(tag) {
    const tagPattern = /^#[\w]+$/;
    return tagPattern.test(tag);
  }
  makeButton(lable, clickFn, classId = "tagsummary-button") {
    const button = createEl("button");
    (0, import_obsidian6.setIcon)(button, lable);
    button.className = classId;
    this.plugin.registerDomEvent(
      button,
      "click",
      clickFn
    );
    return button;
  }
  makeBlockSelector(index) {
    const checkboxEl = createEl("div");
    checkboxEl.setAttribute("index", index);
    let checkedBtn;
    let uncheckedBtn;
    const checkBox = function(bool) {
      this.plugin.tagSummary.updateSelection(parseInt(checkboxEl.getAttribute("index")), bool);
      if (bool) {
        uncheckedBtn.remove();
        checkboxEl.appendChild(checkedBtn);
      } else {
        checkedBtn.remove();
        checkboxEl.appendChild(uncheckedBtn);
      }
    }.bind(this);
    checkedBtn = this.makeButton("check-square", (e) => {
      e.stopPropagation();
      checkBox(false);
    }, "tagsummary-button tagsummary-checkbox checked");
    checkedBtn.title = "Unselect this paragraph.";
    uncheckedBtn = this.makeButton("square", (e) => {
      e.stopPropagation();
      checkBox(true);
    }, "tagsummary-button tagsummary-checkbox");
    uncheckedBtn.title = "Select this paragraph.";
    checkBox(false);
    return checkboxEl;
  }
  makeRemoveTagButton(clickFn, paragraphEl, tag) {
    const button = this.makeButton("list-x", (e) => {
      e.stopPropagation();
      clickFn(e, paragraphEl, tag);
    });
    button.title = "Removed " + tag + " from paragraph.";
    return button;
  }
  makeSummaryRefreshButton(summaryEl) {
    const button = this.makeButton(
      "refresh-ccw",
      (e) => {
        e.stopPropagation();
        this.plugin.tagSummary.update(summaryEl);
        new import_obsidian6.Notice("Tag Summary updated");
        setTimeout(async () => {
        }, 10);
      }
    );
    button.title = "Refresh tag summary";
    return button;
  }
  makeCopyToSection(clickFn, content, sections, tags, filePath, paragraphEl, summaryEl) {
    const copyToEl = createEl("span");
    const selectEl = createEl("selectEl");
    let dropdown = new import_obsidian6.DropdownComponent(selectEl);
    sections.forEach((sec) => {
      dropdown.addOption(sec, truncateStringAtWord(sec, 16));
    });
    dropdown.addOption("top", "Top of note");
    dropdown.addOption("end", "End of note");
    selectEl.querySelector("select").className = "tagsummary-dropdown";
    copyToEl.appendChild(
      this.makeCopyToButton(
        clickFn,
        "note",
        dropdown,
        paragraphEl,
        summaryEl,
        content,
        tags,
        filePath
      )
    );
    copyToEl.appendChild(
      this.makeCopyToButton(
        clickFn,
        "link",
        dropdown,
        paragraphEl,
        summaryEl,
        content,
        tags,
        filePath
      )
    );
    copyToEl.appendChild(
      this.makeCopyToButton(
        clickFn,
        "copy",
        dropdown,
        paragraphEl,
        summaryEl,
        content,
        tags,
        filePath
      )
    );
    copyToEl.appendChild(
      this.makeCopyToButton(
        clickFn,
        "move",
        dropdown,
        paragraphEl,
        summaryEl,
        content,
        tags,
        filePath
      )
    );
    copyToEl.appendChild(selectEl);
    return copyToEl;
  }
  makeCopyToButton(clickFn, mode, dropdown, paragraphEl, summaryEl, content, tags, filePath) {
    let buttonLabel;
    if (mode == "link")
      buttonLabel = "link";
    else if (mode == "copy")
      buttonLabel = "copy-plus";
    else if (mode == "move")
      buttonLabel = "replace";
    else if (mode == "note")
      buttonLabel = "file-plus-2";
    const button = this.makeButton(buttonLabel, (e) => {
      e.stopPropagation();
      if (mode == "note") {
        new SelectFileModal2(this.app, (result) => {
          clickFn(e, mode, dropdown, paragraphEl, summaryEl, content, tags, filePath, result);
        }).open();
      } else {
        clickFn(e, mode, dropdown, paragraphEl, summaryEl, content, tags, filePath);
      }
    });
    let buttonHoverText;
    if (mode == "link")
      buttonHoverText = "Copy paragraph link to section.";
    else if (mode == "copy")
      buttonHoverText = "Copy paragraph to section.";
    else if (mode == "move")
      buttonHoverText = "Move paragraph to section.";
    else if (mode == "note")
      buttonHoverText = "Copy paragraph to section in note.";
    button.title = buttonHoverText;
    return button;
  }
  makeBakeButton(clickFn, summaryMd, summaryEl, filePath) {
    const button = this.makeButton(
      "stamp",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, summaryEl, filePath);
      }
    );
    button.title = "Flatten summary (replaces code block).";
    return button;
  }
  makeCopyButton(clickFn, content) {
    const button = this.makeButton("clipboard-list", (e) => {
      e.stopPropagation();
      clickFn(e, content);
    });
    button.title = "Copy paragraph";
    return button;
  }
  makeCopySummaryButton(summaryMd) {
    const button = this.makeButton(
      "clipboard-list",
      (e) => {
        e.stopPropagation();
        navigator.clipboard.writeText(summaryMd);
        new import_obsidian6.Notice("Summary copied to clipboard.");
      }
    );
    button.title = "Copy summary";
    return button;
  }
  makeSummaryNoteButton(clickFn, summaryMd, tags) {
    const button = this.makeButton(
      "file-plus-2",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, tags);
      }
    );
    button.title = "Create note from summary";
    return button;
  }
  showTagSelector(event) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    let pageX, pageY;
    let nodeType;
    let deepestNode;
    let range;
    if (this.app.isMobile) {
      const touch = event.touches[0] || event.changedTouches[0];
      pageX = Math.round(touch.pageX);
      pageY = Math.round(touch.pageY);
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    } else {
      pageX = event.pageX;
      pageY = event.pageY;
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    }
    if (mode == "preview") {
      if (nodeType === Node.TEXT_NODE) {
        const tagSelector = new TagSelector(
          this.app,
          this.plugin,
          event,
          (tag) => {
            this.plugin.tagEditor.add(
              "#" + tag,
              pageX,
              pageY
              //,
              //{range: range, el: deepestNode}
            );
          }
        ).open();
      }
    }
  }
  removeElementWithAnimation(el, callback) {
    const height = el.offsetHeight;
    el.style.height = `${height}px`;
    setTimeout(() => {
      el.style.height = "0px";
      el.style.opacity = "0";
      el.style.margin = "0";
      el.style.padding = "0";
    }, 0);
    el.addEventListener(
      "transitionend",
      function onEnd() {
        el.removeEventListener("transitionend", onEnd);
        callback();
      }
    );
  }
};

// TagSummary.ts
var import_obsidian7 = require("obsidian");
var TagSummary = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  async bakeSummaryBtnHandler(summaryMd, summaryEl, filePath) {
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    if (mdSource) {
      const file = await this.app.vault.getAbstractFileByPath(filePath);
      const fileContent = await this.app.vault.read(file);
      const newFileContent = replaceTextInString(
        mdSource,
        fileContent,
        summaryMd
      );
      this.app.vault.modify(file, newFileContent);
      const notice = new import_obsidian7.Notice("Tag summary flattened to active note.");
    } else {
      new import_obsidian7.Notice("\u26A0\uFE0F Tag Buddy: Can	 find code block source. This is a BUG. \u{1FAB2}");
    }
  }
  copyBtnHandler(e, content) {
    const selection = window.getSelection().toString();
    let notice;
    if (selection != "") {
      navigator.clipboard.writeText(selection);
      notice = new import_obsidian7.Notice("Selection copied to clipboard.");
    } else {
      navigator.clipboard.writeText(content);
      notice = new import_obsidian7.Notice("Tagged paragraph copied to clipboard.");
    }
  }
  removeTagBtnHandler(e, paragraphEl, tag) {
    const tagEl = getTagElement(paragraphEl, tag);
    this.plugin.tagEditor.edit(tagEl);
  }
  async copyToBtnHandler(e, mode, dropdown, paragraphEl, summaryEl, content, tags, filePath, selectedFile) {
    let newContent;
    const selection = window.getSelection().toString();
    if (selection == "")
      newContent = content;
    else
      newContent = selection;
    let notice;
    if (mode == "link") {
      const fileName = filePath.split("/").pop().replace(/\.md$/, "");
      newContent = "[[" + filePath + "|" + fileName + "]]";
    }
    if (mode != "link" && !selection) {
      tags.forEach((tag, i) => {
        newContent = removeTagFromString(newContent, tag).trim();
      });
    }
    const copySuccess = this.copyTextToSection(
      //this.plugin.settings.taggedParagraphCopyPrefix + 
      newContent,
      dropdown.getValue(),
      filePath,
      mode != "link",
      selectedFile
    );
    if (copySuccess) {
      if (mode == "note") {
        notice = new import_obsidian7.Notice(
          "Copied to section: " + dropdown.getValue() + " in " + selectedFile.name + " \u{1F517}",
          5e3
        );
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(selectedFile.path + "#" + dropdown.getValue(), "");
        });
      } else if (mode == "move" && !selection) {
        const file = this.app.vault.getAbstractFileByPath(filePath);
        let fileContent = await this.app.vault.read(file);
        fileContent = fileContent.trim();
        const newFileContent = replaceTextInString(
          content.trim(),
          fileContent,
          newContent
        ).trim();
        if (fileContent != newFileContent) {
          this.app.vault.modify(file, newFileContent);
          const copiedToWhere = dropdown.getValue() == "top" ? "top of note" : dropdown.getValue() == "end" ? "end of note" : dropdown.getValue();
          notice = new import_obsidian7.Notice(
            //'Moved to section: ' + dropdown.getValue() +
            //'.\nðŸ”— Open source note.', 
            "Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"),
            5e3
          );
          this.plugin.gui.removeElementWithAnimation(paragraphEl, () => {
            setTimeout(async () => {
              this.update(summaryEl);
              paragraphEl.remove();
            }, 500);
            setTimeout(async () => {
            }, 800);
          });
          if (dropdown.getValue() != "top" || dropdown.getValue() != "end") {
            this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
              this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
            });
          }
        } else {
          new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ".\nCan't update source file.");
        }
      } else if (mode == "copy" || mode == "link") {
        notice = new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"));
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
        });
      }
    }
  }
  async makeSummaryBtnHandler(summaryMd, tags, code = false) {
    const newNoteObj = fileObjFromTags(tags);
    let fileContent = code ? summaryMd : "## " + newNoteObj.title + "\n\n" + summaryMd;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
    const fileName = getActiveFileFolder(view) + newNoteObj.fileName;
    const file = this.app.vault.getAbstractFileByPath(fileName);
    let notice;
    if (!code) {
      tags.forEach((tag) => {
        fileContent = replaceTextInString(tag, fileContent, tag.substring(1), true);
      });
    }
    if (file instanceof import_obsidian7.TFile) {
      notice = new import_obsidian7.Notice("\u26A0\uFE0F Note already exists.\nClick here to overwrite.", 8e3);
      this.plugin.registerDomEvent(notice.noticeEl, "click", (e) => {
        this.app.vault.modify(file, fileContent);
        notice = new import_obsidian7.Notice("Note updated.\n\u{1F517} Open note.", 5e3);
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(fileName, "");
        });
      });
    } else if (!file) {
      this.app.vault.create(fileName, fileContent);
      const notice2 = new import_obsidian7.Notice("Summary note created. \u{1F4DC}\n\u{1F517} Open note.");
      this.plugin.registerDomEvent(notice2.noticeEl, "click", (e) => {
        this.app.workspace.openLinkText(newNoteObj.fileName, "");
      });
    }
  }
  createCodeBlock(tagsArray, pos) {
    const codeBlockString = "```tag-summary\ntags: " + tagsArray.join(" ") + "\n```";
    if (pos == "note") {
      this.makeSummaryBtnHandler(codeBlockString, tagsArray, true);
    } else {
      this.copyTextToSection(
        codeBlockString,
        pos,
        "",
        false
      );
    }
  }
  async codeBlockProcessor(source, el, ctx) {
    let tags = Array();
    let include = Array();
    let exclude = Array();
    let sections = Array();
    let max = 50;
    const maxPattern = /^\s*max:\s*(\d+)\s*$/;
    let match;
    const rows = source.split("\n").filter((row) => row.length > 0);
    rows.forEach((line) => {
      if (line.match(/^\s*tags:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*tags:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        tags = list;
      }
      if (line.match(/^\s*include:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*include:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        include = list;
      }
      if (line.match(/^\s*exclude:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*exclude:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        exclude = list;
      }
      if (line.match(/^\s*sections:[\p{L}0-9_\-/#, ]+$/gu)) {
        const content = line.replace(/^\s*sections:/, "").trim();
        let list = content.split(",").map((sec) => sec.trim());
        sections = list;
      }
      match = line.match(maxPattern);
      if (match) {
        max = Math.min(50, Number(match[1]));
      }
    });
    const codeBlock = "```tag-summary\n" + source.trim() + "\n```";
    if (tags.length > 0 || include.length > 0) {
      await this.create(
        el,
        tags,
        include,
        exclude,
        sections,
        max,
        ctx.sourcePath,
        codeBlock
      );
    } else {
      this.createEmpty(
        el,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        ctx.sourcePath ? ctx.sourcePath : "",
        codeBlock
      );
    }
  }
  createEmpty(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const container = createEl("div");
    const textDiv = createEl("blockquote");
    textDiv.innerHTML = "There are no files with tagged paragraphs that match the tags:<br>" + (tags.length > 0 ? tags.join(", ") : "No tags specified.") + "<br>";
    container.appendChild(textDiv);
    container.setAttribute(
      "codeblock-tags",
      tags.length > 0 ? tags.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-include",
      include ? include.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-exclude",
      exclude ? exclude.join(",") : ""
    );
    container.setAttribute(
      "codeblock-sections",
      sections ? sections.join(",") : ""
    );
    container.setAttribute(
      "codeblock-max",
      max
    );
    container.setAttribute(
      "codeblock-code",
      mdSource
    );
    container.appendChild(this.plugin.gui.makeSummaryRefreshButton(container));
    ;
    element.replaceWith(container);
  }
  async create(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const activeFile = await this.app.workspace.getActiveFile();
    const validTags = tags.concat(include);
    const tempComponent = new TempComponent();
    const summaryContainer = createEl("div");
    this.selectedBlocks = [];
    this.blocks = [];
    summaryContainer.setAttribute(
      "class",
      "tag-summary-block"
    );
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian7.getAllTags)(cache);
      if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    listFiles = listFiles.sort((file1, file2) => {
      return file2.stat.ctime - file1.stat.ctime;
    });
    let listContents = await this.readFiles(listFiles);
    let count = 0;
    let summary = "";
    listContents.forEach((item) => {
      const fileName = item[0].name.replace(/.md$/g, "");
      const filePath = item[0].path;
      if (activeFile) {
        if (activeFile.name == item[0].name)
          return;
      }
      let listParagraphs = Array();
      const blocks = item[1].split(/\n\s*\n/).filter((row) => row.trim().length > 0);
      blocks.forEach((paragraph) => {
        let valid = false;
        let listTags = paragraph.match(/(?<=^|\s)(#[^\s#.,;!?:]+)/g);
        if (listTags != null && listTags.length > 0) {
          if (!paragraph.contains("```") && !paragraph.contains("---")) {
            valid = this.isValidText(listTags, tags, include, exclude);
          }
        }
        if (valid)
          listParagraphs.push(paragraph);
      });
      listParagraphs.forEach(async (paragraph) => {
        if (count++ >= max)
          return;
        paragraph += "\n";
        var regex = new RegExp();
        var tagText = new String();
        var tagSection = null;
        tags.forEach((tag) => {
          tagText = tag.replace("#", "\\#");
          regex = new RegExp(`${tagText}(\\W|$)`, "g");
          if (paragraph.match(regex) != null) {
            tagSection = tag;
          }
        });
        const buttonContainer = createEl("div");
        buttonContainer.setAttribute("class", "tagsummary-buttons");
        const paragraphEl = createEl("blockquote");
        paragraphEl.setAttribute("file-source", filePath);
        paragraphEl.setAttribute("index", count - 1);
        paragraphEl.setAttribute("class", "tag-summary-paragraph");
        const blockLink = paragraph.match(/\^[\p{L}0-9_\-/^]+/gu);
        let link;
        if (blockLink)
          link = "[[" + filePath + "#" + blockLink + "|" + fileName + "]]";
        else
          link = "[[" + filePath + "|" + fileName + "]]";
        if (this.plugin.settings.tagSummaryBlockButtons) {
          if (sections.length >= 1) {
            buttonContainer.appendChild(
              this.plugin.gui.makeCopyToSection(
                this.copyToBtnHandler.bind(this),
                paragraph,
                sections,
                tags,
                blockLink ? filePath + "#" + blockLink[0] : filePath,
                paragraphEl,
                summaryContainer
              )
            );
          }
          buttonContainer.appendChild(
            this.plugin.gui.makeCopyButton(
              this.copyBtnHandler.bind(this),
              paragraph.trim()
            )
          );
          buttonContainer.appendChild(
            this.plugin.gui.makeRemoveTagButton(
              this.removeTagBtnHandler.bind(this),
              paragraphEl,
              tagSection
              //, 
              //(blockLink ? (filePath + '#' + blockLink[0]) : filePath)
            )
          );
        }
        const mdParagraph = paragraph;
        paragraph = "**" + link + "**\n" + paragraph;
        summary += paragraph + "\n";
        paragraphEl.setAttribute("md-source", mdParagraph);
        blocks.push(mdParagraph);
        await import_obsidian7.MarkdownRenderer.renderMarkdown(
          paragraph,
          paragraphEl,
          filePath,
          //'', 
          tempComponent
        );
        const titleEl = createEl("span");
        titleEl.setAttribute("class", "tagsummary-item-title");
        titleEl.appendChild(paragraphEl.querySelector("strong").cloneNode(true));
        if (this.plugin.settings.tagSummaryBlockButtons)
          paragraphEl.appendChild(buttonContainer);
        paragraphEl.querySelector("strong").replaceWith(titleEl);
        summaryContainer.appendChild(paragraphEl);
      });
    });
    if (summary != "") {
      setTimeout(async () => {
        if (this.plugin.settings.showSummaryButtons) {
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryRefreshButton(
              summaryContainer
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeCopySummaryButton(
              summary
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryNoteButton(
              this.makeSummaryBtnHandler.bind(this),
              summary,
              tags
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeBakeButton(
              this.bakeSummaryBtnHandler.bind(this),
              summary,
              summaryContainer,
              activeFile.path
            )
          );
          summaryContainer.appendChild(createEl("br"));
        }
        summaryContainer.appendChild(createEl("hr"));
      }, 0);
      summaryContainer.setAttribute(
        "codeblock-tags",
        tags.join(",")
      );
      summaryContainer.setAttribute(
        "codeblock-tags-include",
        include.length > 0 ? include.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-tags-exclude",
        exclude.length > 0 ? exclude.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-sections",
        sections.length > 0 ? sections.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-max",
        max
      );
      summaryContainer.setAttribute(
        "codeblock-code",
        mdSource
      );
      element.replaceWith(summaryContainer);
    } else {
      this.createEmpty(
        element,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        "",
        mdSource
      );
    }
  }
  update(summaryEl) {
    const tagsStr = summaryEl.getAttribute(
      "codeblock-tags"
    );
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = summaryEl.getAttribute(
      "codeblock-tags-include"
    );
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    const tagsExcludeStr = summaryEl.getAttribute(
      "codeblock-tags-exclude"
    );
    const tagsExclude = tagsExcludeStr ? tagsExcludeStr.split(",") : [];
    const sectionsStr = summaryEl.getAttribute(
      "codeblock-sections"
    );
    const sections = sectionsStr ? sectionsStr.split(",") : [];
    const max = Number(summaryEl.getAttribute(
      "codeblock-max"
    ));
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    this.create(
      summaryEl,
      tags,
      tagsInclude,
      tagsExclude,
      sections,
      max,
      "",
      mdSource
    );
  }
  // Not factored yet
  async copyTextToSection(text, section, filePath, addLink = true, selectedFile, detectPrefix = true) {
    const file = selectedFile ? selectedFile : await this.app.workspace.getActiveFile();
    let fileContent = await this.app.vault.read(file);
    const fileContentLines = getLinesInString(fileContent);
    const mdHeadings = getMarkdownHeadings(fileContentLines);
    let targetLine;
    if (mdHeadings.length <= 0 || section == "end" || section == "top") {
      if (section == "top") {
        targetLine = findFirstLineAfterFrontMatter(fileContent);
        if (targetLine == 0)
          fileContent = "\n" + fileContent;
      } else if (section == "end" || mdHeadings.length <= 0) {
        targetLine = fileContentLines.length - 1;
      }
    } else if (mdHeadings.length > 0) {
      const headingObj = mdHeadings.find((heading) => heading.text.trim() === section);
      if (headingObj) {
        targetLine = headingObj.line;
      } else {
        new import_obsidian7.Notice(`${section} not found.`);
        return false;
      }
    }
    const linePrefix = detectPrefix ? getListTypeFromLineNumber(fileContent, targetLine + 1) : "";
    let finalText;
    if (addLink)
      finalText = linePrefix + text + ` [[${filePath}|\u{1F517}]]`;
    else
      finalText = linePrefix + text;
    let newContent = insertTextAfterLine(finalText, fileContent, targetLine);
    await this.app.vault.modify(file, newContent);
    return true;
  }
  async readFiles(listFiles) {
    let list = [];
    for (let t = 0; t < listFiles.length; t += 1) {
      const file = listFiles[t];
      let content = await this.app.vault.cachedRead(file);
      list.push([file, content]);
    }
    return list;
  }
  isValidText(listTags, tags, include, exclude) {
    let valid = true;
    if (tags.length > 0) {
      valid = valid && tags.some((value) => listTags.includes(value));
    }
    if (include.length > 0) {
      valid = valid && include.every((value) => listTags.includes(value));
    }
    if (valid && exclude.length > 0) {
      valid = !exclude.some((value) => listTags.includes(value));
    }
    return valid;
  }
  static getTagsToCheckFromEl(tagSummaryEl) {
    const tagsStr = tagSummaryEl.getAttribute("codeblock-tags");
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = tagSummaryEl.getAttribute("codeblock-tags-include");
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    return tags.concat(tagsInclude);
  }
  async getFile(el) {
    const filePath = el.getAttribute("file-source");
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    return file;
  }
  updateSelection(index, bool) {
    if (bool) {
      if (!this.selectedBlocks.includes(index)) {
        this.selectedBlocks.push(index);
      }
    } else {
      this.selectedBlocks = this.selectedBlocks.filter((itemIndex) => itemIndex !== index);
    }
  }
  getSelectedMarkdownBlocks() {
  }
};
var TempComponent = class extends import_obsidian7.Component {
  constructor() {
    super(...arguments);
    this.doNotPostProcess = true;
  }
  onload() {
  }
  onunload() {
  }
};

// TagProcessor.ts
var import_obsidian8 = require("obsidian");
var TagProcessor = class {
  constructor(app2, plugin) {
    this.outOfSync = false;
    this.app = app2;
    this.plugin = plugin;
    this.debouncedProcessActiveFileTagEls = (0, import_obsidian8.debounce)(this.processActiveFileTags.bind(this), 500);
    this.debouncedProcessActiveFileTagEls();
  }
  reset() {
    this.outOfSync = false;
  }
  filterActiveFileTagEls(tags) {
    const filteredTagElements = Array.from(tags).filter((tag) => {
      if (tag.closest(".frontmatter-section-data"))
        return false;
      if (tag.parentElement.closest(".markdown-embed"))
        return false;
      if (tag.closest(".markdown-embed"))
        return false;
      if (tag.parentElement.closest(".tag-summary-block"))
        return false;
      return true;
    });
    return filteredTagElements;
  }
  async renderPostProcessor(el, ctx) {
    const processingFile = this.app.vault.getAbstractFileByPath(ctx.sourcePath);
    const activeFile = this.app.workspace.getActiveFile();
    const activeFilePath = activeFile == null ? void 0 : activeFile.path;
    const nativeEmbedEl = el.querySelector(".internal-embed");
    const tags = el.querySelectorAll(".tag");
    if (nativeEmbedEl && ctx.sourcePath == activeFilePath || ctx.sourcePath == activeFilePath && tags.length > 0 || el.classList.contains("tag-summary-paragraph")) {
      if (this.plugin.settings.debugMode)
        console.log("Tag Buddy: renderPostProcessor");
    } else {
      return;
    }
    if (nativeEmbedEl) {
      let nativeEmbedObserver;
      nativeEmbedObserver = new MutationObserver((mutationsList) => {
        const target = mutationsList[0].target;
        if (target.querySelectorAll(".tag").length > 0) {
          nativeEmbedObserver.disconnect();
          this.processNativeEmbed(target);
        }
      });
      nativeEmbedObserver.observe(nativeEmbedEl, { childList: true, subtree: true });
    }
    if (el.classList.contains("tag-summary-paragraph")) {
      this.processTagSummaryParagraph(el);
      return;
    }
    this.debouncedProcessActiveFileTagEls();
  }
  async processActiveFileTags() {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processing active file tags");
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian8.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (mode == "preview") {
      const activeFile = await this.app.workspace.getActiveFile();
      const fileContent = await this.app.vault.read(activeFile);
      const sections = view.currentMode.renderer.sections;
      const activeFileTagEls = [];
      const activeFileTags = await this.getMarkdownTags(
        activeFile,
        fileContent
      );
      sections.forEach((section) => {
        Array.from(section.el.querySelectorAll(".tag")).forEach((tag) => {
          activeFileTagEls.push(tag);
        });
      });
      const filteredTagElements = this.filterActiveFileTagEls(activeFileTagEls);
      if (filteredTagElements.length > 0) {
        this.assignMarkdownTags(
          activeFileTags,
          filteredTagElements,
          0,
          //startIndex,
          "active"
        );
      }
    }
  }
  async processTagSummaryParagraph(paragraphEl) {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processTagSummaryParagraph");
    const filePath = paragraphEl.getAttribute("file-source");
    const markdownBlock = paragraphEl.getAttribute("md-source").trim();
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    const fileContent = await this.app.vault.read(file);
    const startIndex = fileContent.indexOf(markdownBlock);
    const mdTags = this.getMarkdownTags(
      file,
      fileContent
    );
    this.assignMarkdownTags(
      mdTags,
      paragraphEl.querySelectorAll(".tag"),
      startIndex,
      "plugin-summary"
    );
  }
  // adapt this method to use the cache tag info (line, offset, etc)
  getMarkdownTags(file, fileContent) {
    const tagPositions = [];
    let match;
    const regex = /(?<=^|\s)(#(?=[^\s#.'â€™,;!?:]*[^\d\s#.'â€™,;!?:])[^\s#.'â€™,;!?:]+)(?=[.,;!?:'â€™\s]|$)|(?<!`)```(?!`)/g;
    let insideCodeBlock = false;
    while ((match = regex.exec(fileContent)) !== null) {
      if (match[0].trim() === "```") {
        insideCodeBlock = !insideCodeBlock;
        continue;
      }
      if (insideCodeBlock)
        continue;
      const tag = match[0].trim();
      tagPositions.push({ tag, index: match.index, source: file.name });
    }
    return tagPositions;
  }
  async assignMarkdownTags(tagPositions, tagElements, startIndex, type) {
    if (type == "active") {
      if (this.plugin.settings.debugMode) {
        const activeFilePath = this.app.workspace.getActiveFile().path;
        console.log(tagPositions.length, tagElements.length);
        const temp1 = [];
        tagPositions.forEach((nodeObj) => {
          temp1.push(nodeObj.tag);
        });
        const temp2 = [];
        tagElements.forEach((nodeObj) => {
          temp2.push(nodeObj.innerText);
        });
        console.log(temp1, temp2);
      }
      if (tagPositions.length != tagElements.length) {
        this.outOfSync = true;
        new import_obsidian8.Notice("Markdown source and preview tags out of sync. Please close and reload this note.");
        if (this.plugin.settings.debugMode)
          this.logDifferences(tagPositions, tagElements);
        return;
      }
    }
    let tagEl;
    const tagElArray = Array.from(tagElements);
    let tagElIndex = 0;
    let tagPos;
    for (let i = 0; i < tagPositions.length; i++) {
      tagPos = tagPositions[i];
      if (tagPos.index >= startIndex) {
        tagEl = tagElArray[tagElIndex];
        if (tagEl) {
          if (tagEl.innerText.trim() == tagPos.tag.trim()) {
            tagEl.setAttribute("md-index", tagPos.index);
            tagEl.setAttribute("file-source", tagPos.source);
            tagEl.setAttribute("type", type);
            tagEl.setAttribute("pos", i);
            tagElIndex++;
          } else {
            this.outOfSync = true;
            new import_obsidian8.Notice("Markdown source and preview tags out of sync. Please close and reload this note.");
            this.logDifferences(tagPositions, tagElements);
            return;
          }
        }
      }
    }
    ;
    return tagElArray;
  }
  async processNativeEmbed(embed, checkDuplicates = false) {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processNativeEmbed");
    embed = embed.closest(".markdown-embed");
    if (embed.getAttribute("src")) {
      const linkElement = embed.getAttribute("src");
      let filePath = embed.getAttribute("src");
      const linkArray = filePath.split("#");
      const hasAnchorLink = linkArray.length > 1;
      let anchorLinkType = "";
      let anchorLink;
      if (hasAnchorLink) {
        anchorLink = linkArray[1];
        anchorLinkType = anchorLink.startsWith("^") ? "block" : "header";
      }
      filePath = linkArray[0].trim() + ".md";
      const file = await validateFilePath(filePath);
      if (file) {
        const fileContent = await this.app.vault.read(file);
        const embededTagFile = await this.getMarkdownTags(file, fileContent);
        if (hasAnchorLink && anchorLinkType != "") {
          if (anchorLinkType == "header" && !fileContainsHeading(fileContent, anchorLink)) {
            embed.setAttribute("embed-success", "false");
            return;
          } else {
            embed.setAttribute("embed-success", "true");
          }
        }
        const tempComponent = new TempComponent2();
        const tempContainerHTML = createEl("div");
        await import_obsidian8.MarkdownRenderer.renderMarkdown(
          fileContent,
          tempContainerHTML,
          "noFile",
          //file.path, 
          tempComponent
        );
        const innerText = await embed.querySelector(".markdown-embed-content").innerText;
        const startIndex = tempContainerHTML.innerText.indexOf(innerText);
        this.assignMarkdownTags(
          embededTagFile,
          embed.querySelectorAll(".tag"),
          startIndex,
          "native-embed"
        );
      }
    }
  }
  logDifferences(tagPositions, tagElements) {
    const tags = tagPositions.map((item) => item.tag);
    const innerTexts1 = tagElements.map((item) => item.innerText);
    let uniqueToTagPositions = [];
    let uniqueToTagElements = [];
    const findUnique = (arr1, arr2) => {
      return arr1.filter((item) => !arr2.includes(item));
    };
    uniqueToTagPositions = findUnique(tags, innerTexts1);
    uniqueToTagElements = findUnique(innerTexts1, tags);
    console.log("differences:", uniqueToTagPositions.length, uniqueToTagElements.length);
    if (uniqueToTagPositions.length) {
      console.log("Unique to tagPositions based on tag:", uniqueToTagPositions);
    }
    if (uniqueToTagElements.length) {
      console.log("Unique to tagElements based on innerText:", uniqueToTagElements);
    }
  }
};
var TempComponent2 = class extends import_obsidian8.Component {
  onload() {
  }
  onunload() {
  }
};

// ReadingModeTagEditor.ts
var import_obsidian9 = require("obsidian");
var ReadingModeTagEditor = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  async renameTag(tag, newName, vaultToggle = false) {
    if (vaultToggle) {
      const validTags = [tag];
      let listFiles = this.app.vault.getMarkdownFiles();
      listFiles = listFiles.filter((file) => {
        const cache = this.app.metadataCache.getFileCache(file);
        const tagsInFile = (0, import_obsidian9.getAllTags)(cache);
        if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
          return true;
        }
        return false;
      });
      let listContents = await this.plugin.tagSummary.readFiles(listFiles);
      listContents.forEach((note) => {
        this.renameTagInFileByIndex(
          tag,
          newName,
          note[0]
        );
      });
    } else {
      const file = this.app.workspace.getActiveFile();
      this.renameTagInFileByIndex(
        tag,
        newName,
        file
      );
    }
  }
  async renameTagInFileByIndex(tag, newName, file) {
    const fileContent = await this.app.vault.read(file);
    let newFileContent = fileContent;
    const tagPositions = this.plugin.tagProcessor.getMarkdownTags(file, fileContent);
    let filteredTagObjs = tagPositions.filter((tagObj) => tagObj.tag === tag);
    if (filteredTagObjs.length > 0) {
      filteredTagObjs.sort((a, b) => a.index - b.index);
      let offset = 0;
      filteredTagObjs.forEach((tagObj) => {
        const newIndex = tagObj.index + offset;
        newFileContent = newFileContent.substring(0, newIndex) + newName + newFileContent.substring(newIndex + tagObj.tag.length);
        offset += newName.length - tagObj.tag.length;
      });
      this.app.vault.modify(file, newFileContent);
    } else {
      new import_obsidian9.Notice("No tags to rename.");
    }
  }
  /* async renameTagInFile (tag, newName, file:TFile) {
  
  console.log((tag), newName, file.name)
  
          // this will be used for remove hash, rename, and lowercase
          let fileContent = await this.app.vault.read(file);
          fileContent = fileContent.trim();
          const newFileContent = Utils.replaceTextInString(
              tag.trim(),
              fileContent, 
              newName,
              true).trim();
          this.app.vault.modify(file, newFileContent);
      }*/
  async add(tag, x, y) {
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy add " + tag + " at (" + x + ", " + y + ")");
    }
    let fileContent;
    let file;
    const clickedTextObj = getClickedTextObjFromDoc(x, y);
    const clickedText = clickedTextObj == null ? void 0 : clickedTextObj.text;
    const clickedTextIndex = clickedTextObj == null ? void 0 : clickedTextObj.index;
    const clickedTextEl = clickedTextObj == null ? void 0 : clickedTextObj.el;
    let contentSourceType = null;
    let summaryEl = void 0;
    let embedEl = void 0;
    if (clickedTextObj) {
      try {
        summaryEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".tag-summary-paragraph");
        embedEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".markdown-embed");
      } catch (e) {
      }
      if (summaryEl) {
        file = await this.plugin.tagSummary.getFile(summaryEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "plugin-summary";
      } else if (embedEl) {
        file = await getEmbedFile(embedEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "native-embed";
      } else {
        file = await this.app.workspace.getActiveFile();
        fileContent = await this.app.vault.read(file);
        contentSourceType = "active";
      }
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (clickedText) {
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag.\nTry a different text area.");
      return;
    }
    const escapedClickedText = escapeRegExp(clickedText);
    const regex = new RegExp(escapedClickedText, "g");
    const matches = fileContent.match(regex);
    if (matches && matches.length > 1) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag: Clicked text repeated in note. Try a another text block.");
      return;
    } else if (matches && matches.length === 0 || !matches) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (!this.plugin.settings.lockRecentTags)
      this.plugin.saveRecentTag(tag);
    const startIndex = regex.exec(fileContent).index;
    const endIndex = startIndex + clickedText.length;
    const clickedWordObj = getWordObjFromString(clickedText, clickedTextIndex);
    const clickedWord = clickedWordObj.text;
    const clickedWordIndex = clickedWordObj.index;
    let newContent;
    if (clickedWord) {
      if (isWordNearEnd(clickedText, clickedWord))
        newContent = insertTextInString(" " + tag, fileContent, endIndex);
      else
        newContent = insertTextInString(tag, fileContent, startIndex + clickedWordIndex);
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find clicked word.\nPlease try again.");
      return;
    }
    await this.app.vault.modify(file, newContent);
    if (contentSourceType == "plugin-summary") {
      const summaryContainer = summaryEl.closest(".tag-summary-block");
      this.plugin.tagSummary.update(summaryContainer);
    } else if (contentSourceType == "native-embed") {
      setTimeout(async () => {
        this.plugin.tagProcessor.processNativeEmbed(embedEl, true);
      }, 200);
    }
  }
  async edit(tagEl, event, pragraphEl) {
    let tagContainer;
    const tagContainerType = tagEl.getAttribute(
      "type"
    );
    const index = tagEl.getAttribute(
      "md-index"
    );
    const filePath = tagEl.getAttribute(
      "file-source"
    );
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy edit tag: " + tagEl.innerText + "\nIn file: " + filePath);
    }
    if (tagContainerType == "native-embed")
      tagContainer = tagEl.closest(".markdown-embed");
    else if (tagContainerType == "plugin-summary")
      tagContainer = tagEl.closest(".tag-summary-paragraph");
    else
      tagContainer = this.app.workspace.activeLeaf.containerEl.querySelector(".markdown-reading-view");
    if (filePath) {
      const file = await validateFilePath(filePath);
      let fileContent;
      let fileContentBackup;
      const tag = tagEl.innerText.trim();
      try {
        fileContent = await this.app.vault.read(file);
        fileContentBackup = fileContent;
      } catch (error) {
        new import_obsidian9.Notice("Tag Buddy file read error:\n" + error.message);
        return;
      }
      let safeToEmptyFile = false;
      const tagRegex = /^\s*#(\w+)\s*$/;
      if (tagRegex.test(fileContent.trim())) {
        safeToEmptyFile = true;
      }
      let beforeTag = fileContent.substring(0, index);
      let afterTag = fileContent.substring(
        Number(index) + Number(tag.length)
      );
      let afterTagChr = "";
      if (fileContent[index] === "\n")
        beforeTag += "\n";
      let newContent = "";
      if (!event) {
        newContent = beforeTag + afterTagChr + afterTag;
      } else if (event.altKey || event.type == "touchstart" && !this.plugin.settings.mobileTagSearch) {
        const noHash = tag.substring(1);
        newContent = beforeTag + noHash + afterTagChr + afterTag;
        if (this.app.isMobile && this.plugin.settings.mobileNotices) {
          new import_obsidian9.Notice("Tag Buddy: " + tag + " converted to text.");
        }
      } else if (event.type == "touchend" || this.plugin.settings.mobileTagSearch || ctrlCmdKey(event) && !this.plugin.settings.removeOnClick || !ctrlCmdKey(event) && this.plugin.settings.removeOnClick) {
        let parentTag = "";
        if (tag.includes("/") && (this.plugin.settings.removeChildTagsFirst || event.shiftKey && !this.plugin.settings.removeChildTagsFirst)) {
          let parts = tag.split("/");
          const removedChild = parts.pop();
          parentTag = parts.join("/");
          newContent = beforeTag + parentTag + afterTagChr + afterTag;
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: '" + removedChild + "' removed from parent tag.");
          }
        } else {
          newContent = beforeTag + afterTag;
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: " + tag + " removed.");
          }
        }
      }
      if (tagEl.getAttribute("type") == "plugin-summary") {
        const summaryEl = tagEl.closest(".tag-summary-paragraph");
        const mdSource = summaryEl.getAttribute("md-source").trim();
        const escapedText = escapeRegExp(mdSource);
        const regex = new RegExp(escapedText, "g");
        const matches = fileContent.match(regex);
        if (matches && matches.length > 1) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't safely remove/edit tag:\nSurrounding text repeated in source note.");
          return;
        } else if (matches && matches.length === 0 || !matches) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't find tag in source note.\n");
          return;
        }
        if (newContent == "" && !safeToEmptyFile || contentChangedTooMuch(
          fileContentBackup,
          newContent,
          tag,
          2
        )) {
          new import_obsidian9.Notice("Tag Buddy: File change error.");
          newContent = fileContentBackup;
        } else if (newContent == "" && safeToEmptyFile) {
          new import_obsidian9.Notice("Tag Buddy: Tag removed. The note is empty.");
        }
        setTimeout(async () => {
          const tagParagraphEl = tagEl.closest(".tag-summary-paragraph");
          const tagSummaryBlock = tagEl.closest(".tag-summary-block");
          const tagsToCheck = TagSummary.getTagsToCheckFromEl(tagSummaryBlock);
          const tagsInContent = tagsInString(tagParagraphEl.innerText);
          if (tagsToCheck.includes(tag)) {
            const tagCount = countOccurrences(tagsToCheck, tagsInContent);
            if (tagCount >= 2) {
              this.plugin.tagSummary.update(tagSummaryBlock);
            } else {
              const notice = new import_obsidian9.Notice(tag + " removed from paragraph.\n\u{1F517} Open source note.", 5e3);
              this.plugin.gui.removeElementWithAnimation(
                tagParagraphEl,
                () => {
                  setTimeout(async () => {
                    this.plugin.tagSummary.update(tagSummaryBlock);
                    tagParagraphEl.remove();
                  }, 500);
                }
              );
              this.plugin.registerDomEvent(
                notice.noticeEl,
                "click",
                (e) => {
                  this.app.workspace.openLinkText(filePath, "");
                }
              );
            }
          } else {
            this.plugin.tagSummary.update(tagSummaryBlock);
          }
        }, 200);
      } else if (tagEl.getAttribute("type") == "native-embed") {
        setTimeout(async () => {
          this.plugin.tagProcessor.processNativeEmbed(tagContainer, true);
        }, 200);
      }
      try {
        await this.app.vault.modify(file, newContent);
      } catch (error) {
        try {
          const backupFileName = String(file.name.substring(0, file.name.indexOf(".md")) + " BACKUP.md");
          this.app.vault.create(backupFileName, fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error.message + "\n" + backupFileName + " saved to vault root.");
        } catch (error2) {
          navigator.clipboard.writeText(fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error2.message + "\nNote content copied to clipboard.");
        }
      }
      this.plugin.tagProcessor.debouncedProcessActiveFileTagEls();
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't identify tag location. Please try again.");
    }
  }
};

// Mobile.ts
var DoubleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.callback(event);
    } else {
      this.timeout = setTimeout(() => {
        clearTimeout(this.timeout);
      }, 500);
    }
    this.lastTap = currentTime;
  }
};
var TripleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.tapCount = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.tapCount++;
      if (this.tapCount === 2) {
        this.callback(event);
        this.tapCount = 0;
      }
    } else {
      this.tapCount = 0;
    }
    this.timeout = setTimeout(() => {
      clearTimeout(this.timeout);
      this.tapCount = 0;
    }, 500);
    this.lastTap = currentTime;
  }
};
var PressAndHoldHandler = class {
  constructor(plugin, element, callback, duration = 600) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.duration = duration;
    this.timeout = null;
    this.plugin.registerDomEvent(
      this.element,
      "touchstart",
      this.handleTouchStart.bind(this),
      true
    );
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchStart(event) {
    this.timeout = setTimeout(() => {
      this.callback(event);
      this.timeout = null;
    }, this.duration);
  }
  handleTouchEnd(event) {
    if (this.timeout) {
      clearTimeout(this.timeout);
      this.timeout = null;
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  removeOnClick: true,
  removeChildTagsFirst: true,
  optToConvert: true,
  mobileTagSearch: false,
  mobileNotices: true,
  tagSummaryBlockButtons: false,
  taggedParagraphCopyPrefix: "",
  recentlyAddedTags: "",
  lockRecentTags: false,
  showSummaryButtons: false,
  debugMode: false
};
var TagBuddy = class extends import_obsidian10.Plugin {
  // onunload() { I think all the cleanup is done automatically the way I register everything. } 
  async onload() {
    console.log("Tag Buddy Plugin loaded on " + (this.app.isMobile ? "mobile at " : "desktop at ") + (/* @__PURE__ */ new Date()).toUTCString().substring(17));
    this.addSettingTab(new TBSettingsTab(this.app, this));
    await this.loadSettings();
    this.app.workspace.onLayoutReady(async () => {
      this.gui = new GUI(this.app, this);
      this.tagSummary = new TagSummary(this.app, this);
      this.tagProcessor = new TagProcessor(this.app, this);
      this.tagEditor = new ReadingModeTagEditor(this.app, this);
      this.registerMarkdownPostProcessor(
        this.tagProcessor.renderPostProcessor.bind(this.tagProcessor)
      );
      try {
        this.registerMarkdownCodeBlockProcessor(
          "tag-summary",
          this.tagSummary.codeBlockProcessor.bind(this.tagSummary)
        );
      } catch (e) {
      }
      this.registerDomEvent(
        document,
        "contextmenu",
        async (event) => {
          const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
          if (view && ctrlCmdKey(event) && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
            event.preventDefault();
            this.gui.showTagSelector(event);
          }
        }
      );
      this.registerEvent(this.app.on(
        "layout-change",
        async (event) => {
          var _a;
          const mode = (_a = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView)) == null ? void 0 : _a.getMode();
          if (this.settings.debugMode)
            console.log("Tag Buddy: layout-change:", mode);
          if (mode == "preview") {
            this.tagProcessor.reset();
            this.tagProcessor.debouncedProcessActiveFileTagEls();
          } else if (mode == "source") {
          }
        }
      ));
      this.registerEvent(this.app.workspace.on(
        "file-open",
        //debounce(
        async (event) => {
          var _a, _b;
          const activeFile = await this.app.workspace.getActiveFile();
          if (this.settings.debugMode)
            console.log("Tag Buddy: last active file:", (_a = this.activeFile) == null ? void 0 : _a.name);
          if (this.settings.debugMode)
            console.log("Tag Buddy: file open:", activeFile.name);
          if (activeFile.path != ((_b = this.activeFile) == null ? void 0 : _b.path)) {
            this.tagProcessor.reset();
            this.activeFile = this.app.workspace.getActiveFile();
            if (this.tagProcessor) {
              this.tagProcessor.processActiveFileTags();
            }
          }
        }
        //, 3000, true)
      ));
      if (!this.app.isMobile) {
        this.registerDomEvent(
          document,
          "click",
          this.onClickEvent.bind(this),
          true
        );
      } else {
        this.registerDomEvent(
          document,
          "click",
          (e) => {
            const isTag = e.target.classList.contains("tag");
            if (isTag && !this.settings.mobileTagSearch) {
              e.stopPropagation();
            } else {
            }
          },
          true
        );
        new PressAndHoldHandler(
          this,
          document,
          (event) => {
            this.gui.showTagEditor(event.target.closest(".tag").innerText);
          }
          //this.onClickEvent.bind(this)
        );
        new DoubleTapHandler(
          this,
          document,
          this.onClickEvent.bind(this)
        );
        new TripleTapHandler(
          this,
          document,
          async (event) => {
            const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
            if (view && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
              event.preventDefault();
              this.gui.showTagSelector(event);
            }
          },
          true
          //this.gui.showTagSelector.bind(this.gui)
        );
      }
    });
  }
  async onClickEvent(event) {
    const target = event.target;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Unsupported view type. Try again within the source note.");
      return;
    }
    if (view) {
      if (view.getMode() != "preview" || !view.containerEl.contains(event.target))
        return;
    }
    if (!this.app.isMobile) {
      if (this.settings.removeOnClick && ctrlCmdKey(event) || !this.settings.removeOnClick && !ctrlCmdKey(event)) {
        return;
      } else if (event.altKey && target && target.matches(".tag")) {
        event.stopPropagation();
        event.preventDefault();
        this.gui.showTagEditor(event.target.closest(".tag").innerText);
        return;
      }
    } else {
      setTimeout(() => {
        const selection = window.getSelection();
        if (selection)
          selection.removeAllRanges();
      }, 400);
      if (this.settings.mobileTagSearch && event.type == "touchend") {
        console.log("handle touch end");
        return;
      }
    }
    if (target && target.matches(".tag")) {
      if (this.tagProcessor.outOfSync) {
        new import_obsidian10.Notice("Markdown source and preview tags are out of sync. Please close and reload this note.");
        return;
      }
      if (this.settings.removeOnClick || !this.settings.removeOnClick && ctrlCmdKey(event)) {
        event.stopPropagation();
        event.preventDefault();
      }
      const clickedTag = target.closest(".tag");
      const tag = clickedTag.innerText;
      let tagIndex = clickedTag.getAttribute("md-index");
      let tagFile = clickedTag.getAttribute("file-source");
      if (tagFile) {
        this.tagEditor.edit(
          target,
          event
        );
      } else {
        setTimeout(async () => {
          tagIndex = clickedTag.getAttribute("md-index");
          tagFile = clickedTag.getAttribute("file-source");
          this.tagEditor.edit(
            target,
            event
          );
        }, 300);
      }
    } else if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Might be in an unsupported view type.");
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getTagsFromApp() {
    const tagsObject = this.app.metadataCache.getTags();
    const tagsArray = Object.entries(tagsObject);
    tagsArray.sort((a, b) => b[1] - a[1]);
    const recentTags = this.getRecentTags();
    if (recentTags.length > 0) {
      const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
      const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
      return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
    } else {
      return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
    }
  }
  saveRecentTag(tag) {
    if (isTagValid(tag)) {
      const recentTagsString = this.settings.recentlyAddedTags;
      let recentTags;
      if (recentTagsString == "") {
        recentTags = [];
      } else if (recentTagsString.indexOf(", ")) {
        recentTags = this.settings.recentlyAddedTags.split(", ");
      } else {
        recentTags = [this.settings.recentlyAddedTags];
      }
      if (recentTags.includes(tag)) {
        recentTags.splice(recentTags.indexOf(tag), 1);
      }
      recentTags.unshift(tag.trim());
      recentTags = recentTags.slice(0, 3);
      this.settings.recentlyAddedTags = recentTags.join(", ");
      this.saveSettings();
    } else {
    }
  }
  getRecentTags() {
    const recentTags = this.settings.recentlyAddedTags == "" ? [] : this.settings.recentlyAddedTags.split(", ");
    return recentTags;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJndWkudHMiLCAidXRpbHMudHMiLCAiTW9kYWwudHMiLCAiVGFnRWRpdG9yTW9kYWwudHMiLCAiRmluZEZpbGVNb2RhbC50cyIsICJUYWdTdW1tYXJ5LnRzIiwgIlRhZ1Byb2Nlc3Nvci50cyIsICJSZWFkaW5nTW9kZVRhZ0VkaXRvci50cyIsICJNb2JpbGUudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blJlbmRlcmVyLCBkZWJvdW5jZSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFRCU2V0dGluZ3NUYWIgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuaW1wb3J0IHsgR1VJIH0gZnJvbSBcIi4vZ3VpXCI7XG5pbXBvcnQgeyBUYWdTdW1tYXJ5IH0gZnJvbSAnLi9UYWdTdW1tYXJ5JztcbmltcG9ydCB7IFRhZ1Byb2Nlc3NvciB9IGZyb20gJy4vVGFnUHJvY2Vzc29yJztcbmltcG9ydCB7IFJlYWRpbmdNb2RlVGFnRWRpdG9yIH0gZnJvbSAnLi9SZWFkaW5nTW9kZVRhZ0VkaXRvcic7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcbmltcG9ydCAqIGFzIE1vYmlsZSBmcm9tICcuL01vYmlsZSc7XG5cbmludGVyZmFjZSBUQlNldHRpbmdzIHtcblx0cmVtb3ZlT25DbGljazogYm9vbGVhbjsgLy8gY3RybFxuXHRyZW1vdmVDaGlsZFRhZ3NGaXJzdDsgLy8gXG5cdG9wdFRvQ29udmVydDogYm9vbGVhbjsgLy9hbHRcblx0bW9iaWxlVGFnU2VhcmNoOiBib29sZWFuOyBcblx0bW9iaWxlTm90aWNlczogYm9vbGVhbjsgXG5cdHRhZ1N1bW1hcnlCbG9ja0J1dHRvbnM6IGJvb2xlYW47IFxuXHR0YWdnZWRQYXJhZ3JhcGhDb3B5UHJlZml4OiBzdHJpbmc7XG5cdHJlY2VudGx5QWRkZWRUYWdzOiBzdHJpbmc7XG5cdGxvY2tSZWNlbnRUYWdzOiBib29sZWFuO1xuXHRzaG93U3VtbWFyeUJ1dHRvbnM6Ym9vbGVhbjtcblx0ZGVidWdNb2RlOiBib29sZWFuO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPFRCU2V0dGluZ3M+ID0ge1xuXHRyZW1vdmVPbkNsaWNrOiB0cnVlLCBcblx0cmVtb3ZlQ2hpbGRUYWdzRmlyc3Q6IHRydWUsIFxuXHRvcHRUb0NvbnZlcnQ6IHRydWUsIFxuXHRtb2JpbGVUYWdTZWFyY2g6IGZhbHNlLCBcblx0bW9iaWxlTm90aWNlczogdHJ1ZSxcblx0dGFnU3VtbWFyeUJsb2NrQnV0dG9uczogZmFsc2UsXG5cdHRhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXg6ICcnLFxuXHRyZWNlbnRseUFkZGVkVGFnczogJycsXG5cdGxvY2tSZWNlbnRUYWdzOiBmYWxzZSxcblx0c2hvd1N1bW1hcnlCdXR0b25zOmZhbHNlLFxuXHRkZWJ1Z01vZGU6IGZhbHNlLFxufTsgXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFRhZ0J1ZGR5IGV4dGVuZHMgUGx1Z2luIHsgIFxuXHRzZXR0aW5nczogVEJTZXR0aW5ncztcblx0Z3VpOiBHVUk7XG5cdHRhZ1N1bW1hcnk6IFRhZ1N1bW1hcnk7XG5cdHRhZ1Byb2Nlc3NvcjogVGFnUHJvY2Vzc29yO1xuXHR0YWdFZGl0b3I6IFJlYWRpbmdNb2RlVGFnRWRpdG9yO1xuXHRwcml2YXRlIGFjdGl2ZUZpbGU6IFRGaWxlO1xuXG5cdC8vIG9udW5sb2FkKCkgeyBJIHRoaW5rIGFsbCB0aGUgY2xlYW51cCBpcyBkb25lIGF1dG9tYXRpY2FsbHkgdGhlIHdheSBJIHJlZ2lzdGVyIGV2ZXJ5dGhpbmcuIH0gXG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgUGx1Z2luIGxvYWRlZCBvbiAnIFxuXHRcdFx0KyAodGhpcy5hcHAuaXNNb2JpbGUgPyAnbW9iaWxlIGF0ICc6J2Rlc2t0b3AgYXQgJykgXG5cdFx0XHQrIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKS5zdWJzdHJpbmcoMTcpKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVEJTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHRcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblxuXHRcdFx0dGhpcy5ndWkgPSBuZXcgR1VJKHRoaXMuYXBwLCB0aGlzKVxuXHRcdFx0dGhpcy50YWdTdW1tYXJ5ID0gbmV3IFRhZ1N1bW1hcnkgKHRoaXMuYXBwLCB0aGlzKTtcblx0XHRcdHRoaXMudGFnUHJvY2Vzc29yID0gbmV3IFRhZ1Byb2Nlc3NvciAodGhpcy5hcHAsIHRoaXMpO1xuXHRcdFx0dGhpcy50YWdFZGl0b3IgPSBuZXcgUmVhZGluZ01vZGVUYWdFZGl0b3IgKHRoaXMuYXBwLCB0aGlzKTtcdFxuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKFxuXHRcdFx0dGhpcy50YWdQcm9jZXNzb3IucmVuZGVyUG9zdFByb2Nlc3Nvci5iaW5kKHRoaXMudGFnUHJvY2Vzc29yKVxuXHRcdFx0KVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFxuXHRcdFx0XHRcdCd0YWctc3VtbWFyeScsIFxuXHRcdFx0XHRcdHRoaXMudGFnU3VtbWFyeS5jb2RlQmxvY2tQcm9jZXNzb3IuYmluZCh0aGlzLnRhZ1N1bW1hcnkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGNhdGNoIHt9XG5cdFx0ICAgIFxuXHRcdCAgICAvL3RoaXMucmVnaXN0ZXJFdmVudCggdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCBhc3luYyAoKSA9PiB7IGNvbnNvbGUubG9nKCdhY3RpdmUgbGVhZiBjaGFuZ2UnKSB9KSk7XG5cdFx0ICAgIC8vdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWNoYW5nZScsIGFzeW5jICgpID0+IHsgY29uc29sZS5sb2coJ2VkaXRvciBjaGFuZ2UnKTsgIH0sIHRydWUpKTtcblx0XHQgICAgLy90aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpKSk7XG5cdFx0ICAgIFxuXHRcdCAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0ICAgIFx0ZG9jdW1lbnQsIFxuXHRcdCAgICBcdCdjb250ZXh0bWVudScsIFxuXHRcdCAgICBcdGFzeW5jIChldmVudDogTW91c2VFdmVudCkgPT4ge1x0XG5cdCAgICBcdFx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdCAgICAgICAgXG5cdFx0XHQgICAgICAgIGlmICh2aWV3ICYmIFxuXHRcdFx0ICAgICAgICBcdFV0aWxzLmN0cmxDbWRLZXkgKGV2ZW50KSAmJlxuXHRcdFx0ICAgICAgICBcdCh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmXG5cdFx0XHQgICAgICAgIFx0KHZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSlcblx0XHQgICAgICAgIFx0KSB7ICAgICAgICAgXG5cdFx0XHQgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0ICAgICAgICAgICAgLy90aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcblx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHQgICAgICAgIH1cblx0XHQgICAgfSk7IFxuXHRcdCAgIFxuXHRcdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm9uKFxuXHRcdFx0XHQnbGF5b3V0LWNoYW5nZScsIFxuXHRcdFx0XHRhc3luYyAoZXZlbnQ6IEVkaXRvckV2ZW50KSA9PiB7ICBcblx0XHRcdFx0XHRjb25zdCBtb2RlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZ2V0TW9kZSgpO1xuXHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogbGF5b3V0LWNoYW5nZTonLCBtb2RlKTtcblx0XHRcdFx0XHRpZiAobW9kZSA9PSAncHJldmlldycpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnJlc2V0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLnRhZ1Byb2Nlc3Nvci5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscygpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnc291cmNlJykge1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0KSk7XG5cdFx0XHRcblx0XHRcdC8vZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFxuXHRcdFx0XHQnZmlsZS1vcGVuJywgXG5cdFx0XHRcdC8vZGVib3VuY2UoXG5cdFx0XHRcdGFzeW5jIChldmVudDogRWRpdG9yRXZlbnQpID0+IHsgXG5cdFx0XHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBsYXN0IGFjdGl2ZSBmaWxlOicsIHRoaXMuYWN0aXZlRmlsZT8ubmFtZSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBmaWxlIG9wZW46JywgYWN0aXZlRmlsZS5uYW1lKVxuXHRcdFx0XHRcdGlmIChhY3RpdmVGaWxlLnBhdGggIT0gdGhpcy5hY3RpdmVGaWxlPy5wYXRoKSB7XG5cdFx0XHRcdFx0XHR0aGlzLnRhZ1Byb2Nlc3Nvci5yZXNldCgpO1xuXHRcdFx0XHRcdFx0dGhpcy5hY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0XHRcdGlmICh0aGlzLnRhZ1Byb2Nlc3Nvcikge1xuXHRcdFx0XHRcdFx0XHR0aGlzLnRhZ1Byb2Nlc3Nvci5wcm9jZXNzQWN0aXZlRmlsZVRhZ3MoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vY29uc29sZS5sb2coJ2ZpbGUgb3BlbjonLCBhY3RpdmVGaWxlLm5hbWUpXG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdH1cblx0XHRcdFx0Ly8sIDMwMDAsIHRydWUpXG5cdFx0XHQpKTtcblxuXHRcdFx0Ly8gTm90IGRvaW5nIHRoaXMgYmVjYXVzZSB0aGV5IG5lZWQgdG8gb3B0K2NsaWNrIG9uIGEgdGFnIHRvIHBhc3MgaXRcblx0XHRcdC8vIEkgZG9uJ3Qgd2FudCB0byBoYXZlIHRvIGFkZCBhIHRhZyBzZWxlY3RvciBpbiB0aGUgZWRpdG9yXG5cdFx0XHQvLyB0aGluayBvbiBtb2JpbGUuLi4gdG9vIG1hbnkgbGF5ZXJzIG9mIG1vZGFscy5cblx0XHRcdC8qdGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdFx0aWQ6IFwidGFnYnVkZHktdGFnLWFjdGlvbnNcIixcblx0XHRcdFx0bmFtZTogXCJUYWcgQWN0aW9uXCIsXG5cdFx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdFx0Ly90aGlzLmd1aS5zaG93VGFnRWRpdG9yKClcblx0XHRcdFx0XHR0aGlzLmd1aS5zaG93VGFnRWRpdG9yKClcblx0XHRcdFx0fSxcblx0XHRcdH0pOyovXG5cblx0XHRcdC8vdGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LmJvZHksICdzY3JvbGwnLCAoZXZlbnQpID0+IHt9LCB0cnVlKTtcblxuXHRcdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0XHQvLyBUaGlzIGV2ZW50IGhhbmRsZXMgYWxsIHRoZSBpbnRlcmFjdGlvbnMgb24gZGVza3RvcFxuXHRcdFx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0XHRcdFx0ZG9jdW1lbnQsIFxuXHRcdFx0XHRcdCdjbGljaycsIFxuXHRcdFx0XHRcdHRoaXMub25DbGlja0V2ZW50LmJpbmQodGhpcyksIFxuXHRcdFx0XHRcdHRydWVcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7IC8vIE1vYmlsZSBpbnRlcmFjdGlvblxuXHRcdFx0XHQvLyBUaGlzIGV2ZW50IGNhdGNoZXMgYWxsIHRhcHMgb24gbW9iaWxlIGJlY2F1c2Ugd2UgaGF2ZSBjdXN0b20gZG91YmxlLXRhcCBhbmQgcHJlc3MtaG9sZCBldmVudHMuXG5cdFx0XHRcdC8vIEJ1dCB3ZSBvbmx5IHN0b3AgYWxsIG90aGVyIG1vYmlsZSBldmVudHMgaWYgdGhpcyBjbGljayB3YXMgb24gYSB0YWcuIFxuXHRcdFx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0XHRcdFx0ZG9jdW1lbnQsIFxuXHRcdFx0XHRcdCdjbGljaycsIFxuXHRcdFx0XHRcdChlOkV2ZW50KSA9PiB7IFxuXHRcdFx0XHRcdFx0Y29uc3QgaXNUYWcgPSBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3RhZycpO1xuXHRcdFx0XHRcdFx0aWYgKGlzVGFnICYmICF0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkge1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcdFxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sIHRydWVcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRuZXcgTW9iaWxlLlByZXNzQW5kSG9sZEhhbmRsZXIoXG5cdFx0XHRcdFx0dGhpcywgXG5cdFx0XHRcdFx0ZG9jdW1lbnQsIFxuXHRcdFx0XHRcdChldmVudCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5ndWkuc2hvd1RhZ0VkaXRvcihldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Ly90aGlzLm9uQ2xpY2tFdmVudC5iaW5kKHRoaXMpXG5cdFx0XHRcdCk7XG5cdFx0XHRcdG5ldyBNb2JpbGUuRG91YmxlVGFwSGFuZGxlcihcblx0XHRcdFx0XHR0aGlzLCBcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0dGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKVxuXHRcdFx0XHQpO1xuXHRcdFx0XHRuZXcgTW9iaWxlLlRyaXBsZVRhcEhhbmRsZXIoXG5cdFx0XHRcdFx0dGhpcyxcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0YXN5bmMgKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiB7XHRcblx0XHQgICAgXHRcdFx0Y29uc3QgdmlldyA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cdFx0XHRcdCAgICAgICAgaWYgKHZpZXcgJiYgXG5cdFx0XHRcdCAgICAgICAgXHQodmlldy5nZXRNb2RlKCkgPT0gJ3ByZXZpZXcnKSAmJlxuXHRcdFx0XHQgICAgICAgIFx0KHZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSlcblx0XHRcdCAgICAgICAgXHQpIHsgICAgICAgICBcblx0XHRcdFx0ICAgICAgICBcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHRcdCAgICAgICAgfVxuXHRcdCAgICBcdFx0fSwgdHJ1ZVxuXHRcdFx0XHRcdC8vdGhpcy5ndWkuc2hvd1RhZ1NlbGVjdG9yLmJpbmQodGhpcy5ndWkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9XHRcblxuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgb25DbGlja0V2ZW50IChcblx0XHRldmVudDogRXZlbnRcblx0KTp2b2lkIHtcblx0XHQvLyBTdXBwb3J0IGZvciBkaWZmZXJlbnQgdmlld3M/IFxuXHRcdC8vIElmIHRhZyBoYXMgbm8gY29udGV4dCBwcm9wZXJ0aWVzLCB0aGVuIHRyeSB0byBmaWd1cmUgb3V0IHdoZXJlIGl0IGlzP1xuXHRcdC8vbmV3IE5vdGljZSAoJ1RhZyBCdWRkeSBldmVudCB0eXBlOiAnICsgZXZlbnQudHlwZSk7XG5cblx0XHRjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0Y29uc3QgdmlldyA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cblx0XHQvLyBUaGlzIGNvbmRpdGlvbiBpdCBpbiBjYXNlIHdlIGNsaWNrIG9uIGEgdGFnIGluIGFub3RoZXIgcGx1Z2luIGxpa2UgcmVwZWF0IG9yIGNoZWNrbGlzdFxuXHRcdC8vIENhbid0IGVkaXQgdGFncyBpbiB0aGVzZSBjYXNlcy4gRm9yIG5vdy5cblx0XHRpZiAoIXZpZXcgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkgeyBcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gVW5zdXBwb3J0ZWQgdmlldyB0eXBlLiBUcnkgYWdhaW4gd2l0aGluIHRoZSBzb3VyY2Ugbm90ZS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmlldykgeyBcblx0XHRcdGlmICh2aWV3LmdldE1vZGUoKSAhPSAncHJldmlldycgfHwgIXZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkgcmV0dXJuO1xuXHRcdH0gXG5cdFxuXG5cdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblx0XHRcdGlmICgodGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrICYmIFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpKSBcblx0XHRcdFx0fHwgKCF0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgIVV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpKSkgeyBcblx0XHRcdFx0cmV0dXJuOyBcblx0XHRcdC8vfSBlbHNlIGlmIChldmVudC5hbHRLZXkgJiYgIXRoaXMuc2V0dGluZ3Mub3B0VG9Db252ZXJ0KSB7ICBcblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuYWx0S2V5ICYmIHRhcmdldCAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7ICBcblxuLy9jb25zb2xlLmxvZyhldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFx0Ly8gZ2V0IHRoZSB0YWcgdmlhOiBldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dFxuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5ndWkuc2hvd1RhZ0VkaXRvcihldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFxuXHRcdFx0XHRyZXR1cm47IFxuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0Ly8gUmVtb3ZlcyB0aGUgYXV0b21hdGljIHN5c3RlbSBzZWxlY3Rpb24gb24gbW9iaWxlLiBcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4geyBcblx0XHRcdFx0Y29uc3Qgc2VsZWN0aW9uID0gd2luZG93LmdldFNlbGVjdGlvbigpO1xuXHRcdFx0XHRpZiAoc2VsZWN0aW9uKSBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XG5cdFx0XHR9LCA0MDApXG5cblx0XHRcdC8qaWYgKGV2ZW50LnR5cGUgPT0gJ3RvdWNoc3RhcnQnKXtcblx0XHRcdFx0Y29uc29sZS5sb2coJ2hhbmRsZSB0b3VjaCBzdGFydCcpXG5cdFx0XHRcdC8vZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0dGhpcy5ndWkuc2hvd1RhZ0VkaXRvcihldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fSBlbHNlICovXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggJiYgZXZlbnQudHlwZSA9PSAndG91Y2hlbmQnKSB7XG5cdFx0XHRcdC8vIGlmIHdlIGdldCB0aGlzIGZhciwgdGhpcyBpcyBhIGRvdWJsZSB0YXBcblx0XHRcdFx0Y29uc29sZS5sb2coJ2hhbmRsZSB0b3VjaCBlbmQnKVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9IFxuXHRcdH1cbiBcblx0XHRpZiAodGFyZ2V0ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHtcdFxuXHRcdFx0Ly8gY29uc3Qgc2Nyb2xsU3RhdGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5jdXJyZW50TW9kZT8uZ2V0U2Nyb2xsKCk7XG5cblx0XHRcdGlmICh0aGlzLnRhZ1Byb2Nlc3Nvci5vdXRPZlN5bmMpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnTWFya2Rvd24gc291cmNlIGFuZCBwcmV2aWV3IHRhZ3MgYXJlIG91dCBvZiBzeW5jLiBQbGVhc2UgY2xvc2UgYW5kIHJlbG9hZCB0aGlzIG5vdGUuJyk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MucmVtb3ZlT25DbGljayBcblx0XHRcdFx0fHwgKCF0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgVXRpbHMuY3RybENtZEtleShldmVudCkpKSB7XG5cdFx0XHRcdGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBjbGlja2VkVGFnID0gdGFyZ2V0LmNsb3Nlc3QoJy50YWcnKTsgXG5cdFx0XHRjb25zdCB0YWcgPSBjbGlja2VkVGFnLmlubmVyVGV4dDtcblxuXHRcdFx0bGV0IHRhZ0luZGV4ID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4Jyk7XG5cdFx0XHRsZXQgdGFnRmlsZSA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpO1xuXG5cdFx0XHRpZiAodGFnRmlsZSkge1xuXHRcdFx0XHQvLyBUcnlcblx0XHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdChcblx0XHRcdFx0XHR0YXJnZXQsIFxuXHRcdFx0XHRcdGV2ZW50XG5cdFx0XHRcdCk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBUcnkgYWdhaW5cblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0dGFnSW5kZXggPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblx0XHRcdFx0XHR0YWdGaWxlID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cdFx0XHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdCAoXG5cdFx0XHRcdFx0XHR0YXJnZXQsIFxuXHRcdFx0XHRcdFx0ZXZlbnRcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHR9LCAzMDApO1xuXHRcdFx0fVxuXG5cdFx0fSBlbHNlIGlmICghdmlldyAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IENhblxcJ3QgZWRpdCB0YWcuIE1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIHZpZXcgdHlwZS4nKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBsb2FkU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxuXHRcblx0Z2V0VGFnc0Zyb21BcHAoKTogc3RyaW5nW10ge1xuXHQgICAgY29uc3QgdGFnc09iamVjdCA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0VGFncygpO1xuXG5cdCAgICAvLyBDb252ZXJ0IHRhZ3NPYmplY3QgdG8gYW4gYXJyYXkgb2YgW3RhZywgY291bnRdIHR1cGxlc1xuXHQgICAgY29uc3QgdGFnc0FycmF5ID0gT2JqZWN0LmVudHJpZXModGFnc09iamVjdCk7XG5cblx0ICAgIC8vIFNvcnQgYnkgdXNlIGNvdW50XG5cdCAgICB0YWdzQXJyYXkuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pO1xuXG5cdCAgICBjb25zdCByZWNlbnRUYWdzID0gdGhpcy5nZXRSZWNlbnRUYWdzKCk7XG5cdCAgIC8vIGNvbnNvbGUubG9nKCdyZWNlbnQgdGFnIGxlbmd0aDogJyArIHJlY2VudFRhZ3MubGVuZ3RoKVxuXG5cdCAgICBpZiAocmVjZW50VGFncy5sZW5ndGg+MCkge1xuXHQgICAgXHQvL2NvbnNvbGUubG9nKHJlY2VudFRhZ3MpXG5cdCAgICBcdC8vIGNvbnZlcnQgdGhlbSB0byBbdGFnLCBjb3VudF0gdHVwbGVzIGZvciBjb25zaXN0ZW5jeVxuXHQgICBcdFx0Y29uc3QgcmVjZW50VGFnc0FzVHVwbGVzID0gcmVjZW50VGFncy5tYXAodGFnID0+IFt0YWcsIDBdKTtcblx0ICAgIFx0Ly8gQ29uY2F0ZW5hdGUgdGhlIHR3byBhcnJheXNcblx0ICAgIFx0Y29uc3QgcmVjZW50QW5kQWxsVGFncyA9IHJlY2VudFRhZ3NBc1R1cGxlcy5jb25jYXQodGFnc0FycmF5KTtcblx0ICAgIFx0Ly8gRXh0cmFjdCB0YWcgbmFtZXMgYWZ0ZXIgcmVtb3ZpbmcgdGhlICNcblx0ICAgIFx0cmV0dXJuIHJlY2VudEFuZEFsbFRhZ3MubWFwKChbdGFnLCBfXSkgPT4gdGFnLnJlcGxhY2UoL14jLywgXCJcIikpO1xuICAgICAgIFx0fSBlbHNlIHtcbiAgICAgICBcdFx0cmV0dXJuIHRhZ3NBcnJheS5tYXAoKFt0YWcsIF9dKSA9PiB0YWcucmVwbGFjZSgvXiMvLCBcIlwiKSk7XG4gICAgICAgXHR9XG5cdH1cblxuXHRzYXZlUmVjZW50VGFnIChcblx0XHR0YWc6c3RyaW5nXG5cdCk6dm9pZCB7XG5cdFx0aWYgKFV0aWxzLmlzVGFnVmFsaWQodGFnKSkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYWNjZXB0ZWQ6JywgdGFnKVxuXHRcdFx0Y29uc3QgcmVjZW50VGFnc1N0cmluZyA9IHRoaXMuc2V0dGluZ3MucmVjZW50bHlBZGRlZFRhZ3M7XG5cdFx0XHRsZXQgcmVjZW50VGFnczpBcnJheTtcblx0XHRcdGlmIChyZWNlbnRUYWdzU3RyaW5nID09ICcnKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSBbXTtcblx0XHRcdH0gZWxzZSBpZiAocmVjZW50VGFnc1N0cmluZy5pbmRleE9mKCcsICcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSB0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzLnNwbGl0KCcsICcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVjZW50VGFncyA9IFt0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzXVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAocmVjZW50VGFncy5pbmNsdWRlcyh0YWcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3Muc3BsaWNlKHJlY2VudFRhZ3MuaW5kZXhPZih0YWcpLCAxKTtcblx0XHRcdH1cblxuXHRcdFx0cmVjZW50VGFncy51bnNoaWZ0KHRhZy50cmltKCkpO1xuXHRcdFx0cmVjZW50VGFncyA9IHJlY2VudFRhZ3Muc2xpY2UoMCwgMyk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzID0gcmVjZW50VGFncy5qb2luKCcsICcpO1xuXHRcdFx0dGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygncmVqZWN0ZWQ6JywgdGFnKVxuXHRcdH1cblx0fVxuXG5cdGdldFJlY2VudFRhZ3MgKCk6QXJyYXkge1xuXHRcdGNvbnN0IHJlY2VudFRhZ3MgPSBcblx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzPT0nJyA/IFxuXHRcdFtdIDogdGhpcy5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncy5zcGxpdCgnLCAnKTtcblx0XHRyZXR1cm4gcmVjZW50VGFncztcblx0fVxufVxuIiwgImltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBUQlNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5KSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuICAgIFxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIC8vY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiVGFnIEJ1ZGR5XCIgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiT3ZlcnJpZGUgbmF0aXZlIHRhZyBzZWFyY2ggb24gY2xpY2tcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgT0ZGIHRvIHVzZSBDVFJML0NNRCtDTElDSyB0byByZW1vdmUgdGFnLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiQ29udmVydCB0byB0YWcgdGV4dCAocmVtb3ZlcyAjKVwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gdXNlIE9QVC9BTFQrQ0xJQ0sgdG8gcGVyZm9ybSBuYXRpdmUgdGFnIHNlYXJjaC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3B0VG9Db252ZXJ0KVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wdFRvQ29udmVydCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJSZW1vdmUgbmVzdGVkIHRhZ3MgZmlyc3RcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgT0ZGIHRvIHVzZSBTSElGVCtDTElDSyB0byByZW1vdmUgbmVzdGVkIHRhZ3MgZmlyc3QuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUNoaWxkVGFnc0ZpcnN0KVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUNoaWxkVGFnc0ZpcnN0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIk1vYmlsZSB0YWcgc2VhcmNoXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9OIHRvIHJlc3RvcmUgbW9iaWxlIG5hdGl2ZSB0YWcgc2VhcmNoIG9uIHRhcC4gVGFnIHJlbW92YWwgd2lsbCB0aGVuIHVzZSBMT05HIFBSRVNTLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2gpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlVGFnU2VhcmNoID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlNob3cgbW9iaWxlIG5vdGljZXNcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgT0ZGIHRvIGhpZGUgbm90aWNlcyB3aGVuIGVkaXRpbmcgb3IgcmVtb3ZpbmcgYSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJTaG93IHRhZyBzdW1tYXJ5IHBhcmFncmFwaCBidXR0b25zXCIpXG4gICAgICAgIC5zZXREZXNjKFwiU2hvdyBidXR0b25zIGJlbG93IGVhY2ggdGFnZ2VkIHBhcmFncmFwaCB0aGF0IGxldCB5b3UgY29weSwgcmVtb3ZlLCBhbmQgbW92ZSB0aGUgcGFyYWdyYXBoLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdTdW1tYXJ5QmxvY2tCdXR0b25zKVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ1N1bW1hcnlCbG9ja0J1dHRvbnMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiU2hvdyB0YWcgc3VtbWFyeSBidXR0b25zXCIpXG4gICAgICAgIC5zZXREZXNjKFwiU2hvdyBidXR0b25zIGJlbG93IGVhY2ggc3VtbWFyeSB0aGF0IGxldCB5b3UgY29weSBvciBtYWtlIGEgbm90ZSBmcm9tIHRoZSBzdW1tYXJ5LlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3VtbWFyeUJ1dHRvbnMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muc2hvd1N1bW1hcnlCdXR0b25zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gc2VjdGlvbiBwcmVmaXhcIilcbiAgICAgICAgLnNldERlc2MoXCJXaGVuIG1vdmluZyBhIHRhZ2dlZCBwYXJhZ3JhcGggZnJvbSB0YWcgc3VtbWFyaWVzIGJlbG93IG5vdGUgaGVhZGVyIHNlY3Rpb25zIHVzZSB0aGlzIHByZWZpeDpcXG5FeGFtcGxlOiAnLSAnLCAnPiAnLCAnLSBbIF0nXCIpXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG4gICAgICAgICAgICB0ZXh0XG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnZ2VkUGFyYWdyYXBoQ29weVByZWZpeClcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdnZWRQYXJhZ3JhcGhDb3B5UHJlZml4KVxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBpc1ZhbGlkVGFnKHRhZykge1xuICAgICAgICAgICAgY29uc3QgdGFnUGF0dGVybiA9IC9eI1tcXHddKyQvO1xuICAgICAgICAgICAgcmV0dXJuIHRhZ1BhdHRlcm4udGVzdCh0YWcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmlsdGVyQW5kSm9pblRhZ3ModGFnc1N0cmluZykge1xuICAgICAgICAgICAgY29uc3QgdGFnc0FycmF5ID0gdGFnc1N0cmluZy5zcGxpdChcIiwgXCIpO1xuICAgICAgICAgICAgY29uc3QgdmFsaWRUYWdzID0gdGFnc0FycmF5LmZpbHRlcihpc1ZhbGlkVGFnKTtcbiAgICAgICAgICAgIHJldHVybiB2YWxpZFRhZ3Muam9pbihcIiwgXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkaW5nIHdpbGwgYWx3YXlzIGxpbWl0IHRvIDMuIEJ1dCBpZiB0aGV5IGVkaXQgaXQgaGVyZSwgaXQgY2FuIGJlIGFueSBsZW5ndGguXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVGhlIG1vc3QgcmVjZW50IHRhZ3MgYWRkZWQgdmlhIFRhZyBCdWRkeSBhcmUgc3RvcmVkIGhlcmUuIFRoZXNlIHdpbGwgc2hvdyB1cCBmaXJzdCBpbiB0aGUgbGlzdCB3aGVuIGFkZGluZy5cIilcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncyA9IGZpbHRlckFuZEpvaW5UYWdzKHZhbHVlKTsgLy92YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJMb2NrIHJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9OIHRvIGxvY2sgdGhlIHJlY2VudCB0YWdzIGxpc3QuIFJlY2VudCB0YWdzIHdpbGwgbm90IGJlIHVwZGF0ZWQuIEluc3RlYWQsIHRoZSB0YWdzIGFib3ZlIHdpbGwgYWN0IGxpa2UgYSBmYXZvcml0ZXMgbGlzdC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2hyJyk7XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDFcIiwgeyB0ZXh0OiBcIlN1cHBvcnQgYSBidWRkeVwiIH0pO1xuICAgICAgICBjb25zdCBkb25hdGVMaW5rID0gY29udGFpbmVyRWwuY3JlYXRlRWwoJ2EnKTtcbiAgICAgICAgZG9uYXRlTGluay5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCAnaHR0cHM6Ly93d3cuYnV5bWVhY29mZmVlLmNvbS9tb3JlbWV5b3UnKTtcbiAgICAgICAgY29uc3QgZG9uYXRlQnV0dG9uID0gY3JlYXRlRWwoJ2ltZycpO1xuICAgICAgICBkb25hdGVCdXR0b24uc2V0QXR0cmlidXRlKCdzcmMnLCAnaHR0cHM6Ly9jZG4uYnV5bWVhY29mZmVlLmNvbS9idXR0b25zL3YyL2RlZmF1bHQteWVsbG93LnBuZycpO1xuICAgICAgICBkb25hdGVCdXR0b24uc2V0QXR0cmlidXRlKCdhbHQnLCAnQnV5IE1lIEEgQ29mZmVlJyk7XG4gICAgICAgIGRvbmF0ZUJ1dHRvbi5zdHlsZSA9ICdoZWlnaHQ6IDQwcHggIWltcG9ydGFudDt3aWR0aDogMTUwcHggIWltcG9ydGFudDsnXG4gICAgICAgIGRvbmF0ZUxpbmsuYXBwZW5kQ2hpbGQoZG9uYXRlQnV0dG9uKVxuICAgICAgICAvLy5pbm5lckhUTUwgPSBgPGltZyBzcmM9XCJodHRwczovL2Nkbi5idXltZWFjb2ZmZWUuY29tL2J1dHRvbnMvdjIvZGVmYXVsdC15ZWxsb3cucG5nXCIgYWx0PVwiQnV5IE1lIEEgQ29mZmVlXCIgc3R5bGU9XCJoZWlnaHQ6IDQwcHggIWltcG9ydGFudDt3aWR0aDogMTUwcHggIWltcG9ydGFudDtcIiA+PC9hPmA7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2JyJyk7XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdicicpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnYnInKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJEZWJ1ZyBtb2RlXCIpXG4gICAgICAgIC5zZXREZXNjKFwiT3V0cHV0IHRvIGNvbnNvbGUuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSlcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBEcm9wZG93bkNvbXBvbmVudCwgc2V0SWNvbiwgTWFya2Rvd25SZW5kZXJlciwgRHJvcGRvd25Db21wb25lbnQsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB0eXBlIHsgQXBwIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcbmltcG9ydCB7IFRhZ1NlbGVjdG9yIH0gZnJvbSAnLi9Nb2RhbCdcbmltcG9ydCB7IFRCVGFnRWRpdG9yTW9kYWwgfSBmcm9tICcuL1RhZ0VkaXRvck1vZGFsJ1xuaW1wb3J0IHsgU2VsZWN0RmlsZU1vZGFsIH0gZnJvbSAnLi9GaW5kRmlsZU1vZGFsJ1xuXG5leHBvcnQgY2xhc3MgR1VJIHtcblx0YXBwOiBBcHA7IFxuXHRwbHVnaW46IFRhZ0J1ZGR5O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdHNob3dUYWdFZGl0b3IgKHRhZyA9ICcnKSB7XG5cblx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBtb2RlID0gdmlldz8uZ2V0TW9kZSgpO1xuXHRcblx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUpIHtcblx0XHRcdFxuXHRcdH0gZWxzZSB7XG5cdFx0XG5cdFx0fVxuXG4gICAgICAgXHRpZiAobW9kZSA9PSAncHJldmlldycpIHtcblx0XHRcdFxuXHRcdFx0Y29uc3QgdGFnRWRpdG9yTW9kYWw6IFRCVGFnRWRpdG9yTW9kYWwgPSBuZXcgVEJUYWdFZGl0b3JNb2RhbCAoXG5cdFx0XHRcdHRoaXMuYXBwLCBcblx0XHRcdFx0dGhpcy5wbHVnaW4sXG5cdFx0XHRcdHRhZy8vLFxuXHRcdFx0XHQvLyh0YWcpPT57XG5cdFx0XHRcdC8vXHRjb25zb2xlLmxvZyh0YWcpIFxuXHRcdFx0XHQvL31cblx0XHRcdCkub3BlbigpO1xuXG5cdFx0fVxuXG5cblx0fVxuXG5cdGlzVGFnVmFsaWQgKHRhZzpzdHJpbmcpOmJvb2xlYW4geyAvLyBpbmNsdWRpbmcgdGhlICNcblx0XHRjb25zdCB0YWdQYXR0ZXJuID0gL14jW1xcd10rJC87XG5cdFx0cmV0dXJuIHRhZ1BhdHRlcm4udGVzdCh0YWcpO1xuXHR9XG5cblx0bWFrZUJ1dHRvbiAoXG5cdFx0bGFibGU6IHN0cmluZywgXG5cdFx0Y2xpY2tGbjogKGU6IEV2ZW50KSA9PiB2b2lkLCBcblx0XHRjbGFzc0lkPSd0YWdzdW1tYXJ5LWJ1dHRvbidcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gY3JlYXRlRWwoJ2J1dHRvbicpO1xuXHQgICAgLy9idXR0b24uaW5uZXJUZXh0ID0gbGFibGU7XG4gICAgXHRzZXRJY29uKGJ1dHRvbiwgbGFibGUpO1xuXHQgICAgYnV0dG9uLmNsYXNzTmFtZSA9IGNsYXNzSWQ7XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0YnV0dG9uLCBcblx0XHRcdCdjbGljaycsIFxuXHRcdFx0Y2xpY2tGblxuXHRcdCk7XG5cblx0ICAgIHJldHVybiBidXR0b247XG5cdH1cblxuXG5cdG1ha2VCbG9ja1NlbGVjdG9yIChcblx0XHRpbmRleDogTnVtYmVyXG5cdCk6IEhUTUxFbGVtZW50IHtcblx0XHRcblx0XHRjb25zdCBjaGVja2JveEVsID0gY3JlYXRlRWwgKCdkaXYnKTtcblx0XHQvL2NoZWNrYm94RWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWNoZWNrYm94Jylcblx0XHRjaGVja2JveEVsLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBpbmRleClcblxuXHRcdGxldCBjaGVja2VkQnRuO1xuXHRcdGxldCB1bmNoZWNrZWRCdG47XG5cblx0XHRjb25zdCBjaGVja0JveCA9IGZ1bmN0aW9uIChib29sOiBCb29sZWFuKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGNoZWNrYm94RWwuZ2V0QXR0cmlidXRlKCdpbmRleCcpKVxuXG5cdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZVNlbGVjdGlvbiAocGFyc2VJbnQoY2hlY2tib3hFbC5nZXRBdHRyaWJ1dGUoJ2luZGV4JykpLCBib29sKTtcblx0XHRcdGlmIChib29sKSB7XG5cdFx0XHRcdHVuY2hlY2tlZEJ0bi5yZW1vdmUoKTtcblx0XHRcdFx0Y2hlY2tib3hFbC5hcHBlbmRDaGlsZChjaGVja2VkQnRuKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoZWNrZWRCdG4ucmVtb3ZlKCk7XG5cdFx0XHRcdGNoZWNrYm94RWwuYXBwZW5kQ2hpbGQodW5jaGVja2VkQnRuKTtcblx0XHRcdH0gXG5cdFx0fS5iaW5kKHRoaXMpO1xuXG5cdFx0Y2hlY2tlZEJ0biA9IHRoaXMubWFrZUJ1dHRvbiAoJ2NoZWNrLXNxdWFyZScsIChlKSA9PiB7IFxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGNoZWNrQm94KGZhbHNlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3ggY2hlY2tlZCcpO1xuXHRcdGNoZWNrZWRCdG4udGl0bGUgPSAnVW5zZWxlY3QgdGhpcyBwYXJhZ3JhcGguJztcblx0XHRcblx0XHR1bmNoZWNrZWRCdG4gPSB0aGlzLm1ha2VCdXR0b24gKCdzcXVhcmUnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjaGVja0JveCh0cnVlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3gnKTtcblx0XHR1bmNoZWNrZWRCdG4udGl0bGUgPSAnU2VsZWN0IHRoaXMgcGFyYWdyYXBoLic7XG5cblx0XHRjaGVja0JveCAoZmFsc2UpXG5cblx0XHRyZXR1cm4gY2hlY2tib3hFbDtcblxuXHR9XG5cblx0bWFrZVJlbW92ZVRhZ0J1dHRvbiAoXG5cdFx0Y2xpY2tGbjogRnVuY3Rpb24sXG5cdFx0cGFyYWdyYXBoRWw6IEVsZW1lbnQsIFxuXHRcdHRhZzogc3RyaW5nLy8sIFxuXHRcdC8vZmlsZVBhdGg6IHN0cmluZ1xuXHQpOkhUTUxCdXR0b25FbGVtZW50IHtcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24gKCdsaXN0LXgnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdGNsaWNrRm4oZSwgcGFyYWdyYXBoRWwsIHRhZylcblxuXHRcdFx0Ly9jb25zdCB0YWdFbCA9IFV0aWxzLmdldFRhZ0VsZW1lbnQocGFyYWdyYXBoRWwsIHRhZyk7XG5cdFx0XHQvL3RoaXMucGx1Z2luLnRhZ0VkaXRvci5lZGl0KHRhZ0VsKTtcblx0XHR9KTtcblx0XHRidXR0b24udGl0bGUgPSAnUmVtb3ZlZCAnICsgdGFnICsgJyBmcm9tIHBhcmFncmFwaC4nO1xuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlU3VtbWFyeVJlZnJlc2hCdXR0b24gKFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudFxuXHQpOiBIVE1MRWxlbWVudCB7XHRcblx0XHRcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24oXG5cdFx0XHQncmVmcmVzaC1jY3cnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUoc3VtbWFyeUVsKTtcblx0XHRcdFx0Ly90aGlzLnVwZGF0ZVN1bW1hcnkoc3VtbWFyeUVsKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1RhZyBTdW1tYXJ5IHVwZGF0ZWQnKTtcblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHRcdC8vdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnJ1bigpOyBcblx0XHRcdFx0fSwgMTApO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnUmVmcmVzaCB0YWcgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlUb1NlY3Rpb24gKFxuXHRcdGNsaWNrRm46RnVuY3Rpb24sXG5cdFx0Y29udGVudDogc3RyaW5nLCBcblx0XHRzZWN0aW9uczogc3RyaW5nW10sIFxuXHRcdHRhZ3M6IEFycmF5LCBcblx0XHRmaWxlUGF0aDogc3RyaW5nLCBcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnRcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgY29weVRvRWw6IEhUTUxFbGVtZW50ID0gY3JlYXRlRWwoJ3NwYW4nKTtcblx0XHRjb25zdCBzZWxlY3RFbDogSFRNTFNlbGVjdEVsZW1lbnQgPSBjcmVhdGVFbCgnc2VsZWN0RWwnKTtcblx0XHRsZXQgZHJvcGRvd24gPSBuZXcgRHJvcGRvd25Db21wb25lbnQoc2VsZWN0RWwpO1xuXHRcdHNlY3Rpb25zLmZvckVhY2goKHNlYykgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHNlYywgVXRpbHMudHJ1bmNhdGVTdHJpbmdBdFdvcmQoc2VjLCAxNikpOyBcblx0XHR9KTtcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ3RvcCcsICdUb3Agb2Ygbm90ZScpOyBcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ2VuZCcsICdFbmQgb2Ygbm90ZScpOyBcblx0XHRcblx0XHRzZWxlY3RFbC5xdWVyeVNlbGVjdG9yKCdzZWxlY3QnKS5jbGFzc05hbWUgPSAndGFnc3VtbWFyeS1kcm9wZG93bic7XG5cblx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdGNsaWNrRm4sXG5cdFx0XHRcdCdub3RlJyxcdFxuXHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0cGFyYWdyYXBoRWwsIFxuXHRcdFx0XHRzdW1tYXJ5RWwsXG5cdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdHRhZ3MsXG5cdFx0XHRcdGZpbGVQYXRoIFxuXHRcdFx0KVxuXHRcdClcblx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdGNsaWNrRm4sXG5cdFx0XHRcdCdsaW5rJyxcdFxuXHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0cGFyYWdyYXBoRWwsIFxuXHRcdFx0XHRzdW1tYXJ5RWwsXG5cdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdHRhZ3MsXG5cdFx0XHRcdGZpbGVQYXRoIFxuXHRcdFx0KVxuXHRcdClcblx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdGNsaWNrRm4sXG5cdFx0XHRcdCdjb3B5Jyxcblx0XHRcdFx0ZHJvcGRvd24sXG5cdFx0XHRcdHBhcmFncmFwaEVsLCBcblx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRjb250ZW50LFxuXHRcdFx0XHR0YWdzLFxuXHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdClcblx0XHQpXG5cdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHR0aGlzLm1ha2VDb3B5VG9CdXR0b24gKFxuXHRcdFx0XHRjbGlja0ZuLFxuXHRcdFx0XHQnbW92ZScsXG5cdFx0XHRcdGRyb3Bkb3duLFxuXHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdHN1bW1hcnlFbCxcblx0XHRcdFx0Y29udGVudCxcblx0XHRcdFx0dGFncyxcblx0XHRcdFx0ZmlsZVBhdGggXG5cdFx0XHQpXG5cdFx0KVxuXG5cdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoc2VsZWN0RWwpO1xuXG5cblx0XHRyZXR1cm4gY29weVRvRWw7XG5cdH1cblxuXHRtYWtlQ29weVRvQnV0dG9uIChcblx0XHRjbGlja0ZuOiBGdW5jdGlvbixcblx0XHRtb2RlOiBTdHJpbmcsXG5cdFx0ZHJvcGRvd246IERyb3Bkb3duQ29tcG9uZW50LFxuXHRcdHBhcmFncmFwaEVsOiBIVE1MRWxlbWVudCwgXG5cdFx0c3VtbWFyeUVsOiBIVE1MRWxlbWVudCxcblx0XHRjb250ZW50OiBzdHJpbmcsICBcblx0XHR0YWdzOiBBcnJheSwgXG5cdFx0ZmlsZVBhdGg6IHN0cmluZyBcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0bGV0IGJ1dHRvbkxhYmVsO1xuXHRcdGlmIChtb2RlID09ICdsaW5rJykgYnV0dG9uTGFiZWwgPSAnbGluayc7XG5cdFx0ZWxzZSBpZiAobW9kZSA9PSAnY29weScpIGJ1dHRvbkxhYmVsID0gJ2NvcHktcGx1cyc7XG5cdFx0ZWxzZSBpZiAobW9kZSA9PSAnbW92ZScpIGJ1dHRvbkxhYmVsID0gJ3JlcGxhY2UnOyAvLydjb3B5LWNoZWNrJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdub3RlJykgYnV0dG9uTGFiZWwgPSAnZmlsZS1wbHVzLTInO1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uIChidXR0b25MYWJlbCwgKGUpID0+IHsgXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXG5cdFx0XHRpZiAobW9kZSA9PSAnbm90ZScpIHtcblxuXHRcdFx0XHRuZXcgU2VsZWN0RmlsZU1vZGFsKHRoaXMuYXBwLCAocmVzdWx0KSA9PiB7XG5cbiAgXHRcdFx0XHRcdC8vbmV3IE5vdGljZShgRmlsZTogJHtyZXN1bHQubmFtZX1gKTtcblxuICBcdFx0XHRcdFx0Y2xpY2tGbihlLCBtb2RlLCBkcm9wZG93biwgcGFyYWdyYXBoRWwsIHN1bW1hcnlFbCwgY29udGVudCwgdGFncywgZmlsZVBhdGgsIHJlc3VsdCk7XG5cblx0XHRcdFx0fSkub3BlbigpO1xuXG5cdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdGNsaWNrRm4oZSwgbW9kZSwgZHJvcGRvd24sIHBhcmFncmFwaEVsLCBzdW1tYXJ5RWwsIGNvbnRlbnQsIHRhZ3MsIGZpbGVQYXRoKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRsZXQgYnV0dG9uSG92ZXJUZXh0O1xuXHRcdGlmIChtb2RlID09ICdsaW5rJykgYnV0dG9uSG92ZXJUZXh0ID0gJ0NvcHkgcGFyYWdyYXBoIGxpbmsgdG8gc2VjdGlvbi4nIDtcblx0XHRlbHNlIGlmIChtb2RlID09ICdjb3B5JykgYnV0dG9uSG92ZXJUZXh0ID0gJ0NvcHkgcGFyYWdyYXBoIHRvIHNlY3Rpb24uJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdtb3ZlJykgYnV0dG9uSG92ZXJUZXh0ID0gJ01vdmUgcGFyYWdyYXBoIHRvIHNlY3Rpb24uJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdub3RlJykgYnV0dG9uSG92ZXJUZXh0ID0gJ0NvcHkgcGFyYWdyYXBoIHRvIHNlY3Rpb24gaW4gbm90ZS4nO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gYnV0dG9uSG92ZXJUZXh0O1xuXG5cdFx0cmV0dXJuIGJ1dHRvbjtcblx0XHRcblx0fVxuXG5cdG1ha2VCYWtlQnV0dG9uIChcblx0XHRjbGlja0ZuOiBGdW5jdGlvbixcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZywgXG5cdFx0c3VtbWFyeUVsOkhUTUxFbGVtZW50LCBcblx0XHRmaWxlUGF0aDpzdHJpbmdcblx0KTogSFRNTEVsZW1lbnQge1x0XG5cdFx0XG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uIChcblx0XHRcdCdzdGFtcCcsIFxuXHRcdFx0YXN5bmMoZSkgPT4geyBcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0XG5cdFx0XHRcdGNsaWNrRm4gKHN1bW1hcnlNZCwgc3VtbWFyeUVsLCBmaWxlUGF0aClcblxuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnRmxhdHRlbiBzdW1tYXJ5IChyZXBsYWNlcyBjb2RlIGJsb2NrKS4nO1xuXG5cdFx0cmV0dXJuIGJ1dHRvbjtcblx0fVxuXG5cdG1ha2VDb3B5QnV0dG9uIChcblx0XHRjbGlja0ZuLFxuXHRcdGNvbnRlbnRcblx0KTogSFRNTEVsZW1lbnQge1x0XG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uICgnY2xpcGJvYXJkLWxpc3QnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjbGlja0ZuKGUsIGNvbnRlbnQpO1xuXHRcdH0pO1xuXHRcdGJ1dHRvbi50aXRsZSA9ICdDb3B5IHBhcmFncmFwaCc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlTdW1tYXJ5QnV0dG9uIChcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZylcblx0OkhUTUxFbGVtZW50IHtcblxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoXG5cdFx0XHQnY2xpcGJvYXJkLWxpc3QnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc3VtbWFyeU1kKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1N1bW1hcnkgY29waWVkIHRvIGNsaXBib2FyZC4nKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0NvcHkgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZVN1bW1hcnlOb3RlQnV0dG9uIChcblx0XHRjbGlja0ZuOiBGdW5jdGlvbixcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZywgXG5cdFx0dGFnczogQXJyYXlcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uIChcblx0XHRcdCdmaWxlLXBsdXMtMicsIFxuXHRcdFx0YXN5bmMgKGUpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0Y2xpY2tGbiAoc3VtbWFyeU1kLCB0YWdzKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0NyZWF0ZSBub3RlIGZyb20gc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0c2hvd1RhZ1NlbGVjdG9yKGV2ZW50KXtcblx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBtb2RlID0gdmlldz8uZ2V0TW9kZSgpO1xuXHRcdGxldCBwYWdlWCwgcGFnZVlcblx0XHRsZXQgbm9kZVR5cGVcblx0XHRsZXQgZGVlcGVzdE5vZGU7XG5cdFx0bGV0IHJhbmdlXG5cdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlKSB7XG5cdFx0XHRjb25zdCB0b3VjaCA9IGV2ZW50LnRvdWNoZXNbMF0gfHwgZXZlbnQuY2hhbmdlZFRvdWNoZXNbMF07XG5cdFx0XHRwYWdlWCA9IE1hdGgucm91bmQodG91Y2gucGFnZVgpO1xuXHRcdFx0cGFnZVkgPSBNYXRoLnJvdW5kKHRvdWNoLnBhZ2VZKTtcblx0XHRcdC8vY29uc3QgZWwgPSBVdGlscy5nZXREZWVwZXN0VGV4dE5vZGUoZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChwYWdlWCwgcGFnZVkpKVxuXHRcdFx0Ly9jb25zdCBlbCA9IGRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQocGFnZVgsIHBhZ2VZKTtcblx0XHRcdC8vZGVlcGVzdE5vZGUgPSBVdGlscy5nZXREZWVwZXN0Tm9kZShlbCk7XG5cdFx0XHRyYW5nZSA9IGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQocGFnZVgsIHBhZ2VZKVxuXHRcdFx0bm9kZVR5cGUgPSByYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVHlwZSAvL2RlZXBlc3ROb2RlLm5vZGVUeXBlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRwYWdlWCA9IGV2ZW50LnBhZ2VYO1xuXHRcdFx0cGFnZVkgPSBldmVudC5wYWdlWTtcblx0XHRcdHJhbmdlID0gZG9jdW1lbnQuY2FyZXRSYW5nZUZyb21Qb2ludChwYWdlWCwgcGFnZVkpXG5cdFx0XHRub2RlVHlwZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlO1xuXHRcdH1cblxuXHRcdC8vY29uc3QgdGFyZ2V0Q2xhc3NlcyA9IFsndGFnJ107XG4gICAgICAgIC8vaWYgKG1vZGUgPT0gJ3ByZXZpZXcnICYmICF0YXJnZXRDbGFzc2VzLnNvbWUoY2xzID0+IGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoY2xzKSkpIHtcbiAgICAgICBcdGlmIChtb2RlID09ICdwcmV2aWV3Jykge1xuXHRcdFx0aWYgKG5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuXHRcdFx0XHRjb25zdCB0YWdTZWxlY3RvcjogVGFnU2VsZWN0b3IgPSBuZXcgVGFnU2VsZWN0b3IoXG5cdFx0XHRcdFx0dGhpcy5hcHAsIFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLCBcblx0XHRcdFx0XHRldmVudCwgKHRhZyk9Pntcblx0XHRcdFx0XHRcdC8vY29uc29sZS5sb2codGFnKVxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4udGFnRWRpdG9yLmFkZChcblx0XHRcdCAgICAgICAgXHRcdCcjJyArIHRhZywgXG5cdFx0XHQgICAgICAgIFx0XHRwYWdlWCwgXG5cdFx0XHQgICAgICAgIFx0XHRwYWdlWS8vLFxuXHRcdFx0ICAgICAgICBcdFx0Ly97cmFuZ2U6IHJhbmdlLCBlbDogZGVlcGVzdE5vZGV9XG5cdCAgICAgICAgXHRcdFx0KVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0KS5vcGVuKCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmVtb3ZlRWxlbWVudFdpdGhBbmltYXRpb24oIFxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXG5cdFx0Y2FsbGJhY2s6IChlOiBFdmVudCkgPT4gdm9pZCwgXG5cdCk6dm9pZCB7XG5cblx0ICAvLyBHZXQgdGhlIGFjdHVhbCBoZWlnaHQgb2YgdGhlIGVsZW1lbnRcblx0ICBjb25zdCBoZWlnaHQgPSBlbC5vZmZzZXRIZWlnaHQ7XG5cblx0ICAvLyBTZXQgaGVpZ2h0IHRvIHRoZSBjdXJyZW50IHZhbHVlIGZvciBDU1MgdHJhbnNpdGlvblxuXHQgIGVsLnN0eWxlLmhlaWdodCA9IGAke2hlaWdodH1weGA7XG5cblx0ICAvLyBBbGxvdyB0aGUgYnJvd3NlciB0byB1cGRhdGUsIHRoZW4gc2V0IHRvIDAgdG8gdHJpZ2dlciB0aGUgdHJhbnNpdGlvblxuXHQgIC8vc2V0VGltZW91dCgoKSA9PiB7IGVsLnN0eWxlLmhlaWdodCA9ICcwcHgnOyB9LCAwKTtcblx0ICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gJzBweCc7XG4gICAgICAgIGVsLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gICAgICAgIGVsLnN0eWxlLm1hcmdpbiA9ICcwJztcbiAgICAgICAgZWwuc3R5bGUucGFkZGluZyA9ICcwJztcbiAgICBcdH0sIDApO1xuXHQgIFxuXHQgIGVsLmFkZEV2ZW50TGlzdGVuZXIoXG5cdCAgXHQndHJhbnNpdGlvbmVuZCcsIGZ1bmN0aW9uIG9uRW5kKCkge1xuICAgIFx0XHRlbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0cmFuc2l0aW9uZW5kJywgb25FbmQpO1xuICAgIFx0XHRjYWxsYmFjaygpO1xuXHQgICAgXHQvL3NldFRpbWVvdXQoKCkgPT4geyBlbC5yZW1vdmUoKTsgfSwgMTApOyAvLyByZW1vdmUgaW4gdGhlIGNhbGxiYWNrXG5cdCAgfSk7XG5cdH1cblxuXHRcblxufSIsICJpbXBvcnQgeyBURmlsZSwgUGxhdGZvcm0gfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWdFbGVtZW50KFxuICAgIHBhcmFncmFwaEVsOiBIVE1MRWxlbWVudCwgXG4gICAgdGFnVGV4dDogc3RyaW5nXG4pOiBIVE1MRWxlbWVudCB7XG4gICAgY29uc3QgZWxzID0gcGFyYWdyYXBoRWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpOyBcbiAgICBsZXQgdGFnRWxUZXh0ID0gJyc7XG4gICAgbGV0IHRhZ0VsSGFzU3ViOmJvb2xlYW47XG4gICAgZm9yIChsZXQgZWwgb2YgZWxzKSB7XG4gICAgICAgIHRhZ0VsVGV4dCA9IGVsLmlubmVyVGV4dC50cmltKCk7XG4gICAgICAgIGlmICh0YWdFbFRleHQgPT09IHRhZ1RleHQpIHtcbiAgICAgICAgICAgIHJldHVybiBlbFxuICAgICAgICB9XG4gICAgfSAgICBcbiAgICAvL2NvbnNvbGUud2FybihgRWxlbWVudCB3aXRoIHRleHQgXCIke3RhZ1RleHR9XCIgbm90IGZvdW5kYCk7XG4gICAgcmV0dXJuIG51bGw7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1dvcmROZWFyRW5kKFxuICAgIHN0cjogc3RyaW5nLCBcbiAgICB3b3JkOiBzdHJpbmcsIFxuICAgIGNoYXJEaXN0YW5jZTogbnVtYmVyID0gMFxuKTogYm9vbGVhbiB7XG4gICAgLy8gRmluZCB0aGUgbGFzdCBvY2N1cnJlbmNlIG9mIHRoZSB3b3JkXG4gICAgY29uc3QgbGFzdEluZGV4ID0gc3RyLmxhc3RJbmRleE9mKHdvcmQpO1xuXG4gICAgLy8gSWYgdGhlIHdvcmQgaXNuJ3QgZm91bmQsIHJldHVybiBmYWxzZVxuICAgIGlmIChsYXN0SW5kZXggPT09IC0xKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHdoZXJlIHRoZSB3b3JkIGVuZHNcbiAgICBjb25zdCB3b3JkRW5kSW5kZXggPSBsYXN0SW5kZXggKyB3b3JkLmxlbmd0aDtcblxuICAgIC8vIENoZWNrIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSB3b3JkJ3MgZW5kIHRvIHRoZSBzdHJpbmcncyBlbmRcbiAgICBjb25zdCBkaXN0YW5jZVRvRW5kID0gc3RyLmxlbmd0aCAtIHdvcmRFbmRJbmRleDtcblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSB3b3JkIGlzIHRoZSBsYXN0IHdvcmQgb3IgaWYgdGhlIGRpc3RhbmNlIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjaGFyRGlzdGFuY2VcbiAgICByZXR1cm4gZGlzdGFuY2VUb0VuZCA9PT0gMCB8fCBkaXN0YW5jZVRvRW5kIDw9IGNoYXJEaXN0YW5jZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdvcmRPYmpGcm9tU3RyaW5nKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZywgXG4gICAgb2Zmc2V0OiBudW1iZXJcbik6T2JqZWN0IHtcbiAgICBcbiAgICBsZXQgd29yZFJlZ2V4ID0gL1teXFxzXSsoPz1bLiw6IT9dPyhcXHN8JCkpL2c7XG4gICAgbGV0IG1hdGNoO1xuICAgIGxldCBpbmRleDtcbiAgICBsZXQgd29yZCA9IG51bGw7XG4gICAgd2hpbGUgKChtYXRjaCA9IHdvcmRSZWdleC5leGVjKHNvdXJjZVRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAobWF0Y2guaW5kZXggPD0gb2Zmc2V0ICYmIG9mZnNldCA8PSBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCkge1xuICAgICAgICAgICAgIHdvcmQgPSBtYXRjaFswXTtcbiAgICAgICAgICAgIGluZGV4ID0gbWF0Y2guaW5kZXg7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB0ZXh0OiB3b3JkLCBcbiAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENsaWNrZWRUZXh0T2JqRnJvbURvYyhcbiAgICB4LCBcbiAgICB5LCBcbiAgICBtaW5Ob2RlTGVuZ3RoOiBzdHJpbmc9MTBcbik6c3RyaW5nIHtcbiAgICBcbiAgICAvLyBHZXQgdGhlIHdvcmQgdW5kZXIgdGhlIGNsaWNrIHBvc2l0aW9uXG4gICAgbGV0IHJhbmdlLCBub2RlVGV4dCwgb2Zmc2V0O1xuXG4gICAgaWYgKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpIHtcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KHgsIHkpO1xuLy9jb25zb2xlLmxvZyh4LCB5LCByYW5nZSlcbiAgICAgICAgaWYgKHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICAgICAgbm9kZVRleHQgPSByYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVmFsdWUudHJpbSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgb2Zmc2V0ID0gcmFuZ2Uuc3RhcnRPZmZzZXQ7XG4gICAgfVxuXG4gICAgaWYgKG5vZGVUZXh0Lmxlbmd0aCA8IG1pbk5vZGVMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuLy9jb25zb2xlLmxvZyhub2RlVGV4dCwgb2Zmc2V0LCByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlKVxuICAgIHJldHVybiB7XG4gICAgICAgIHRleHQ6IG5vZGVUZXh0LCBcbiAgICAgICAgaW5kZXg6IG9mZnNldCwgXG4gICAgICAgIGVsOiByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtkb3duSGVhZGluZ3MoXG4gICAgYm9keUxpbmVzOiBzdHJpbmdbXSxcbiAgICBoZWFkaW5nRmlsdGVyOiBzdHJpbmcgPSAnJ1xuKTogSGVhZGluZ1tdIHtcbiAgICBcbiAgICBjb25zdCBoZWFkZXJzOiBIZWFkaW5nW10gPSBbXTtcbiAgICBsZXQgYWNjdW11bGF0ZWRJbmRleCA9IDA7XG5cbiAgICBib2R5TGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCMrKVtcXHNdPyguKikkLyk7XG5cbiAgICAgICAgaWYgKG1hdGNoICYmIFxuICAgICAgICAgICAgKGhlYWRpbmdGaWx0ZXIgPT0gJycgfHwgbWF0Y2hbMl0gPT0gaGVhZGluZ0ZpbHRlcikpIHtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgZnVsbFRleHQ6IG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgIGxldmVsOiBtYXRjaFsxXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdGV4dDogbWF0Y2hbMl0sXG4gICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgc3RhcnRJbmRleDogYWNjdW11bGF0ZWRJbmRleCxcbiAgICAgICAgICAgICAgICBlbmRJbmRleDogKGFjY3VtdWxhdGVkSW5kZXggKyBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYWNjdW11bGF0ZWRJbmRleCArPSBsaW5lLmxlbmd0aCArIDE7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaGVhZGVycztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbGVDb250YWluc0hlYWRpbmcoXG4gICAgZmlsZUNvbnRlbnQ6IHN0cmluZyxcbiAgICBoZWFkaW5nOiBzdHJpbmdcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGZpbGVDb250ZW50TGluZXM6IHN0cmluZ1tdID0gZ2V0TGluZXNJblN0cmluZyhmaWxlQ29udGVudCk7XG4gICAgY29uc3QgbWRIZWFkaW5ncyA9IGdldE1hcmtkb3duSGVhZGluZ3MoZmlsZUNvbnRlbnRMaW5lcywgaGVhZGluZyk7XG4gICAgcmV0dXJuIChtZEhlYWRpbmdzLmxlbmd0aCA+IDApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3RMaW5lQWZ0ZXJGcm9udE1hdHRlcihtYXJrZG93bjogU3RyaW5nKTogTnVtYmVyIHtcbiAgICAvLyBTcGxpdCB0aGUgbWFya2Rvd24gc3RyaW5nIGludG8gbGluZXMuXG4gICAgY29uc3QgbGluZXMgPSBnZXRMaW5lc0luU3RyaW5nKG1hcmtkb3duKTsgLy9tYXJrZG93bi5zcGxpdCgnXFxuJyk7XG5cbiAgICBsZXQgaW5Gcm9udE1hdHRlciA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBsaW5lIGlzIGEgZnJvbnQgbWF0dGVyIGRlbGltaXRlci5cbiAgICAgICAgaWYgKGxpbmUgPT09ICctLS0nKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgdGhlIHN0YXJ0IG9mIHRoZSBmcm9udCBtYXR0ZXIsIHNldCB0aGUgZmxhZy5cbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgaW4gdGhlIGZyb250IG1hdHRlciwgdGhpcyBtYXJrcyBpdHMgZW5kLlxuICAgICAgICAgICAgaW5Gcm9udE1hdHRlciA9ICFpbkZyb250TWF0dGVyO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSBqdXN0IGVuZGVkIHRoZSBmcm9udCBtYXR0ZXIsIHJldHVybiB0aGUgbmV4dCBsaW5lJ3MgbnVtYmVyLlxuICAgICAgICAgICAgaWYgKCFpbkZyb250TWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgLy8rIDI7IC8vICsyIHRvIGFkanVzdCBmb3IgemVyby1iYXNlZCBpbmRleGluZyBhbmQgdG8gZ2V0IHRoZSBsaW5lIGFmdGVyIHRoZSBjbG9zaW5nIGRlbGltaXRlci5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3Mgbm8gZnJvbnQgbWF0dGVyIG9yIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2luZyBkZWxpbWl0ZXIsIHJldHVybiAxICh0aGUgZmlyc3QgbGluZSkuXG4gICAgcmV0dXJuIDA7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpbmVzSW5TdHJpbmcoXG4gICAgaW5wdXQ6IHN0cmluZ1xuKTogQXJyYXkge1xuICAgIC8qY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHRlbXBTdHJpbmcgPSBpbnB1dDtcblxuICAgIHdoaWxlICh0ZW1wU3RyaW5nLmluY2x1ZGVzKFwiXFxuXCIpKSB7XG4gICAgICAgIGNvbnN0IGxpbmVFbmRJbmRleCA9IHRlbXBTdHJpbmcuaW5kZXhPZihcIlxcblwiKTtcbiAgICAgICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nLnNsaWNlKDAsIGxpbmVFbmRJbmRleCkpO1xuICAgICAgICB0ZW1wU3RyaW5nID0gdGVtcFN0cmluZy5zbGljZShsaW5lRW5kSW5kZXggKyAxKTtcbiAgICB9XG4gICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nKTtcblxuICAgIHJldHVybiBsaW5lczsqL1xuXG4gICAgY29uc3QgbGluZXMgPSBpbnB1dC5zcGxpdCgnXFxuJyk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgbGFzdCBsaW5lIGlzIGVtcHR5IGFuZCByZW1vdmUgaXQgaWYgbmVjZXNzYXJ5LlxuICAgIGlmIChsaW5lcy5sZW5ndGggPiAwICYmIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdID09PSAnJykge1xuICAgICAgICBsaW5lcy5wb3AoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGluZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaW5lQ2hySW5kZXgoY29udGVudCwgbGluZU51bWJlcikge1xuICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICBpZiAobGluZU51bWJlciA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICBsZXQgY2hhcmFjdGVySW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVOdW1iZXI7IGkrKykge1xuICAgIC8vIEFkZCB0aGUgbGVuZ3RoIG9mIGVhY2ggbGluZSBwbHVzIDEgZm9yIHRoZSAnXFxuJyBjaGFyYWN0ZXIgdGhhdCB3YXMgcmVtb3ZlZCBieSBzcGxpdFxuICAgIGNoYXJhY3RlckluZGV4ICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7XG4gIH1cblxuICByZXR1cm4gY2hhcmFjdGVySW5kZXg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0QWZ0ZXJMaW5lKFxuICAgIHRleHQ6IHN0cmluZywgXG4gICAgYm9keTogc3RyaW5nLCBcbiAgICBsaW5lOiBudW1iZXIsIFxuICAgIGZpbGVQYXRoXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIGNvbnN0IHNwbGl0Q29udGVudCA9IGJvZHkuc3BsaXQoXCJcXG5cIik7XG4gICAgY29uc3QgcHJlID0gc3BsaXRDb250ZW50LnNsaWNlKDAsIGxpbmUgKyAxKS5qb2luKFwiXFxuXCIpO1xuICAgIGNvbnN0IHBvc3QgPSBzcGxpdENvbnRlbnQuc2xpY2UobGluZSArIDEpLmpvaW4oXCJcXG5cIik7XG5cbiAgICByZXR1cm4gYCR7cHJlfVxcbiR7dGV4dH1cXG4ke3Bvc3R9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RUeXBlRnJvbUxpbmVOdW1iZXIoZnVsbFRleHQ6IHN0cmluZywgbGluZU51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IGZ1bGxUZXh0LnNwbGl0KFwiXFxuXCIpO1xuICAgIGlmIChsaW5lTnVtYmVyID49IDAgJiYgbGluZU51bWJlciA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbbGluZU51bWJlcl07XG5cbiAgICAgICAgY29uc3QgbGVhZGluZ1doaXRlc3BhY2UgPSBsaW5lLm1hdGNoKC9eXFxzKi8pWzBdO1xuXG4gICAgICAgIC8vIENoZWNrIGZvciB1bmNoZWNrZWQgY2hlY2tib3ggbGlzdCBpdGVtcyBmaXJzdFxuICAgICAgICBpZiAoL15cXHMqLVxcc1xcW1xcc1xcXVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGFuIHVuY2hlY2tlZCBjaGVja2JveFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhIFwiY2hlY2tlZFwiIGNoZWNrYm94XG4gICAgICAgIGVsc2UgaWYgKC9eXFxzKi1cXHNcXFt4XFxdXFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiRGV0ZWN0ZWQgYSBjaGVja2VkIGNoZWNrYm94LCBjb252ZXJ0aW5nIHRvIHVuY2hlY2tlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIFRoZW4gY2hlY2sgZm9yIG5vcm1hbCBkYXNoIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqLVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGEgbm9ybWFsIGJ1bGxldFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBcIjtcbiAgICAgICAgfSBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG51bWJlcmVkIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqXFxkK1xcLlxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQobGluZS5tYXRjaCgvXlxccyooXFxkKylcXC4vKVsxXSwgMTApO1xuICAgICAgICAgICAgcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtfS4gYDtcbiAgICAgICAgICAgIC8vcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtICsgMX0uIGA7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhcnJvdyBpdGVtc1xuICAgICAgICBlbHNlIGlmICgvXlxccyo+XFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbGVhZGluZ1doaXRlc3BhY2UgKyBcIj4gXCI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgIH1cbiAgICByZXR1cm4gXCJcIjsgXG59XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGFnRnJvbVN0cmluZyhcbiAgICBpbnB1dFRleHQsIFxuICAgIGhhc2h0YWdUb1JlbW92ZSwgXG4gICAgYWxsOmJvb2xlYW49dHJ1ZVxuKTogc3RyaW5nIHsgIFxuICAgIFxuICAgIC8vY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxcXHM/XCIgKyBoYXNodGFnVG9SZW1vdmUgKyBcIlxcXFxiXCIsIGFsbD9cImdpXCI6XCJpXCIpO1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcbiAgICAgICAgXCJcXFxccz9cIiArIFxuICAgICAgICBoYXNodGFnVG9SZW1vdmUucmVwbGFjZSgvIy9nLCAnXFxcXCMnKSArIFxuICAgICAgICBcIig/IVxcXFx3fFxcXFwvKVwiLCBcbiAgICAgICAgYWxsP1wiZ2lcIjpcImlcIlxuICAgICk7XG5cbiAgICByZXR1cm4gaW5wdXRUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0SW5TdHJpbmcgKFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBjaGFyUG9zOiBudW1iZXJcbik6c3RyaW5nIHsgLy8gcGFzcyAwIGZvciB0aGUgc3RhcnQgb3Igc291cmNlVGV4dC5sZW5ndGgtMSBmb3IgdGhlIGVuZFxuICAgIC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkobmV3VGV4dCkpO1xuICAgIHJldHVybiAoc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgY2hhclBvcykgKyBuZXdUZXh0ICsgJyAnICsgc291cmNlVGV4dC5zdWJzdHJpbmcoY2hhclBvcykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGV4dEZyb21TdHJpbmcgKFxuICAgIHJlbW92ZVRleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBhbGw6Ym9vbGVhbj1mYWxzZVxuKTpzdHJpbmcge1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCh0aGlzLmVzY2FwZVJlZ0V4cChyZW1vdmVUZXh0KSwgYWxsID8gXCJnaVwiIDogXCJpXCIpO1xuICAgIHJldHVybiBzb3VyY2VUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlVGV4dEluU3RyaW5nIChcbiAgICByZXBsYWNlVGV4dDogc3RyaW5nLCBcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsIFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgYWxsOiBib29sZWFuID0gZmFsc2Vcbik6c3RyaW5nIHtcbi8qY29uc29sZS5sb2coJ1JFUExBQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKSsnPDwnKTtcbmNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbmNvbnNvbGUubG9nKCdTT1VSQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytzb3VyY2VUZXh0Kyc8PCcpXG5jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG5jb25zb2xlLmxvZygnTkVXIFRFWFQnKTtcbmNvbnNvbGUubG9nKCc+PicrbmV3VGV4dCsnPDwnKSovXG4vL2NvbnNvbGUubG9nKGVzY2FwZVJlZ0V4cChyZXBsYWNlVGV4dC50cmltKCkpKVxuICAgICAgICBjb25zdCBlc2NhcGVkUmVwbGFjZVRleHQgPSBlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG4gICAgICAgIC8vY29uc3QgZXNjYXBlZFJlcGxhY2VUZXh0ID0gZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0KS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG5cbiAgICAgICAgLy9jb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0LnRyaW0oKSksIGFsbCA/IFwiZ2lcIiA6IFwiaVwiKTtcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZWRSZXBsYWNlVGV4dCwgYWxsID8gXCJnc2lcIiA6IFwic2lcIik7XG5cbiAgICAgICAgcmV0dXJuIHNvdXJjZVRleHQudHJpbSgpLnJlcGxhY2UocmVnZXgsIG5ld1RleHQudHJpbSgpKS50cmltKCk7XG4gICAgICAgIC8vcmV0dXJuIHNvdXJjZVRleHQucmVwbGFjZShyZWdleCwgbmV3VGV4dCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZVN0cmluZ0F0V29yZChcbiAgICBzdHI6IHN0cmluZywgXG4gICAgbWF4Q2hhcnM6bnVtYmVyPTE2XG4pOnN0cmluZyB7XG5cbiAgICBpZiAoc3RyLmxlbmd0aCA8PSBtYXhDaGFycykgcmV0dXJuIHN0cjtcbiAgICBsZXQgdHJ1bmNhdGVkID0gc3RyLnN1YnN0cigwLCBtYXhDaGFycyk7ICBcbiAgICBjb25zdCBsYXN0U3BhY2UgPSB0cnVuY2F0ZWQubGFzdEluZGV4T2YoJyAnKTsgXG4gICAgaWYgKGxhc3RTcGFjZSA+IDApIHRydW5jYXRlZCA9IHRydW5jYXRlZC5zdWJzdHIoMCwgbGFzdFNwYWNlKTtcblxuICAgIHJldHVybiB0cnVuY2F0ZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRlbnRDaGFuZ2VkVG9vTXVjaChcbiAgICBvcmlnaW5hbDogc3RyaW5nLCBcbiAgICBtb2RpZmllZDogc3RyaW5nLCBcbiAgICB0YWc6IHN0cmluZywgXG4gICAgYnVmZmVyID0gNVxuKTogYm9vbGVhbiB7XG4gIGNvbnN0IGV4cGVjdGVkQ2hhbmdlID0gdGFnLmxlbmd0aDsgLy8gaW5jbHVkaW5nIHRoZSAnIycgc3ltYm9sXG4gIGNvbnN0IHRocmVzaG9sZCA9IGV4cGVjdGVkQ2hhbmdlICsgYnVmZmVyOyAvLyBhbGxvdyBmb3Igc29tZSBtaW5vciB1bmludGVuZGVkIG1vZGlmaWNhdGlvbnNcbiAgY29uc3QgYWN0dWFsQ2hhbmdlID0gTWF0aC5hYnMob3JpZ2luYWwubGVuZ3RoIC0gbW9kaWZpZWQubGVuZ3RoKTtcblxuICByZXR1cm4gYWN0dWFsQ2hhbmdlID4gdGhyZXNob2xkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZU9iakZyb21UYWdzKFxuICAgIHRhZ3M6IEFycmF5XG4pOiBPYmplY3Qge1xuXG4gICAgLy8gUmVtb3ZlIGhhc2hlcyBhbmQgc3BsaXQgdGFncyBpbnRvIGFuIGFycmF5XG4gICAgbGV0IHRhZ3NBcnJheSA9IHRhZ3MubWFwKHRhZyA9PiB0YWcucmVwbGFjZSgvIy9nLCAnJykudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IGR1cGxpY2F0ZXNcbiAgICB0YWdzQXJyYXkgPSB0YWdzQXJyYXkuZmlsdGVyKCh0YWcsIGluZGV4LCBzZWxmKSA9PiBzZWxmLmluZGV4T2YodGFnKSA9PT0gaW5kZXgpO1xuXG4gICAgLy8gQ29uc3RydWN0IHRoZSBmaWxlIG5hbWVcbiAgICBjb25zdCB0YWdzUGFydCA9IHRhZ3NBcnJheS5qb2luKCcrJyk7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRhdGVQYXJ0ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArICctJyArXG4gICAgICAgICAgICAgICAgICAgICAoY3VycmVudERhdGUuZ2V0TW9udGgoKSArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArICctJyArXG4gICAgICAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkuc2xpY2UoLTIpO1xuICAgIC8vY29uc3QgZmlsZU5hbWUgPSBgVGFnIFN1bW1hcnkgKCR7dGFnc1BhcnR9KSAoJHtkYXRlUGFydH0pLm1kYDtcbiAgICBjb25zdCBmaWxlTmFtZSA9IGBUYWcgU3VtbWFyeSAoJHtkYXRlUGFydH0pLm1kYDtcblxuICAgIC8vIENvbnN0cnVjdCB0aGUgdGl0bGVcbiAgICBjb25zdCB0aXRsZVRhZ3NQYXJ0ID0gdGFnc0FycmF5Lm1hcCh0YWcgPT4gdGFnLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGFnLnNsaWNlKDEpKS5qb2luKCcgKyAnKTtcbiAgICBjb25zdCB0aXRsZSA9IGAke3RpdGxlVGFnc1BhcnR9IFRhZyBTdW1tYXJ5YDtcblxuICAgIC8vIFJldHVybiB0aGUgb2JqZWN0IHdpdGggZmlsZU5hbWUgYW5kIHRpdGxlIHByb3BlcnRpZXNcbiAgICByZXR1cm4ge1xuICAgICAgICBmaWxlTmFtZTogZmlsZU5hbWUsXG4gICAgICAgIHRpdGxlOiB0aXRsZVxuICAgIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY3RpdmVGaWxlRm9sZGVyKFxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIC8vY29uc3QgYWN0aXZlRmlsZSA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi52aWV3LmZpbGU7XG4gICAgLy9jb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBpZiAoIWFjdGl2ZUZpbGUpIHJldHVybiBudWxsO1xuXG4gICAgaWYgKGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnXFxcXCcpIHx8IGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnLycpKSB7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjb3JyZWN0IHBhdGggc2VwYXJhdG9yXG4gICAgICAgIGNvbnN0IHBhdGhTZXBhcmF0b3IgPSBhY3RpdmVGaWxlLnBhdGguaW5jbHVkZXMoJ1xcXFwnKSA/ICdcXFxcJyA6ICcvJztcblxuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBhY3RpdmVGaWxlLnBhdGguc3BsaXQocGF0aFNlcGFyYXRvcik7XG4gICAgICAgIHBhdGhQYXJ0cy5wb3AoKTsgIC8vIFJlbW92ZSB0aGUgZmlsZSBuYW1lIHBhcnRcbiAgICAgICAgbGV0IGZvbGRlclBhdGggPSBwYXRoUGFydHMuam9pbihwYXRoU2VwYXJhdG9yKTtcblxuICAgICAgICAvLyBFbnN1cmUgdGhlIGZvbGRlciBwYXRoIGVuZHMgd2l0aCB0aGUgY29ycmVjdCBwYXRoIHNlcGFyYXRvclxuICAgICAgICBpZiAoIWZvbGRlclBhdGguZW5kc1dpdGgocGF0aFNlcGFyYXRvcikpIHtcbiAgICAgICAgICAgIGZvbGRlclBhdGggKz0gcGF0aFNlcGFyYXRvcjtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIGZvbGRlclBhdGggPSAnJ1xuICAgIH1cblxuICAgIHJldHVybiBmb2xkZXJQYXRoO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0VGFnc0Zyb21BcHAoXG4gICAgYXBwOiBBcHAsXG4gICAgcmVjZW50VGFnczogQXJyYXlcbik6IHN0cmluZ1tdIHtcbiAgICBjb25zdCB0YWdzT2JqZWN0ID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0VGFncygpO1xuXG4gICAgLy8gQ29udmVydCB0YWdzT2JqZWN0IHRvIGFuIGFycmF5IG9mIFt0YWcsIGNvdW50XSB0dXBsZXNcbiAgICBjb25zdCB0YWdzQXJyYXkgPSBPYmplY3QuZW50cmllcyh0YWdzT2JqZWN0KTtcblxuICAgIC8vIFNvcnQgYnkgdXNlIGNvdW50XG4gICAgdGFnc0FycmF5LnNvcnQoKGEsIGIpID0+IGJbMV0gLSBhWzFdKTtcblxuICAgIC8vY29uc3QgcmVjZW50VGFncyA9IHRoaXMuZ2V0UmVjZW50VGFncygpO1xuICAgIC8vY29uc3QgcmVjZW50VGFncyA9IHBsdWdpbi5nZXRSZWNlbnRUYWdzKCk7XG4gICAgLy9jb25zb2xlLmxvZygncmVjZW50IHRhZyBsZW5ndGg6ICcgKyByZWNlbnRUYWdzLmxlbmd0aClcblxuICAgIGlmIChyZWNlbnRUYWdzLmxlbmd0aD4wKSB7XG4gICAgICAgIC8vY29uc29sZS5sb2cocmVjZW50VGFncylcbiAgICAgICAgLy8gY29udmVydCB0aGVtIHRvIFt0YWcsIGNvdW50XSB0dXBsZXMgZm9yIGNvbnNpc3RlbmN5XG4gICAgICAgIGNvbnN0IHJlY2VudFRhZ3NBc1R1cGxlcyA9IHJlY2VudFRhZ3MubWFwKHRhZyA9PiBbdGFnLCAwXSk7XG4gICAgICAgIC8vIENvbmNhdGVuYXRlIHRoZSB0d28gYXJyYXlzXG4gICAgICAgIGNvbnN0IHJlY2VudEFuZEFsbFRhZ3MgPSByZWNlbnRUYWdzQXNUdXBsZXMuY29uY2F0KHRhZ3NBcnJheSk7XG4gICAgICAgIC8vIEV4dHJhY3QgdGFnIG5hbWVzIGFmdGVyIHJlbW92aW5nIHRoZSAjXG4gICAgICAgIHJldHVybiByZWNlbnRBbmRBbGxUYWdzLm1hcCgoW3RhZywgX10pID0+IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGFnc0FycmF5Lm1hcCgoW3RhZywgX10pID0+IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpKTtcbiAgICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUZpbGVQYXRoIChcbiAgICBmaWxlUGF0aDogc3RyaW5nXG4pOiBzdHJpbmcge1xuICAgIGNvbnN0IG1hdGNoaW5nRmlsZXMgPSBhd2FpdCBhcHAudmF1bHQuZ2V0RmlsZXMoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLm5hbWUgPT09IGZpbGVQYXRoKTtcbiAgICBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY29uc3QgZmlsZVBhdGggPSBtYXRjaGluZ0ZpbGVzWzBdLnBhdGg7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuICAgICAgICAvL2NvbnNvbGUubG9nKCdWYWxpZGF0ZSBmaWxlOiAnICsgZW1iZWRGaWxlLm5hbWUpO1xuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9IGVsc2UgaWYgKG1hdGNoaW5nRmlsZXMubGVuZ3RoID4gMSkge1xuICAgICAgICBuZXcgTm90aWNlKCdUYWcgQnVkZHk6IE11bHRpcGxlIGZpbGVzIGZvdW5kIHdpdGggdGhlIHNhbWUgbmFtZS4gQ2FuXFwndCBzYWZlbHkgZWRpdCB0YWcuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogTm8gZmlsZSBmb3VuZC4gVHJ5IGFnYWluLCBvciB0aGlzIHRhZyBtaWdodCBiZSBpbiBhbiB1bnN1cHBvcnRlZCBlbWJlZCB0eXBlLicpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjdHJsQ21kS2V5IChcbiAgICBldmVudDogRXZlbnRcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGlzTWFjID0gUGxhdGZvcm0uaXNNYWNPUyAvLyAobmF2aWdhdG9yLnBsYXRmb3JtLnRvVXBwZXJDYXNlKCkuaW5kZXhPZignTUFDJykgPj0gMCk7XG5cbiAgICBpZiAoaXNNYWMpIHJldHVybiBldmVudC5tZXRhS2V5O1xuICAgIGVsc2UgcmV0dXJuIGV2ZW50LmN0cmxLZXk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0YWdzSW5TdHJpbmcoXG4gICAgc3RyaW5nOiBzdHJpbmcsIFxuICAgIHRhZz86IHN0cmluZ1xuKTogc3RyaW5nW10ge1xuICAgIGxldCByZWdleDtcbiAgICBpZiAodGFnKSB7XG4gICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0YWcucmVwbGFjZSgvXFwvL2csICdcXFxcLycpICsgXCIoPyFbXFxcXHdcXFxcL1xcXFwjXSlcIiwgXCJnXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1hdGNoIGFueSB0YWctbGlrZSBwYXR0ZXJuIHN0YXJ0aW5nIHdpdGggJyMnXG4gICAgICAgIHJlZ2V4ID0gLyMoXFx3KykoPyFbXFx3XFwvI10pL2c7XG4gICAgfVxuICAgIGNvbnN0IG1hdGNoZXMgPSBzdHJpbmcubWF0Y2gocmVnZXgpO1xuXG4gICAgcmV0dXJuIG1hdGNoZXMgfHwgW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb3VudE9jY3VycmVuY2VzKFxuICAgIHN1bW1hcnlUYWdzOiBBcnJheSwgXG4gICAgY29udGVudFRhZ3Ncbik6IG51bWJlciB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBmb3IgKGxldCB0YWcgb2Ygc3VtbWFyeVRhZ3MpIHtcbiAgICAgICAgY291bnQgKz0gY29udGVudFRhZ3MuZmlsdGVyKGl0ZW0gPT4gaXRlbSA9PT0gdGFnKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gb3V0ZXJIVE1MVG9FbGVtZW50KG91dGVySFRNTDogc3RyaW5nKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbiAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0ZW1wRGl2LmlubmVySFRNTCA9IG91dGVySFRNTDtcbiAgcmV0dXJuIHRlbXBEaXYuZmlyc3RDaGlsZCBhcyBIVE1MRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChcbiAgICBzdHJpbmc6IHN0cmluZ1xuKTpzdHJpbmcge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTsgLy8gJCYgbWVhbnMgdGhlIHdob2xlIG1hdGNoZWQgc3RyaW5nXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbWJlZEZpbGUgKFxuICAgIGVsOiBIVE1MRWxlbWVudFxuKTpURmlsZSB7XG4gICAgbGV0IGZpbGVQYXRoID0gZWwuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICBjb25zdCBsaW5rQXJyYXkgPSBmaWxlUGF0aC5zcGxpdCgnIycpO1xuICAgIGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB2YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKTtcbiAgICByZXR1cm4gZmlsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnVmFsaWQgKFxuICAgIHRhZzogU3RyaW5nLFxuICAgIGZ1bGxUYWc6IEJvb2xlYW4gPSBmYWxzZVxuKTpib29sZWFuIHsgXG4gICAgbGV0IHRhZ1BhdHRlcm4gXG4gICAgaWYgKGZ1bGxUYWcpIHRhZ1BhdHRlcm4gPSAvXiNbYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIC8vZWxzZSB0YWdQYXR0ZXJuID0gLyg/PVteXFxkXFxzXSspW2EtekEtWjAtOV9cXC1cXC9dKy9nXG4gICAgZWxzZSB0YWdQYXR0ZXJuID0gL15bYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIHJldHVybiB0YWdQYXR0ZXJuLnRlc3QodGFnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RWYWxpZFRhZ3ModGFnc1N0cmluZzogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIC8vIFNwbGl0IHRoZSBzdHJpbmcgYnkgY29tbWFzIHRvIGdldCBpbmRpdmlkdWFsIHRhZ3NcbiAgICBjb25zdCBwb3RlbnRpYWxUYWdzID0gdGFnc1N0cmluZy5zcGxpdCgnLCcpO1xuXG4gICAgLy8gRmlsdGVyIG91dCB2YWxpZCB0YWdzXG4gICAgY29uc3QgdmFsaWRUYWdzID0gcG90ZW50aWFsVGFnc1xuICAgICAgICAubWFwKHRhZyA9PiB0YWcudHJpbSgpKSAvLyBUcmltIGVhY2ggdGFnXG4gICAgICAgIC5maWx0ZXIodGFnID0+IGlzVGFnVmFsaWQodGFnLCB0cnVlKSk7IC8vIFVzZSB0aGUgaXNUYWdWYWxpZCBmdW5jdGlvbiB0byBjaGVjayB2YWxpZGl0eVxuXG4gICAgcmV0dXJuIHZhbGlkVGFncztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGN0cmxDbWRTdHIgKCk6IHN0cmluZyB7XG4gICAgY29uc3QgaXNNYWMgPSBQbGF0Zm9ybS5pc01hY09TIC8vKG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpID49IDApO1xuICAgIGlmIChpc01hYykgcmV0dXJuICdDTUQnO1xuICAgIGVsc2UgcmV0dXJuICdDVFJMJztcbn1cbiIsICJpbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBTdWdnZXN0TW9kYWwsIE1vZGFsLCBTZXR0aW5nLCBOb3RpY2UsIFRGaWxlLCByZW5kZXJSZXN1bHRzLCBwcmVwYXJlRnV6enlTZWFyY2gsIEZ1enp5TWF0Y2gsIGZ1enp5U2VhcmNoLCBwcmVwYXJlUXVlcnkgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIFRhZ1NlbGVjdG9yIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeVxuICAgIGFwcDogQXBwO1xuICAgIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWRcbiAgICB0YWc6IHN0cmluZ1xuICAgIGlucHV0TGlzdGVuZXI6IEV2ZW50TGlzdGVuZXJcbiAgICB0YWdDYWNoZTogc3RyaW5nW11cbiAgICBsb2NhdGlvbjogT2JqZWN0O1xuICAgIGhlaWdodCA9IDIxNTtcbiAgICBub1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgIFxuICAgIFxuICAgIGNvbnN0cnVjdG9yIChhcHA6IEFwcCwgcGx1Z2luOiBUYWdCdWRkeSwgZXZlbnQ6RXZlbnQsIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpe1xuICAgICAgICBzdXBlcihhcHApXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxuICAgICAgICB0aGlzLnRhZyA9ICcnXG4gICAgICAgIHRoaXMub25DaG9vc2VJdGVtQ2FsbGJhY2sgPSBvbkNob29zZUl0ZW1DYWxsYmFja1xuICAgICAgICB0aGlzLmlucHV0TGlzdGVuZXIgPSB0aGlzLmxpc3RlbklucHV0LmJpbmQodGhpcylcbiAgICAgICAgdGhpcy50YWdDYWNoZSA9IFtdXG4gICAgICAgIGlmIChldmVudCAhPSBudWxsKSB0aGlzLmxvY2F0aW9uID0ge3g6IGV2ZW50LnBhZ2VYLCB5OiBldmVudC5wYWdlWX1cbiAgICAgICAgLy90aGlzLmxpbWl0ID0gMTBcbiAgICAgICAgLy90aGlzLmVtcHR5U3RhdGVUZXh0ID0gJ0FkZCBuZXcgdGFnJ1xuICAgICAgICAvLyB0byBhZGQgYSBicmFuZCBuZXcgdGFnIHdlJ2QgZWl0aGVyIG5lZWQgdG86XG4gICAgICAgIC8vIC0gU0hJRlQgYWxyZWFkeSB3b3Jrcy4gYnV0IGZvciBtb2JpbGU/XG4gICAgICAgIC8vIC0gaGF2ZSBhbm90aGVyIGJ1dHRvbiBvbiBmYXIgcmlnaHQgb24gaW5wdXQgdG8gYWRkIChmb3IgbW9iaWxlKVxuICAgICAgICAvLyB0aGlzIHNlbGVjdG9yIGlzIGFsc28gd2hlcmUgd2UgY2FuIGFkZCBhbiBlZGl0IGljb24gbmV4dCB0byBlYWNoIHRhZy4gXG4gICAgICAgIC8vIGNsaWNraW5nIHRoaXMgd291bGQgYnJpbmcgdXAgdGhlIGVkaXQgbW9kYWxcbiAgICAgICBcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJcIilcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBpZiAoIXRoaXMuYXBwLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdENvbnRhaW5lckVsLnBhcmVudE5vZGUuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5zdHlsZS5oZWlnaHQgPSAnMjE1cHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLmxlZnQgPSBgJHt0aGlzLmxvY2F0aW9uLnh9cHhgO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLnRvcCA9IGAke3RoaXMubG9jYXRpb24ueX1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57IHRoaXMuaW5wdXRFbC5mb2N1cygpIH0sIDUwMCk7IC8vIG5vdCB3b3JraW5nP1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBzdXBlci5vbkNsb3NlKClcbiAgICB9XG5cbiAgICBsaXN0ZW5JbnB1dChldmVudDogS2V5Ym9hcmRFdmVudCl7XG4gICAgICAgIHRoaXMubm9TZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbXNIZWlnaHQgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuaW5wdXRFbC52YWx1ZSkubGVuZ3RoICogNDI7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1pbih0aGlzLmhlaWdodCwgTWF0aC5tYXgoNjUsIGl0ZW1zSGVpZ2h0KSlcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Q29udGFpbmVyRWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmICF0aGlzLm5vU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnB1dEVsLnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm4gPSAvKD89W15cXGRcXHNdKylbYS16QS1aMC05X1xcLVxcL10rL2dcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QodGV4dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW0odGhpcy5pbnB1dEVsLnZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCB0YWcuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKmdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpIDogc3RyaW5nW117XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkVGFncyA9IFV0aWxzLmdldFRhZ3NGcm9tQXBwKFxuICAgICAgICAgICAgdGhpcy5hcHAsIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZ2V0UmVjZW50VGFncygpKS5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgLy90YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgcXVlcnkgPT0gJycgPyB0cnVlIDogdGFnLnRvTG93ZXJDYXNlKCkgPT0gcXVlcnkudG9Mb3dlckNhc2UoKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZmlsdGVyZWRUYWdzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oaGVhZGVyOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGhlYWRlciB9KTtcbiAgICB9Ki9cblxuICAgIG9uTm9TdWdnZXN0aW9uKCl7XG4gICAgICAgIHN1cGVyLm9uTm9TdWdnZXN0aW9uKClcbiAgICAgICAgdGhpcy5ub1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ25vIHN1Z2dlc3Rpb25zJylcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBzdHJpbmdbXSB7XG4gICAgICAgY29uc3QgZmlsdGVyZWRUYWdzID0gVXRpbHMuZ2V0VGFnc0Zyb21BcHAoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5nZXRSZWNlbnRUYWdzKClcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZFRhZ3M7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQodGFnOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGFnXG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VJdGVtKHJlc3VsdDogc3RyaW5nKSB7XG4vL2NvbnNvbGUubG9nKHJlc3VsdClcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57dGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpfSwgMjUwKVxuICAgICAgICB9XG4gICAgfVxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBURmlsZSwgU2V0dGluZywgU2VsZWN0RmlsZU1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBQcm9ncmVzc0JhckNvbXBvbmVudH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVEJUYWdFZGl0b3JNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICAvL29yaWdpbmFsVGFnOiBTdHJpbmdzXG4gICAgb3B0aW9uc0RpdjogSFRNTEVsZW1lbnQ7XG4gICAgZWRpdERpdjogSFRNTEVsZW1lbnQ7XG4gICAgaW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgLy9zdWJtaXRCdG46IEJ1dHRvbkNvbXBvbmVudDtcbiAgICB0YWdBY3Rpb25Ecm9wZG93bjogRHJvcGRvd25Db21wb25lbnQ7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIHNldHRpbmdzID0ge1xuICAgICAgICBvcmlnaW5hbFRhZzogJycsXG4gICAgICAgIHZhdWx0VG9nZ2xlOiBmYWxzZSxcbiAgICAgICAgbmV3TmFtZTogJycsXG4gICAgICAgIHN1bW1hcnlQb3M6ICd0b3AnLFxuICAgICAgICBhY3Rpb246ICdyZW5hbWUnXG4gICAgfTtcblxuICAgIC8vY29uc3RydWN0b3IoYXBwOiBBcHAsIHRhZzogU3RyaW5nLCBvblN1Ym1pdDogKHJlc3VsdDogc3RyaW5nKSA9PiB2b2lkKSB7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogVGFnQnVkZHksIHRhZzogU3RyaW5nKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldHRpbmdzLm9yaWdpbmFsVGFnID0gdGFnO1xuICAgICAgICAvL3RoaXMub3JpZ2luYWxUYWcgPSB0YWc7XG4gICAgICAgIC8vdGhpcy5vblN1Ym1pdCA9IG9uU3VibWl0O1xuICAgIH1cblxuICAgIG9uT3BlbiAoKSB7XG4gICAgICAgIGxldCB7IGNvbnRlbnRFbCwgdGl0bGVFbCAsIG1vZGFsRWwsIGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG4gICAgICAgIHRpdGxlRWwuc2V0VGV4dChcIlRhZyBBY3Rpb25zXCIpXG5cbiAgICAgICAgdGhpcy5lZGl0RGl2ID0gY3JlYXRlRWwoJ2RpdicpXG4gICAgICAgIHRoaXMuZWRpdERpdi5jbGFzc0xpc3QuYWRkICgndGFnLWVkaXRvci1lZGl0LWRpdicpXG5cbiAgICAgICAgdGhpcy5vcHRpb25zRGl2ID0gY3JlYXRlRWwgKCdkaXYnKTtcbiAgICAgICAgdGhpcy5vcHRpb25zRGl2LmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLW9wdGlvbnMnKVxuXG4gICAgICAgIHRoaXMuaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh0aGlzLmVkaXREaXYpO1xuICAgICAgICB0aGlzLmlucHV0LmlucHV0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItaW5wdXQnKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHRoaXMuZWRpdERpdilcbiAgICAgICAgLmFkZE9wdGlvbigncmVuYW1lJywgXCJSZW5hbWVcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ2xvd2VyJywgXCJDb252ZXJ0IHRvIGxvd2VyIGNhc2VcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ3RvdGV4dCcsIFwiUmVtb3ZlIGhhc2ggKCMpXCIpIFxuICAgICAgICAuYWRkT3B0aW9uKCdzdW1tYXJ5JywgXCJDcmVhdGUgc3VtbWFyeVwiKTsgXG4gICAgICAgIHRoaXMudGFnQWN0aW9uRHJvcGRvd24uc2VsZWN0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItZHJvcGRvd24nKTtcblxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKHRoaXMuZWRpdERpdilcbiAgICAgICAgY29udGVudEVsLmFwcGVuZENoaWxkKHRoaXMub3B0aW9uc0RpdilcblxuICAgICAgICB0aGlzLnNob3dFZGl0VGFnT3B0aW9ucygncmVuYW1lJyk7ICAgXG4gICAgXG4gICAgICAgIGNvbnN0IGhyID0gY3JlYXRlRWwgKCdocicpXG4gICAgICAgIGhyLmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLWhyJyk7IFxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKGhyKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hY3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBcInN1bW1hcnlcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N1bW1hcnlPcHRpb25zICgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2lmIChlZGl0RGl2LmNvbnRhaW5zKHN1bW1hcnlPcHRTZWxlY3RFbCkpIGVkaXREaXYucmVtb3ZlQ2hpbGQoc3VtbWFyeU9wdFNlbGVjdEVsKVxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0VkaXRUYWdPcHRpb25zICh2YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IFxuXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldENsYXNzICgndGFnLWVkaXRvci1zdWJtaXQnKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1N1Ym1pdCcpXG4gICAgICAgICAgICAub25DbGljayAoKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0VGFnRWRpdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfVxuXG4gICAgc3VibWl0VGFnRWRpdCAoKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzKVxuXG4gICAgICAgIC8vY29uc3Qgc3RhcnRzV2l0aEhhc2g6IEJvb2xlYW4gPSB0aGlzLnNldHRpbmdzLm5ld05hbWUudHJpbSgpWzBdID09ICcjJztcbiAgICAgICAgY29uc3QgaXNWYWxpZFRhZzogQm9vbGVhbiA9IFV0aWxzLmlzVGFnVmFsaWQodGhpcy5zZXR0aW5ncy5uZXdOYW1lLnRyaW0oKSwgdHJ1ZSlcbiAgICAgICAgY29uc3QgYWN0aW9uOiBTdHJpbmcgPSB0aGlzLnNldHRpbmdzLmFjdGlvbjtcbiAgICAgICAgbGV0IG5ld05hbWU6IFN0cmluZyA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWc7XG5cbiAgICAgICAgaWYgKGFjdGlvbiA9PSAnc3VtbWFyeScpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlUYWdzOiBBcnJheSA9IFV0aWxzLmV4dHJhY3RWYWxpZFRhZ3MgKHRoaXMuaW5wdXQuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICBpZiAoc3VtbWFyeVRhZ3MubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UgKCdJbnZhbGlkIHRhZyBmb3JtYXQuJylcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5jcmVhdGVDb2RlQmxvY2soc3VtbWFyeVRhZ3MsIHRoaXMuc2V0dGluZ3Muc3VtbWFyeVBvcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PSAncmVuYW1lJyAmJiAhaXNWYWxpZFRhZykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSAoJ0ludmFsaWQgdGFnIGZvcm1hdC4nKVxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9oZWxwLm9ic2lkaWFuLm1kL0VkaXRpbmcrYW5kK2Zvcm1hdHRpbmcvVGFncyNUYWcrZm9ybWF0XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT0gJ3JlbmFtZScpIG5ld05hbWUgPSB0aGlzLnNldHRpbmdzLm5ld05hbWU7XG4gICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24gPT0gJ2xvd2VyJykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PSAndG90ZXh0JykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcuc3Vic3RyaW5nKDEpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyB2YXVsdCB0b2dnbGUgaXMgaW4gdGhlIHJlbmFtZVRhZyBtZXRob2RcblxuICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnRWRpdG9yLnJlbmFtZVRhZyAoXG4gICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyxcbiAgICAgICAgICAgICAgICBuZXdOYW1lLFxuICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MudmF1bHRUb2dnbGVcbiAgICAgICAgICAgIClcblxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgIC8qXG4gICAgfSBlbHNlIGlmICh2YXVsdFRvZ2dsZSkge1xuICAgICAgICBcbiAgICAgICAgLy8gbWFrZSB0aGlzIGludG8gYSBmdW5jdGlvbiAvLyBjYWxsIGl0IGZyb20gdGhlIGFjdGlvbiBmdW5jdGlvblxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICAgICAgdGl0bGVFbC5zZXRUZXh0KFwiQXBwbHlpbmcgZWRpdFwiKVxuICAgICAgICAvL3N1Ym1pdEJ0bi5zZXREaXNhYmxlZCh0cnVlKVxuICAgICAgICBjb25zdCBlZGl0UHJvZ3Jlc3MgPSBuZXcgUHJvZ3Jlc3NCYXJDb21wb25lbnQgKGNvbnRlbnRFbClcbiAgICAgICAgZWRpdFByb2dyZXNzLnNldFZhbHVlKDc1KVxuXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGVudEVsKVxuICAgICAgICAuc2V0Q2xhc3MgKCd0YWctZWRpdG9yLXN1Ym1pdCcpXG4gICAgICAgIC5zZXRCdXR0b25UZXh0KCdDYW5jZWwnKVxuICAgICAgICAub25DbGljayAoKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgLy8gdmFsaWRhdGVcbiAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjYW5jZWwnKTtcbiAgICAgICAgICAgICAgIC8vc3VibWl0VGFnRWRpdCgpXG4gICAgICAgICAgICB9XG4gICAgICAgIClcbiAgICAgICAgLy8gY2xvc2Ugd2hlbiBkb25lXG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZG8gaXRcbiAgICAgICAgbW9kYWwuY2xvc2UoKTtcbiAgICB9Ki9cblxuXG4gICAgLyppbnB1dENoYW5nZUhhbmRsZXIgKHZhbHVlOiBTdHJpbmcsIGVkaXRUeXBlOiBTdHJpbmcpIHtcbiAgICAgICAgY29uc29sZS5sb2codmFsdWUpO1xuXG4gICAgICAgIGlmIChlZGl0VHlwZSA9PSAncmVuYW1lJykge1xuICAgICAgICAgICAgLy8gdmFsaWRhdGVcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MubmV3TmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzLm5ld05hbWUpXG4gICAgICAgIH1cbiAgICB9Ki9cblxuICAgIHNob3dTdW1tYXJ5T3B0aW9ucyAoKSB7XG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQoZmFsc2UpXG5cbiAgICAgICAgbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgZG8geW91IHdhbnQgdG8gYWRkIHRoZSB0YWcgc3VtbWFyeT9cIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiQWRkIG11bHRpcGxlIHRhZ3MgYWJvdmUgc2VwYXJhdGVkIGJ5IGEgY29tbWEuXCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgLmFkZE9wdGlvbigndG9wJywgXCJUb3Agb2YgdGhpcyBub3RlXCIpXG4gICAgICAgICAgICAuYWRkT3B0aW9uKCdlbmQnLCBcIkJvdHRvbSBvZiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgIC8vLmFkZE9wdGlvbignaGVyZScsIFwiSW4gcGxhY2Ugb2YgdGhpcyB0YWdcIilcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ25vdGUnLCBcIkluIGEgbmV3IG5vdGVcIikgXG4gICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdW1tYXJ5UG9zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzLnN1bW1hcnlQb3MpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApOyBcbiAgICB9XG5cblxuICAgIHNob3dFZGl0VGFnT3B0aW9ucyAoZWRpdFR5cGU6IFN0cmluZykge1xuXG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyk7XG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQodHJ1ZSlcblxuICAgICAgICBpZiAoZWRpdFR5cGUgPT0gJ3JlbmFtZScpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBuZXcgU2V0dGluZyh0aGlzLm9wdGlvbnNEaXYpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJOZXcgbmFtZVwiKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKFwiVGFncyBjYW4gaW5jbHVkZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyAoXyksIGh5cGhlbnMgKC0pLCBhbmQgZm9yd2FyZCBzbGFzaGVzICgvKSBmb3IgbmVzdGVkIHRhZ3MuXCIpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQoKG9wdCkgPT5cbiAgICAgICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSgnJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmlucHV0Q2hhbmdlSGFuZGxlciAodmFsdWUsIGVkaXRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5uZXdOYW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgd2hlcmVFZGl0T3B0ID0gbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgdG8gbWFrZSB0aGlzIGNoYW5nZT9cIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXQVJOSU5HOiBUaGVyZSBpcyBOTyBVTkRPIGZvciB0aGlzIHRoaXMgYWN0aW9uLlwiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICBvcHRcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ25vdGUnLCBcIkp1c3Qgd2l0aGluIHRoaXMgbm90ZVwiKVxuICAgICAgICAgICAgLmFkZE9wdGlvbigndmF1bHQnLCBcIkFjcm9zcyBlbnRpcmUgdmF1bHRcIilcbiAgICAgICAgICAgIC5vbkNoYW5nZSgodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT0gJ3ZhdWx0Jykge1xuICAgICAgICAgICAgICAgICAgICB3aGVyZUVkaXRPcHQuc2V0RGVzYyhcIldBUk5JTkc6IFRoZXJlIGlzIE5PIFVORE8gZm9yIHZhdWx0IGNoYW5nZXMuIENvbnNpZGVyIG1ha2luZyBhIGJhY2t1cCBvZiB5b3VyIHZhdWx0IGZpcnN0LlwiKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnZhdWx0VG9nZ2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB3aGVyZUVkaXRPcHQuc2V0RGVzYyhcIlwiKVxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLnZhdWx0VG9nZ2xlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zZXR0aW5ncy52YXVsdFRvZ2dsZSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG5cblxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlLCBGdXp6eVN1Z2dlc3RNb2RhbCwgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3RGaWxlTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgcmVzdWx0OiBURmlsZTtcbiAgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkO1xuICBmaWxlTGlzdDogVEZpbGVbXTtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG5cbiAgICB0aGlzLmZpbGVMaXN0ID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhbGwgYXZhaWxhYmxlIHN1Z2dlc3Rpb25zLlxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgLy9pZiAodGhpcy5maWxlTGlzdC5sZW5ndGggPT0gMClcbiAgICByZXR1cm4gdGhpcy5maWxlTGlzdC5maWx0ZXIoKGZpbGUpID0+XG4gICAgICBmaWxlLnBhdGguaW5jbHVkZXMocXVlcnkpXG4gICAgKTtcbiAgfVxuXG4gIC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXG4gIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgIGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZmlsZS5uYW1lIH0pO1xuICAgIGVsLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiBmaWxlLnBhdGggfSk7XG4gIH1cblxuICAvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cbiAgb25DaG9vc2VTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgLy9uZXcgTm90aWNlKGBTZWxlY3RlZCAke2ZpbGUucGF0aH1gKTtcbiAgICAvL2NvbnNvbGUubG9nKGV2dC50YXJnZXQudmFsdWUpXG4gICAgLy9pZiAoZmlsZS5uYW1lKVxuICAgIHRoaXMub25TdWJtaXQoZmlsZSlcbiAgfVxuXG4gIC8vb25Ob1N1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAvL25ldyBOb3RpY2UoYE5vIHNlbGVjdGlvbmApO1xuICAgIC8vdGhpcy5vblN1Ym1pdChmaWxlKVxuICAvL31cbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blJlbmRlcmVyLCBDYWNoZWRNZXRhZGF0YSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgRHJvcGRvd25Db21wb25lbnQsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFnU3VtbWFyeSB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblx0c2VsZWN0ZWRCbG9ja3M6IE51bWJlcltdO1xuXHRibG9ja3M6IFN0cmluZ1tdO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGFzeW5jIGJha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBzdHJpbmcsIFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudCwgXG5cdFx0ZmlsZVBhdGg6c3RyaW5nXG5cdCkge1xuXHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZSdcblx0XHQpO1xuXHRcdFxuXHRcdGlmIChtZFNvdXJjZSkge1xuXHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBuZXdGaWxlQ29udGVudCA9IFV0aWxzLnJlcGxhY2VUZXh0SW5TdHJpbmcgKFxuXHRcdFx0XHRtZFNvdXJjZSwgXG5cdFx0XHRcdGZpbGVDb250ZW50LCBcblx0XHRcdFx0c3VtbWFyeU1kXG5cdFx0XHQpXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG5cdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnVGFnIHN1bW1hcnkgZmxhdHRlbmVkIHRvIGFjdGl2ZSBub3RlLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIFRhZyBCdWRkeTogQ2FuXFx0IGZpbmQgY29kZSBibG9jayBzb3VyY2UuIFRoaXMgaXMgYSBCVUcuIFx1RDgzRVx1REVCMicpO1xuXHRcdH1cblx0fVxuXG5cdGNvcHlCdG5IYW5kbGVyIChlLCBjb250ZW50KTp2b2lkIHtcblxuXHRcdC8vZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdGxldCBub3RpY2U7XG5cblx0XHRpZiAoc2VsZWN0aW9uICE9ICcnKSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChzZWxlY3Rpb24pO1xuXHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ1NlbGVjdGlvbiBjb3BpZWQgdG8gY2xpcGJvYXJkLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWdnZWQgcGFyYWdyYXBoIGNvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cdFx0fVxuXG5cdFx0Ly9uYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHQvL2NvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IENvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cblx0fVxuXG5cdHJlbW92ZVRhZ0J0bkhhbmRsZXIgKGUsIHBhcmFncmFwaEVsLCB0YWcpOnZvaWQge1xuXHRcdGNvbnN0IHRhZ0VsID0gVXRpbHMuZ2V0VGFnRWxlbWVudChwYXJhZ3JhcGhFbCwgdGFnKTtcblx0XHR0aGlzLnBsdWdpbi50YWdFZGl0b3IuZWRpdCh0YWdFbCk7XG5cdH1cblxuXHRhc3luYyBjb3B5VG9CdG5IYW5kbGVyIChcblx0XHRlOiBFdmVudCwgXG5cdFx0bW9kZTogU3RyaW5nLFxuXHRcdGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCxcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnQsXG5cdFx0Y29udGVudDogc3RyaW5nLCAgXG5cdFx0dGFnczogQXJyYXksIFxuXHRcdGZpbGVQYXRoOiBzdHJpbmcsXG5cdFx0c2VsZWN0ZWRGaWxlOiBURmlsZVxuXHQpIHtcblx0XHRsZXQgbmV3Q29udGVudFxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdFxuXHRcdGlmIChzZWxlY3Rpb24gPT0gJycpIG5ld0NvbnRlbnQgPSBjb250ZW50O1xuXHRcdGVsc2UgbmV3Q29udGVudCA9IHNlbGVjdGlvbjtcblx0XHRsZXQgbm90aWNlO1xuXHRcdFx0XHRcblx0XHRpZiAobW9kZSA9PSAnbGluaycpIHtcblx0XHRcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKS5yZXBsYWNlKC9cXC5tZCQvLCAnJyk7XG5cdFx0XHRuZXdDb250ZW50ID0gJ1tbJyArIGZpbGVQYXRoICsgJ3wnICsgZmlsZU5hbWUgKyAnXV0nO1xuXHRcdFxuXHRcdH0gXG5cblx0XHRpZiAobW9kZSAhPSAnbGluaycgJiYgIXNlbGVjdGlvbikge1xuXHRcdFx0dGFncy5mb3JFYWNoKCh0YWcsIGkpID0+IHtcblx0XHRcdFx0Ly8gbWFrZSB0aGlzIGEgc2V0dGluZy4gd2UnbGwgZGVmYXVsdCB0byBhbHdheXMgZm9yIG5vd1xuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMucmVtb3ZlVGFnRnJvbVN0cmluZyhuZXdDb250ZW50LCB0YWcpLnRyaW0oKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvcHlTdWNjZXNzID0gdGhpcy5jb3B5VGV4dFRvU2VjdGlvbihcblx0XHRcdC8vdGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnZ2VkUGFyYWdyYXBoQ29weVByZWZpeCArIFxuXHRcdFx0bmV3Q29udGVudCwgXG5cdFx0XHRkcm9wZG93bi5nZXRWYWx1ZSgpLCBcblx0XHRcdGZpbGVQYXRoLFxuXHRcdFx0KG1vZGUhPSdsaW5rJyksXG5cdFx0XHRzZWxlY3RlZEZpbGVcblx0XHQpO1xuXG5cdFx0aWYgKGNvcHlTdWNjZXNzKSB7XG5cblx0XHRcdGlmIChtb2RlID09ICdub3RlJykge1xuXG5cdFx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UoXG5cdFx0XHRcdFx0J0NvcGllZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArICcgaW4gJyArIHNlbGVjdGVkRmlsZS5uYW1lICsgJyBcdUQ4M0RcdUREMTcnLFxuXHRcdFx0XHRcdDUwMDApO1xuXHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KG5vdGljZS5ub3RpY2VFbCwgJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHNlbGVjdGVkRmlsZS5wYXRoKycjJytkcm9wZG93bi5nZXRWYWx1ZSgpLCAnJyk7XG4gXHRcdFx0XHR9KTtcblxuXHRcdFx0fSBlbHNlIGlmIChtb2RlID09ICdtb3ZlJyAmJiAhc2VsZWN0aW9uKSB7XG5cblxuXHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblx0XHRcdFx0bGV0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBmaWxlQ29udGVudC50cmltKCk7XG5cdFx0XHRcdGNvbnN0IG5ld0ZpbGVDb250ZW50ID0gVXRpbHMucmVwbGFjZVRleHRJblN0cmluZyhcblx0XHRcdFx0XHRjb250ZW50LnRyaW0oKSwgXG5cdFx0XHRcdFx0ZmlsZUNvbnRlbnQsIFxuXHRcdFx0XHRcdG5ld0NvbnRlbnQpLnRyaW0oKTtcblx0XHRcdFx0aWYgKGZpbGVDb250ZW50ICE9IG5ld0ZpbGVDb250ZW50KSB7XG5cdFx0XHRcdFx0Ly8gcmVuaXZlIHRoZSB0YWcgYmVmb3JlIGNvcHlpbmdcblx0XHRcdFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IGNvcGllZFRvV2hlcmU6IFN0cmluZyA9IGRyb3Bkb3duLmdldFZhbHVlKCk9PSd0b3AnID8gJ3RvcCBvZiBub3RlJyA6IGRyb3Bkb3duLmdldFZhbHVlKCk9PSdlbmQnID8gJ2VuZCBvZiBub3RlJyA6IGRyb3Bkb3duLmdldFZhbHVlKClcblx0XHRcdFx0XHRub3RpY2UgPSBuZXcgTm90aWNlKFxuXHRcdFx0XHRcdFx0Ly8nTW92ZWQgdG8gc2VjdGlvbjogJyArIGRyb3Bkb3duLmdldFZhbHVlKCkgK1xuXHRcdFx0XHRcdFx0Ly8nLlxcblx1RDgzRFx1REQxNyBPcGVuIHNvdXJjZSBub3RlLicsIFxuXHRcdFx0XHRcdFx0J0NvcGllZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArICcuICcgKyAoKGRyb3Bkb3duLmdldFZhbHVlKCk9PSd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCk9PSdlbmQnKSA/ICcnIDogJ1x1RDgzRFx1REQxNycpLFxuXHRcdFx0XHRcdFx0NTAwMCk7XG5cblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkucmVtb3ZlRWxlbWVudFdpdGhBbmltYXRpb24ocGFyYWdyYXBoRWwsICgpID0+IHsgXG5cdCAgICBcdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0ICAgIFx0XHRcdFx0XHR0aGlzLnVwZGF0ZShzdW1tYXJ5RWwpOyBcblx0ICAgIFx0XHRcdFx0XHRwYXJhZ3JhcGhFbC5yZW1vdmUoKTsgXG5cdCAgICBcdFx0XHRcdH0sIDUwMCk7XHRcdFx0XHRcdFx0XG5cdFx0XHRcdCAgICBcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0ICAgIFx0XHQvL3RoaXMucGx1Z2luLnRhZ1Byb2Nlc3Nvci5ydW4oKTsgXG5cdFx0XHRcdCAgICBcdH0sIDgwMCk7XG5cdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRpZiAoZHJvcGRvd24uZ2V0VmFsdWUoKSAhPSAndG9wJyB8fCBkcm9wZG93bi5nZXRWYWx1ZSgpICE9ICdlbmQnKSB7XG5cblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHQvL3RoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoZmlsZVBhdGgsICcnKTtcblx0XHRcdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcblx0XHQgXHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlICgnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpIFxuXHRcdFx0XHRcdFx0KyAnLlxcbkNhblxcJ3QgdXBkYXRlIHNvdXJjZSBmaWxlLicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnY29weScgfHwgbW9kZSA9PSAnbGluaycpIHtcblx0XHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ0NvcGllZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArICcuICcgKyAoKGRyb3Bkb3duLmdldFZhbHVlKCk9PSd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCk9PSdlbmQnKSA/ICcnIDogJ1x1RDgzRFx1REQxNycpKTtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XHRcblx0fVxuXG5cdGFzeW5jIG1ha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBTdHJpbmcsIFxuXHRcdHRhZ3M6IEFycmF5LFxuXHRcdGNvZGU6IEJvb2xlYW4gPSBmYWxzZVxuXHQpIHtcblx0XHRcblx0XHQvL2NvbnN0IG5ld05vdGVPYmogPSB0aGlzLmZpbGVPYmpGcm9tVGFncyh0YWdzKTtcblx0XHRjb25zdCBuZXdOb3RlT2JqID0gVXRpbHMuZmlsZU9iakZyb21UYWdzKHRhZ3MpO1xuXHRcdGxldCBmaWxlQ29udGVudCA9IGNvZGUgPyBzdW1tYXJ5TWQgOiAnIyMgJyArIG5ld05vdGVPYmoudGl0bGUgKyAnXFxuXFxuJyArIHN1bW1hcnlNZDtcblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHQvL2NvbnN0IGZpbGVOYW1lID0gdGhpcy5nZXRBY3RpdmVGaWxlRm9sZGVyKCkrbmV3Tm90ZU9iai5maWxlTmFtZTtcblx0XHRjb25zdCBmaWxlTmFtZSA9IFV0aWxzLmdldEFjdGl2ZUZpbGVGb2xkZXIodmlldykrbmV3Tm90ZU9iai5maWxlTmFtZTtcblx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVOYW1lKTtcblx0XHRsZXQgbm90aWNlO1xuXG5cdFx0Ly9jb25zb2xlLmxvZyAobmV3Tm90ZU9iai5maWxlTmFtZSk7XG5cblx0XHRpZiAoIWNvZGUpIHtcblx0XHRcdHRhZ3MuZm9yRWFjaCAoKHRhZykgPT4ge1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IFV0aWxzLnJlcGxhY2VUZXh0SW5TdHJpbmcgKHRhZywgZmlsZUNvbnRlbnQsIHRhZy5zdWJzdHJpbmcoMSksIHRydWUpXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cblx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgTm90ZSBhbHJlYWR5IGV4aXN0cy5cXG5DbGljayBoZXJlIHRvIG92ZXJ3cml0ZS4nLCA4MDAwKTtcblx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgZmlsZUNvbnRlbnQpO1xuXHRcdFx0XHRub3RpY2UgPSBuZXcgTm90aWNlICgnTm90ZSB1cGRhdGVkLlxcblx1RDgzRFx1REQxNyBPcGVuIG5vdGUuJywgNTAwMCk7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoZmlsZU5hbWUsICcnKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdH0gZWxzZSBpZiAoIWZpbGUpIHtcblxuXHRcdFx0dGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVOYW1lLCBmaWxlQ29udGVudCk7XG5cdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnU3VtbWFyeSBub3RlIGNyZWF0ZWQuIFx1RDgzRFx1RENEQ1xcblx1RDgzRFx1REQxNyBPcGVuIG5vdGUuJyk7XG5cdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KG5vdGljZS5ub3RpY2VFbCwgJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChuZXdOb3RlT2JqLmZpbGVOYW1lLCAnJyk7XG5cdFx0XHR9KTtcblxuXG5cdFx0fVxuXHR9XG5cblx0Y3JlYXRlQ29kZUJsb2NrICh0YWdzQXJyYXk6IFN0cmluZ1tdLCBwb3M6IFN0cmluZykge1xuXHRcdC8vY29uc29sZS5sb2coc3VtbWFyeVBvcylcblx0XHRjb25zdCBjb2RlQmxvY2tTdHJpbmcgPSBcblx0XHRcdCdgYGB0YWctc3VtbWFyeVxcbicgK1xuXHRcdFx0J3RhZ3M6ICcgKyB0YWdzQXJyYXkuam9pbignICcpICsgJ1xcbicgK1xuXHRcdFx0J2BgYCc7XG5cblx0XHRpZiAocG9zID09ICdub3RlJykge1xuXG5cdFx0XHR0aGlzLm1ha2VTdW1tYXJ5QnRuSGFuZGxlciAoY29kZUJsb2NrU3RyaW5nLCB0YWdzQXJyYXksIHRydWUpO1xuXG5cdFx0fSBlbHNlIHtcblxuXHRcdFx0dGhpcy5jb3B5VGV4dFRvU2VjdGlvbihcblx0XHRcdCAgICBjb2RlQmxvY2tTdHJpbmcsXG5cdFx0XHQgICAgcG9zLCBcblx0XHRcdCAgICAnJyxcblx0XHRcdCAgICBmYWxzZVxuXHRcdCAgICApXG5cdFx0fVxuXG5cdH1cblxuXHRhc3luYyBjb2RlQmxvY2tQcm9jZXNzb3IgKFxuXHRcdHNvdXJjZTogc3RyaW5nLCBcblx0XHRlbDpIVE1MRWxlbWVudCwgXG5cdFx0Y3R4XG5cdCk6IHZvaWQge1xuXHRcdFxuXHRcdC8vIEluaXRpYWxpemUgdGFnIGxpc3Rcblx0XHRsZXQgdGFnczogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdGxldCBpbmNsdWRlOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IGV4Y2x1ZGU6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgc2VjdGlvbnM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgbWF4OiBudW1iZXIgPSA1MDtcblx0XHRjb25zdCBtYXhQYXR0ZXJuID0gL15cXHMqbWF4OlxccyooXFxkKylcXHMqJC87XG5cdFx0bGV0IG1hdGNoO1xuXG5cdFx0Ly8gUHJvY2VzcyByb3dzIGluc2lkZSBjb2RlYmxvY2tcblx0XHRjb25zdCByb3dzID0gc291cmNlLnNwbGl0KFwiXFxuXCIpLmZpbHRlcigocm93KSA9PiByb3cubGVuZ3RoID4gMCk7XG5cdFx0cm93cy5mb3JFYWNoKChsaW5lKSA9PiB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgdGhlIHRhZ3MgKE9SKVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqdGFnczpbXFxwe0x9MC05X1xcLS8jIF0rJC9ndSkpIHtcblx0XHRcdFx0Y29uc3QgY29udGVudCA9IGxpbmUucmVwbGFjZSgvXlxccyp0YWdzOi8sIFwiXCIpLnRyaW0oKTtcblxuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2YgdmFsaWQgdGFncyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIHRhZ3MgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubWFwKCh0YWcpID0+IHRhZy50cmltKCkpO1xuXHRcdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoKHRhZykgPT4ge1xuXHRcdFx0XHRcdGlmICh0YWcubWF0Y2goL14jW1xccHtMfV0rW14jXSokL3UpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRhZ3MgPSBsaXN0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgdGhlIHRhZ3MgdG8gaW5jbHVkZSAoQU5EKVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqaW5jbHVkZTpbXFxwe0x9MC05X1xcLS8jIF0rJC9ndSkpIHtcblx0XHRcdFx0Y29uc3QgY29udGVudCA9IGxpbmUucmVwbGFjZSgvXlxccyppbmNsdWRlOi8sIFwiXCIpLnRyaW0oKTtcblxuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2YgdmFsaWQgdGFncyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIGluY2x1ZGUgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubWFwKCh0YWcpID0+IHRhZy50cmltKCkpO1xuXHRcdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoKHRhZykgPT4ge1xuXHRcdFx0XHRcdGlmICh0YWcubWF0Y2goL14jW1xccHtMfV0rW14jXSokL3UpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGluY2x1ZGUgPSBsaXN0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgdGhlIHRhZ3MgdG8gZXhjbHVkZSAoTk9UKVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqZXhjbHVkZTpbXFxwe0x9MC05X1xcLS8jIF0rJC9ndSkpIHtcblx0XHRcdFx0Y29uc3QgY29udGVudCA9IGxpbmUucmVwbGFjZSgvXlxccypleGNsdWRlOi8sIFwiXCIpLnRyaW0oKTtcblxuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2YgdmFsaWQgdGFncyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIGV4Y2x1ZGUgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubWFwKCh0YWcpID0+IHRhZy50cmltKCkpO1xuXHRcdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoKHRhZykgPT4ge1xuXHRcdFx0XHRcdGlmICh0YWcubWF0Y2goL14jW1xccHtMfV0rW14jXSokL3UpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGV4Y2x1ZGUgPSBsaXN0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgc2VjdGlvbnMgb2YgYSBub3RlXG5cdFx0XHRpZiAobGluZS5tYXRjaCgvXlxccypzZWN0aW9uczpbXFxwe0x9MC05X1xcLS8jLCBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqc2VjdGlvbnM6LywgXCJcIikudHJpbSgpO1xuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2Ygc2VjdGlvbnMgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBzZWN0aW9ucyB2YXJpYWJsZVxuXHRcdFx0XHRsZXQgbGlzdCA9IGNvbnRlbnQuc3BsaXQoJywnKS5tYXAoKHNlYykgPT4gc2VjLnRyaW0oKSk7XG5cdFx0XHRcdHNlY3Rpb25zID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIG1heCBudW1iZXIgb2YgYmxvY2tzIHRvIGRpc3BsYXlcblx0XHRcdG1hdGNoID0gbGluZS5tYXRjaChtYXhQYXR0ZXJuKTtcblx0XHRcdGlmIChtYXRjaCkge1xuICAgIFx0XHRcdG1heCA9IE1hdGgubWluKDUwLCBOdW1iZXIobWF0Y2hbMV0pKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRjb25zdCBjb2RlQmxvY2sgPSAnYGBgdGFnLXN1bW1hcnlcXG4nK3NvdXJjZS50cmltKCkrJ1xcbmBgYCdcblx0XHQvLyBDcmVhdGUgc3VtbWFyeSBvbmx5IGlmIHRoZSB1c2VyIHNwZWNpZmllZCBzb21lIHRhZ3Ncblx0XHRpZiAodGFncy5sZW5ndGggPiAwIHx8IGluY2x1ZGUubGVuZ3RoID4gMCkge1xuXHRcdFx0YXdhaXQgdGhpcy5jcmVhdGUoXG5cdFx0XHRcdGVsLCBcblx0XHRcdFx0dGFncywgXG5cdFx0XHRcdGluY2x1ZGUsIFxuXHRcdFx0XHRleGNsdWRlLCBcblx0XHRcdFx0c2VjdGlvbnMsIFxuXHRcdFx0XHRtYXgsIFxuXHRcdFx0XHRjdHguc291cmNlUGF0aCwgXG5cdFx0XHRcdGNvZGVCbG9ja1xuXHRcdFx0KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jcmVhdGVFbXB0eShcblx0XHRcdFx0ZWwsIFxuXHRcdFx0XHR0YWdzID8gdGFncyA6IFtdLCBcblx0XHRcdFx0aW5jbHVkZSA/IGluY2x1ZGUgOiBbXSwgXG5cdFx0XHRcdGV4Y2x1ZGUgPyBleGNsdWRlIDogW10sIFxuXHRcdFx0XHRzZWN0aW9ucyA/IHNlY3Rpb25zIDogW10sIFxuXHRcdFx0XHRtYXggPyBtYXggOiBbXSwgXG5cdFx0XHRcdGN0eC5zb3VyY2VQYXRoID8gY3R4LnNvdXJjZVBhdGggOiAnJywgXG5cdFx0XHRcdGNvZGVCbG9ja1xuXHRcdFx0KTtcblx0XHR9IFxuXHR9OyBcblxuXHRjcmVhdGVFbXB0eShcblx0XHRlbGVtZW50OiBIVE1MRWxlbWVudCwgXG5cdFx0dGFnczogU3RyaW5nW10sIFxuXHRcdGluY2x1ZGU6IHN0cmluZ1tdLCBcblx0XHRleGNsdWRlOiBzdHJpbmdbXSwgXG5cdFx0c2VjdGlvbnM6IHN0cmluZ1tdLCBcblx0XHRtYXg6IG51bWJlciwgXG5cdFx0ZmlsZUN0eDogc3RyaW5nLCBcblx0XHRtZFNvdXJjZTpzdHJpbmdcblx0KTogdm9pZCB7XG5cblx0XHRjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbCgnZGl2Jyk7XG5cdFx0Y29uc3QgdGV4dERpdiA9IGNyZWF0ZUVsKFwiYmxvY2txdW90ZVwiKTtcblx0XHR0ZXh0RGl2LmlubmVySFRNTCA9IFwiVGhlcmUgYXJlIG5vIGZpbGVzIHdpdGggdGFnZ2VkIHBhcmFncmFwaHMgdGhhdCBtYXRjaCB0aGUgdGFnczo8YnI+XCJcblx0XHRcdCsgKHRhZ3MubGVuZ3RoPjAgPyB0YWdzLmpvaW4oJywgJykgOiBcIk5vIHRhZ3Mgc3BlY2lmaWVkLlwiKSArIFwiPGJyPlwiO1xuXHRcdFxuXHRcdGNvbnRhaW5lci5hcHBlbmRDaGlsZCh0ZXh0RGl2KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay10YWdzJywgXG5cdFx0XHQoKHRhZ3MubGVuZ3RoID4gMCkgPyB0YWdzLmpvaW4oJywnKSA6ICcnKVxuXHRcdCk7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJywgXG5cdFx0XHQoaW5jbHVkZSA/IGluY2x1ZGUuam9pbignLCcpIDogJycpXG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay10YWdzLWV4Y2x1ZGUnLCBcblx0XHRcdChleGNsdWRlID8gZXhjbHVkZS5qb2luKCcsJykgOiAnJylcblx0XHQpO1xuXHRcdGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXNlY3Rpb25zJywgXG5cdFx0XHQoc2VjdGlvbnMgPyBzZWN0aW9ucy5qb2luKCcsJykgOiAnJylcblx0XHQpO1xuXHRcdGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLW1heCcsIFxuXHRcdFx0bWF4XG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1jb2RlJywgXG5cdFx0XHRtZFNvdXJjZVxuXHRcdCk7XG5cblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5wbHVnaW4uZ3VpLm1ha2VTdW1tYXJ5UmVmcmVzaEJ1dHRvbihjb250YWluZXIpKTs7XG5cblx0XHRlbGVtZW50LnJlcGxhY2VXaXRoKGNvbnRhaW5lcik7XG5cdH1cblxuXHRhc3luYyBjcmVhdGUoXG5cdFx0ZWxlbWVudDogSFRNTEVsZW1lbnQsIFxuXHRcdHRhZ3M6IHN0cmluZ1tdLCBcblx0XHRpbmNsdWRlOiBzdHJpbmdbXSwgXG5cdFx0ZXhjbHVkZTogc3RyaW5nW10sIFxuXHRcdHNlY3Rpb25zOiBzdHJpbmdbXSxcblx0XHRtYXg6IG51bWJlciwgXG5cdFx0ZmlsZUN0eDogc3RyaW5nLFxuXHRcdG1kU291cmNlOnN0cmluZ1xuXHQpOiB2b2lkIHtcblx0XHRcbi8vY29uc29sZS5sb2coJ2NyZWF0ZSBzdW1tYXJ5Jylcblx0XHRjb25zdCBhY3RpdmVGaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRjb25zdCB2YWxpZFRhZ3MgPSB0YWdzLmNvbmNhdChpbmNsdWRlKTtcblx0XHRjb25zdCB0ZW1wQ29tcG9uZW50ID0gbmV3IFRlbXBDb21wb25lbnQoKTtcblx0XHRjb25zdCBzdW1tYXJ5Q29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuXHRcdHRoaXMuc2VsZWN0ZWRCbG9ja3MgPSBbXTtcblx0XHR0aGlzLmJsb2NrcyA9IFtdO1xuXG5cdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY2xhc3MnLCBcblx0XHRcdCd0YWctc3VtbWFyeS1ibG9jaydcblx0XHQpO1xuXHRcdFxuXHRcdC8vIEdldCBmaWxlc1xuXHRcdGxldCBsaXN0RmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0XHQvLyBGaWx0ZXIgZmlsZXNcblx0XHRsaXN0RmlsZXMgPSBsaXN0RmlsZXMuZmlsdGVyKChmaWxlKSA9PiB7XG5cdFx0XHQvLyBSZW1vdmUgZmlsZXMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgdGFncyBzZWxlY3RlZCBieSB0aGUgdXNlclxuXHRcdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdGNvbnN0IHRhZ3NJbkZpbGUgPSBnZXRBbGxUYWdzKGNhY2hlKTtcblxuXHRcdFx0aWYgKHZhbGlkVGFncy5zb21lKCh2YWx1ZSkgPT4gdGFnc0luRmlsZT8uaW5jbHVkZXModmFsdWUpKSkge1xuXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG5cblx0XHQvLyBTb3J0IGZpbGVzIGFscGhhYmV0aWNhbGx5XG5cdFx0Ly8gbWFrZSB0aGlzIGEgcHJvcGVydHkgb2YgdGhlIGNvZGUgYmxvY2suIGJ1dCBkZWZhdWx0IHRvIG1vZGlmaWVkIGRhdGVcblx0XHQvKmxpc3RGaWxlcyA9IGxpc3RGaWxlcy5zb3J0KChmaWxlMSwgZmlsZTIpID0+IHtcblx0XHRcdGlmIChmaWxlMS5wYXRoIDwgZmlsZTIucGF0aCkge1xuXHRcdFx0XHRyZXR1cm4gLTE7XG5cdFx0XHR9IGVsc2UgaWYgKGZpbGUxLnBhdGggPiBmaWxlMi5wYXRoKSB7XG5cdFx0XHRcdHJldHVybiAxO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmV0dXJuIDA7XG5cdFx0XHR9XG5cdFx0fSk7Ki9cbiBcblxuXHRcdGxpc3RGaWxlcyA9IGxpc3RGaWxlcy5zb3J0KChmaWxlMSwgZmlsZTIpID0+IHtcblx0XHQgICAgLy8gU2luY2UgbXRpbWUgaXMgYSBVbml4IHRpbWVzdGFtcCBpbiBtaWxsaXNlY29uZHMsIHdlIGNhbiBkaXJlY3RseSBzdWJ0cmFjdCB0aGVtXG5cdFx0ICAgIC8vY29uc29sZS5sb2coZmlsZTIuc3RhdC5jdGltZSAtIGZpbGUxLnN0YXQuY3RpbWUpXG5cdFx0ICAgIHJldHVybiBmaWxlMi5zdGF0LmN0aW1lIC0gZmlsZTEuc3RhdC5jdGltZTtcblx0XHR9KTtcblxuXHRcdC8vIEdldCBmaWxlcyBjb250ZW50XG5cdFx0bGV0IGxpc3RDb250ZW50czogW1RGaWxlLCBzdHJpbmddW10gPSBhd2FpdCB0aGlzLnJlYWRGaWxlcyhsaXN0RmlsZXMpO1xuXHRcdGxldCBjb3VudCA9IDA7XG5cblx0XHQvLyBDcmVhdGUgc3VtbWFyeVxuXHRcdGxldCBzdW1tYXJ5OiBzdHJpbmcgPSBcIlwiO1xuXHRcdGxpc3RDb250ZW50cy5mb3JFYWNoKChpdGVtKSA9PiB7XG5cblx0XHRcdC8vIEdldCBmaWxlcyBuYW1lXG5cdFx0XHQvLyBpdGVtWzBdIGlzIHRoZSBmaWxlLCBpdGVtWzFdIGlzIHRoZSBmaWxlIGNvbnRlbnRcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gaXRlbVswXS5uYW1lLnJlcGxhY2UoLy5tZCQvZywgXCJcIik7XG5cdFx0XHRjb25zdCBmaWxlUGF0aCA9IGl0ZW1bMF0ucGF0aDtcblx0XHRcdC8vY29uc29sZS5sb2coYWN0aXZlRmlsZSlcblx0XHRcdC8vIERvIG5vdCBhZGQgdGhpcyBpdGVtIGlmIGl0J3MgaW4gdGhlIHNhbWUgZmlsZSB3ZSdyZSBjcmVhdGluZyB0aGUgc3VtbWFyeVxuXHRcdFx0Ly8gU2hvdWxkIGZpbHRlciB0aGlzIGZpbGUgb3V0IGVhcmxpZXJcblx0XHRcdGlmIChhY3RpdmVGaWxlKSB7XG5cdFx0XHRcdGlmIChhY3RpdmVGaWxlLm5hbWUgPT0gaXRlbVswXS5uYW1lKSByZXR1cm47XG5cdFx0XHR9XG5cblx0XHRcdC8vIEdldCBwYXJhZ3JhcGhzXG5cdFx0XHRsZXQgbGlzdFBhcmFncmFwaHM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRcdGNvbnN0IGJsb2NrcyA9IGl0ZW1bMV0uc3BsaXQoL1xcblxccypcXG4vKS5maWx0ZXIoKHJvdykgPT4gcm93LnRyaW0oKS5sZW5ndGggPiAwKTtcblxuXHRcdFx0Ly8gR2V0IGxpc3QgaXRlbXNcblx0XHRcdGJsb2Nrcy5mb3JFYWNoKChwYXJhZ3JhcGgpID0+IHtcblx0XHRcdFx0XG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZSBwYXJhZ3JhcGggaXMgYW5vdGhlciBwbHVnaW5cblx0XHRcdFx0bGV0IHZhbGlkID0gZmFsc2U7XG5cdFx0XHRcdC8vbGV0IGxpc3RUYWdzID0gcGFyYWdyYXBoLm1hdGNoKC8jW1xccHtMfTAtOV9cXC0vI10rL2d1KTtcblx0XHRcdFx0bGV0IGxpc3RUYWdzID0gcGFyYWdyYXBoLm1hdGNoKC8oPzw9XnxcXHMpKCNbXlxccyMuLDshPzpdKykvZyk7IC8vIHJldmlzZWQgdG8gbm90IG1hdGNoIGhhc2ggaW4gbWlkZGxlIG9mIHdvcmRcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChsaXN0VGFncyAhPSBudWxsICYmIGxpc3RUYWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRpZiAoIXBhcmFncmFwaC5jb250YWlucyhcImBgYFwiKSAmJiAhcGFyYWdyYXBoLmNvbnRhaW5zKFwiLS0tXCIpKSB7XG5cdFx0XHRcdFx0XHR2YWxpZCA9IHRoaXMuaXNWYWxpZFRleHQobGlzdFRhZ3MsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmICh2YWxpZCkgbGlzdFBhcmFncmFwaHMucHVzaChwYXJhZ3JhcGgpOyAgXG5cblx0XHRcdH0pXG5cblx0XHRcdC8vIFRoZXJlIGlzIGFsc28gc29tZSByZWR1bmRhbmN5IGhlcmUgYmVjYXVzZSB3ZSBhcmUgcHJvY2Vzc2luZyBhIGxvdCBvZiBjb250ZW50IHRoYXQgd2UgZG9uJ3QgbmVlZCwgaWYgYSBtYXggaXMgc2V0LiBcblx0XHRcdC8vIGFkanVzdCB0aGUgY291bnQgY2hlY2sgXG5cdFx0XHQvLyBQcm9jZXNzIGVhY2ggYmxvY2sgb2YgdGV4dFxuXHRcdFx0bGlzdFBhcmFncmFwaHMuZm9yRWFjaChhc3luYyhwYXJhZ3JhcGgpID0+IHtcblx0XHRcdFx0aWYgKGNvdW50KysgPj0gbWF4KSByZXR1cm47XG5cblx0XHRcdFx0Ly8gUmVzdG9yZSBuZXdsaW5lIGF0IHRoZSBlbmRcblx0XHRcdFx0cGFyYWdyYXBoICs9IFwiXFxuXCI7XG5cblx0XHRcdFx0dmFyIHJlZ2V4ID0gbmV3IFJlZ0V4cDtcblxuXHRcdFx0XHQvLyBDaGVjayB3aGljaCB0YWcgbWF0Y2hlcyBpbiB0aGlzIHBhcmFncmFwaC5cblx0XHRcdFx0dmFyIHRhZ1RleHQgPSBuZXcgU3RyaW5nO1xuXHRcdFx0XHR2YXIgdGFnU2VjdGlvbiA9IG51bGw7XG5cdFx0XHRcdHRhZ3MuZm9yRWFjaCgodGFnKSA9PiB7XG5cdFx0XHRcdFx0dGFnVGV4dCA9IHRhZy5yZXBsYWNlKCcjJywgJ1xcXFwjJyk7XG5cdFx0XHRcdFx0cmVnZXggPSBuZXcgUmVnRXhwKGAke3RhZ1RleHR9KFxcXFxXfCQpYCwgJ2cnKTtcbiAgICAgICAgICAgICAgXHRcdGlmIChwYXJhZ3JhcGgubWF0Y2gocmVnZXgpICE9IG51bGwpIHsgXG4gICAgICAgICAgICAgIFx0XHRcdHRhZ1NlY3Rpb24gPSB0YWdcbiAgICAgICAgICAgICAgXHRcdH0gXG4gICAgICAgICAgICBcdH0pO1xuICAgICAgICAgIFx0XHRcbiAgICAgICAgICBcdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICAgIFx0XHQvL2NvbnN0IHNlbGVjdENvbnRhaW5lciA9IGNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgICBcdFx0YnV0dG9uQ29udGFpbmVyLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGFnc3VtbWFyeS1idXR0b25zJylcbiAgICAgICAgICBcdFx0Y29uc3QgcGFyYWdyYXBoRWwgPSBjcmVhdGVFbChcImJsb2NrcXVvdGVcIik7XG5cdFx0XHRcdHBhcmFncmFwaEVsLnNldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnLCBmaWxlUGF0aCk7XG5cblx0XHRcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdpbmRleCcsIGNvdW50LTEpO1xuXG5cdFx0XHRcdHBhcmFncmFwaEVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGFnLXN1bW1hcnktcGFyYWdyYXBoJyk7XG5cblx0XHRcdFx0Y29uc3QgYmxvY2tMaW5rID0gcGFyYWdyYXBoLm1hdGNoKC9cXF5bXFxwe0x9MC05X1xcLS9eXSsvZ3UpOyBcblx0XHRcdFx0bGV0IGxpbms7XG4gICAgICAgIFx0XHRcbiAgICAgICAgXHRcdGlmIChibG9ja0xpbmspIGxpbmsgPSAnW1snICsgZmlsZVBhdGggKyAnIycgKyBibG9ja0xpbmsgKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG4gICAgICAgIFx0XHRlbHNlIGxpbmsgPSAnW1snICsgZmlsZVBhdGggKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG5cdFx0XHRcdFx0XHRcbiAgICAgICAgXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdTdW1tYXJ5QmxvY2tCdXR0b25zKSB7XG5cbiAgICAgICAgXHRcdFx0LypidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUJsb2NrU2VsZWN0b3IoXG5cdFx0XHRcdFx0XHRcdGNvdW50LTFcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpOyovXG5cblx0XHRcdFx0XHRpZiAoc2VjdGlvbnMubGVuZ3RoID49IDEpIHtcblx0XHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VDb3B5VG9TZWN0aW9uKFxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuY29weVRvQnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdFx0XHRcdHBhcmFncmFwaCwgXG5cdFx0XHRcdFx0XHRcdFx0c2VjdGlvbnMsIFxuXHRcdFx0XHRcdFx0XHRcdHRhZ3MsXG5cdFx0XHRcdFx0XHRcdFx0KGJsb2NrTGluayA/IChmaWxlUGF0aCArICcjJyArIGJsb2NrTGlua1swXSkgOiBmaWxlUGF0aCksIFxuXHRcdFx0XHRcdFx0XHRcdHBhcmFncmFwaEVsLCBcblx0XHRcdFx0XHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyXG5cdFx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5tYWtlQ29weUJ1dHRvbihcblx0XHRcdFx0XHRcdFx0dGhpcy5jb3B5QnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHRcdFx0XHRcdFx0XHRwYXJhZ3JhcGgudHJpbSgpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KTtcbiAgICBcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcbiAgICBcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VSZW1vdmVUYWdCdXR0b24oXG4gICAgXHRcdFx0XHRcdFx0dGhpcy5yZW1vdmVUYWdCdG5IYW5kbGVyLmJpbmQodGhpcyksXG4gICAgXHRcdFx0XHRcdFx0cGFyYWdyYXBoRWwsIFxuICAgIFx0XHRcdFx0XHRcdHRhZ1NlY3Rpb24vLywgXG4gICAgXHRcdFx0XHRcdFx0Ly8oYmxvY2tMaW5rID8gKGZpbGVQYXRoICsgJyMnICsgYmxvY2tMaW5rWzBdKSA6IGZpbGVQYXRoKVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCk7XG5cbiAgICBcdFx0XHR9XG5cbiAgICAgICAgXHRcdGNvbnN0IG1kUGFyYWdyYXBoID0gcGFyYWdyYXBoO1xuICAgICAgICBcdFx0cGFyYWdyYXBoID0gJyoqJyArIGxpbmsgKyAnKipcXG4nICsgcGFyYWdyYXBoO1xuICAgICAgICAgIFx0XHRzdW1tYXJ5ICs9IHBhcmFncmFwaCArICdcXG4nOyBcblxuICAgICAgICAgIFx0XHRwYXJhZ3JhcGhFbC5zZXRBdHRyaWJ1dGUoJ21kLXNvdXJjZScsIG1kUGFyYWdyYXBoKTsgXG4gICAgICAgICAgXHRcdGJsb2Nrcy5wdXNoKG1kUGFyYWdyYXBoKVxuXG4gICAgICAgICAgXHRcdGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXG4gICAgICAgICAgXHRcdFx0cGFyYWdyYXBoLCBcbiAgICAgICAgICBcdFx0XHRwYXJhZ3JhcGhFbCwgXG4gICAgICAgICAgXHRcdFx0ZmlsZVBhdGgsIC8vJycsIFxuICAgICAgICAgIFx0XHRcdHRlbXBDb21wb25lbnRcbiAgICAgIFx0XHRcdCk7XG5cbi8vY29uc29sZS5sb2coJ21hcmtkb3duIHJlbmRlciBzdW1tYXJ5JylcbiAgICAgICAgICBcdFx0XG4gICAgICAgICAgXHRcdGNvbnN0IHRpdGxlRWwgPSBjcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICAgIFx0XHR0aXRsZUVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGFnc3VtbWFyeS1pdGVtLXRpdGxlJyk7XG5cbiAgICAgICAgICBcdFx0Ly8gTm90IGRvaW5nIHRoaXMgdW50aWwvd2hlbi9pZiB3ZSBldmVyIGNsZWFuIHVwIGFsbCB0aGUgY29weVRvIG1ldGhvZHNcbiAgICAgICAgICBcdFx0Ly8gYXMgZGVzY3JpYmVkIGluIHRoZSBnZXRTZWxlY3Rpb24gbWV0aG9kLlxuXHRcdFx0XHQvKnRpdGxlRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VCbG9ja1NlbGVjdG9yKFxuXHRcdFx0XHRcdFx0cGFyc2VJbnQgKHBhcmFncmFwaEVsLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSlcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCk7Ki9cblxuICAgICAgICAgIFx0XHR0aXRsZUVsLmFwcGVuZENoaWxkKHBhcmFncmFwaEVsLnF1ZXJ5U2VsZWN0b3IoJ3N0cm9uZycpLmNsb25lTm9kZSh0cnVlKSlcblxuICAgICAgICAgIFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnU3VtbWFyeUJsb2NrQnV0dG9ucykgcGFyYWdyYXBoRWwuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgICBcdFx0cGFyYWdyYXBoRWwucXVlcnlTZWxlY3Rvcignc3Ryb25nJykucmVwbGFjZVdpdGgodGl0bGVFbClcbiAgICAgICAgICBcdFx0Ly9wYXJhZ3JhcGhFbC5zZXRBdHRyaWJ1dGUoJ21kLXNvdXJjZScsIG1kUGFyYWdyYXBoKVxuXG4gICAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQocGFyYWdyYXBoRWwpO1xuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFxuXHRcdFxuXHRcdC8vIEFkZCBTdW1tYXJ5XG5cdFx0aWYgKHN1bW1hcnkgIT0gJycpIHtcblx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucykge1xuXHRcdFx0XHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZVN1bW1hcnlSZWZyZXNoQnV0dG9uKFxuXHRcdFx0XHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUNvcHlTdW1tYXJ5QnV0dG9uKFxuXHQgICAgICAgIFx0XHRcdFx0c3VtbWFyeVxuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZVN1bW1hcnlOb3RlQnV0dG9uKFxuXHQgICAgICAgIFx0XHRcdFx0dGhpcy5tYWtlU3VtbWFyeUJ0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0ICAgICAgICBcdFx0XHRcdHN1bW1hcnksIFxuXHQgICAgICAgIFx0XHRcdFx0dGFnc1xuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0ICAgICAgICBcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUJha2VCdXR0b24oXG5cdCAgICAgICAgXHRcdFx0XHR0aGlzLmJha2VTdW1tYXJ5QnRuSGFuZGxlci5iaW5kKHRoaXMpLFxuXHQgICAgICAgIFx0XHRcdFx0c3VtbWFyeSwgXG5cdCAgICAgICAgXHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyLCBcblx0ICAgICAgICBcdFx0XHRcdGFjdGl2ZUZpbGUucGF0aFxuICAgICAgICBcdFx0XHRcdClcbiAgICAgICAgXHRcdFx0KTtcblxuXHQgICAgICAgIFx0XHRzdW1tYXJ5Q29udGFpbmVyLmFwcGVuZENoaWxkKGNyZWF0ZUVsKCdicicpKTsgXG5cdFx0XHRcdH0gXG5cdFx0XHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWwoJ2hyJykpOyBcblx0XHRcdH0sIDApO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stdGFncycsIFxuXHRcdFx0XHR0YWdzLmpvaW4oJywnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZScsIFxuXHRcdFx0XHQoKGluY2x1ZGUubGVuZ3RoID4gMCkgPyBpbmNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXRhZ3MtZXhjbHVkZScsIFxuXHRcdFx0XHQoKGV4Y2x1ZGUubGVuZ3RoID4gMCkgPyBleGNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXNlY3Rpb25zJywgXG5cdFx0XHRcdCgoc2VjdGlvbnMubGVuZ3RoID4gMCkgPyBzZWN0aW9ucy5qb2luKCcsJykgOiAnJylcblx0XHRcdCk7XG5cdFx0XHRzdW1tYXJ5Q29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdFx0J2NvZGVibG9jay1tYXgnLCBcblx0XHRcdFx0bWF4XG5cdFx0XHQpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stY29kZScsIFxuXHRcdFx0XHRtZFNvdXJjZVxuXHRcdFx0KTtcblxuXHRcdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChzdW1tYXJ5Q29udGFpbmVyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jcmVhdGVFbXB0eShcblx0XHRcdFx0ZWxlbWVudCwgXG5cdFx0XHRcdHRhZ3MgPyB0YWdzIDogW10sIFxuXHRcdFx0XHRpbmNsdWRlID8gaW5jbHVkZSA6IFtdLCBcblx0XHRcdFx0ZXhjbHVkZSA/IGV4Y2x1ZGUgOiBbXSwgXG5cdFx0XHRcdHNlY3Rpb25zID8gc2VjdGlvbnMgOiBbXSwgXG5cdFx0XHRcdG1heCA/IG1heCA6IFtdLCBcblx0XHRcdFx0JycsIFxuXHRcdFx0XHRtZFNvdXJjZVxuXHRcdFx0KTtcblx0XHR9XG5cdH1cblxuXHR1cGRhdGUgKFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudFxuXHQpOiB2b2lkIHtcblx0XHRcblx0XHRjb25zdCB0YWdzU3RyID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncydcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3MgPSB0YWdzU3RyID8gdGFnc1N0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCB0YWdzSW5jbHVkZVN0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZSdcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3NJbmNsdWRlID0gdGFnc0luY2x1ZGVTdHIgPyB0YWdzSW5jbHVkZVN0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCB0YWdzRXhjbHVkZVN0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtZXhjbHVkZSdcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3NFeGNsdWRlID0gdGFnc0V4Y2x1ZGVTdHIgPyB0YWdzRXhjbHVkZVN0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCBzZWN0aW9uc1N0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXNlY3Rpb25zJ1xuXHRcdFx0KTtcblx0XHRjb25zdCBzZWN0aW9ucyA9IHNlY3Rpb25zU3RyID8gc2VjdGlvbnNTdHIuc3BsaXQoJywnKSA6IFtdO1xuXG5cdFx0Y29uc3QgbWF4ID0gTnVtYmVyKHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLW1heCdcblx0XHQpKTtcblxuXHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZSdcblx0XHQpO1xuXG5cdFx0dGhpcy5jcmVhdGUoXG5cdFx0XHRzdW1tYXJ5RWwsIFxuXHRcdFx0dGFncywgXG5cdFx0XHR0YWdzSW5jbHVkZSwgXG5cdFx0XHR0YWdzRXhjbHVkZSwgXG5cdFx0XHRzZWN0aW9ucywgXG5cdFx0XHRtYXgsIFxuXHRcdFx0JycsIFxuXHRcdFx0bWRTb3VyY2UpO1xuXHR9XG5cblxuXHQvLyBOb3QgZmFjdG9yZWQgeWV0XG5cdGFzeW5jIGNvcHlUZXh0VG9TZWN0aW9uKFxuXHQgICAgdGV4dDogc3RyaW5nLCBcblx0ICAgIHNlY3Rpb246IHN0cmluZywgXG5cdCAgICBmaWxlUGF0aDogc3RyaW5nLFxuXHQgICAgYWRkTGluazogQm9vbGVhbiA9IHRydWUsXG5cdCAgICBzZWxlY3RlZEZpbGU6IFRGaWxlLFxuXHQgICAgZGV0ZWN0UHJlZml4OiBCb29sZWFuID0gdHJ1ZSlcblx0OlByb21pc2U8Ym9vbGVhbj57XG5cblx0ICAgIGNvbnN0IGZpbGUgPSBzZWxlY3RlZEZpbGUgPyBzZWxlY3RlZEZpbGUgOiAoYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSk7XG5cdCAgICBsZXQgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHQgICAgY29uc3QgZmlsZUNvbnRlbnRMaW5lczogc3RyaW5nW10gPSBVdGlscy5nZXRMaW5lc0luU3RyaW5nKGZpbGVDb250ZW50KTtcblx0ICAgIGNvbnN0IG1kSGVhZGluZ3MgPSBVdGlscy5nZXRNYXJrZG93bkhlYWRpbmdzKGZpbGVDb250ZW50TGluZXMpO1xuXHQgICAgbGV0IHRhcmdldExpbmU7XG5cblx0ICAgIGlmIChtZEhlYWRpbmdzLmxlbmd0aCA8PSAwIHx8IHNlY3Rpb24gPT0gJ2VuZCcgfHwgc2VjdGlvbiA9PSAndG9wJykge1xuXHQgICAgXHRpZiAoc2VjdGlvbiA9PSAndG9wJykge1x0ICAgIFx0XG5cdFx0ICAgIFx0dGFyZ2V0TGluZSA9IFV0aWxzLmZpbmRGaXJzdExpbmVBZnRlckZyb250TWF0dGVyKGZpbGVDb250ZW50KVxuXHRcdCAgICBcdGlmICh0YXJnZXRMaW5lID09IDApIGZpbGVDb250ZW50ID0gJ1xcbicgKyBmaWxlQ29udGVudFxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKHRhcmdldExpbmUpXG5cdFx0ICAgIH0gZWxzZSBpZiAoc2VjdGlvbiA9PSAnZW5kJyB8fCBtZEhlYWRpbmdzLmxlbmd0aCA8PSAwKSB7XG5cdFx0ICAgIFx0Ly8gdXRpbCBmdW5jdGlvbiB0byBmaW5kIGxhc3QgbGluZSBpbiBmaWxlXG5cdFx0ICAgIFx0dGFyZ2V0TGluZSA9IGZpbGVDb250ZW50TGluZXMubGVuZ3RoIC0gMTtcblx0XHQgICAgfVxuXHQgICAgfSBlbHNlIGlmIChtZEhlYWRpbmdzLmxlbmd0aCA+IDApIHsgLy8gaWYgdGhlcmUgYXJlIGFueSBoZWFkaW5nc1xuXHQgICAgICAgIGNvbnN0IGhlYWRpbmdPYmogPSBtZEhlYWRpbmdzLmZpbmQoaGVhZGluZyA9PiBoZWFkaW5nLnRleHQudHJpbSgpID09PSBzZWN0aW9uKTtcblx0ICAgICAgICBpZiAoaGVhZGluZ09iaikge1xuXHQgICAgICAgIFx0dGFyZ2V0TGluZSA9IGhlYWRpbmdPYmoubGluZTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBuZXcgTm90aWNlIChgJHtzZWN0aW9ufSBub3QgZm91bmQuYCk7XG5cdCAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGNvbnN0IGxpbmVQcmVmaXg6IFN0cmluZyA9IGRldGVjdFByZWZpeCA/IFV0aWxzLmdldExpc3RUeXBlRnJvbUxpbmVOdW1iZXIoZmlsZUNvbnRlbnQsIHRhcmdldExpbmUrMSkgOiAnJztcbiAgICAgICAgbGV0IGZpbmFsVGV4dDtcbiAgICAgICAgaWYgKGFkZExpbmspIGZpbmFsVGV4dCA9IGxpbmVQcmVmaXggKyB0ZXh0ICsgYCBbWyR7ZmlsZVBhdGh9fFx1RDgzRFx1REQxN11dYDtcbiAgICAgICAgZWxzZSBmaW5hbFRleHQgPSBsaW5lUHJlZml4ICsgdGV4dDtcbiAgICAgICAgLy9sZXQgbmV3Q29udGVudCA9IHRoaXMuaW5zZXJ0VGV4dEFmdGVyTGluZSh0ZXh0LCBmaWxlQ29udGVudCwgaGVhZGluZ09iai5saW5lKTtcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQgPSBVdGlscy5pbnNlcnRUZXh0QWZ0ZXJMaW5lKGZpbmFsVGV4dCwgZmlsZUNvbnRlbnQsIHRhcmdldExpbmUpO1xuICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuXHR9XG5cblx0YXN5bmMgcmVhZEZpbGVzKFxuXHRcdGxpc3RGaWxlczogVEZpbGVbXVxuXHQpOiBQcm9taXNlPFtURmlsZSwgc3RyaW5nXVtdPiB7XG5cdFx0XG5cdFx0bGV0IGxpc3Q6IFtURmlsZSwgc3RyaW5nXVtdID0gW107XG5cdFx0Zm9yIChsZXQgdCA9IDA7IHQgPCBsaXN0RmlsZXMubGVuZ3RoOyB0ICs9IDEpIHtcblx0XHRcdGNvbnN0IGZpbGUgPSBsaXN0RmlsZXNbdF07XG5cdFx0XHRsZXQgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSk7XG5cdFx0XHRsaXN0LnB1c2goW2ZpbGUsIGNvbnRlbnRdKTtcblx0XHR9XG5cblx0XHRyZXR1cm4gbGlzdDtcblx0fVxuXG5cdGlzVmFsaWRUZXh0KFxuXHQgICAgbGlzdFRhZ3M6IHN0cmluZ1tdLCBcblx0ICAgIHRhZ3M6IHN0cmluZ1tdLCBcblx0ICAgIGluY2x1ZGU6IHN0cmluZ1tdLCBcblx0ICAgIGV4Y2x1ZGU6IHN0cmluZ1tdXG5cdCk6IGJvb2xlYW4ge1xuXG5cdCAgICBsZXQgdmFsaWQgPSB0cnVlO1xuXG5cdCAgICAvLyBDaGVjayBPUiAodGFncylcblx0ICAgIGlmICh0YWdzLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICB2YWxpZCA9IHZhbGlkICYmIHRhZ3Muc29tZSgodmFsdWUpID0+IGxpc3RUYWdzLmluY2x1ZGVzKHZhbHVlKSk7XG5cdCAgICB9XG5cdCAgICAvLyBDaGVjayBBTkQgKGluY2x1ZGUpXG5cdCAgICBpZiAoaW5jbHVkZS5sZW5ndGggPiAwKSB7XG5cdCAgICAgICAgdmFsaWQgPSB2YWxpZCAmJiBpbmNsdWRlLmV2ZXJ5KCh2YWx1ZSkgPT4gbGlzdFRhZ3MuaW5jbHVkZXModmFsdWUpKTtcblx0ICAgIH1cblx0ICAgIC8vIENoZWNrIE5PVCAoZXhjbHVkZSlcblx0ICAgIGlmICh2YWxpZCAmJiBleGNsdWRlLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICB2YWxpZCA9ICFleGNsdWRlLnNvbWUoKHZhbHVlKSA9PiBsaXN0VGFncy5pbmNsdWRlcyh2YWx1ZSkpO1xuXHQgICAgfVxuXHQgICAgcmV0dXJuIHZhbGlkOyAgICAgICBcblx0fVxuXG5cdHN0YXRpYyBnZXRUYWdzVG9DaGVja0Zyb21FbCAoXG5cdFx0dGFnU3VtbWFyeUVsOiBIVE1MRWxlbWVudFxuXHQpOiBBcnJheSB7XG5cdFx0Y29uc3QgdGFnc1N0ciA9IHRhZ1N1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzJyk7XG5cdFx0Y29uc3QgdGFncyA9IHRhZ3NTdHIgPyB0YWdzU3RyLnNwbGl0KCcsJykgOiBbXTtcblx0XHRjb25zdCB0YWdzSW5jbHVkZVN0ciA9IHRhZ1N1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzLWluY2x1ZGUnKTtcblx0XHRjb25zdCB0YWdzSW5jbHVkZSA9IHRhZ3NJbmNsdWRlU3RyID8gdGFnc0luY2x1ZGVTdHIuc3BsaXQoJywnKSA6IFtdO1xuXHRcdHJldHVybiB0YWdzLmNvbmNhdCh0YWdzSW5jbHVkZSk7XG5cdH1cblxuXHRhc3luYyBnZXRGaWxlIChcblx0XHRlbDogSFRNTEVsZW1lbnRcblx0KTpURmlsZSB7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSBlbC5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7IFxuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdHJldHVybiBmaWxlO1xuXHR9XG5cblx0dXBkYXRlU2VsZWN0aW9uIChcblx0XHRpbmRleDogTnVtYmVyLCBcblx0XHRib29sOiBCb29sZWFuXG5cdCk6IHZvaWQge1xuXG5cdFx0Ly8gSWYgaXNTZWxlY3RlZCBpcyB0cnVlLCBhZGQgdGhlIGluZGV4IGlmIGl0J3Mgbm90IGFscmVhZHkgaW4gdGhlIGFycmF5XG5cdFx0aWYgKGJvb2wpIHtcblx0XHQgICAgaWYgKCF0aGlzLnNlbGVjdGVkQmxvY2tzLmluY2x1ZGVzKGluZGV4KSkge1xuXHRcdCAgICAgICAgdGhpcy5zZWxlY3RlZEJsb2Nrcy5wdXNoKGluZGV4KTtcblx0XHQgICAgfVxuXHRcdH0gZWxzZSB7XG5cdFx0ICAgIC8vIElmIGlzU2VsZWN0ZWQgaXMgZmFsc2UsIHJlbW92ZSB0aGUgaW5kZXggZnJvbSB0aGUgYXJyYXlcblx0XHQgICAgdGhpcy5zZWxlY3RlZEJsb2NrcyA9IHRoaXMuc2VsZWN0ZWRCbG9ja3MuZmlsdGVyKGl0ZW1JbmRleCA9PiBpdGVtSW5kZXggIT09IGluZGV4KTtcblx0XHR9XG5cbi8vY29uc29sZS5sb2codGhpcy5zZWxlY3RlZEJsb2NrcylcblxuXHR9XG5cblxuXHRnZXRTZWxlY3RlZE1hcmtkb3duQmxvY2tzICgpOiBTdHJpbmdbXSB7XG5cdFx0XG5cdFx0Ly8gVGhpcyBpcyB0b28gbWVzc3kgd2l0aCBjdXJyZW50IGltcGxtZW50YXRpb24uXG5cdFx0Ly8gVG8gbWFrZSB0aGlzIHdvcmssIHdlIG5lZWQgdG8gYnJlYWsgb3V0IGFsbCB0aGUgY29weVRvLCBnZXRQcmVmaXgsIGFkZExpbmssIGV0YyBtZXRob2RzL3Byb3BzXG5cdFx0Ly8gd2UgbmVlZCB0byBiZSBidWlsZGluZyB0aGUgY29udGVudCBhcyB3ZSBzZWxlY3QuXG5cblx0XHQvLyBtb3ZlOiBJIGRvbid0IHRoaW5rIHdlIGNhbiByZW1vdmUgaW4gYnVsaz8gbWF5YmUganVzdCBkbyBpdCB3aXRob3V0IG1vdGlvbi5cblx0XHQvLyBiYWtlIHNob3VsZCBiZSBlYXN5XG5cdFx0Ly8gY29weSwgZWFzeVxuXHRcdC8vIG5ldyBub3RlXG5cdFx0Ly8gY29weSB0bzogZWFzeSwgYnV0IG5lZWQgdG8gYWRkIHRoZSBidWxsZXQgdG8gZWFjaFxuXHRcdC8vIGkgZ3Vlc3MgbGluayBpcyB0aGUgc2FtZSBlYXN5XG5cdH1cblxufVxuXG5jbGFzcyBUZW1wQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblx0ZG9Ob3RQb3N0UHJvY2VzcyA9IHRydWU7XG5cdG9ubG9hZCgpIHt9XG5cdG9udW5sb2FkKCkge31cbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blJlbmRlcmVyLCBNYXJrZG93blBvc3RQcm9jZXNzb3IsIGRlYm91bmNlLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFRhZ0J1ZGR5IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcblxuZXhwb3J0IGNsYXNzIFRhZ1Byb2Nlc3NvciB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblx0cHJpdmF0ZSBvdXRPZlN5bmM6IGJvb2xlYW4gPSBmYWxzZTtcblx0ZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHM6IEZ1bmN0aW9uO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5XG5cdCkge1xuXG5cdFx0dGhpcy5hcHAgPSBhcHA7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cblx0XHR0aGlzLmRlYm91bmNlZFByb2Nlc3NBY3RpdmVGaWxlVGFnRWxzID0gZGVib3VuY2UodGhpcy5wcm9jZXNzQWN0aXZlRmlsZVRhZ3MuYmluZCh0aGlzKSwgNTAwKVxuXG5cdFx0dGhpcy5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscygpO1xuXG5cdH1cblxuXHRyZXNldCgpIHtcbi8vY29uc29sZS5sb2coJ3RhZyBwcm9jZXNzb3IgcmVzZXQnKTtcblx0XHR0aGlzLm91dE9mU3luYyA9IGZhbHNlO1xuXHR9XG5cblx0ZmlsdGVyQWN0aXZlRmlsZVRhZ0VscyAoXG5cdFx0dGFnczogSFRNTEVsZW1lbnRbXVxuXHQpOiBBcnJheSB7XHRcdFxuLy9jb25zb2xlLmxvZyh0YWdzLmxlbmd0aClcblx0XHRjb25zdCBmaWx0ZXJlZFRhZ0VsZW1lbnRzID0gQXJyYXkuZnJvbSh0YWdzKS5maWx0ZXIodGFnID0+IHtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLmZyb250bWF0dGVyLXNlY3Rpb24tZGF0YVxuXHRcdCAgICAvLyBUaGlzIGlzIGEgYnVnIG9uIG1vYmlsZS4gTW9iaWxlIGluY2x1ZGVzIHRoZSB5YW1sIHRhZ3MgaW4gcmVuZGVyZWQgaHRtbFxuXHRcdCAgICBpZiAodGFnLmNsb3Nlc3QoJy5mcm9udG1hdHRlci1zZWN0aW9uLWRhdGEnKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAubWFya2Rvd24tZW1iZWRcblx0XHQgICAgaWYgKHRhZy5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC5tYXJrZG93bi1lbWJlZFxuXHRcdCAgICBpZiAodGFnLmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC5tYXJrZG93bi1lbWJlZFxuXHRcdCAgICAvL2lmICh0YWcucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuaW50ZXJuYWwtZW1iZWQnKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAubWFya2Rvd24tZW1iZWRcblx0XHQgICAgLy9pZiAodGFnLmNsb3Nlc3QoJy5pbnRlcm5hbC1lbWJlZCcpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC50YWctc3VtbWFyeS1ibG9ja1xuXHRcdCAgICBpZiAodGFnLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LWJsb2NrJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICByZXR1cm4gdHJ1ZTtcblx0XHR9KTtcblxuLy9jb25zb2xlLmxvZyhmaWx0ZXJlZFRhZ0VsZW1lbnRzLmxlbmd0aClcblx0XHRyZXR1cm4gZmlsdGVyZWRUYWdFbGVtZW50cztcblx0fVxuXG5cdGFzeW5jIHJlbmRlclBvc3RQcm9jZXNzb3IgKFxuXHRcdGVsOiBIVE1MRWxlbWVudCwgXG5cdFx0Y3R4OiBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0XG5cdCk6IHZvaWQge1x0XG5cdFx0Y29uc3QgcHJvY2Vzc2luZ0ZpbGU6IFRGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGN0eC5zb3VyY2VQYXRoKTtcblx0XHRjb25zdCBhY3RpdmVGaWxlOiBURmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZVBhdGg6IHN0cmluZyA9IGFjdGl2ZUZpbGU/LnBhdGg7XG5cdFx0XG5cdFx0Y29uc3QgbmF0aXZlRW1iZWRFbDogSFRNTEVsZW1lbnQgPSBlbC5xdWVyeVNlbGVjdG9yKCcuaW50ZXJuYWwtZW1iZWQnKTtcblx0XHRjb25zdCB0YWdzOiBIVE1MRWxlbWVudFtdID0gZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpO1xuXG5cdFx0aWYgKChuYXRpdmVFbWJlZEVsICYmIGN0eC5zb3VyY2VQYXRoID09IGFjdGl2ZUZpbGVQYXRoKSAvLyBlbWJlZHNcblx0XHRcdHx8IChjdHguc291cmNlUGF0aCA9PSBhY3RpdmVGaWxlUGF0aCAmJiB0YWdzLmxlbmd0aCA+IDApIC8vIGFjdGl2ZSBmaWxlIHRhZ3Ncblx0XHRcdHx8IGVsLmNsYXNzTGlzdC5jb250YWlucygndGFnLXN1bW1hcnktcGFyYWdyYXBoJykgLy8gc3VtbWFyeSB0YWdzXG5cdFx0KSB7XG5cdFx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiByZW5kZXJQb3N0UHJvY2Vzc29yJyk7IFxuXHRcdH1cblx0XHRlbHNlIHsgcmV0dXJuOyB9XG5cdFxuXHRcdGlmIChuYXRpdmVFbWJlZEVsKSB7XG5cdFx0XHQvL3RoaXMubmF0aXZlRW1iZWRzLnB1c2gobmF0aXZlRW1iZWRFbCk7XG5cdFx0XHRsZXQgbmF0aXZlRW1iZWRPYnNlcnZlcjogTXV0YXRpb25PYnNlcnZlcjtcblx0XHRcdG5hdGl2ZUVtYmVkT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigobXV0YXRpb25zTGlzdCkgPT4ge1x0XHRcdFxuXHRcdFx0XHRjb25zdCB0YXJnZXQ6IEhUTUxFbGVtZW50ID0gbXV0YXRpb25zTGlzdFswXS50YXJnZXQ7XG5cdFx0XHRcdGlmICh0YXJnZXQucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRuYXRpdmVFbWJlZE9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHRcdFx0XHR0aGlzLnByb2Nlc3NOYXRpdmVFbWJlZCh0YXJnZXQpO1xuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdG5hdGl2ZUVtYmVkT2JzZXJ2ZXIub2JzZXJ2ZShuYXRpdmVFbWJlZEVsLCB7IGNoaWxkTGlzdDogdHJ1ZSwgc3VidHJlZTogdHJ1ZSB9KTtcblx0XHR9XG5cdFxuXHRcdGlmIChlbC5jbGFzc0xpc3QuY29udGFpbnMoJ3RhZy1zdW1tYXJ5LXBhcmFncmFwaCcpKSB7XG5cdFx0XHR0aGlzLnByb2Nlc3NUYWdTdW1tYXJ5UGFyYWdyYXBoKGVsKTtcblx0XHRcdHJldHVybjsgXG5cdFx0fSBcblxuXHRcdHRoaXMuZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHMoKTtcdFxuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc0FjdGl2ZUZpbGVUYWdzIChcblx0XHQvL3RhZ3M6IEhUTUxFbGVtZW50W10sXG5cdCk6IHZvaWQge1x0XHRcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBwcm9jZXNzaW5nIGFjdGl2ZSBmaWxlIHRhZ3MnKVx0XHRcblxuXHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFx0Ly9jb25zdCBwcmVWaWV3ID0gYXdhaXQgdmlldy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubWFya2Rvd24tcmVhZGluZy12aWV3Jyk7XG5cdFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChhY3RpdmVGaWxlKTtcblx0XHRcdGNvbnN0IHNlY3Rpb25zID0gdmlldy5jdXJyZW50TW9kZS5yZW5kZXJlci5zZWN0aW9ucztcblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGVUYWdFbHMgPSBbXTtcblxuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZVRhZ3MgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhcblx0XHRcdFx0YWN0aXZlRmlsZSwgXG5cdFx0XHRcdGZpbGVDb250ZW50XG5cdFx0XHQpO1xuXG5cdFx0XHRzZWN0aW9ucy5mb3JFYWNoKHNlY3Rpb24gPT4ge1xuXHRcdFx0XHRBcnJheS5mcm9tKHNlY3Rpb24uZWwucXVlcnlTZWxlY3RvckFsbCgnLnRhZycpKS5mb3JFYWNoKHRhZyA9PiB7XG5cdFx0XHRcdFx0YWN0aXZlRmlsZVRhZ0Vscy5wdXNoKHRhZyk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEZpbHRlciB0YWdzIFxuXHRcdFx0Y29uc3QgZmlsdGVyZWRUYWdFbGVtZW50cyA9IHRoaXMuZmlsdGVyQWN0aXZlRmlsZVRhZ0VscyhhY3RpdmVGaWxlVGFnRWxzKTtcblx0XHRcdFxuXHRcdFx0aWYgKGZpbHRlcmVkVGFnRWxlbWVudHMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHR0aGlzLmFzc2lnbk1hcmtkb3duVGFncyhcblx0XHRcdFx0XHRhY3RpdmVGaWxlVGFncywgXG5cdFx0XHRcdFx0ZmlsdGVyZWRUYWdFbGVtZW50cywgIFxuXHRcdFx0XHRcdDAsIC8vc3RhcnRJbmRleCxcblx0XHRcdFx0XHQnYWN0aXZlJ1xuXHRcdFx0XHQpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGFzeW5jIHByb2Nlc3NUYWdTdW1tYXJ5UGFyYWdyYXBoIChcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsXG5cdCk6dm9pZCB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogcHJvY2Vzc1RhZ1N1bW1hcnlQYXJhZ3JhcGgnKVxuXG5cdFx0Y29uc3QgZmlsZVBhdGggPSBwYXJhZ3JhcGhFbC5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cdFx0Y29uc3QgbWFya2Rvd25CbG9jayA9IHBhcmFncmFwaEVsLmdldEF0dHJpYnV0ZSgnbWQtc291cmNlJykudHJpbSgpO1xuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRjb25zdCBzdGFydEluZGV4ID0gZmlsZUNvbnRlbnQuaW5kZXhPZihtYXJrZG93bkJsb2NrKTtcblx0XHRjb25zdCBtZFRhZ3MgPSB0aGlzLmdldE1hcmtkb3duVGFncyhcblx0XHRcdGZpbGUsIFxuXHRcdFx0ZmlsZUNvbnRlbnRcblx0XHQpO1xuXHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKFxuXHRcdFx0bWRUYWdzLCBcblx0XHRcdHBhcmFncmFwaEVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSwgXG5cdFx0XHRzdGFydEluZGV4LCBcblx0XHRcdCdwbHVnaW4tc3VtbWFyeSdcblx0XHQpO1xuXHR9XG5cblx0Ly8gYWRhcHQgdGhpcyBtZXRob2QgdG8gdXNlIHRoZSBjYWNoZSB0YWcgaW5mbyAobGluZSwgb2Zmc2V0LCBldGMpXG5cdGdldE1hcmtkb3duVGFncyAoXG5cdFx0ZmlsZTogVEZpbGUsIFxuXHRcdGZpbGVDb250ZW50OiBzdHJpbmdcblx0KTogQXJyYXkge1xuXG5cdFx0Y29uc3QgdGFnUG9zaXRpb25zID0gW107XG5cdFx0bGV0IG1hdGNoO1xuXHRcdC8vIE9ic2lkaWFuIHRhZyBzcGVjOiBodHRwczovL2hlbHAub2JzaWRpYW4ubWQvRWRpdGluZythbmQrZm9ybWF0dGluZy9UYWdzI1RhZytmb3JtYXRcblx0XHQvL2NvbnN0IHJlZ2V4ID0gLyg/Ol58XFxzKSNbXlxccyNdK3xgYGAvZzsgLy8gQlVHOiB3cm9uZyBtYXRjaC5pbmRleC4gbWF0Y2hlcyB0aGUgc3BhY2UgYmVmb3JlIHRoZSB0YWcuXG5cdFx0Ly9jb25zdCByZWdleCA9IC8oPzw9XnxcXHMpI1teXFxzI10rfGBgYC9nIC8vIEZJWC4gQnV0IHN0aWxsIG1hdGNoaW5nIHB1bmN0dWF0aW9uIGFmdGVyXG5cdFx0Ly9jb25zdCByZWdleCA9IC8oPzw9XnxcXHMpKCNbXlxccyMuLDshPzpdKykoPz1bLiw7IT86XFxzXXwkKXxgYGAvZyAgLy8gbWF0Y2hlcyBwdW5jdHVhdGlvbiBhZnRlciwgYnV0IG5vdCBpbmNsdWRlZCBpbiB0aGUgbWF0Y2hcblx0XHQvL2NvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykoI1teXFxzIy4sOyE/Ol0rKSg/PVsuLDshPzpcXHNdfCQpfCg/PCFgKWBgYCg/IWApL2c7IC8vIEZpeCBmb3IgbWF0Y2hpbmcgYGBgYCBcblx0XHQvL2NvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykoI1teXFxzIy4nLDshPzpdKykoPz1bLiw7IT86J1xcc118JCl8KD88IWApYGBgKD8hYCkvZzsgLy8gRml4IGZvciBtYXRjaGluZyBidXQgZXhjbHVkaW5nICcncycgaW4gJyN0YWcncydcblx0XHRjb25zdCByZWdleCA9IC8oPzw9XnxcXHMpKCMoPz1bXlxccyMuJ1x1MjAxOSw7IT86XSpbXlxcZFxccyMuJ1x1MjAxOSw7IT86XSlbXlxccyMuJ1x1MjAxOSw7IT86XSspKD89Wy4sOyE/OidcdTIwMTlcXHNdfCQpfCg/PCFgKWBgYCg/IWApL2c7IC8vIGZpeCBmb3IgbnVtYmVyLW9ubHkgYW5kIHR5cG9ncmFwaGljIGFwb3N0cm9waHknc1xuXG5cdFx0bGV0IGluc2lkZUNvZGVCbG9jayA9IGZhbHNlO1xuXG5cdFx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoZmlsZUNvbnRlbnQpKSAhPT0gbnVsbCkge1xuXHRcdCAgICBpZiAobWF0Y2hbMF0udHJpbSgpID09PSBcImBgYFwiKSB7XG5cdFx0ICAgICAgICBpbnNpZGVDb2RlQmxvY2sgPSAhaW5zaWRlQ29kZUJsb2NrOyBcblx0XHQgICAgICAgIGNvbnRpbnVlOyAvLyBSZWplY3QgaWYgdGFnIGluIGEgY29kZSBibG9ja1xuXHRcdCAgICB9XHQgICAgXG5cdFx0ICAgIGlmIChpbnNpZGVDb2RlQmxvY2spIGNvbnRpbnVlO1xuXHRcdCAgICBjb25zdCB0YWcgPSBtYXRjaFswXS50cmltKCk7XG5cdFx0ICAgIHRhZ1Bvc2l0aW9ucy5wdXNoKHt0YWc6dGFnLCBpbmRleDptYXRjaC5pbmRleCwgc291cmNlOmZpbGUubmFtZX0pOyBcbi8vY29uc29sZS5sb2codGFnKVxuXHRcdH1cblx0XHRyZXR1cm4gdGFnUG9zaXRpb25zO1xuXHR9XG5cblx0YXN5bmMgYXNzaWduTWFya2Rvd25UYWdzIChcblx0XHR0YWdQb3NpdGlvbnM6QXJyYXksIFxuXHRcdHRhZ0VsZW1lbnRzOiBIVE1MRWxlbWVudFtdLFxuXHRcdHN0YXJ0SW5kZXg6IG51bWJlciwgXG5cdFx0dHlwZTogc3RyaW5nXG5cdCk6IEhUTUxFbGVtZW50W10ge1xuXHRcdGlmICh0eXBlID09ICdhY3RpdmUnKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKHN0YXJ0SW5kZXgpO1xuXHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkge1xuXHRcdFx0XHRjb25zdCBhY3RpdmVGaWxlUGF0aCA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkucGF0aDtcblx0XHRcdFx0Y29uc29sZS5sb2codGFnUG9zaXRpb25zLmxlbmd0aCwgdGFnRWxlbWVudHMubGVuZ3RoKSBcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyh0YWdQb3NpdGlvbnMsIHRhZ0VsZW1lbnRzLCB0aGlzLnRhZ0ZpbGVNYW5hZ2VyLmdldFRhZ3MoYWN0aXZlRmlsZVBhdGgpKSBcblx0XHRcdFx0Y29uc3QgdGVtcDEgPSBbXTtcblx0XHRcdFx0dGFnUG9zaXRpb25zLmZvckVhY2gobm9kZU9iaiA9PiB7IHRlbXAxLnB1c2gobm9kZU9iai50YWcpIH0pO1xuXHRcdFx0XHRjb25zdCB0ZW1wMiA9IFtdO1xuXHRcdFx0XHR0YWdFbGVtZW50cy5mb3JFYWNoKG5vZGVPYmogPT4geyB0ZW1wMi5wdXNoKG5vZGVPYmouaW5uZXJUZXh0KSB9KTtcblx0XHRcdFx0Y29uc29sZS5sb2codGVtcDEsIHRlbXAyKVxuXHRcdFx0XHQvL2lmICh0YWdQb3NpdGlvbnMubGVuZ3RoICE9IHRhZ0VsZW1lbnRzLmxlbmd0aCB8fCB0YWdQb3NpdGlvbnMubGVuZ3RoICE9IHRoaXMudGFnRmlsZU1hbmFnZXIuZ2V0VGFncyhhY3RpdmVGaWxlUGF0aCkubGVuZ3RoKSB7XHRcdFx0XG5cdFx0XHR9XG5cblx0XHRcdGlmICh0YWdQb3NpdGlvbnMubGVuZ3RoICE9IHRhZ0VsZW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0XHR0aGlzLm91dE9mU3luYyA9IHRydWU7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ01hcmtkb3duIHNvdXJjZSBhbmQgcHJldmlldyB0YWdzIG91dCBvZiBzeW5jLiBQbGVhc2UgY2xvc2UgYW5kIHJlbG9hZCB0aGlzIG5vdGUuJyk7XG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIHRoaXMubG9nRGlmZmVyZW5jZXModGFnUG9zaXRpb25zLCB0YWdFbGVtZW50cylcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGxldCB0YWdFbDtcblx0XHRjb25zdCB0YWdFbEFycmF5ID0gQXJyYXkuZnJvbSh0YWdFbGVtZW50cyk7IFxuXHRcdGxldCB0YWdFbEluZGV4ID0gMDtcblx0XHRsZXQgdGFnUG9zO1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgdGFnUG9zaXRpb25zLmxlbmd0aDsgaSsrKSB7XG5cdFx0Ly90YWdQb3NpdGlvbnMuZm9yRWFjaCgodGFnUG9zLCBpKSA9PiB7XG5cdFx0XHR0YWdQb3MgPSB0YWdQb3NpdGlvbnNbaV07XG4vL2NvbnNvbGUubG9nKHRhZ0VsQXJyYXlbdGFnRWxJbmRleF0pXG5cdFx0XHRpZiAodGFnUG9zLmluZGV4ID49IHN0YXJ0SW5kZXgpIHtcblx0XHRcdFx0dGFnRWwgPSB0YWdFbEFycmF5W3RhZ0VsSW5kZXhdIGFzIEhUTUxFbGVtZW50O1xuXHRcdFx0XHRpZiAodGFnRWwpIHtcbi8vY29uc29sZS5sb2codGFnRWwsIHRhZ1Bvc2l0aW9uc1tpXS50YWcsIHRhZ1Bvc2l0aW9uc1tpXS5pbmRleCk7XG5cdFx0XHRcdFx0aWYgKHRhZ0VsLmlubmVyVGV4dC50cmltKCkgPT0gdGFnUG9zLnRhZy50cmltKCkpIHtcblx0XHQgICAgXHRcdFx0dGFnRWwuc2V0QXR0cmlidXRlKCdtZC1pbmRleCcsIHRhZ1Bvcy5pbmRleCk7XG5cdFx0ICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnLCB0YWdQb3Muc291cmNlKTtcblx0XHQgICAgXHRcdFx0dGFnRWwuc2V0QXR0cmlidXRlKCd0eXBlJywgdHlwZSk7XG5cdFx0ICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgncG9zJywgaSk7XG5cdFx0ICAgIFx0XHQgICAgdGFnRWxJbmRleCsrO1xuXHRcdCAgICBcdFx0fSBlbHNlIHtcblx0XHQgICAgXHRcdFx0dGhpcy5vdXRPZlN5bmMgPSB0cnVlO1xuXHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnTWFya2Rvd24gc291cmNlIGFuZCBwcmV2aWV3IHRhZ3Mgb3V0IG9mIHN5bmMuIFBsZWFzZSBjbG9zZSBhbmQgcmVsb2FkIHRoaXMgbm90ZS4nKTtcblx0XHRcdFx0XHRcdHRoaXMubG9nRGlmZmVyZW5jZXModGFnUG9zaXRpb25zLCB0YWdFbGVtZW50cylcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHQgICAgXHRcdH1cbiAgICBcdFx0XHR9XG4gICAgXHRcdH0gXG5cdFx0fTtcblx0XHRcblx0XHRyZXR1cm4gdGFnRWxBcnJheTsgXG5cdH1cblxuXHRhc3luYyBwcm9jZXNzTmF0aXZlRW1iZWQgKFxuXHRcdC8vdGFnczogSFRNTEVsZW1lbnRbXSBcblx0XHRlbWJlZDogSFRNTEVsZW1lbnQsXG5cdFx0Y2hlY2tEdXBsaWNhdGVzOiBib29sZWFuID0gZmFsc2Vcblx0KTp2b2lkIHtcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBwcm9jZXNzTmF0aXZlRW1iZWQnKVxuXHRcdGVtYmVkID0gZW1iZWQuY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJyk7XG4gXHRcdGlmIChlbWJlZC5nZXRBdHRyaWJ1dGUoJ3NyYycpKSB7XG5cdFx0XHRjb25zdCBsaW5rRWxlbWVudCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cdFx0XHRsZXQgZmlsZVBhdGggPSBlbWJlZC5nZXRBdHRyaWJ1dGUoJ3NyYycpO1xuXHRcdFx0Y29uc3QgbGlua0FycmF5ID0gZmlsZVBhdGguc3BsaXQoJyMnKTtcblx0XHRcdGNvbnN0IGhhc0FuY2hvckxpbmsgPSBsaW5rQXJyYXkubGVuZ3RoID4gMTtcblx0XHRcdGxldCBhbmNob3JMaW5rVHlwZSA9ICcnO1xuXHRcdFx0bGV0IGFuY2hvckxpbms7XG5cdFx0XHRpZiAoaGFzQW5jaG9yTGluaykge1xuXHRcdFx0XHRhbmNob3JMaW5rID0gbGlua0FycmF5WzFdO1xuXHRcdFx0XHRhbmNob3JMaW5rVHlwZSA9IGFuY2hvckxpbmsuc3RhcnRzV2l0aCgnXicpID8gJ2Jsb2NrJyA6ICdoZWFkZXInO1xuXHRcdFx0fVxuXHRcdFx0ZmlsZVBhdGggPSBsaW5rQXJyYXlbMF0udHJpbSgpICsgJy5tZCc7XG5cdFx0XHRjb25zdCBmaWxlID0gYXdhaXQgVXRpbHMudmFsaWRhdGVGaWxlUGF0aChmaWxlUGF0aClcdFx0XHRcblx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAoaGFzQW5jaG9yTGluayAmJiBhbmNob3JMaW5rVHlwZSAhPSAnJykge1xuXHRcdFx0XHRcdGlmIChcblx0XHRcdFx0XHRcdGFuY2hvckxpbmtUeXBlID09ICdoZWFkZXInIFxuXHRcdFx0XHRcdFx0JiYgIVV0aWxzLmZpbGVDb250YWluc0hlYWRpbmcoZmlsZUNvbnRlbnQsIGFuY2hvckxpbmspXG5cdFx0XHRcdFx0KSB7XG5cdFx0XHRcdFx0XHRlbWJlZC5zZXRBdHRyaWJ1dGUoJ2VtYmVkLXN1Y2Nlc3MnLCAnZmFsc2UnKTtcblx0XHRcdFx0XHRcdHJldHVybjsgLy8gUmVqZWN0IGlmIHRoaXMgaXMgYSBuYXRpdmUgXCJjYW4ndCBmaW5kICNzZWN0aW9uXCIgZXJyb3Jcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0ZW1iZWQuc2V0QXR0cmlidXRlKCdlbWJlZC1zdWNjZXNzJywgJ3RydWUnKTtcdFxuXHRcdFx0XHRcdH0gXG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCB0ZW1wQ29tcG9uZW50ID0gbmV3IFRlbXBDb21wb25lbnQoKTtcblx0XHRcdFx0Y29uc3QgdGVtcENvbnRhaW5lckhUTUwgPSBjcmVhdGVFbChcImRpdlwiKTtcblx0XHRcdFx0XG5cdFx0XHRcdGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXG5cdFx0XHRcdFx0ZmlsZUNvbnRlbnQsIFxuXHRcdFx0XHRcdHRlbXBDb250YWluZXJIVE1MLCBcblx0XHRcdFx0XHQnbm9GaWxlJywgLy9maWxlLnBhdGgsIFxuXHRcdFx0XHRcdHRlbXBDb21wb25lbnRcblx0XHRcdFx0KTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnN0IGlubmVyVGV4dCA9IGF3YWl0IGVtYmVkLnF1ZXJ5U2VsZWN0b3IoJy5tYXJrZG93bi1lbWJlZC1jb250ZW50JykuaW5uZXJUZXh0O1xuXHRcdFx0XHRjb25zdCBzdGFydEluZGV4ID0gdGVtcENvbnRhaW5lckhUTUwuaW5uZXJUZXh0LmluZGV4T2YoaW5uZXJUZXh0KTtcblx0XHRcdFx0XG5cdFx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKFxuXHRcdFx0XHRcdGVtYmVkZWRUYWdGaWxlLCBcblx0XHRcdFx0XHRlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIFxuXHRcdFx0XHRcdHN0YXJ0SW5kZXgsIFxuXHRcdFx0XHRcdCduYXRpdmUtZW1iZWQnXG5cdFx0XHRcdCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0bG9nRGlmZmVyZW5jZXModGFnUG9zaXRpb25zLCB0YWdFbGVtZW50cykge1xuXHRcdC8vIEV4dHJhY3QgdGFncyBhbmQgaW5uZXJUZXh0cyBpbnRvIHNlcGFyYXRlIGFycmF5c1xuXHRcdGNvbnN0IHRhZ3MgPSB0YWdQb3NpdGlvbnMubWFwKGl0ZW0gPT4gaXRlbS50YWcpO1xuXHRcdGNvbnN0IGlubmVyVGV4dHMxID0gdGFnRWxlbWVudHMubWFwKGl0ZW0gPT4gaXRlbS5pbm5lclRleHQpO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSBhcnJheXMgdG8gc3RvcmUgdW5pcXVlIGVsZW1lbnRzXG5cdFx0bGV0IHVuaXF1ZVRvVGFnUG9zaXRpb25zID0gW107XG5cdFx0bGV0IHVuaXF1ZVRvVGFnRWxlbWVudHMgPSBbXTtcblxuXHRcdC8vIEhlbHBlciBmdW5jdGlvbiB0byBmaW5kIHVuaXF1ZSBlbGVtZW50cyBpbiBvbmUgYXJyYXkgY29tcGFyZWQgdG8gb3RoZXJzXG5cdFx0Y29uc3QgZmluZFVuaXF1ZSA9IChhcnIxLCBhcnIyKSA9PiB7XG5cdFx0XHRyZXR1cm4gYXJyMS5maWx0ZXIoaXRlbSA9PiAhYXJyMi5pbmNsdWRlcyhpdGVtKSk7XG5cdFx0fTtcblxuXHRcdHVuaXF1ZVRvVGFnUG9zaXRpb25zID0gZmluZFVuaXF1ZSh0YWdzLCBpbm5lclRleHRzMSk7XG5cdFx0dW5pcXVlVG9UYWdFbGVtZW50cyA9IGZpbmRVbmlxdWUoaW5uZXJUZXh0czEsIHRhZ3MpO1xuXG5cdFx0Y29uc29sZS5sb2coJ2RpZmZlcmVuY2VzOicsIHVuaXF1ZVRvVGFnUG9zaXRpb25zLmxlbmd0aCwgdW5pcXVlVG9UYWdFbGVtZW50cy5sZW5ndGgpO1xuXHRcdC8vIExvZyB0aGUgZGlmZmVyZW5jZXNcblx0XHRpZiAodW5pcXVlVG9UYWdQb3NpdGlvbnMubGVuZ3RoKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlVuaXF1ZSB0byB0YWdQb3NpdGlvbnMgYmFzZWQgb24gdGFnOlwiLCB1bmlxdWVUb1RhZ1Bvc2l0aW9ucyk7XG5cdFx0fVxuXHRcdGlmICh1bmlxdWVUb1RhZ0VsZW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0Y29uc29sZS5sb2coXCJVbmlxdWUgdG8gdGFnRWxlbWVudHMgYmFzZWQgb24gaW5uZXJUZXh0OlwiLCB1bmlxdWVUb1RhZ0VsZW1lbnRzKTtcblx0XHR9XG5cdH1cblxufVxuXG5jbGFzcyBUZW1wQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblx0b25sb2FkKCkge31cblx0b251bmxvYWQoKSB7fVxufSIsICJpbXBvcnQgeyBBcHAsIE1hcmtkb3duUmVuZGVyZXIsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRhZ1N1bW1hcnkgfSBmcm9tICcuL1RhZ1N1bW1hcnknO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIFJlYWRpbmdNb2RlVGFnRWRpdG9yIHtcblx0YXBwOiBBcHA7IFxuXHRwbHVnaW46IFRhZ0J1ZGR5O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGFzeW5jIHJlbmFtZVRhZyAodGFnLCBuZXdOYW1lLCB2YXVsdFRvZ2dsZTogQm9vbGVhbiA9IGZhbHNlKSB7XG5cdFx0Ly9jb25zb2xlLmxvZyAoJ1JlYWRpbmdNb2RlVGFnRWRpdG9yOiByZW5hbWUnKVxuXG4gICAgICAgIGlmICh2YXVsdFRvZ2dsZSkge1xuICAgICAgICBcdC8vY29uc29sZS5sb2coJyEhISEhIXJlbmFtaW5nIGFjcm9zcyB2YXVsdCcpXG5cbiAgICAgICAgXHRjb25zdCB2YWxpZFRhZ3MgPSBbdGFnXVxuXHRcdFx0bGV0IGxpc3RGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuXHRcdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLmZpbHRlcigoZmlsZSkgPT4ge1xuXHRcdFx0XHQvLyBSZW1vdmUgZmlsZXMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgdGFncyBzZWxlY3RlZCBieSB0aGUgdXNlclxuXHRcdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0XHRjb25zdCB0YWdzSW5GaWxlID0gZ2V0QWxsVGFncyhjYWNoZSk7XG5cblx0XHRcdFx0aWYgKHZhbGlkVGFncy5zb21lKCh2YWx1ZSkgPT4gdGFnc0luRmlsZT8uaW5jbHVkZXModmFsdWUpKSkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGxldCBsaXN0Q29udGVudHM6IFtURmlsZSwgc3RyaW5nXVtdID0gYXdhaXQgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5yZWFkRmlsZXMobGlzdEZpbGVzKTtcblx0ICAgICAgICAvLyBsaXN0Q29udGVudHNbbl1bMF0gaXMgdGhlIGZpbGUsIGxpc3RDb250ZW50c1tuXVtbMV0gaXMgdGhlIGZpbGUgY29udGVudFxuXHQgICAgICAgIFxuXHQgICAgICAgIGxpc3RDb250ZW50cy5mb3JFYWNoKChub3RlKSA9PiB7XG5cdCAgICAgICAgXHQvL3RoaXMucmVuYW1lVGFnSW5GaWxlICh0YWcsIG5ld05hbWUsIG5vdGVbMF0pO1xuXHQgICAgICAgIFx0dGhpcy5yZW5hbWVUYWdJbkZpbGVCeUluZGV4IChcblx0ICAgICAgICBcdFx0dGFnLFxuXHQgICAgICAgIFx0XHRuZXdOYW1lLFxuXHQgICAgICAgIFx0XHRub3RlWzBdXG4gICAgXHRcdFx0KVxuXG5cdCAgICAgICAgfSk7XG4gXG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgXHRjb25zdCBmaWxlOiBURmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG4gICAgICAgIFx0dGhpcy5yZW5hbWVUYWdJbkZpbGVCeUluZGV4IChcbiAgICAgICAgXHRcdHRhZyxcbiAgICAgICAgXHRcdG5ld05hbWUsXG4gICAgICAgIFx0XHRmaWxlXG4gICAgXHRcdClcbiAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGFzeW5jIHJlbmFtZVRhZ0luRmlsZUJ5SW5kZXggKFxuICAgIFx0dGFnOiBTdHJpbmcsIFxuICAgIFx0bmV3TmFtZTogU3RyaW5nLCBcbiAgICBcdGZpbGU6IFRGaWxlXG5cdCk6Vm9pZCB7XG5cbiAgICBcdGNvbnN0IGZpbGVDb250ZW50OiBTdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBsZXQgbmV3RmlsZUNvbnRlbnQ6IFN0cmluZyA9IGZpbGVDb250ZW50O1xuICAgIFx0Y29uc3QgdGFnUG9zaXRpb25zID0gdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLmdldE1hcmtkb3duVGFncyAoZmlsZSwgZmlsZUNvbnRlbnQpO1xuICAgIFx0Ly8ge3RhZzp0YWcsIGluZGV4Om1hdGNoLmluZGV4LCBzb3VyY2U6ZmlsZS5uYW1lfVxuXG4gICAgXHRsZXQgZmlsdGVyZWRUYWdPYmpzID0gdGFnUG9zaXRpb25zLmZpbHRlcih0YWdPYmogPT4gdGFnT2JqLnRhZyA9PT0gdGFnKTtcblxuICAgIFx0aWYgKGZpbHRlcmVkVGFnT2Jqcy5sZW5ndGggPiAwKSB7XG5cbiAgICBcdFx0ZmlsdGVyZWRUYWdPYmpzLnNvcnQoKGEsIGIpID0+IGEuaW5kZXggLSBiLmluZGV4KTtcbiAgICBcdFx0bGV0IG9mZnNldCA9IDA7XG5cdFx0ICAgIGZpbHRlcmVkVGFnT2Jqcy5mb3JFYWNoKHRhZ09iaiA9PiB7XG5cdFx0ICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIG5ldyBpbmRleCBjb25zaWRlcmluZyB0aGUgb2Zmc2V0XG5cdFx0ICAgICAgICBjb25zdCBuZXdJbmRleCA9IHRhZ09iai5pbmRleCArIG9mZnNldDtcblx0XHQgICAgICAgIC8vIFJlcGxhY2UgdGhlIHRhZyBhdCB0aGUgY29ycmVjdCBwb3NpdGlvblxuXHRcdCAgICAgICAgbmV3RmlsZUNvbnRlbnQgPSBuZXdGaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgbmV3SW5kZXgpICsgbmV3TmFtZSArIG5ld0ZpbGVDb250ZW50LnN1YnN0cmluZyhuZXdJbmRleCArIHRhZ09iai50YWcubGVuZ3RoKTtcblx0XHQgICAgICAgIC8vIFVwZGF0ZSB0aGUgb2Zmc2V0IGZvciB0aGUgbmV4dCBpdGVyYXRpb25cblx0XHQgICAgICAgIG9mZnNldCArPSBuZXdOYW1lLmxlbmd0aCAtIHRhZ09iai50YWcubGVuZ3RoO1xuXHRcdCAgICB9KTtcblxuICAgIFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG4gICAgXHR9IGVsc2Uge1xuICAgIFx0XHRuZXcgTm90aWNlICgnTm8gdGFncyB0byByZW5hbWUuJylcbiAgICBcdH1cbiAgICB9XG5cbiAgIC8qIGFzeW5jIHJlbmFtZVRhZ0luRmlsZSAodGFnLCBuZXdOYW1lLCBmaWxlOlRGaWxlKSB7XG5cbmNvbnNvbGUubG9nKCh0YWcpLCBuZXdOYW1lLCBmaWxlLm5hbWUpXG5cbiAgICAgICAgLy8gdGhpcyB3aWxsIGJlIHVzZWQgZm9yIHJlbW92ZSBoYXNoLCByZW5hbWUsIGFuZCBsb3dlcmNhc2VcbiAgICAgICAgbGV0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgZmlsZUNvbnRlbnQgPSBmaWxlQ29udGVudC50cmltKCk7XG4gICAgICAgIGNvbnN0IG5ld0ZpbGVDb250ZW50ID0gVXRpbHMucmVwbGFjZVRleHRJblN0cmluZyhcbiAgICAgICAgICAgIHRhZy50cmltKCksXG4gICAgICAgICAgICBmaWxlQ29udGVudCwgXG4gICAgICAgICAgICBuZXdOYW1lLFxuICAgICAgICAgICAgdHJ1ZSkudHJpbSgpO1xuICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuICAgIH0qL1xuXG5cdGFzeW5jIGFkZCAoXG5cdFx0dGFnOiBzdHJpbmcsIFxuXHRcdHg6IG51bWJlciwgXG5cdFx0eTogbnVtYmVyLy8sXG5cdFx0Ly9tb2JpbGVPYmo6IE9iamVjdFxuXHQpOnZvaWQge1xuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIHsgY29uc29sZS5sb2coJ1RhZyBCdWRkeSBhZGQgJyArIHRhZyArICcgYXQgKCcgKyB4ICsgJywgJyArIHkgKyAnKScpOyB9XG5cblx0XHRsZXQgZmlsZUNvbnRlbnQ6IHN0cmluZztcblx0XHRsZXQgZmlsZTogVEZpbGU7XG5cdFx0Y29uc3QgY2xpY2tlZFRleHRPYmogPSBVdGlscy5nZXRDbGlja2VkVGV4dE9iakZyb21Eb2MoeCwgeSk7XG5cdFx0Y29uc3QgY2xpY2tlZFRleHQ6IHN0cmluZyA9IGNsaWNrZWRUZXh0T2JqPy50ZXh0O1xuXHRcdGNvbnN0IGNsaWNrZWRUZXh0SW5kZXg6bnVtYmVyID0gY2xpY2tlZFRleHRPYmo/LmluZGV4OyAvLyB0aGlzIGlzIHRoZSBpbmRleCBpbiBkb2N1bWVudCwgZm9yIG5hcnJvd2luZyBkb3duIHRvIHRoZSBjbGlja2VkIHdvcmQuXG5cdFx0Y29uc3QgY2xpY2tlZFRleHRFbDogSFRNTEVsZW1lbnQgPSBjbGlja2VkVGV4dE9iaj8uZWw7XG5cdFx0bGV0IGNvbnRlbnRTb3VyY2VUeXBlOiBzdHJpbmcgPSBudWxsXG5cdFx0bGV0IHN1bW1hcnlFbDogSFRNTEVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cdFx0bGV0IGVtYmVkRWw6IEhUTUxFbGVtZW50ID0gdW5kZWZpbmVkO1xuXG4vL2NvbnNvbGUubG9nKGNsaWNrZWRUZXh0T2JqKVx0XHRcblx0XHRpZiAoY2xpY2tlZFRleHRPYmopIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHN1bW1hcnlFbCA9IGNsaWNrZWRUZXh0RWw/LmNsb3Nlc3QoJy50YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblx0XHRcdFx0ZW1iZWRFbCA9IGNsaWNrZWRUZXh0RWw/LmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpO1xuXHRcdFx0fSBjYXRjaCB7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzdW1tYXJ5RWwpIHtcbi8vY29uc29sZS5sb2coJ2lzIHN1bW1hcnknKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5nZXRGaWxlKHN1bW1hcnlFbCk7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29udGVudFNvdXJjZVR5cGUgPSAncGx1Z2luLXN1bW1hcnknO1xuXHRcdFx0XHRcblx0XHRcdH0gZWxzZSBpZiAoZW1iZWRFbCkge1xuLy9jb25zb2xlLmxvZygnaXMgZW1iZWQnKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgVXRpbHMuZ2V0RW1iZWRGaWxlKGVtYmVkRWwpO1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGNvbnRlbnRTb3VyY2VUeXBlID0gJ25hdGl2ZS1lbWJlZCc7XG5cblx0XHRcdH0gZWxzZSB7IFxuLy9jb25zb2xlLmxvZygnaXMgYWN0aXZlIGZpbGUnKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRjb250ZW50U291cmNlVHlwZSA9ICdhY3RpdmUnO1xuXHRcdFx0fSBcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCB0ZXh0IHBvc2l0aW9uIG9yIGFyZWEgdG9vIGJ1c3kuXFxuVHJ5IGEgYW5vdGhlciB0ZXh0IGFyZWEuJyk7XG5cdFx0ICAgIHJldHVybjtcblx0XHR9XG5cblxuXHRcdGlmIChjbGlja2VkVGV4dCkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoY2xpY2tlZFRleHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgYWRkIHRhZy5cXG5UcnkgYSBkaWZmZXJlbnQgdGV4dCBhcmVhLicpXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgZXNjYXBlZENsaWNrZWRUZXh0ID0gVXRpbHMuZXNjYXBlUmVnRXhwKGNsaWNrZWRUZXh0KTtcblx0XHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlZENsaWNrZWRUZXh0LCBcImdcIik7ICBcblx0XHRjb25zdCBtYXRjaGVzID0gZmlsZUNvbnRlbnQubWF0Y2gocmVnZXgpO1xuXG5cdFx0aWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPiAxKSB7XG5cdFx0ICAgIG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBhZGQgdGFnOiBDbGlja2VkIHRleHQgcmVwZWF0ZWQgaW4gbm90ZS4gVHJ5IGEgYW5vdGhlciB0ZXh0IGJsb2NrLicpO1xuXHRcdCAgICByZXR1cm47XG5cblx0XHR9IGVsc2UgaWYgKChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoID09PSAwKSB8fCAhbWF0Y2hlcykge1xuXHRcdFx0bmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IGZpbmQgdGV4dCBwb3NpdGlvbiBvciBhcmVhIHRvbyBidXN5LlxcblRyeSBhIGFub3RoZXIgdGV4dCBhcmVhLicpO1xuXHRcdCAgICByZXR1cm47XG5cdFx0fSBcblxuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MpIHRoaXMucGx1Z2luLnNhdmVSZWNlbnRUYWcodGFnKTsgXG5cdFx0XG5cdFx0Y29uc3Qgc3RhcnRJbmRleCA9IHJlZ2V4LmV4ZWMoZmlsZUNvbnRlbnQpLmluZGV4OyAvLyB0aGlzIGlzIHRoZSBpbmRleCBpbiB0aGUgbWQgc291cmNlXG5cdFx0Y29uc3QgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgY2xpY2tlZFRleHQubGVuZ3RoOyAvLyB1c2UgdGhpcyB0byBhZGQgdGFnIGF0IGVuZCBvZiBibG9ja1xuXG5cdFx0Y29uc3QgY2xpY2tlZFdvcmRPYmogPSBVdGlscy5nZXRXb3JkT2JqRnJvbVN0cmluZyAoY2xpY2tlZFRleHQsIGNsaWNrZWRUZXh0SW5kZXgpO1xuXHRcdGNvbnN0IGNsaWNrZWRXb3JkID0gY2xpY2tlZFdvcmRPYmoudGV4dDtcblx0XHRjb25zdCBjbGlja2VkV29yZEluZGV4ID0gY2xpY2tlZFdvcmRPYmouaW5kZXg7XG5cdFx0bGV0IG5ld0NvbnRlbnQ7XG5cblx0XHRpZiAoY2xpY2tlZFdvcmQpIHtcblx0XHRcdGlmIChVdGlscy5pc1dvcmROZWFyRW5kKGNsaWNrZWRUZXh0LCBjbGlja2VkV29yZCkpIFxuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMuaW5zZXJ0VGV4dEluU3RyaW5nKCcgJyArIHRhZywgZmlsZUNvbnRlbnQsIGVuZEluZGV4KTtcblx0XHRcdGVsc2Vcblx0XHRcdFx0bmV3Q29udGVudCA9IFV0aWxzLmluc2VydFRleHRJblN0cmluZyh0YWcsIGZpbGVDb250ZW50LCBzdGFydEluZGV4K2NsaWNrZWRXb3JkSW5kZXgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCBjbGlja2VkIHdvcmQuXFxuUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHQgICAgcmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG5cblx0XHRpZiAoY29udGVudFNvdXJjZVR5cGUgPT0gJ3BsdWdpbi1zdW1tYXJ5Jykge1xuXHRcdFx0Y29uc3Qgc3VtbWFyeUNvbnRhaW5lciA9IHN1bW1hcnlFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKVxuXHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUoc3VtbWFyeUNvbnRhaW5lcik7IFxuXHRcdH0gZWxzZSBpZiAoY29udGVudFNvdXJjZVR5cGUgPT0gJ25hdGl2ZS1lbWJlZCcpIHtcblx0XHRcdC8vY29uc29sZS5sb2coJ2FkZGVkIHRvIG5hdGl2ZSBlbWJlZDonLCBlbWJlZEVsKVxuXHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHR0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IucHJvY2Vzc05hdGl2ZUVtYmVkKGVtYmVkRWwsIHRydWUpO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBlZGl0IChcblx0XHR0YWdFbDogSFRNTEVsZW1lbnQsIFxuXHRcdGV2ZW50OiBFdmVudCwgXG5cdFx0cHJhZ3JhcGhFbDogSFRNTEVsZW1lbnRcblx0KTp2b2lkIHtcblxuXHRcdGxldCB0YWdDb250YWluZXI6IEhUTUxFbGVtZW50O1xuXHRcdGNvbnN0IHRhZ0NvbnRhaW5lclR5cGUgPSB0YWdFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQndHlwZSdcblx0XHQpO1xuXHRcdGNvbnN0IGluZGV4ID0gdGFnRWwuZ2V0QXR0cmlidXRlKFxuXHRcdFx0J21kLWluZGV4J1xuXHRcdCk7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSB0YWdFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnZmlsZS1zb3VyY2UnXG5cdFx0KTtcblxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgZWRpdCB0YWc6ICcgKyB0YWdFbC5pbm5lclRleHQgXG5cdFx0XHRcdCsgJ1xcbkluIGZpbGU6ICcgKyBmaWxlUGF0aCk7XG5cdFx0fVxuXG5cdFx0aWYgKHRhZ0NvbnRhaW5lclR5cGUgPT0gJ25hdGl2ZS1lbWJlZCcpIHRhZ0NvbnRhaW5lciA9IHRhZ0VsLmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpO1xuXHRcdGVsc2UgaWYgKHRhZ0NvbnRhaW5lclR5cGUgPT0gJ3BsdWdpbi1zdW1tYXJ5JykgdGFnQ29udGFpbmVyID0gdGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LXBhcmFncmFwaCcpO1xuXHRcdGVsc2UgdGFnQ29udGFpbmVyID0gdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLXJlYWRpbmctdmlldycpO1xuXHRcdFxuXHRcdGlmIChmaWxlUGF0aCkge1xuIFxuXHRcdFx0Y29uc3QgZmlsZTogVEZpbGUgPSBhd2FpdCBVdGlscy52YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKTtcblx0XHRcdGxldCBmaWxlQ29udGVudDogU3RyaW5nO1xuXHRcdFx0bGV0IGZpbGVDb250ZW50QmFja3VwOiBTdHJpbmc7XG5cdFx0XHRjb25zdCB0YWc6IHN0cmluZyA9IHRhZ0VsLmlubmVyVGV4dC50cmltKCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0ZmlsZUNvbnRlbnRCYWNrdXAgPSBmaWxlQ29udGVudDtcblxuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5IGZpbGUgcmVhZCBlcnJvcjpcXG4nICsgZXJyb3IubWVzc2FnZSk7XG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBjaGVjayBpZiB0aGUgZmlsZSBoYXMgb25seSBvbmUgdGFnIGxlZnQgKGFuZCB0aGF0J3MgYWxsIHRoYXRzIGxlZnQgaW4gdGhlIGZpbGUpXG5cdFx0XHRsZXQgc2FmZVRvRW1wdHlGaWxlID0gZmFsc2U7XG5cdFx0XHRjb25zdCB0YWdSZWdleCA9IC9eXFxzKiMoXFx3KylcXHMqJC87XG5cdFx0XHRpZiAodGFnUmVnZXgudGVzdChmaWxlQ29udGVudC50cmltKCkpKSB7XG5cdFx0ICAgIFx0c2FmZVRvRW1wdHlGaWxlID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IGJlZm9yZVRhZyA9IGZpbGVDb250ZW50LnN1YnN0cmluZygwLCBpbmRleCk7XG5cdFx0XHQvL2xldCBhZnRlclRhZyA9IGZpbGVDb250ZW50LnN1YnN0cmluZygoTnVtYmVyKGluZGV4KStOdW1iZXIodGFnLmxlbmd0aCkrMSkpO1xuXHRcdFx0bGV0IGFmdGVyVGFnID0gZmlsZUNvbnRlbnQuc3Vic3RyaW5nKFxuXHRcdFx0XHROdW1iZXIoaW5kZXgpICsgTnVtYmVyKHRhZy5sZW5ndGgpXG5cdFx0XHQpO1xuXG5cdFx0XHQvL2NvbnNvbGUubG9nIChKU09OLnN0cmluZ2lmeShiZWZvcmVUYWcpKTtcblx0XHRcdC8vY29uc29sZS5sb2cgKEpTT04uc3RyaW5naWZ5KHRhZykpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoSlNPTi5zdHJpbmdpZnkoYWZ0ZXJUYWcpKTtcblxuXHRcdFx0bGV0IGFmdGVyVGFnQ2hyID0gJyc7XG5cdFx0XHRcblx0XHRcdC8qaWYgKGFmdGVyVGFnLnN0YXJ0c1dpdGgoJyAnKSkge1xuXHRcdFx0XHRhZnRlclRhZ0NociA9ICcgJztcblx0XHRcdH0gZWxzZSBpZiAoYWZ0ZXJUYWcuc3RhcnRzV2l0aCgnXFxuJykpIHtcblx0XHRcdFx0YWZ0ZXJUYWdDaHIgPSAnXFxuJztcblx0XHRcdH0qL1xuXHRcdFx0XG5cdFx0XHQvLyBDYW4ndCByZW1lbWJlciB3aHkgSSBoYXZlIHRoaXMuLi5cblx0XHRcdC8vIG5lZWQgdG8gcmVmYWN0b3IgYWxsIHRoaXMgbGluZSBicmVhayBzcGFjZSBzdHVmZlxuXHRcdFx0aWYgKGZpbGVDb250ZW50W2luZGV4XSA9PT0gJ1xcbicpIGJlZm9yZVRhZyArPSAnXFxuJztcblx0XHRcdFxuXHRcdFx0bGV0IG5ld0NvbnRlbnQgPSAnJztcblxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcdFx0Ly8gVE8tRE86IFJFRkFDVE9SXG5cdFx0XHQvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cblx0XHRcdGlmICghZXZlbnQpIHsgLy8gdGhlbiB3ZSdyZSBjYWxsaW5nIHRoaXMgbWV0aG9kIGZyb20gYSBidXR0b24uIG5lZWQgdG8gcmV0aGluayBob3cgdGhpcyBpcyBvcmdhbml6ZWQuXG5cdFx0XHRcdFxuXHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgYWZ0ZXJUYWdDaHIgKyBhZnRlclRhZztcblxuXHRcdFx0fSBlbHNlIGlmIChldmVudC5hbHRLZXkgXG5cdFx0XHRcdFx0XHR8fCAoKGV2ZW50LnR5cGUgPT0gJ3RvdWNoc3RhcnQnKSBcblx0XHRcdFx0XHRcdFx0JiYgIXRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkpIFxuXHRcdFx0eyBcblx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBoYXNoIG9ubHlcblx0XHRcdFx0Y29uc3Qgbm9IYXNoID0gdGFnLnN1YnN0cmluZygxKTtcblx0XHRcdFx0Ly9uZXdDb250ZW50ID0gYmVmb3JlVGFnICsgKCFiZWZvcmVUYWcuZW5kc1dpdGgoJyAnKT8nICc6JycpICsgbm9IYXNoICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBub0hhc2ggKyBhZnRlclRhZ0NociArIGFmdGVyVGFnO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpIFxuXHRcdFx0XHRcdHsgbmV3IE5vdGljZSAoJ1RhZyBCdWRkeTogJyArIHRhZyArICcgY29udmVydGVkIHRvIHRleHQuJyk7IH1cblx0XHRcdFxuXHRcdFx0fSBlbHNlIGlmICgoKGV2ZW50LnR5cGUgPT0gJ3RvdWNoZW5kJykgXG5cdFx0XHRcdHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkgXG5cdFx0XHRcdFx0fHwgKFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKSBcblx0XHRcdFx0XHR8fCAoIVV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG5cdFx0XHRcdCkgXG5cdFx0XHR7XG5cblx0XHRcdFx0Ly8gUmVtb3ZlIHRhZyAob3IgY2hpbGQgZmlyc3QsIGlmIGV4aXN0cylcblx0XHRcdFx0bGV0IHBhcmVudFRhZyA9ICcnO1xuXG5cdFx0XHRcdGlmICh0YWcuaW5jbHVkZXMoJy8nKSBcblx0XHRcdFx0XHQmJiAodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QgXG5cdFx0XHRcdFx0XHR8fCAoZXZlbnQuc2hpZnRLZXkgXG5cdFx0XHRcdFx0XHRcdCYmICF0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdClcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpIFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bGV0IHBhcnRzID0gdGFnLnNwbGl0KCcvJyk7XG5cdFx0XHRcdFx0Y29uc3QgcmVtb3ZlZENoaWxkID0gcGFydHMucG9wKCk7XG5cdFx0XHRcdFx0cGFyZW50VGFnID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgXG5cdFx0XHRcdFx0XHQrIHBhcmVudFRhZyBcblx0XHRcdFx0XHRcdCsgYWZ0ZXJUYWdDaHIgXG5cdFx0XHRcdFx0XHQrIGFmdGVyVGFnO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlIFxuXHRcdFx0XHRcdFx0JiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcykgXG5cdFx0XHRcdFx0eyBcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IFxcJycgXG5cdFx0XHRcdFx0XHRcdCsgcmVtb3ZlZENoaWxkIFxuXHRcdFx0XHRcdFx0XHQrICdcXCcgcmVtb3ZlZCBmcm9tIHBhcmVudCB0YWcuJyk7IFxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArIGFmdGVyVGFnO1xuXHRcdFx0XHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSBcblx0XHRcdFx0XHRcdCYmIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpIHsgXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiAnICsgdGFnICsgJyByZW1vdmVkLicpOyBcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0gXG5cdFx0XHRcblx0XHRcdFx0aWYgKHRhZ0VsLmdldEF0dHJpYnV0ZSgndHlwZScpID09ICdwbHVnaW4tc3VtbWFyeScpIHtcblxuXHRcdFx0XHRcdC8vIFNhZmV0eSBjaGVjayAxXG5cdFx0XHRcdFx0Y29uc3Qgc3VtbWFyeUVsID0gdGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LXBhcmFncmFwaCcpO1xuXHRcdFx0XHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZSgnbWQtc291cmNlJykudHJpbSgpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IGVzY2FwZWRUZXh0ID0gVXRpbHMuZXNjYXBlUmVnRXhwKG1kU291cmNlKTtcblx0XHRcdFx0XHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlZFRleHQsICdnJyk7XG5cdFx0XHRcdFx0Y29uc3QgbWF0Y2hlcyA9IGZpbGVDb250ZW50Lm1hdGNoKHJlZ2V4KTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0XHQgICAgbmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IHNhZmVseSByZW1vdmUvZWRpdCB0YWc6XFxuU3Vycm91bmRpbmcgdGV4dCByZXBlYXRlZCBpbiBzb3VyY2Ugbm90ZS4nKTtcblx0XHRcdFx0XHQgICAgcmV0dXJuO1xuXG5cdFx0XHRcdFx0fSBlbHNlIGlmICgobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA9PT0gMCkgfHwgIW1hdGNoZXMpIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBmaW5kIHRhZyBpbiBzb3VyY2Ugbm90ZS5cXG4nKTtcblx0XHRcdFx0XHQgICAgcmV0dXJuO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIFNhZmV0eSBjaGVjayAyXG5cdFx0XHRcdFx0aWYgKChuZXdDb250ZW50ID09ICcnICYmICFzYWZlVG9FbXB0eUZpbGUpIFxuXHRcdFx0XHRcdFx0fHwgVXRpbHMuY29udGVudENoYW5nZWRUb29NdWNoKFxuXHRcdFx0XHRcdFx0XHRmaWxlQ29udGVudEJhY2t1cCwgXG5cdFx0XHRcdFx0XHRcdG5ld0NvbnRlbnQsIFxuXHRcdFx0XHRcdFx0XHR0YWcsIFxuXHRcdFx0XHRcdFx0XHQyKVxuXHRcdFx0XHRcdFx0KSBcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IEZpbGUgY2hhbmdlIGVycm9yLicpO1xuXHRcdFx0XHRcdFx0bmV3Q29udGVudCA9IGZpbGVDb250ZW50QmFja3VwO1xuXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChuZXdDb250ZW50ID09ICcnICYmIHNhZmVUb0VtcHR5RmlsZSkge1xuXHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBUYWcgcmVtb3ZlZC4gVGhlIG5vdGUgaXMgZW1wdHkuJyk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGNvbnN0IHRhZ1BhcmFncmFwaEVsID0gdGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LXBhcmFncmFwaCcpO1xuXHRcdFx0XHRcdFx0Y29uc3QgdGFnU3VtbWFyeUJsb2NrID0gdGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LWJsb2NrJyk7XG5cdFx0XHRcdFx0XHRjb25zdCB0YWdzVG9DaGVjayA9IFRhZ1N1bW1hcnkuZ2V0VGFnc1RvQ2hlY2tGcm9tRWwodGFnU3VtbWFyeUJsb2NrKTtcblx0XHRcdFx0XHRcdGNvbnN0IHRhZ3NJbkNvbnRlbnQgPSBVdGlscy50YWdzSW5TdHJpbmcodGFnUGFyYWdyYXBoRWwuaW5uZXJUZXh0KTtcblxuXHRcdFx0XHRcdFx0aWYgKHRhZ3NUb0NoZWNrLmluY2x1ZGVzKHRhZykpIHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGFnQ291bnQgPSBVdGlscy5jb3VudE9jY3VycmVuY2VzKHRhZ3NUb0NoZWNrLCB0YWdzSW5Db250ZW50KVxuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0aWYgKHRhZ0NvdW50ID49IDIpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZSh0YWdTdW1tYXJ5QmxvY2spOyBcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCdsYXN0IG9uZSwgd2lsbCByZW1vdmUgcGFyYWdyYXBoJylcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICh0YWcgKyAnIHJlbW92ZWQgZnJvbSBwYXJhZ3JhcGguXFxuXHVEODNEXHVERDE3IE9wZW4gc291cmNlIG5vdGUuJywgNTAwMCk7XG5cdFx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLnJlbW92ZUVsZW1lbnRXaXRoQW5pbWF0aW9uKFxuXHRcdFx0XHRcdFx0XHRcdFx0dGFnUGFyYWdyYXBoRWwsIFxuXHRcdFx0XHRcdFx0XHRcdFx0KCkgPT4ge1xuXHRcdFx0XHQgICAgXHRcdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0ICAgIFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnRhZ1N1bW1hcnkudXBkYXRlKHRhZ1N1bW1hcnlCbG9jayk7IFxuXHRcdFx0XHQgICAgXHRcdFx0XHRcdFx0dGFnUGFyYWdyYXBoRWwucmVtb3ZlKCk7IFxuXHRcdFx0ICAgIFx0XHRcdFx0XHRcdH0sIDUwMCk7XG5cdFx0XHRcdFx0XHRcdFx0fSk7XG5cblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0XHRcdFx0XHRcdFx0bm90aWNlLm5vdGljZUVsLCBcblx0XHRcdFx0XHRcdFx0XHRcdCdjbGljaycsIFxuXHRcdFx0XHRcdFx0XHRcdFx0KGU6IEV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHRcdCBcdCBcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlUGF0aCwgJycpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUodGFnU3VtbWFyeUJsb2NrKTsgXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0XHR9IGVsc2UgaWYgKHRhZ0VsLmdldEF0dHJpYnV0ZSgndHlwZScpID09ICduYXRpdmUtZW1iZWQnKSB7XG5cblx0XHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IucHJvY2Vzc05hdGl2ZUVtYmVkKHRhZ0NvbnRhaW5lciwgdHJ1ZSk7XG5cdFx0XHRcdFx0fSwgMjAwKVxuXG5cdFx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblxuIFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXG5cdFx0XHRcdHRyeSB7XG5cblx0XHRcdFx0XHRjb25zdCBiYWNrdXBGaWxlTmFtZSA9IFN0cmluZyhmaWxlLm5hbWUuc3Vic3RyaW5nKDAsIGZpbGUubmFtZS5pbmRleE9mKCcubWQnKSkgKyAnIEJBQ0tVUC5tZCcpO1xuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShiYWNrdXBGaWxlTmFtZSwgZmlsZUNvbnRlbnRCYWNrdXApO1xuXG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIFRhZy9ub3RlIGVkaXRpbmcgZXJyb3I6ICcgKyBlcnJvci5tZXNzYWdlICsgJ1xcbicgKyBiYWNrdXBGaWxlTmFtZSArICcgc2F2ZWQgdG8gdmF1bHQgcm9vdC4nKTtcblx0XHRcdFx0XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmaWxlQ29udGVudEJhY2t1cCk7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIFRhZy9ub3RlIGVkaXRpbmcgZXJyb3I6ICcgKyBlcnJvci5tZXNzYWdlICsgJ1xcbk5vdGUgY29udGVudCBjb3BpZWQgdG8gY2xpcGJvYXJkLicpO1xuXG5cdFx0XHRcdH1cblx0XHRcdH0gXG5cblx0XHRcdHRoaXMucGx1Z2luLnRhZ1Byb2Nlc3Nvci5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscygpO1xuXG5cdFx0fSBlbHNlIHtcblx0XHRcdG5ldyBOb3RpY2UoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IGlkZW50aWZ5IHRhZyBsb2NhdGlvbi4gUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHR9XG5cdH1cblxufSIsICJpbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEFwcCwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5cbmV4cG9ydCBjbGFzcyBEb3VibGVUYXBIYW5kbGVyIHtcblx0XG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogVGFnQnVkZHksIGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjYWxsYmFjazogRnVuY3Rpb24pe1xuXHQgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47IC8vIFN0b3JlIHRoZSBwbHVnaW4gaW5zdGFuY2Vcblx0ICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdCAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdCAgICB0aGlzLmxhc3RUYXAgPSAwO1xuXHQgICAgXG5cdCAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHQgICAgXHR0aGlzLmVsZW1lbnQsXG5cdCAgICBcdCd0b3VjaGVuZCcsIFxuXHQgICAgXHR0aGlzLmhhbmRsZVRvdWNoRW5kLmJpbmQodGhpcyksIFxuXHQgICAgXHR0cnVlXG4gICAgXHQpO1xuXHQgIH1cblxuXHQgIGhhbmRsZVRvdWNoRW5kKGV2ZW50OiBFdmVudCkge1xuXHQgICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcblx0ICAgIGNvbnN0IHRhcExlbmd0aCA9IGN1cnJlbnRUaW1lIC0gdGhpcy5sYXN0VGFwO1xuXHQgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG5cdCAgICBpZiAodGFwTGVuZ3RoIDwgNTAwICYmIHRhcExlbmd0aCA+IDApIHtcblx0ICAgICAgdGhpcy5jYWxsYmFjayhldmVudCk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcblx0ICAgICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcblx0ICAgICAgfSwgNTAwKTtcblx0ICAgIH1cblx0ICAgIHRoaXMubGFzdFRhcCA9IGN1cnJlbnRUaW1lO1xuXHQgIH1cbn1cblxuZXhwb3J0IGNsYXNzIFRyaXBsZVRhcEhhbmRsZXIge1xuXHRcbiAgcHJpdmF0ZSBwbHVnaW46IGFueTtcbiAgcHJpdmF0ZSBlbGVtZW50OiBIVE1MRWxlbWVudDtcbiAgcHJpdmF0ZSBjYWxsYmFjazogRnVuY3Rpb247XG4gIHByaXZhdGUgbGFzdFRhcDogbnVtYmVyO1xuICBwcml2YXRlIHRpbWVvdXQ6IGFueTtcbiAgcHJpdmF0ZSB0YXBDb3VudDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogYW55LCBlbGVtZW50OiBIVE1MRWxlbWVudCwgY2FsbGJhY2s6IEZ1bmN0aW9uKXtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjsgLy8gU3RvcmUgdGhlIHBsdWdpbiBpbnN0YW5jZVxuICAgIHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG4gICAgdGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgIHRoaXMubGFzdFRhcCA9IDA7XG4gICAgdGhpcy50YXBDb3VudCA9IDA7IC8vIEluaXRpYWxpemUgdGFwIGNvdW50XG4gICAgXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChcbiAgICAgIHRoaXMuZWxlbWVudCxcbiAgICAgICd0b3VjaGVuZCcsIFxuICAgICAgdGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLCBcbiAgICAgIHRydWVcbiAgICApO1xuICB9XG5cbiAgaGFuZGxlVG91Y2hFbmQoZXZlbnQ6IEV2ZW50KSB7XG4gICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICBjb25zdCB0YXBMZW5ndGggPSBjdXJyZW50VGltZSAtIHRoaXMubGFzdFRhcDtcbiAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICBcbiAgICBpZiAodGFwTGVuZ3RoIDwgNTAwICYmIHRhcExlbmd0aCA+IDApIHtcbiAgICAgIHRoaXMudGFwQ291bnQrKzsgLy8gSW5jcmVtZW50IHRhcCBjb3VudFxuXG4gICAgICAvLyBJZiB0cmlwbGUgdGFwIGlzIGRldGVjdGVkLCB0cmlnZ2VyIHRoZSBjYWxsYmFjayBhbmQgcmVzZXQgdGFwQ291bnRcbiAgICAgIGlmICh0aGlzLnRhcENvdW50ID09PSAyKSB7XG4gICAgICAgIHRoaXMuY2FsbGJhY2soZXZlbnQpO1xuICAgICAgICB0aGlzLnRhcENvdW50ID0gMDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50YXBDb3VudCA9IDA7IC8vIFJlc2V0IHRhcCBjb3VudCBpZiB0aW1lIGJldHdlZW4gdGFwcyBpcyB0b28gbG9uZ1xuICAgIH1cblxuICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgICB0aGlzLnRhcENvdW50ID0gMDsgLy8gUmVzZXQgdGFwIGNvdW50IHdoZW4gdGltZW91dCBpcyByZWFjaGVkXG4gICAgfSwgNTAwKTtcblxuICAgIHRoaXMubGFzdFRhcCA9IGN1cnJlbnRUaW1lO1xuICB9XG59XG5cblxuZXhwb3J0IGNsYXNzIFByZXNzQW5kSG9sZEhhbmRsZXIge1xuXHRcblx0Y29uc3RydWN0b3IoXG5cdFx0cGx1Z2luOiBUYWdCdWRkeSwgXG5cdFx0ZWxlbWVudDogSFRNTEVsZW1lbnQsIFxuXHRcdGNhbGxiYWNrOiBGdW5jdGlvbiwgXG5cdFx0ZHVyYXRpb246IG51bWJlciA9IDYwMFxuXHQpe1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuZWxlbWVudCA9IGVsZW1lbnQ7XG5cdFx0dGhpcy5jYWxsYmFjayA9IGNhbGxiYWNrO1xuXHRcdHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjsgXG5cdFx0dGhpcy50aW1lb3V0ID0gbnVsbDtcblxuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0XHR0aGlzLmVsZW1lbnQsIFxuXHRcdFx0J3RvdWNoc3RhcnQnLCBcblx0XHRcdHRoaXMuaGFuZGxlVG91Y2hTdGFydC5iaW5kKHRoaXMpLCBcblx0XHRcdHRydWVcblx0XHQpO1xuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0XHR0aGlzLmVsZW1lbnQsIFxuXHRcdFx0J3RvdWNoZW5kJywgXG5cdFx0XHR0aGlzLmhhbmRsZVRvdWNoRW5kLmJpbmQodGhpcyksIFxuXHRcdFx0dHJ1ZVxuXHRcdCk7XG5cdH1cblxuXHRoYW5kbGVUb3VjaFN0YXJ0KGV2ZW50OiBFdmVudCkge1xuXHRcdC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHQvL2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0dGhpcy5jYWxsYmFjayhldmVudCk7XG5cdFx0XHR0aGlzLnRpbWVvdXQgPSBudWxsO1xuXHRcdH0sIHRoaXMuZHVyYXRpb24pO1xuXHR9XG5cblx0aGFuZGxlVG91Y2hFbmQoZXZlbnQ6IEV2ZW50KSB7XG5cdFx0aWYgKHRoaXMudGltZW91dCkge1xuXHRcdFx0Y2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG5cdFx0XHR0aGlzLnRpbWVvdXQgPSBudWxsO1xuXHRcdH1cblx0fVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG9CQUFnTzs7O0FDQ2hPLHNCQUErQztBQUV4QyxJQUFNLGdCQUFOLGNBQTRCLGlDQUFpQjtBQUFBLEVBR2hELFlBQVlDLE1BQVUsUUFBa0I7QUFDcEMsVUFBTUEsTUFBSyxNQUFNO0FBQ2pCLFNBQUssU0FBUztBQUFBLEVBQ2xCO0FBQUEsRUFFQSxVQUFnQjtBQUNaLFFBQUksRUFBRSxZQUFZLElBQUk7QUFDdEIsZ0JBQVksTUFBTTtBQUlsQixRQUFJLHdCQUFRLFdBQVcsRUFDdEIsUUFBUSxxQ0FBcUMsRUFDN0MsUUFBUSxpREFBaUQsRUFDekQ7QUFBQSxNQUFVLENBQUMsV0FDUixPQUNDLFNBQVMsS0FBSyxPQUFPLFNBQVMsYUFBYSxFQUMzQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixhQUFLLE9BQU8sU0FBUyxnQkFBZ0I7QUFDckMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ25DLENBQUM7QUFBQSxJQUNMO0FBRUEsUUFBSSx3QkFBUSxXQUFXLEVBQ3RCLFFBQVEsaUNBQWlDLEVBQ3pDLFFBQVEs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V0FBVyxHQUFHLEdBQUc7QUFFMUIsWUFBTSxtQkFBbUIsS0FBSyxTQUFTO0FBQ3ZDLFVBQUk7QUFDSixVQUFJLG9CQUFvQixJQUFJO0FBQzNCLHFCQUFhLENBQUM7QUFBQSxNQUNmLFdBQVcsaUJBQWlCLFFBQVEsSUFBSSxHQUFHO0FBQzFDLHFCQUFhLEtBQUssU0FBUyxrQkFBa0IsTUFBTSxJQUFJO0FBQUEsTUFDeEQsT0FBTztBQUNOLHFCQUFhLENBQUMsS0FBSyxTQUFTLGlCQUFpQjtBQUFBLE1BQzlDO0FBRUEsVUFBSSxXQUFXLFNBQVMsR0FBRyxHQUFHO0FBQzdCLG1CQUFXLE9BQU8sV0FBVyxRQUFRLEdBQUcsR0FBRyxDQUFDO0FBQUEsTUFDN0M7QUFFQSxpQkFBVyxRQUFRLElBQUksS0FBSyxDQUFDO0FBQzdCLG1CQUFhLFdBQVcsTUFBTSxHQUFHLENBQUM7QUFDbEMsV0FBSyxTQUFTLG9CQUFvQixXQUFXLEtBQUssSUFBSTtBQUN0RCxXQUFLLGFBQWE7QUFBQSxJQUNuQixPQUFPO0FBQUEsSUFFUDtBQUFBLEVBQ0Q7QUFBQSxFQUVBLGdCQUF1QjtBQUN0QixVQUFNLGFBQ04sS0FBSyxTQUFTLHFCQUFtQixLQUNqQyxDQUFDLElBQUksS0FBSyxTQUFTLGtCQUFrQixNQUFNLElBQUk7QUFDL0MsV0FBTztBQUFBLEVBQ1I7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImZvbGRlclBhdGgiLCAiYXBwIiwgImZpbGVQYXRoIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiU2VsZWN0RmlsZU1vZGFsIiwgImFwcCIsICJhcHAiLCAiU2VsZWN0RmlsZU1vZGFsIiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAiZSIsICJub3RpY2UiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJUZW1wQ29tcG9uZW50IiwgImltcG9ydF9vYnNpZGlhbiIsICJhcHAiLCAiZXJyb3IiXQp9Cg==
