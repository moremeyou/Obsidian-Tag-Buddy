/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TagBuddy
});
module.exports = __toCommonJS(main_exports);
var import_obsidian10 = require("obsidian");

// settings.ts
var import_obsidian = require("obsidian");
var TBSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    function isValidTag(tag) {
      const tagPattern = /^#[\w]+$/;
      return tagPattern.test(tag);
    }
    function filterAndJoinTags(tagsString) {
      const tagsArray = tagsString.split(", ");
      const validTags = tagsArray.filter(isValidTag);
      return validTags.join(", ");
    }
    containerEl.createEl("h3", { text: "General" });
    new import_obsidian.Setting(containerEl).setName("Recent tags").setDesc("The most recent tags added via Tag Buddy are stored here. These will show up first in the list when adding.").addText((text) => {
      text.setPlaceholder(this.plugin.settings.recentlyAddedTags).setValue(this.plugin.settings.recentlyAddedTags).onChange(async (value) => {
        this.plugin.settings.recentlyAddedTags = filterAndJoinTags(value);
        await this.plugin.saveSettings();
      });
    });
    new import_obsidian.Setting(containerEl).setName("Lock recent tags").setDesc("Toggle ON to lock the recent tags list. Recent tags will not be updated. Instead, the tags above will act like a favorites list.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.lockRecentTags).onChange(async (value) => {
        this.plugin.settings.lockRecentTags = value;
        await this.plugin.saveSettings();
      })
    );
    containerEl.createEl("h3", { text: "Desktop" });
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag:").setDesc("What should happen when you click a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag with CMD/CTRL modifier key:").setDesc("What should happen when you click a tag while holding the CMD or CTRL key?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopCMDClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopCMDClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when clicking a tag with OPT/ALT modifier key:").setDesc("What should happen when you click a tag while holding the OPT or ALT key?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.desktopOPTClickTag).onChange(
        async (value) => {
          this.plugin.settings.desktopOPTClickTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h3", { text: "Mobile" });
    new import_obsidian.Setting(containerEl).setName("Show mobile notices").setDesc("Toggle OFF to hide notices.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileNotices).onChange(
        async (value) => {
          this.plugin.settings.mobileNotices = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when DOUBLE-TAPPING a tag:").setDesc("What should happen when you DOUBLE-TAP a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").addOption("native", "Search tag").setValue(this.plugin.settings.mobileDoubleTapTag).onChange(
        async (value) => {
          this.plugin.settings.mobileDoubleTapTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Action when LONG-PRESSING a tag:").setDesc("What should happen when you LONG-PRESS a tag?").addDropdown(
      (opt) => opt.addOption("remove", "Remove tag").addOption("hash", "Remove hash").addOption("edit", "Edit tag").setValue(this.plugin.settings.mobileLongPressTag).onChange(
        async (value) => {
          this.plugin.settings.mobileLongPressTag = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("TRIPLE-TAP non-tag, non-link text to add a tag:").setDesc("Toggle OFF to disable triple-tap.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileTripleTapText).onChange(
        async (value) => {
          this.plugin.settings.mobileTripleTapText = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h3", { text: "Tag Summaries" });
    new import_obsidian.Setting(containerEl).setName("Show tag summary buttons").setDesc("Toggle OFF to hide these buttons.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.showSummaryButtons).onChange(
        async (value) => {
          this.plugin.settings.showSummaryButtons = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("h5", { text: "Tag Summaries Items" });
    new import_obsidian.Setting(containerEl).setName("Remove tag button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.removeTagBtn).onChange(
        async (value) => {
          this.plugin.settings.removeTagBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to clipboard button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToCBBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToCBBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Move to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.moveToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.moveToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy link to section button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyLinkToSectionBtn).onChange(
        async (value) => {
          this.plugin.settings.copyLinkToSectionBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    new import_obsidian.Setting(containerEl).setName("Copy to note button:").addDropdown(
      (opt) => opt.addOption("always", "Desktop and mobile").addOption("desktop", "Only desktop").addOption("mobile", "Only mobile").addOption("hide", "Hide").setValue(this.plugin.settings.copyToNoteBtn).onChange(
        async (value) => {
          this.plugin.settings.copyToNoteBtn = value;
          await this.plugin.saveSettings();
        }
      )
    );
    containerEl.createEl("hr");
    containerEl.createEl("h1", { text: "Support a buddy" });
    const donateLink = containerEl.createEl("a");
    donateLink.setAttribute("href", "https://www.buymeacoffee.com/moremeyou");
    const donateButton = createEl("img");
    donateButton.setAttribute("src", "https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png");
    donateButton.setAttribute("alt", "Buy Me A Coffee");
    donateButton.style = "height: 40px !important;width: 150px !important;";
    donateLink.appendChild(donateButton);
    containerEl.createEl("br");
    containerEl.createEl("br");
    containerEl.createEl("br");
    new import_obsidian.Setting(containerEl).setName("Debug mode").setDesc("Output to console.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
        this.plugin.settings.debugMode = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// gui.ts
var import_obsidian6 = require("obsidian");

// utils.ts
var import_obsidian2 = require("obsidian");
function getTagElement(paragraphEl2, tagText) {
  const els = paragraphEl2.querySelectorAll(".tag");
  let tagElText = "";
  let tagElHasSub;
  for (let el of els) {
    tagElText = el.innerText.trim();
    if (tagElText === tagText) {
      return el;
    }
  }
  return null;
}
function platformSettingCheck(app2, value) {
  return value == "always" || value == "desktop" && !app2.isMobile || value == "mobile" && app2.isMobile;
}
function platformSettingCheckMultiple(app2, values) {
  for (let value of values) {
    if (platformSettingCheck(app2, value)) {
      return true;
    }
  }
  return false;
}
function isWordNearEnd(str, word, charDistance = 0) {
  const lastIndex = str.lastIndexOf(word);
  if (lastIndex === -1)
    return false;
  const wordEndIndex = lastIndex + word.length;
  const distanceToEnd = str.length - wordEndIndex;
  return distanceToEnd === 0 || distanceToEnd <= charDistance;
}
function getWordObjFromString(sourceText, offset) {
  let wordRegex = /[^\s]+(?=[.,:!?]?(\s|$))/g;
  let match;
  let index;
  let word = null;
  while ((match = wordRegex.exec(sourceText)) !== null) {
    if (match.index <= offset && offset <= match.index + match[0].length) {
      word = match[0];
      index = match.index;
      break;
    }
  }
  return {
    text: word,
    index
  };
}
function getClickedTextObjFromDoc(x, y, minNodeLength = 10) {
  let range, nodeText, offset;
  if (document.caretRangeFromPoint) {
    range = document.caretRangeFromPoint(x, y);
    if (range.startContainer.nodeType === Node.TEXT_NODE) {
      nodeText = range.startContainer.nodeValue.trim();
    } else {
      return null;
    }
    offset = range.startOffset;
  }
  if (nodeText.length < minNodeLength) {
    return null;
  }
  return {
    text: nodeText,
    index: offset,
    el: range.startContainer.parentNode
  };
}
function getMarkdownHeadings(bodyLines, headingFilter = "") {
  const headers = [];
  let accumulatedIndex = 0;
  bodyLines.forEach((line, index) => {
    const match = line.match(/^(#+)[\s]?(.*)$/);
    if (match && (headingFilter == "" || match[2] == headingFilter)) {
      headers.push({
        fullText: match[0],
        level: match[1].length,
        text: match[2],
        line: index,
        startIndex: accumulatedIndex,
        endIndex: accumulatedIndex + match[0].length - 1
      });
    }
    accumulatedIndex += line.length + 1;
  });
  return headers;
}
function findClosestHeaderWithLink(paragraph) {
  const lines = paragraph.split("\n");
  let closestHeader = "";
  for (let i = lines.length - 1; i >= 0; i--) {
    const line = lines[i].trim();
    if (/^#{1,6}\s/.test(line)) {
      closestHeader = line;
      break;
    }
  }
  if (closestHeader) {
    const text = closestHeader.replace(/^#{1,6}\s*/, "").trim();
    const link = `#${text}`;
    return { text, link };
  }
  return { text: "", link: "" };
}
function fileContainsHeading(fileContent, heading) {
  const fileContentLines = getLinesInString(fileContent);
  const mdHeadings = getMarkdownHeadings(fileContentLines, heading);
  return mdHeadings.length > 0;
}
function findFirstLineAfterFrontMatter(markdown) {
  const lines = getLinesInString(markdown);
  let inFrontMatter = false;
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i].trim();
    if (line === "---") {
      inFrontMatter = !inFrontMatter;
      if (!inFrontMatter) {
        return i;
      }
    }
  }
  return 0;
}
function getLinesInString(input) {
  const lines = input.split("\n");
  if (lines.length > 0 && lines[lines.length - 1] === "") {
    lines.pop();
  }
  return lines;
}
function insertTextAfterLine(text, body, line, filePath) {
  const splitContent = body.split("\n");
  const pre = splitContent.slice(0, line + 1).join("\n");
  const post = splitContent.slice(line + 1).join("\n");
  return `${pre}
${text}
${post}`;
}
function getListTypeFromLineNumber(fullText, lineNumber) {
  const lines = fullText.split("\n");
  if (lineNumber >= 0 && lineNumber < lines.length) {
    const line = lines[lineNumber];
    const leadingWhitespace = line.match(/^\s*/)[0];
    if (/^\s*-\s\[\s\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s\[x\]\s/.test(line)) {
      return leadingWhitespace + "- [ ] ";
    } else if (/^\s*-\s/.test(line)) {
      return leadingWhitespace + "- ";
    } else if (/^\s*\d+\.\s/.test(line)) {
      const num = parseInt(line.match(/^\s*(\d+)\./)[1], 10);
      return leadingWhitespace + `${num}. `;
    } else if (/^\s*>\s/.test(line)) {
      return leadingWhitespace + "> ";
    }
  } else {
  }
  return "";
}
function removeTagFromString(inputText, hashtagToRemove, all = true) {
  const regex = new RegExp(
    "\\s?" + hashtagToRemove.replace(/#/g, "\\#") + "(?!\\w|\\/)",
    all ? "gi" : "i"
  );
  return inputText.replace(regex, "").trim();
}
function insertTextInString(newText, sourceText, charPos) {
  return sourceText.substring(0, charPos) + newText + " " + sourceText.substring(charPos);
}
function replaceTextInString(replaceText, sourceText, newText, all = false) {
  const escapedReplaceText = escapeRegExp(replaceText.trim()).replace(/\n/g, "\\s*\\n\\s*");
  const regex = new RegExp(escapedReplaceText, all ? "gsi" : "si");
  return sourceText.trim().replace(regex, newText.trim()).trim();
}
function truncateStringAtWord(str, maxChars = 16) {
  if (str.length <= maxChars)
    return str;
  let truncated = str.substr(0, maxChars);
  const lastSpace = truncated.lastIndexOf(" ");
  if (lastSpace > 0)
    truncated = truncated.substr(0, lastSpace);
  return truncated;
}
function contentChangedTooMuch(original, modified, tag, buffer = 5) {
  const expectedChange = tag.length;
  const threshold = expectedChange + buffer;
  const actualChange = Math.abs(original.length - modified.length);
  return actualChange > threshold;
}
function fileObjFromTags(tags) {
  let tagsArray = tags.map((tag) => tag.replace(/#/g, "").toLowerCase());
  tagsArray = tagsArray.filter((tag, index, self) => self.indexOf(tag) === index);
  const tagsPart = tagsArray.join("+");
  const currentDate = /* @__PURE__ */ new Date();
  const datePart = currentDate.getDate().toString().padStart(2, "0") + //'-' +
  (currentDate.getMonth() + 1).toString().padStart(2, "0") + //'-' +
  currentDate.getFullYear().toString().slice(-2);
  const timePart = (
    //currentDate.getHours().toString().padStart(2, '0') + '-' +
    //currentDate.getMinutes().toString().padStart(2, '0') + '-' +
    currentDate.getSeconds().toString().padStart(2, "0")
  );
  const fileName = `Tag Summary (${datePart} ${timePart}).md`;
  const titleTagsPart = tagsArray.map((tag) => tag.charAt(0).toUpperCase() + tag.slice(1)).join(" + ");
  const title = `${titleTagsPart} Tag Summary`;
  return {
    fileName,
    title
  };
}
function getActiveFileFolder(activeFile) {
  if (!activeFile)
    return null;
  let folderPath;
  if (activeFile.path.includes("\\") || activeFile.path.includes("/")) {
    const pathSeparator = activeFile.path.includes("\\") ? "\\" : "/";
    const pathParts = activeFile.path.split(pathSeparator);
    pathParts.pop();
    folderPath = pathParts.join(pathSeparator);
    if (!folderPath.endsWith(pathSeparator)) {
      folderPath += pathSeparator;
    }
  } else {
    folderPath = "";
  }
  return folderPath;
}
function getTagsFromApp(app2, recentTags) {
  const tagsObject = app2.metadataCache.getTags();
  const tagsArray = Object.entries(tagsObject);
  tagsArray.sort((a, b) => b[1] - a[1]);
  if (recentTags.length > 0) {
    const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
    const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
    return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
  } else {
    return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
  }
}
async function validateFilePath(filePath) {
  const matchingFiles = await app.vault.getFiles().filter((file) => file.name === filePath);
  if (matchingFiles.length === 1) {
    const filePath2 = matchingFiles[0].path;
    const file = await this.app.vault.getAbstractFileByPath(filePath2);
    return file;
  } else if (matchingFiles.length > 1) {
    new Notice("Tag Buddy: Multiple files found with the same name. Can't safely edit tag.");
    return null;
  } else {
    new Notice("Tag Buddy: No file found. Try again, or this tag might be in an unsupported embed type.");
    return null;
  }
}
function ctrlCmdKey(event) {
  const isMac = import_obsidian2.Platform.isMacOS;
  if (isMac)
    return event.metaKey;
  else
    return event.ctrlKey;
}
function tagsInString(string, tag) {
  let regex;
  if (tag) {
    regex = new RegExp(tag.replace(/\//g, "\\/") + "(?![\\w\\/\\#])", "g");
  } else {
    regex = /#(\w+)(?![\w\/#])/g;
  }
  const matches = string.match(regex);
  return matches || [];
}
function countOccurrences(summaryTags, contentTags) {
  let count = 0;
  for (let tag of summaryTags) {
    count += contentTags.filter((item) => item === tag).length;
  }
  return count;
}
function escapeRegExp(string) {
  return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
}
async function getEmbedFile(el) {
  let filePath = el.getAttribute("src");
  const linkArray = filePath.split("#");
  filePath = linkArray[0].trim() + ".md";
  const file = await validateFilePath(filePath);
  return file;
}
function isTagValid(tag, fullTag = false) {
  let tagPattern;
  if (fullTag)
    tagPattern = /^#[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  else
    tagPattern = /^[a-zA-Z0-9_\-\/]*[a-zA-Z_\-\/][a-zA-Z0-9_\-\/]*$/;
  return tagPattern.test(tag);
}
function extractValidTags(tagsString) {
  const potentialTags = tagsString.split(",");
  const validTags = potentialTags.map((tag) => tag.trim()).filter((tag) => isTagValid(tag, true));
  return validTags;
}

// Modal.ts
var import_obsidian3 = require("obsidian");
var TagSelector = class extends import_obsidian3.FuzzySuggestModal {
  constructor(app2, plugin, event, onChooseItemCallback) {
    super(app2);
    this.height = 215;
    this.noSelection = false;
    this.app = app2;
    this.plugin = plugin;
    this.tag = "";
    this.onChooseItemCallback = onChooseItemCallback;
    this.inputListener = this.listenInput.bind(this);
    this.tagCache = [];
    if (event != null)
      this.location = { x: event.pageX, y: event.pageY };
  }
  onOpen() {
    this.setPlaceholder("");
    this.inputEl.addEventListener("keyup", this.inputListener);
    if (!this.app.isMobile) {
      this.resultContainerEl.parentNode.style.width = "200px";
      this.resultContainerEl.style.height = "215px";
      this.resultContainerEl.parentNode.style.left = `${this.location.x}px`;
      this.resultContainerEl.parentNode.style.top = `${this.location.y}px`;
    } else {
      setTimeout(() => {
        this.inputEl.focus();
      }, 500);
    }
    super.onOpen();
  }
  onClose() {
    this.inputEl.removeEventListener("keyup", this.inputListener);
    super.onClose();
  }
  listenInput(event) {
    this.noSelection = false;
    if (!this.app.isMobile) {
      const itemsHeight = this.getSuggestions(this.inputEl.value).length * 42;
      const height = Math.min(this.height, Math.max(65, itemsHeight));
      this.resultContainerEl.style.height = `${height}px`;
    }
    if (event.key == "Enter" && !this.noSelection) {
      const text = this.inputEl.value.trim();
      const pattern = /(?=[^\d\s]+)[a-zA-Z0-9_\-\/]+/g;
      if (pattern.test(text)) {
        this.close();
        this.onChooseItem(this.inputEl.value);
      } else {
        new import_obsidian3.Notice("Invalid tag.");
      }
    }
  }
  /*getSuggestions(query: string) : string[]{
          const filteredTags = Utils.getTagsFromApp(
              this.app, 
              this.plugin.getRecentTags()).filter(tag => 
              //tag.toLowerCase().includes(query.toLowerCase())
              query == '' ? true : tag.toLowerCase() == query.toLowerCase()
          );
          return filteredTags;
      }
  
      renderSuggestion(header: string, el: HTMLElement) {
          el.createEl("div", { text: header });
      }*/
  onNoSuggestion() {
    super.onNoSuggestion();
    this.noSelection = true;
  }
  getItems() {
    const filteredTags = getTagsFromApp(
      this.app,
      this.plugin.getRecentTags()
    );
    return filteredTags;
  }
  getItemText(tag) {
    return tag;
  }
  async onChooseItem(result) {
    if (!this.app.isMobile) {
      this.onChooseItemCallback(result);
    } else {
      setTimeout(() => {
        this.onChooseItemCallback(result);
      }, 250);
    }
  }
};

// TagEditorModal.ts
var import_obsidian4 = require("obsidian");
var TBTagEditorModal = class extends import_obsidian4.Modal {
  //constructor(app: App, tag: String, onSubmit: (result: string) => void) {
  constructor(app2, plugin, tag, index, filePath = null, tagEl2 = null) {
    super(app2);
    this.settings = {
      originalTag: "",
      originalIndex: null,
      tagEl: null,
      filePath: null,
      batchAction: "instance",
      newName: "",
      summaryPos: "top",
      action: "rename"
    };
    this.plugin = plugin;
    this.settings.tagEl = tagEl2;
    this.settings.filePath = filePath;
    this.settings.originalTag = tag;
    this.settings.originalIndex = index;
  }
  onOpen() {
    let { contentEl, titleEl, modalEl, containerEl } = this;
    titleEl.setText("Tag Actions");
    this.editDiv = createEl("div");
    this.editDiv.classList.add("tag-editor-edit-div");
    this.optionsDiv = createEl("div");
    this.optionsDiv.classList.add("tag-editor-options");
    this.input = new import_obsidian4.TextComponent(this.editDiv);
    this.input.inputEl.classList.add("tag-editor-input");
    this.tagActionDropdown = new import_obsidian4.DropdownComponent(this.editDiv).addOption("rename", "Rename").addOption("lower", "Convert to lower case").addOption("totext", "Remove hash (#)").addOption("summary", "Create summary");
    this.tagActionDropdown.selectEl.classList.add("tag-editor-dropdown");
    contentEl.appendChild(this.editDiv);
    contentEl.appendChild(this.optionsDiv);
    this.showEditTagOptions("rename");
    const hr = createEl("hr");
    hr.classList.add("tag-editor-hr");
    contentEl.appendChild(hr);
    this.tagActionDropdown.onChange((value) => {
      this.settings.action = value;
      if (value == "summary") {
        this.showSummaryOptions();
      } else {
        this.showEditTagOptions(value);
      }
    });
    const submitBtn = new import_obsidian4.ButtonComponent(contentEl).setClass("tag-editor-submit").setButtonText("Submit").onClick(
      (evt) => {
        this.submitTagEdit();
      }
    );
  }
  submitTagEdit() {
    const isValidTag = isTagValid(this.settings.newName.trim(), true);
    const action = this.settings.action;
    let newName = this.settings.originalTag;
    if (action == "summary") {
      const summaryTags = extractValidTags(this.input.getValue());
      if (summaryTags.length < 1) {
        new import_obsidian4.Notice("Invalid tag format.");
      } else {
        this.plugin.tagSummary.createCodeBlock(summaryTags, this.settings.summaryPos);
        this.close();
      }
    } else if (action == "rename" && !isValidTag) {
      new import_obsidian4.Notice("Invalid tag format.");
    } else {
      if (action == "rename")
        newName = this.settings.newName;
      else if (action == "lower")
        newName = this.settings.originalTag.toLowerCase();
      else if (action == "totext")
        newName = this.settings.originalTag.substring(1);
      this.plugin.tagEditor.renameTag(
        this.settings.originalTag,
        newName,
        this.settings.batchAction == "instance" ? parseInt(this.settings.originalIndex) : this.settings.batchAction,
        this.settings.filePath,
        this.settings.tagEl
        //parseInt(this.settings.originalIndex),
        //((this.settings.batchAction == 'instance') ? parseInt(this.settings.originalIndex) : this.settings.batchAction)
      );
      this.close();
      setTimeout(async () => {
        this.plugin.tagSummary.update(tagEl.closest());
        paragraphEl.remove();
      }, 500);
    }
  }
  showSummaryOptions() {
    this.optionsDiv.empty();
    this.input.setDisabled(false);
    new import_obsidian4.Setting(this.optionsDiv).setName("Where do you want to add the tag summary?").setDesc("Add multiple tags above separated by a comma.").addDropdown(
      (opt) => opt.addOption("top", "Top of this note").addOption("end", "Bottom of this note").addOption("note", "In a new note").onChange(
        (value) => {
          this.settings.summaryPos = value;
        }
      )
    );
  }
  showEditTagOptions(editType) {
    this.optionsDiv.empty();
    this.input.setValue(this.settings.originalTag);
    this.input.setDisabled(true);
    if (editType == "rename") {
      const newName = new import_obsidian4.Setting(this.optionsDiv).setName("New name").setDesc("Tags can include letters, numbers, underscores (_), hyphens (-), and forward slashes (/) for nested tags.").addText(
        (opt) => opt.setValue("").onChange(
          (value) => {
            this.settings.newName = value;
          }
        )
      );
    }
    const whereEditOpt = new import_obsidian4.Setting(this.optionsDiv).setName("Where to make this change?").addDropdown(
      (opt) => opt.addOption("instance", "Just this instance").addOption("note", "All in this note").addOption("vault", "Across entire vault").onChange((value) => {
        if (value == "vault") {
          whereEditOpt.setDesc("WARNING: There is NO UNDO for vault changes. Consider making a backup of your vault first.");
          this.settings.batchAction = "vault";
        } else if (value == "note") {
          whereEditOpt.setDesc("Only tags in this note will be updated. Choose 'Across entire vault' to update this tag everywhere.");
          this.settings.batchAction = "note";
        } else if (value == "instance") {
          whereEditOpt.setDesc("");
          this.settings.batchAction = "instance";
        }
      })
    );
  }
  onClose() {
    let { contentEl } = this;
    contentEl.empty();
  }
};

// FindFileModal.ts
var import_obsidian5 = require("obsidian");
var SelectFileModal2 = class extends import_obsidian5.SuggestModal {
  constructor(app2, onSubmit) {
    super(app2);
    this.onSubmit = onSubmit;
    this.fileList = this.app.vault.getMarkdownFiles();
  }
  // Returns all available suggestions.
  getSuggestions(query) {
    return this.fileList.filter(
      (file) => file.path.includes(query)
    );
  }
  // Renders each suggestion item.
  renderSuggestion(file, el) {
    el.createEl("div", { text: file.name });
    el.createEl("small", { text: file.path });
  }
  // Perform action on the selected suggestion.
  onChooseSuggestion(file, evt) {
    this.onSubmit(file);
  }
  //onNoSuggestion(file: TFile, evt: MouseEvent | KeyboardEvent) {
  //new Notice(`No selection`);
  //this.onSubmit(file)
  //}
};

// gui.ts
var GUI = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  showTagEditor(tagEl2) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (this.app.isMobile) {
    } else {
    }
    const index = parseInt(tagEl2.getAttribute("md-index"));
    const tag = tagEl2.innerText;
    const filePath = tagEl2.getAttribute("file-source");
    const tagContainerType = tagEl2.getAttribute("type");
    if (mode == "preview") {
      const tagEditorModal = new TBTagEditorModal(
        this.app,
        this.plugin,
        tag,
        index,
        filePath,
        tagContainerType == "plugin-summary" ? tagEl2 : null
        //tag,
        //index
        //(tag)=>{
        //	console.log(tag) 
        //}
      ).open();
    }
  }
  /*isTagValid (tag:string):boolean { // including the #
  	const tagPattern = /^#[\w]+$/;
  	return tagPattern.test(tag);
  }*/
  makeButton(lable, clickFn, classId = "tagsummary-button") {
    const button = createEl("button");
    (0, import_obsidian6.setIcon)(button, lable);
    button.className = classId;
    this.plugin.registerDomEvent(
      button,
      "click",
      clickFn
    );
    return button;
  }
  makeBlockSelector(index) {
    const checkboxEl = createEl("div");
    checkboxEl.setAttribute("index", index);
    let checkedBtn;
    let uncheckedBtn;
    const checkBox = function(bool) {
      this.plugin.tagSummary.updateSelection(parseInt(checkboxEl.getAttribute("index")), bool);
      if (bool) {
        uncheckedBtn.remove();
        checkboxEl.appendChild(checkedBtn);
      } else {
        checkedBtn.remove();
        checkboxEl.appendChild(uncheckedBtn);
      }
    }.bind(this);
    checkedBtn = this.makeButton("check-square", (e) => {
      e.stopPropagation();
      checkBox(false);
    }, "tagsummary-button tagsummary-checkbox checked");
    checkedBtn.title = "Unselect this paragraph.";
    uncheckedBtn = this.makeButton("square", (e) => {
      e.stopPropagation();
      checkBox(true);
    }, "tagsummary-button tagsummary-checkbox");
    uncheckedBtn.title = "Select this paragraph.";
    checkBox(false);
    return checkboxEl;
  }
  makeRemoveTagButton(clickFn, paragraphEl2, tag) {
    const button = this.makeButton("list-x", (e) => {
      e.stopPropagation();
      clickFn(e, paragraphEl2, tag);
    });
    button.title = "Removed " + tag + " from paragraph.";
    return button;
  }
  makeSummaryRefreshButton(summaryEl) {
    const button = this.makeButton(
      "refresh-ccw",
      (e) => {
        e.stopPropagation();
        this.plugin.tagSummary.update(summaryEl);
        new import_obsidian6.Notice("Tag Summary updated");
        setTimeout(async () => {
        }, 10);
      }
    );
    button.title = "Refresh tag summary";
    return button;
  }
  makeCopyToSection(clickFn, content, sections, tags, filePath, paragraphEl2, summaryEl) {
    const copyToEl = createEl("span");
    const selectEl = createEl("selectEl");
    let dropdown = new import_obsidian6.DropdownComponent(selectEl);
    sections.forEach((sec) => {
      dropdown.addOption(sec, truncateStringAtWord(sec, 16));
    });
    dropdown.addOption("top", "Note top");
    dropdown.addOption("end", "Note end");
    selectEl.querySelector("select").className = "tagsummary-dropdown";
    if (platformSettingCheck(this.app, this.plugin.settings.copyToNoteBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "note",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.copyLinkToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "link",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.copyToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "copy",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheck(this.app, this.plugin.settings.moveToSectionBtn)) {
      copyToEl.appendChild(
        this.makeCopyToButton(
          clickFn,
          "move",
          dropdown,
          paragraphEl2,
          summaryEl,
          content,
          tags,
          filePath
        )
      );
    }
    if (platformSettingCheckMultiple(this.app, [
      this.plugin.settings.moveToSectionBtn,
      this.plugin.settings.copyToSectionBtn,
      this.plugin.settings.copyLinkToSectionBtn,
      this.plugin.settings.copyToNoteBtn
    ])) {
      copyToEl.appendChild(selectEl);
    }
    return copyToEl;
  }
  makeCopyToButton(clickFn, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath) {
    let buttonLabel;
    if (mode == "link")
      buttonLabel = "link";
    else if (mode == "copy")
      buttonLabel = "copy-plus";
    else if (mode == "move")
      buttonLabel = "replace";
    else if (mode == "note")
      buttonLabel = "file-plus-2";
    const button = this.makeButton(buttonLabel, async (e) => {
      e.stopPropagation();
      if (mode == "note") {
        new SelectFileModal2(this.app, (file) => {
          clickFn(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath, file);
        }).open();
      } else {
        clickFn(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath);
      }
    });
    let buttonHoverText;
    if (mode == "link")
      buttonHoverText = "Copy paragraph link.";
    else if (mode == "copy")
      buttonHoverText = "Copy paragraph.";
    else if (mode == "move")
      buttonHoverText = "Move paragraph.";
    else if (mode == "note")
      buttonHoverText = "Copy paragraph to section in note.";
    button.title = buttonHoverText;
    return button;
  }
  makeBakeButton(clickFn, summaryMd, summaryEl, filePath) {
    const button = this.makeButton(
      "stamp",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, summaryEl, filePath);
      }
    );
    button.title = "Flatten summary (replaces code block).";
    return button;
  }
  makeCopyButton(clickFn, content) {
    const button = this.makeButton("clipboard-list", (e) => {
      e.stopPropagation();
      clickFn(e, content);
    });
    button.title = "Copy paragraph to clipboard.";
    return button;
  }
  makeCopySummaryButton(summaryMd) {
    const button = this.makeButton(
      "clipboard-list",
      (e) => {
        e.stopPropagation();
        navigator.clipboard.writeText(summaryMd);
        new import_obsidian6.Notice("Summary copied to clipboard.");
      }
    );
    button.title = "Copy summary";
    return button;
  }
  makeSummaryNoteButton(clickFn, summaryMd, tags) {
    const button = this.makeButton(
      "file-plus-2",
      async (e) => {
        e.stopPropagation();
        clickFn(summaryMd, tags);
      }
    );
    button.title = "Create note from summary";
    return button;
  }
  showTagSelector(event) {
    const view = this.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    let pageX, pageY;
    let nodeType;
    let deepestNode;
    let range;
    if (this.app.isMobile) {
      const touch = event.touches[0] || event.changedTouches[0];
      pageX = Math.round(touch.pageX);
      pageY = Math.round(touch.pageY);
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    } else {
      pageX = event.pageX;
      pageY = event.pageY;
      range = document.caretRangeFromPoint(pageX, pageY);
      nodeType = range.startContainer.nodeType;
    }
    if (mode == "preview") {
      if (nodeType === Node.TEXT_NODE) {
        const tagSelector = new TagSelector(
          this.app,
          this.plugin,
          event,
          (tag) => {
            this.plugin.tagEditor.add(
              "#" + tag,
              pageX,
              pageY
              //,
              //{range: range, el: deepestNode}
            );
          }
        ).open();
      }
    }
  }
  removeElementWithAnimation(el, callback) {
    const height = el.offsetHeight;
    el.style.height = `${height}px`;
    setTimeout(() => {
      el.style.height = "0px";
      el.style.opacity = "0";
      el.style.margin = "0";
      el.style.padding = "0";
    }, 0);
    el.addEventListener(
      "transitionend",
      function onEnd() {
        el.removeEventListener("transitionend", onEnd);
        callback();
      }
    );
  }
};

// TagSummary.ts
var import_obsidian7 = require("obsidian");
var TagSummary = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  async bakeSummaryBtnHandler(summaryMd, summaryEl, filePath) {
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    if (mdSource) {
      const file = await this.app.vault.getAbstractFileByPath(filePath);
      const fileContent = await this.app.vault.read(file);
      const newFileContent = replaceTextInString(
        mdSource,
        fileContent,
        summaryMd
      );
      this.app.vault.modify(file, newFileContent);
      const notice = new import_obsidian7.Notice("Tag summary flattened to active note.");
    } else {
      new import_obsidian7.Notice("\u26A0\uFE0F Tag Buddy: Can	 find code block source. This is a BUG. \u{1FAB2}");
    }
  }
  /*public static addSummary(file: TFile, summary: HTMLElement): void {
          if (!this.fileSummaries.has(file)) {
              this.fileSummaries.set(file, new Set([summary]));
          } else {
              const summaries = this.fileSummaries.get(file);
              summaries?.add(summary);
          }
      }
  
      // Method to retrieve an array of unique summary elements for a given file
      public static getSummariesByFile(file: TFile): HTMLElement[] {
          const summaries = this.fileSummaries.get(file);
          return summaries ? Array.from(summaries) : [];
      }*/
  copyBtnHandler(e, content) {
    const selection = window.getSelection().toString();
    let notice;
    if (selection != "") {
      navigator.clipboard.writeText(selection);
      notice = new import_obsidian7.Notice("Selection copied to clipboard.");
    } else {
      navigator.clipboard.writeText(content);
      notice = new import_obsidian7.Notice("Tagged paragraph copied to clipboard.");
    }
  }
  removeTagBtnHandler(e, paragraphEl2, tag) {
    const tagEl2 = getTagElement(paragraphEl2, tag);
    this.plugin.tagEditor.edit(tagEl2);
  }
  async copyToBtnHandler(e, mode, dropdown, paragraphEl2, summaryEl, content, tags, filePath, selectedFile) {
    let newContent;
    const selection = window.getSelection().toString();
    if (selection == "")
      newContent = content;
    else
      newContent = selection;
    let notice;
    if (mode == "link") {
      const fileName = filePath.split("/").pop().replace(/\.md$/, "");
      newContent = "[[" + filePath + "|" + fileName + "]]";
    }
    if (mode != "link" && !selection) {
      tags.forEach((tag, i) => {
        newContent = removeTagFromString(newContent, tag).trim();
      });
    }
    const copySuccess = await this.copyTextToSection(
      //this.plugin.settings.taggedParagraphCopyPrefix + 
      newContent,
      dropdown.getValue(),
      filePath,
      mode != "link",
      selectedFile
    );
    if (copySuccess) {
      if (mode == "note") {
        notice = new import_obsidian7.Notice(
          "Copied to section: " + dropdown.getValue() + " in " + selectedFile.name + " \u{1F517}",
          5e3
        );
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(selectedFile.path + "#" + dropdown.getValue(), "");
        });
      } else if (mode == "move" && !selection) {
        const file = this.app.vault.getAbstractFileByPath(filePath);
        let fileContent = await this.app.vault.read(file);
        fileContent = fileContent.trim();
        const newFileContent = replaceTextInString(
          content.trim(),
          fileContent,
          newContent
        ).trim();
        if (fileContent != newFileContent) {
          this.app.vault.modify(file, newFileContent);
          const copiedToWhere = dropdown.getValue() == "top" ? "top of note" : dropdown.getValue() == "end" ? "end of note" : dropdown.getValue();
          notice = new import_obsidian7.Notice(
            //'Moved to section: ' + dropdown.getValue() +
            //'.\nðŸ”— Open source note.', 
            "Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"),
            5e3
          );
          this.plugin.gui.removeElementWithAnimation(paragraphEl2, () => {
            setTimeout(async () => {
              this.update(summaryEl);
              paragraphEl2.remove();
            }, 500);
            setTimeout(async () => {
            }, 800);
          });
          if (dropdown.getValue() != "top" || dropdown.getValue() != "end") {
            this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
              this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
            });
          }
        } else {
          new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ".\nCan't update source file.");
        }
      } else if (mode == "copy" || mode == "link") {
        notice = new import_obsidian7.Notice("Copied to section: " + dropdown.getValue() + ". " + (dropdown.getValue() == "top" || dropdown.getValue() == "end" ? "" : "\u{1F517}"));
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(this.app.workspace.getActiveFile().path + "#" + dropdown.getValue(), "");
        });
      }
    }
  }
  async makeSummaryBtnHandler(summaryMd, tags, code = false, incrementFile = false) {
    const newNoteObj = fileObjFromTags(tags);
    let fileContent = code ? summaryMd : "## " + newNoteObj.title + "\n\n" + summaryMd;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian7.MarkdownView);
    const filePath = getActiveFileFolder(this.app.workspace.getActiveFile());
    const fileName = filePath + newNoteObj.fileName;
    const file = this.app.vault.getAbstractFileByPath(fileName);
    let notice;
    if (!code) {
      tags.forEach((tag) => {
        fileContent = replaceTextInString(tag, fileContent, tag.substring(1), true);
      });
    }
    if (file instanceof import_obsidian7.TFile && !incrementFile) {
      notice = new import_obsidian7.Notice("\u26A0\uFE0F Note already exists.\nClick here to overwrite.", 8e3);
      this.plugin.registerDomEvent(notice.noticeEl, "click", (e) => {
        this.app.vault.modify(file, fileContent);
        notice = new import_obsidian7.Notice("Note updated.\n\u{1F517} Open note.", 5e3);
        this.plugin.registerDomEvent(notice.noticeEl, "click", (e2) => {
          this.app.workspace.openLinkText(fileName, "");
        });
      });
    } else if (!file) {
      this.app.vault.create(fileName, fileContent);
      const notice2 = new import_obsidian7.Notice("Summary note created. \u{1F4DC}\n\u{1F517} Open note.");
      this.plugin.registerDomEvent(notice2.noticeEl, "click", (e) => {
        this.app.workspace.openLinkText(newNoteObj.fileName, "");
      });
    }
  }
  createCodeBlock(tagsArray, pos) {
    const codeBlockString = "```tag-summary\ntags: " + tagsArray.join(" ") + "\n```";
    if (pos == "note") {
      this.makeSummaryBtnHandler(codeBlockString, tagsArray, true);
    } else {
      this.copyTextToSection(
        codeBlockString,
        pos,
        "",
        false
      );
    }
  }
  async codeBlockProcessor(source, el, ctx) {
    let tags = Array();
    let include = Array();
    let exclude = Array();
    let sections = Array();
    let max = 50;
    const maxPattern = /^\s*max:\s*(\d+)\s*$/;
    let match;
    const rows = source.split("\n").filter((row) => row.length > 0);
    rows.forEach((line) => {
      if (line.match(/^\s*tags:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*tags:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        tags = list;
      }
      if (line.match(/^\s*include:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*include:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        include = list;
      }
      if (line.match(/^\s*exclude:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*exclude:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        exclude = list;
      }
      if (line.match(/^\s*sections:[\p{L}0-9_\-/#, ]+$/gu)) {
        const content = line.replace(/^\s*sections:/, "").trim();
        let list = content.split(",").map((sec) => sec.trim());
        sections = list;
      }
      match = line.match(maxPattern);
      if (match) {
        max = Math.min(50, Number(match[1]));
      }
    });
    const codeBlock = "```tag-summary\n" + source.trim() + "\n```";
    if (tags.length > 0 || include.length > 0) {
      await this.create(
        el,
        tags,
        include,
        exclude,
        sections,
        max,
        ctx.sourcePath,
        codeBlock
      );
    } else {
      this.createEmpty(
        el,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        ctx.sourcePath ? ctx.sourcePath : "",
        codeBlock
      );
    }
  }
  createEmpty(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const container = createEl("div");
    const textDiv = createEl("blockquote");
    textDiv.innerHTML = "There are no notes with tagged paragraphs that match the tags:<br>" + (tags.length > 0 ? tags.join(", ") : "No tags specified.") + "<br>";
    container.appendChild(textDiv);
    container.setAttribute(
      "codeblock-tags",
      tags.length > 0 ? tags.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-include",
      include ? include.join(",") : ""
    );
    container.setAttribute(
      "codeblock-tags-exclude",
      exclude ? exclude.join(",") : ""
    );
    container.setAttribute(
      "codeblock-sections",
      sections ? sections.join(",") : ""
    );
    container.setAttribute(
      "codeblock-max",
      max
    );
    container.setAttribute(
      "codeblock-code",
      mdSource
    );
    container.appendChild(this.plugin.gui.makeSummaryRefreshButton(container));
    ;
    element.replaceWith(container);
  }
  async create(element, tags, include, exclude, sections, max, fileCtx, mdSource) {
    const activeFile = await this.app.workspace.getActiveFile();
    const validTags = tags.concat(include);
    const tempComponent = new TempComponent();
    const summaryContainer = createEl("div");
    this.selectedBlocks = [];
    this.blocks = [];
    summaryContainer.setAttribute(
      "class",
      "tag-summary-block"
    );
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian7.getAllTags)(cache);
      if (file.path.includes("_exclude"))
        return false;
      if (activeFile) {
        if (activeFile.path == file.path)
          return false;
      }
      if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    listFiles = listFiles.sort((file1, file2) => {
      return file2.stat.ctime - file1.stat.ctime;
    });
    let listContents = await this.readFiles(listFiles);
    let count = 0;
    let summary = "";
    listContents.forEach((item) => {
      const fileName = item[0].name.replace(/.md$/g, "");
      const filePath = item[0].path;
      let listParagraphs = Array();
      const blocks = item[1].split(/(?:\n\s*\n|(?<=^|\n)[*-]\s|(?<=^|\n)\d+\.\s)/).filter((row) => row.trim().length > 0);
      blocks.forEach((paragraph) => {
        let valid = false;
        let listTags = paragraph.match(/(?<=^|\s)(#[^\s#.,;!?:]+)/g);
        if (listTags != null && listTags.length > 0) {
          if (!paragraph.contains("```") && !paragraph.contains("---")) {
            valid = this.isValidText(listTags, tags, include, exclude);
          }
        }
        if (valid)
          listParagraphs.push(paragraph);
      });
      listParagraphs.forEach(async (paragraph) => {
        if (count++ >= max)
          return;
        paragraph += "\n";
        var regex = new RegExp();
        var tagText = new String();
        var tagSection = null;
        tags.forEach((tag) => {
          tagText = tag.replace("#", "\\#");
          regex = new RegExp(`${tagText}(\\W|$)`, "g");
          if (paragraph.match(regex) != null) {
            tagSection = tag;
          }
        });
        const buttonContainer = createEl("div");
        buttonContainer.setAttribute("class", "tagsummary-buttons");
        const paragraphEl2 = createEl("blockquote");
        paragraphEl2.setAttribute("file-source", filePath);
        paragraphEl2.setAttribute("index", count - 1);
        paragraphEl2.setAttribute("class", "tag-summary-paragraph");
        const blockLink = paragraph.match(/\^[\p{L}0-9_\-/^]+/gu);
        const header = findClosestHeaderWithLink(paragraph);
        let link;
        if (blockLink)
          link = "[[" + filePath + "#" + blockLink + "|" + fileName + "]]";
        else if (header.text != "")
          link = "[[" + filePath + "#" + header.link + "|" + fileName + "]]";
        else
          link = "[[" + filePath + "|" + fileName + "]]";
        buttonContainer.appendChild(
          this.plugin.gui.makeCopyToSection(
            this.copyToBtnHandler.bind(this),
            paragraph,
            sections,
            tags,
            blockLink ? filePath + "#" + blockLink[0] : filePath,
            paragraphEl2,
            summaryContainer
          )
        );
        if (platformSettingCheck(this.app, this.plugin.settings.copyToCBBtn)) {
          buttonContainer.appendChild(
            this.plugin.gui.makeCopyButton(
              this.copyBtnHandler.bind(this),
              paragraph.trim()
            )
          );
        }
        if (platformSettingCheck(this.app, this.plugin.settings.removeTagBtn)) {
          buttonContainer.appendChild(
            this.plugin.gui.makeRemoveTagButton(
              this.removeTagBtnHandler.bind(this),
              paragraphEl2,
              tagSection
              //, 
              //(blockLink ? (filePath + '#' + blockLink[0]) : filePath)
            )
          );
        }
        const mdParagraph = paragraph;
        paragraph = "**" + link + "**\n" + paragraph;
        summary += paragraph + "\n";
        paragraphEl2.setAttribute("md-source", mdParagraph);
        blocks.push(mdParagraph);
        await import_obsidian7.MarkdownRenderer.render(this.app, paragraph, paragraphEl2, "", tempComponent);
        const titleEl = createEl("span");
        titleEl.setAttribute("class", "tagsummary-item-title");
        titleEl.appendChild(paragraphEl2.querySelector("strong").cloneNode(true));
        paragraphEl2.appendChild(buttonContainer);
        paragraphEl2.querySelector("strong").replaceWith(titleEl);
        summaryContainer.appendChild(paragraphEl2);
      });
    });
    if (summary != "") {
      setTimeout(async () => {
        if (this.plugin.settings.showSummaryButtons) {
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryRefreshButton(
              summaryContainer
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeCopySummaryButton(
              summary
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeSummaryNoteButton(
              this.makeSummaryBtnHandler.bind(this),
              summary,
              tags
            )
          );
          summaryContainer.appendChild(
            this.plugin.gui.makeBakeButton(
              this.bakeSummaryBtnHandler.bind(this),
              summary,
              summaryContainer,
              activeFile.path
            )
          );
          summaryContainer.appendChild(createEl("br"));
        }
      }, 0);
      summaryContainer.setAttribute(
        "codeblock-tags",
        tags.join(",")
      );
      summaryContainer.setAttribute(
        "codeblock-tags-include",
        include.length > 0 ? include.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-tags-exclude",
        exclude.length > 0 ? exclude.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-sections",
        sections.length > 0 ? sections.join(",") : ""
      );
      summaryContainer.setAttribute(
        "codeblock-max",
        max
      );
      summaryContainer.setAttribute(
        "codeblock-code",
        mdSource
      );
      element.replaceWith(summaryContainer);
    } else {
      this.createEmpty(
        element,
        tags ? tags : [],
        include ? include : [],
        exclude ? exclude : [],
        sections ? sections : [],
        max ? max : [],
        "",
        mdSource
      );
    }
  }
  update(summaryEl) {
    const tagsStr = summaryEl.getAttribute(
      "codeblock-tags"
    );
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = summaryEl.getAttribute(
      "codeblock-tags-include"
    );
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    const tagsExcludeStr = summaryEl.getAttribute(
      "codeblock-tags-exclude"
    );
    const tagsExclude = tagsExcludeStr ? tagsExcludeStr.split(",") : [];
    const sectionsStr = summaryEl.getAttribute(
      "codeblock-sections"
    );
    const sections = sectionsStr ? sectionsStr.split(",") : [];
    const max = Number(summaryEl.getAttribute(
      "codeblock-max"
    ));
    const mdSource = summaryEl.getAttribute(
      "codeblock-code"
    );
    this.create(
      summaryEl,
      tags,
      tagsInclude,
      tagsExclude,
      sections,
      max,
      "",
      mdSource
    );
  }
  // Not factored yet
  async copyTextToSection(text, section, filePath, addLink = true, selectedFile, detectPrefix = true) {
    const file = selectedFile ? selectedFile : await this.app.workspace.getActiveFile();
    let fileContent = await this.app.vault.read(file);
    const fileContentLines = getLinesInString(fileContent);
    const mdHeadings = getMarkdownHeadings(fileContentLines);
    let targetLine;
    if (mdHeadings.length <= 0 || section == "end" || section == "top") {
      if (section == "top") {
        targetLine = findFirstLineAfterFrontMatter(fileContent);
        if (targetLine == 0)
          fileContent = "\n" + fileContent;
      } else if (section == "end") {
        targetLine = fileContentLines.length - 1;
      }
    } else if (mdHeadings.length > 0) {
      const headingObj = mdHeadings.find((heading) => heading.text.trim() === section);
      if (headingObj) {
        targetLine = headingObj.line;
      } else {
        new import_obsidian7.Notice(`${section} not found.`);
        return false;
      }
    }
    const linePrefix = detectPrefix ? getListTypeFromLineNumber(fileContent, targetLine + 1) : "";
    let finalText;
    if (addLink)
      finalText = linePrefix + text + ` [[${filePath}|\u{1F517}]]`;
    else
      finalText = linePrefix + text;
    let newContent = insertTextAfterLine(finalText, fileContent, targetLine);
    await this.app.vault.modify(file, newContent);
    return true;
  }
  async readFiles(listFiles) {
    let list = [];
    for (let t = 0; t < listFiles.length; t += 1) {
      const file = listFiles[t];
      let content = await this.app.vault.cachedRead(file);
      list.push([file, content]);
    }
    return list;
  }
  isValidText(listTags, tags, include, exclude) {
    let valid = true;
    if (tags.length > 0) {
      valid = valid && tags.some((value) => listTags.includes(value));
    }
    if (include.length > 0) {
      valid = valid && include.every((value) => listTags.includes(value));
    }
    if (valid && exclude.length > 0) {
      valid = !exclude.some((value) => listTags.includes(value));
    }
    return valid;
  }
  static getTagsToCheckFromEl(tagSummaryEl) {
    const tagsStr = tagSummaryEl.getAttribute("codeblock-tags");
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = tagSummaryEl.getAttribute("codeblock-tags-include");
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    return tags.concat(tagsInclude);
  }
  async getFile(el) {
    const filePath = el.getAttribute("file-source");
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    return file;
  }
  updateSelection(index, bool) {
    if (bool) {
      if (!this.selectedBlocks.includes(index)) {
        this.selectedBlocks.push(index);
      }
    } else {
      this.selectedBlocks = this.selectedBlocks.filter((itemIndex) => itemIndex !== index);
    }
  }
  getSelectedMarkdownBlocks() {
  }
};
TagSummary.fileSummaries = /* @__PURE__ */ new Map();
var TempComponent = class extends import_obsidian7.Component {
  constructor() {
    super(...arguments);
    this.doNotPostProcess = true;
  }
  onload() {
  }
  onunload() {
  }
};

// TagProcessor.ts
var import_obsidian8 = require("obsidian");
var TagProcessor = class {
  constructor(app2, plugin) {
    this.outOfSync = false;
    this.app = app2;
    this.plugin = plugin;
    this.debouncedProcessActiveFileTagEls = (0, import_obsidian8.debounce)(this.processActiveFileTags.bind(this), 500);
    this.debouncedProcessActiveFileTagEls();
  }
  reset() {
    this.outOfSync = false;
  }
  filterActiveFileTagEls(tags) {
    const filteredTagElements = Array.from(tags).filter((tag) => {
      if (tag.closest(".frontmatter-section-data"))
        return false;
      if (tag.parentElement.closest(".markdown-embed"))
        return false;
      if (tag.closest(".markdown-embed"))
        return false;
      if (tag.parentElement.closest(".tag-summary-block"))
        return false;
      return true;
    });
    return filteredTagElements;
  }
  async renderPostProcessor(el, ctx) {
    const processingFile = this.app.vault.getAbstractFileByPath(ctx.sourcePath);
    const activeFile = this.app.workspace.getActiveFile();
    const activeFilePath = activeFile == null ? void 0 : activeFile.path;
    const nativeEmbedEl = el.querySelector(".internal-embed");
    const tags = el.querySelectorAll(".tag");
    if (nativeEmbedEl && ctx.sourcePath == activeFilePath || ctx.sourcePath == activeFilePath && tags.length > 0 || el.classList.contains("tag-summary-paragraph")) {
    } else {
      return;
    }
    if (nativeEmbedEl) {
      let nativeEmbedObserver;
      nativeEmbedObserver = new MutationObserver((mutationsList) => {
        const target = mutationsList[0].target;
        if (target.querySelectorAll(".tag").length > 0) {
          nativeEmbedObserver.disconnect();
          this.processNativeEmbed(target);
        }
      });
      nativeEmbedObserver.observe(nativeEmbedEl, { childList: true, subtree: true });
    }
    if (el.classList.contains("tag-summary-paragraph")) {
      this.processTagSummaryParagraph(el);
      return;
    }
    this.debouncedProcessActiveFileTagEls();
  }
  async processActiveFileTags() {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processing active file tags");
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian8.MarkdownView);
    const mode = view == null ? void 0 : view.getMode();
    if (mode == "preview") {
      const activeFile = await this.app.workspace.getActiveFile();
      const fileContent = await this.app.vault.read(activeFile);
      const sections = view.currentMode.renderer.sections;
      const activeFileTagEls = [];
      const activeFileTags = await this.getMarkdownTags(
        activeFile,
        fileContent
      );
      sections.forEach((section) => {
        Array.from(section.el.querySelectorAll(".tag")).forEach((tag) => {
          activeFileTagEls.push(tag);
        });
      });
      const filteredTagElements = this.filterActiveFileTagEls(activeFileTagEls);
      if (filteredTagElements.length > 0) {
        this.assignMarkdownTags(
          activeFileTags,
          filteredTagElements,
          0,
          //startIndex,
          "active"
        );
      }
    }
  }
  async processTagSummaryParagraph(paragraphEl2) {
    const filePath = paragraphEl2.getAttribute("file-source");
    const markdownBlock = paragraphEl2.getAttribute("md-source").trim();
    const file = await this.app.vault.getAbstractFileByPath(filePath);
    const fileContent = await this.app.vault.read(file);
    const startIndex = fileContent.indexOf(markdownBlock);
    const mdTags = this.getMarkdownTags(
      file,
      fileContent
    );
    this.assignMarkdownTags(
      mdTags,
      paragraphEl2.querySelectorAll(".tag"),
      startIndex,
      "plugin-summary"
    );
  }
  /*
  	// adapt this method to use the cache tag info (line, offset, etc)
  	getMarkdownTags (
  		file: TFile,  
  		fileContent: string 
  	): Array {
  
  		const tagPositions = [];
  		let match;
  		// Obsidian tag spec: https://help.obsidian.md/Editing+and+formatting/Tags#Tag+format
  		//const regex = /(?:^|\s)#[^\s#]+|```/g; // BUG: wrong match.index. matches the space before the tag.
  		//const regex = /(?<=^|\s)#[^\s#]+|```/g // FIX. But still matching punctuation after
  		//const regex = /(?<=^|\s)(#[^\s#.,;!?:]+)(?=[.,;!?:\s]|$)|```/g  // matches punctuation after, but not included in the match
  		//const regex = /(?<=^|\s)(#[^\s#.,;!?:]+)(?=[.,;!?:\s]|$)|(?<!`)```(?!`)/g; // Fix for matching ```` 
  		//const regex = /(?<=^|\s)(#[^\s#.',;!?:]+)(?=[.,;!?:'\s]|$)|(?<!`)```(?!`)/g; // Fix for matching but excluding ''s' in '#tag's'
  		const regex = /(?<=^|\s)(#(?=[^\s#.'â€™,;!?:]*[^\d\s#.'â€™,;!?:])[^\s#.'â€™,;!?:]+)(?=[.,;!?:'â€™\s]|$)|(?<!`)```(?!`)/g; // fix for number-only and typographic apostrophy's
  
  
  
  		let insideCodeBlock = false;
  
  		while ((match = regex.exec(fileContent)) !== null) {
  		    if (match[0].trim() === "```") {
  		        insideCodeBlock = !insideCodeBlock; 
  		        continue; // Reject if tag in a code block
  		    }	    
  		    if (insideCodeBlock) continue;
  		    const tag = match[0].trim();
  		    tagPositions.push({tag:tag, index:match.index, source:file.name}); 
  //console.log(tag)
  		}
  		return tagPositions;
  	}
  */
  getMarkdownTags(file, fileContent) {
    const tagPositions = [];
    const processedPositions = /* @__PURE__ */ new Set();
    let match;
    const regex = /(?<=^|\s)(#(?=[^\s#.'â€™,;!?:]*[^\d\s#.'â€™,;!?:])[^\s#.'â€™,;!?:]+)(?=[.,;!?:'â€™\s]|$)|(?<!`)```(?!`)/g;
    let currentContext = "normal";
    let insideCodeBlock = false;
    let invalidBlockquote = false;
    while ((match = regex.exec(fileContent)) !== null) {
      const matchedString = match[0].trim();
      const matchIndex = match.index;
      if (processedPositions.has(matchIndex)) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping duplicate tag at position ${matchIndex}: ${matchedString}`);
        continue;
      }
      if (matchedString === "```") {
        insideCodeBlock = !insideCodeBlock;
        if (this.plugin.settings.debugMode)
          console.log(`Toggled insideCodeBlock to ${insideCodeBlock}`);
        continue;
      }
      if (insideCodeBlock) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping tag ${matchedString} inside code block.`);
        continue;
      }
      const lineStart = fileContent.lastIndexOf("\n", matchIndex) + 1;
      const lineEnd = fileContent.indexOf("\n", matchIndex);
      const line = fileContent.slice(lineStart, lineEnd !== -1 ? lineEnd : void 0);
      if (line.trim().startsWith(">")) {
        currentContext = "blockquote";
        if (line.startsWith("> 	") || line.startsWith(">	") || line.includes("(not a tag)")) {
          invalidBlockquote = true;
          if (this.plugin.settings.debugMode)
            console.log(`Invalid blockquote triggered at line: ${fileContent.substring(0, matchIndex).split("\n").length}`);
        }
      } else if (line.trim().startsWith("-") || line.trim().match(/^\d+\./)) {
        currentContext = "list";
        invalidBlockquote = false;
      } else if (line.startsWith("	")) {
        currentContext = "indented";
        invalidBlockquote = false;
      } else {
        currentContext = "normal";
        invalidBlockquote = false;
      }
      if (this.plugin.settings.debugMode)
        console.log(`Line ${fileContent.substring(0, matchIndex).split("\n").length}: ${currentContext} - ${line.trim()}`);
      if (invalidBlockquote) {
        if (this.plugin.settings.debugMode)
          console.log(`Skipping tag ${matchedString} due to invalid blockquote context.`);
        continue;
      }
      const isValid = currentContext !== "indented" && // Exclude lines starting with tabs
      !(currentContext === "list" && line.includes("(not a tag)")) && // Exclude invalid list tags
      !(currentContext === "blockquote" && invalidBlockquote);
      if (isValid) {
        tagPositions.push({
          tag: matchedString,
          index: matchIndex,
          source: file.name,
          context: currentContext,
          line: fileContent.substring(0, matchIndex).split("\n").length
          // Calculate line number
        });
        if (this.plugin.settings.debugMode)
          console.log(`Found tag: ${matchedString} in context: ${currentContext}`);
        processedPositions.add(matchIndex);
      } else {
        if (this.plugin.settings.debugMode)
          console.log(`Excluded tag: ${matchedString} in invalid context: ${currentContext}`);
      }
    }
    return tagPositions;
  }
  async assignMarkdownTags(tagPositions, tagElements, startIndex, type) {
    if (type == "active") {
      if (this.plugin.settings.debugMode) {
        const activeFilePath = this.app.workspace.getActiveFile().path;
        console.log(tagPositions.length, tagElements.length);
        const temp1 = [];
        tagPositions.forEach((nodeObj) => {
          temp1.push(nodeObj.tag);
        });
        const temp2 = [];
        tagElements.forEach((nodeObj) => {
          temp2.push(nodeObj.innerText);
        });
        console.log(temp1, temp2);
      }
      if (tagPositions.length != tagElements.length) {
        this.outOfSync = true;
        new import_obsidian8.Notice("Tag Buddy: Markdown source and preview tags out of sync. Try refreshing this summary. Then check for tag syntax errors or conflicts in metadata. Please report if this error persists.", 1e4);
        if (this.plugin.settings.debugMode)
          this.logDifferences(tagPositions, tagElements);
        return;
      }
    }
    let tagEl2;
    const tagElArray = Array.from(tagElements);
    let tagElIndex = 0;
    let tagPos;
    for (let i = 0; i < tagPositions.length; i++) {
      tagPos = tagPositions[i];
      if (tagPos.index >= startIndex) {
        tagEl2 = tagElArray[tagElIndex];
        if (tagEl2) {
          if (tagEl2.innerText.trim() == tagPos.tag.trim()) {
            tagEl2.setAttribute("md-index", tagPos.index);
            tagEl2.setAttribute("file-source", tagPos.source);
            tagEl2.setAttribute("type", type);
            tagEl2.setAttribute("pos", i);
            tagElIndex++;
          } else {
            this.outOfSync = true;
            new import_obsidian8.Notice("Tag Buddy: Markdown source and preview tags out of sync. Try refreshing this summary. Then check for tag syntax errors or conflicts in metadata. Please report if this error persists.");
            this.logDifferences(tagPositions, tagElements);
            return;
          }
        }
      }
    }
    ;
    return tagElArray;
  }
  async processNativeEmbed(embed, checkDuplicates = false) {
    if (this.plugin.settings.debugMode)
      console.log("Tag Buddy: processNativeEmbed");
    embed = embed.closest(".markdown-embed");
    if (embed == null ? void 0 : embed.getAttribute("src")) {
      const linkElement = embed.getAttribute("src");
      let filePath = embed.getAttribute("src");
      const linkArray = filePath.split("#");
      const hasAnchorLink = linkArray.length > 1;
      let anchorLinkType = "";
      let anchorLink;
      if (hasAnchorLink) {
        anchorLink = linkArray[1];
        anchorLinkType = anchorLink.startsWith("^") ? "block" : "header";
      }
      filePath = linkArray[0].trim() + ".md";
      const file = await validateFilePath(filePath);
      if (file) {
        const fileContent = await this.app.vault.read(file);
        const embededTagFile = await this.getMarkdownTags(file, fileContent);
        if (hasAnchorLink && anchorLinkType != "") {
          if (anchorLinkType == "header" && !fileContainsHeading(fileContent, anchorLink)) {
            embed.setAttribute("embed-success", "false");
            return;
          } else {
            embed.setAttribute("embed-success", "true");
          }
        }
        const tempComponent = new TempComponent2();
        const tempContainerHTML = createEl("div");
        await import_obsidian8.MarkdownRenderer.renderMarkdown(
          fileContent,
          tempContainerHTML,
          "noFile",
          //file.path, 
          tempComponent
        );
        const innerText = await embed.querySelector(".markdown-embed-content").innerText;
        const startIndex = tempContainerHTML.innerText.indexOf(innerText);
        this.assignMarkdownTags(
          embededTagFile,
          embed.querySelectorAll(".tag"),
          startIndex,
          "native-embed"
        );
      }
    }
  }
  logDifferences(tagPositions, tagElements) {
    const tags = tagPositions.map((item) => item.tag);
    const innerTexts1 = tagElements.map((item) => item.innerText);
    let uniqueToTagPositions = [];
    let uniqueToTagElements = [];
    const findUnique = (arr1, arr2) => {
      return arr1.filter((item) => !arr2.includes(item));
    };
    uniqueToTagPositions = findUnique(tags, innerTexts1);
    uniqueToTagElements = findUnique(innerTexts1, tags);
    console.log("differences:", uniqueToTagPositions.length, uniqueToTagElements.length);
    if (uniqueToTagPositions.length) {
      console.log("Unique to tagPositions based on tag:", uniqueToTagPositions);
    }
    if (uniqueToTagElements.length) {
      console.log("Unique to tagElements based on innerText:", uniqueToTagElements);
    }
  }
};
var TempComponent2 = class extends import_obsidian8.Component {
  onload() {
  }
  onunload() {
  }
};

// ReadingModeTagEditor.ts
var import_obsidian9 = require("obsidian");
var ReadingModeTagEditor = class {
  constructor(app2, plugin) {
    this.app = app2;
    this.plugin = plugin;
  }
  //async renameTag (tag, newName, batchAction: string | number, specificFile:TFile = null) {
  async renameTag(tag, newName, batchAction, filePath = null, tagEl2) {
    const activeFile = await this.app.workspace.getActiveFile();
    const file = filePath == null ? activeFile : await validateFilePath(filePath);
    if (!file)
      return;
    const fileContent = await this.app.vault.read(file);
    if (typeof batchAction === "number") {
      const newFileContent = this.renameTagInStringByIndex(
        tag,
        newName,
        parseInt(batchAction),
        fileContent
      );
      this.app.vault.modify(file, newFileContent);
    } else if (batchAction == "note") {
      this.renameTagsInFileByIndex(
        tag,
        newName,
        file
      );
    } else if (batchAction == "vault") {
      this.renameTagsInVaultByIndex(
        tag,
        newName
      );
    }
    if (activeFile != file && tagEl2) {
      new import_obsidian9.Notice("Refresh this summary to see changes.", 5e3);
    }
  }
  async renameTagsInVaultByIndex(tag, newName) {
    const validTags = [tag];
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian9.getAllTags)(cache);
      if (validTags.some((value) => tagsInFile == null ? void 0 : tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    let listContents = await this.plugin.tagSummary.readFiles(listFiles);
    listContents.forEach(async (note) => {
      this.renameTagsInFileByIndex(
        tag,
        newName,
        note[0]
      );
    });
  }
  async renameTagsInFileByIndex(tag, newName, file) {
    const fileContent = await this.app.vault.read(file);
    let newFileContent = fileContent;
    const tagPositions = this.plugin.tagProcessor.getMarkdownTags(file, fileContent);
    let filteredTagObjs = tagPositions.filter((tagObj) => tagObj.tag === tag);
    if (filteredTagObjs.length > 0) {
      filteredTagObjs.sort((a, b) => a.index - b.index);
      let offset = 0;
      filteredTagObjs.forEach((tagObj) => {
        const newIndex = tagObj.index + offset;
        newFileContent = newFileContent.substring(0, newIndex) + newName + newFileContent.substring(newIndex + tagObj.tag.length);
        offset += newName.length - tagObj.tag.length;
      });
      this.app.vault.modify(file, newFileContent);
    } else {
    }
  }
  renameTagInStringByIndex(tag, newName, index, fileContent) {
    const newContent = fileContent.substring(0, parseInt(index)) + newName + fileContent.substring(parseInt(index) + parseInt(tag.length));
    return newContent;
  }
  async add(tag, x, y) {
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy add " + tag + " at (" + x + ", " + y + ")");
    }
    let fileContent;
    let file;
    const clickedTextObj = getClickedTextObjFromDoc(x, y);
    const clickedText = clickedTextObj == null ? void 0 : clickedTextObj.text;
    const clickedTextIndex = clickedTextObj == null ? void 0 : clickedTextObj.index;
    const clickedTextEl = clickedTextObj == null ? void 0 : clickedTextObj.el;
    let contentSourceType = null;
    let summaryEl = void 0;
    let embedEl = void 0;
    if (clickedTextObj) {
      try {
        summaryEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".tag-summary-paragraph");
        embedEl = clickedTextEl == null ? void 0 : clickedTextEl.closest(".markdown-embed");
      } catch (e) {
      }
      if (summaryEl) {
        file = await this.plugin.tagSummary.getFile(summaryEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "plugin-summary";
      } else if (embedEl) {
        file = await getEmbedFile(embedEl);
        fileContent = await this.app.vault.read(file);
        contentSourceType = "native-embed";
      } else {
        file = await this.app.workspace.getActiveFile();
        fileContent = await this.app.vault.read(file);
        contentSourceType = "active";
      }
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (clickedText) {
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag.\nTry a different text area.");
      return;
    }
    const escapedClickedText = escapeRegExp(clickedText);
    const regex = new RegExp(escapedClickedText, "g");
    const matches = fileContent.match(regex);
    if (matches && matches.length > 1) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't add tag: Clicked text repeated in note. Try a another text block.");
      return;
    } else if (matches && matches.length === 0 || !matches) {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find text position or area too busy.\nTry a another text area.");
      return;
    }
    if (!this.plugin.settings.lockRecentTags)
      this.plugin.saveRecentTag(tag);
    const startIndex = regex.exec(fileContent).index;
    const endIndex = startIndex + clickedText.length;
    const clickedWordObj = getWordObjFromString(clickedText, clickedTextIndex);
    const clickedWord = clickedWordObj.text;
    const clickedWordIndex = clickedWordObj.index;
    let newContent;
    if (clickedWord) {
      if (isWordNearEnd(clickedText, clickedWord))
        newContent = insertTextInString(" " + tag, fileContent, endIndex);
      else
        newContent = insertTextInString(tag, fileContent, startIndex + clickedWordIndex);
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't find clicked word.\nPlease try again.");
      return;
    }
    await this.app.vault.modify(file, newContent);
    if (contentSourceType == "plugin-summary") {
      const summaryContainer = summaryEl.closest(".tag-summary-block");
      this.plugin.tagSummary.update(summaryContainer);
    } else if (contentSourceType == "native-embed") {
      setTimeout(async () => {
        this.plugin.tagProcessor.processNativeEmbed(embedEl, true);
      }, 200);
    }
  }
  async edit(tagEl2, event, pragraphEl, editType, newName) {
    let tagContainer;
    const tagContainerType = tagEl2.getAttribute(
      "type"
    );
    const index = tagEl2.getAttribute(
      "md-index"
    );
    const filePath = tagEl2.getAttribute(
      "file-source"
    );
    if (this.plugin.settings.debugMode) {
      console.log("Tag Buddy edit tag: " + tagEl2.innerText + "\nIn file: " + filePath);
    }
    if (tagContainerType == "native-embed")
      tagContainer = tagEl2.closest(".markdown-embed");
    else if (tagContainerType == "plugin-summary")
      tagContainer = tagEl2.closest(".tag-summary-paragraph");
    else
      tagContainer = this.app.workspace.activeLeaf.containerEl.querySelector(".markdown-reading-view");
    if (filePath) {
      const file = await validateFilePath(filePath);
      let fileContent;
      let fileContentBackup;
      const tag = tagEl2.innerText.trim();
      try {
        fileContent = await this.app.vault.read(file);
        fileContentBackup = fileContent;
      } catch (error) {
        new import_obsidian9.Notice("Tag Buddy file read error:\n" + error.message);
        return;
      }
      let safeToEmptyFile = false;
      const tagRegex = /^\s*#(\w+)\s*$/;
      if (tagRegex.test(fileContent.trim())) {
        safeToEmptyFile = true;
      }
      let beforeTag = fileContent.substring(0, index);
      let afterTag = fileContent.substring(
        Number(index) + Number(tag.length)
      );
      let afterTagChr = "";
      if (fileContent[index] === "\n")
        beforeTag += "\n";
      let newContent = "";
      if (editType == "rename") {
      } else if (!event) {
        newContent = beforeTag + afterTagChr + afterTag;
      } else if (editType == "hash") {
        const noHash = tag.substring(1);
        newContent = beforeTag + noHash + afterTagChr + afterTag;
        if (this.app.isMobile && this.plugin.settings.mobileNotices) {
          new import_obsidian9.Notice("Tag Buddy: " + tag + " converted to text.");
        }
      } else if (event.type == "touchend" || this.plugin.settings.mobileTagSearch || editType == "remove") {
        let parentTag = "";
        if (tag.includes("/")) {
          let parts = tag.split("/");
          const removedChild = parts.pop();
          parentTag = parts.join("/");
          newContent = beforeTag + parentTag + afterTagChr + afterTag;
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: '" + removedChild + "' removed from parent tag.");
          }
        } else {
          const startsWithPunctuation = /^[.,!:?;]/.test(afterTag.trimStart()[0]);
          if (beforeTag.endsWith(" ") && afterTag.startsWith(" ")) {
            newContent = beforeTag + afterTag.substring(1);
          } else if (startsWithPunctuation) {
            newContent = beforeTag.trimEnd() + afterTag.trimStart();
          } else {
            newContent = beforeTag + afterTag;
          }
          if (this.app.isMobile && this.plugin.settings.mobileNotices) {
            new import_obsidian9.Notice("Tag Buddy: " + tag + " removed.");
          }
        }
      }
      if (tagEl2.getAttribute("type") == "plugin-summary") {
        const summaryEl = tagEl2.closest(".tag-summary-paragraph");
        const mdSource = summaryEl.getAttribute("md-source").trim();
        const escapedText = escapeRegExp(mdSource);
        const regex = new RegExp(escapedText, "g");
        const matches = fileContent.match(regex);
        if (matches && matches.length > 1) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't safely remove/edit tag:\nSurrounding text repeated in source note.");
          return;
        } else if (matches && matches.length === 0 || !matches) {
          new import_obsidian9.Notice("\u26A0\uFE0F Can't find tag in source note.\n");
          return;
        }
        if (newContent == "" && !safeToEmptyFile || contentChangedTooMuch(
          fileContentBackup,
          newContent,
          tag,
          2
        )) {
          new import_obsidian9.Notice("Tag Buddy: File change error.");
          newContent = fileContentBackup;
        } else if (newContent == "" && safeToEmptyFile) {
          new import_obsidian9.Notice("Tag Buddy: Tag removed. The note is empty.");
        }
        setTimeout(async () => {
          const tagParagraphEl = tagEl2.closest(".tag-summary-paragraph");
          const tagSummaryBlock = tagEl2.closest(".tag-summary-block");
          const tagsToCheck = TagSummary.getTagsToCheckFromEl(tagSummaryBlock);
          const tagsInContent = tagsInString(tagParagraphEl.innerText);
          if (tagsToCheck.includes(tag)) {
            const tagCount = countOccurrences(tagsToCheck, tagsInContent);
            if (tagCount >= 2) {
              this.plugin.tagSummary.update(tagSummaryBlock);
            } else {
              const notice = new import_obsidian9.Notice(tag + " removed from paragraph.\n\u{1F517} Open source note.", 5e3);
              this.plugin.gui.removeElementWithAnimation(
                tagParagraphEl,
                () => {
                  setTimeout(async () => {
                    this.plugin.tagSummary.update(tagSummaryBlock);
                    tagParagraphEl.remove();
                  }, 500);
                }
              );
              this.plugin.registerDomEvent(
                notice.noticeEl,
                "click",
                (e) => {
                  this.app.workspace.openLinkText(filePath, "");
                }
              );
            }
          } else {
            this.plugin.tagSummary.update(tagSummaryBlock);
          }
        }, 200);
      } else if (tagEl2.getAttribute("type") == "native-embed") {
        setTimeout(async () => {
          this.plugin.tagProcessor.processNativeEmbed(tagContainer, true);
        }, 200);
      }
      try {
        await this.app.vault.modify(file, newContent);
      } catch (error) {
        try {
          const backupFileName = String(file.name.substring(0, file.name.indexOf(".md")) + " BACKUP.md");
          this.app.vault.create(backupFileName, fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error.message + "\n" + backupFileName + " saved to vault root.", 1e4);
        } catch (error2) {
          navigator.clipboard.writeText(fileContentBackup);
          new import_obsidian9.Notice("\u26A0\uFE0F Tag/note editing error: " + error2.message + "\nNote content copied to clipboard.", 1e4);
        }
      }
      this.plugin.tagProcessor.debouncedProcessActiveFileTagEls();
    } else {
      new import_obsidian9.Notice("\u26A0\uFE0F Can't identify tag location. Please try again.");
    }
  }
};

// Mobile.ts
var DoubleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.callback(event);
    } else {
      this.timeout = setTimeout(() => {
        clearTimeout(this.timeout);
      }, 500);
    }
    this.lastTap = currentTime;
  }
};
var TripleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.tapCount = 0;
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchEnd(event) {
    const currentTime = (/* @__PURE__ */ new Date()).getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.tapCount++;
      if (this.tapCount === 2) {
        this.callback(event);
        this.tapCount = 0;
      }
    } else {
      this.tapCount = 0;
    }
    this.timeout = setTimeout(() => {
      clearTimeout(this.timeout);
      this.tapCount = 0;
    }, 500);
    this.lastTap = currentTime;
  }
};
var PressAndHoldHandler = class {
  constructor(plugin, element, callback, duration = 600) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.duration = duration;
    this.timeout = null;
    this.plugin.registerDomEvent(
      this.element,
      "touchstart",
      this.handleTouchStart.bind(this),
      true
    );
    this.plugin.registerDomEvent(
      this.element,
      "touchend",
      this.handleTouchEnd.bind(this),
      true
    );
  }
  handleTouchStart(event) {
    this.timeout = setTimeout(() => {
      this.callback(event);
      this.timeout = null;
    }, this.duration);
  }
  handleTouchEnd(event) {
    if (this.timeout) {
      clearTimeout(this.timeout);
      this.timeout = null;
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  removeOnClick: true,
  removeChildTagsFirst: true,
  optToConvert: true,
  mobileTagSearch: false,
  tagSummaryBlockButtons: false,
  taggedParagraphCopyPrefix: "",
  // new
  desktopClickTag: "remove",
  desktopCMDClickTag: "edit",
  desktopOPTClickTag: "native",
  mobileDoubleTapTag: "remove",
  mobileLongPressTag: "edit",
  mobileTripleTapText: true,
  removeTagBtn: "always",
  copyToCBBtn: "hide",
  moveToSectionBtn: "always",
  copyToSectionBtn: "always",
  copyLinkToSectionBtn: "hide",
  copyToNoteBtn: "always",
  mobileNotices: true,
  recentlyAddedTags: "",
  lockRecentTags: false,
  showSummaryButtons: false,
  debugMode: false
};
var TagBuddy = class extends import_obsidian10.Plugin {
  onunload() {
  }
  // this is needed for hotreload. Actual cleanup is done throughout.
  async onload() {
    console.log("Tag Buddy Plugin loaded on " + (this.app.isMobile ? "mobile at " : "desktop at ") + (/* @__PURE__ */ new Date()).toUTCString().substring(17));
    this.addSettingTab(new TBSettingsTab(this.app, this));
    await this.loadSettings();
    this.app.workspace.onLayoutReady(async () => {
      this.gui = new GUI(this.app, this);
      this.tagSummary = new TagSummary(this.app, this);
      this.tagProcessor = new TagProcessor(this.app, this);
      this.tagEditor = new ReadingModeTagEditor(this.app, this);
      this.registerMarkdownPostProcessor(
        this.tagProcessor.renderPostProcessor.bind(this.tagProcessor)
      );
      try {
        this.registerMarkdownCodeBlockProcessor(
          "tag-summary",
          this.tagSummary.codeBlockProcessor.bind(this.tagSummary)
        );
      } catch (e) {
      }
      this.registerDomEvent(
        document,
        "contextmenu",
        async (event) => {
          const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
          if (view && ctrlCmdKey(event) && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
            event.preventDefault();
            this.gui.showTagSelector(event);
          }
        }
      );
      this.registerEvent(this.app.on(
        "layout-change",
        async (event) => {
          var _a;
          const mode = (_a = this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView)) == null ? void 0 : _a.getMode();
          if (this.settings.debugMode)
            console.log("Tag Buddy: layout-change:", mode);
          if (mode == "preview") {
            this.tagProcessor.reset();
            this.tagProcessor.debouncedProcessActiveFileTagEls();
          } else if (mode == "source") {
          }
        }
      ));
      this.registerEvent(this.app.workspace.on(
        "file-open",
        //debounce(
        async (event) => {
          var _a, _b;
          const activeFile = await this.app.workspace.getActiveFile();
          if (this.settings.debugMode)
            console.log("Tag Buddy: last active file:", (_a = this.activeFile) == null ? void 0 : _a.name);
          if (this.settings.debugMode)
            console.log("Tag Buddy: file open:", activeFile == null ? void 0 : activeFile.name);
          if ((activeFile == null ? void 0 : activeFile.path) != ((_b = this.activeFile) == null ? void 0 : _b.path)) {
            this.tagProcessor.reset();
            this.activeFile = this.app.workspace.getActiveFile();
            if (this.tagProcessor) {
              this.tagProcessor.processActiveFileTags();
            }
          }
        }
        //, 3000, true)
      ));
      if (!this.app.isMobile) {
        this.registerDomEvent(
          document,
          "click",
          this.onClickEvent.bind(this),
          true
        );
      } else {
        this.registerDomEvent(
          document,
          "click",
          (e) => {
            const isTag = e.target.classList.contains("tag");
            const tag = e.target.closest(".tag");
            if (isTag && this.settings.mobileDoubleTapTag != "native") {
              e.stopPropagation();
            } else if (!isTag) {
            } else {
            }
          },
          true
        );
        new DoubleTapHandler(
          this,
          document,
          (event) => {
            if (event.target.classList.contains("tag")) {
              this.mobileTapHandler(event, this.settings.mobileDoubleTapTag);
            }
          },
          true
          //this.onClickEvent.bind(this)
        );
        new PressAndHoldHandler(
          this,
          document,
          (event) => {
            if (event.target.classList.contains("tag")) {
              this.mobileTapHandler(event, this.settings.mobileLongPressTag);
            }
          }
          /*async (event: MouseEvent) => {	
           			const view = await this.app.workspace.getActiveViewOfType(MarkdownView);
                 if (view && 
                 	(view.getMode() == 'preview') &&
                 	(view.containerEl.contains(event.target))
                	) {         
                 	event.preventDefault();
                 	this.gui.showTagEditor(event.target.closest('.tag').innerText)
                 }
           		}, true*/
          //(event) => {
          //	this.gui.showTagEditor(event.target.closest('.tag').innerText)
          //}
          //this.onClickEvent.bind(this)
        );
        new TripleTapHandler(
          this,
          document,
          async (event) => {
            const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
            if (view && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
              this.gui.showTagSelector(event);
            }
          },
          true
          //this.gui.showTagSelector.bind(this.gui)
        );
      }
    });
  }
  async mobileTapHandler(event, setting) {
    if (setting == "edit") {
      const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
      if (view && view.getMode() == "preview" && view.containerEl.contains(event.target)) {
        this.gui.showTagEditor(event.target.closest(".tag"));
      }
    } else if (setting == "remove") {
      this.tagEditor.edit(event.target, event, null, "remove");
    } else if (setting == "hash") {
      this.tagEditor.edit(event.target, event, null, "hash");
    }
  }
  async onClickEvent(event) {
    const target = event.target;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian10.MarkdownView);
    const modKey = ctrlCmdKey(event) ? "CMD" : event.altKey ? "OPT" : "";
    if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Unsupported view type. Try again within the source note.");
      return;
    }
    if (view) {
      if (view.getMode() != "preview" || !view.containerEl.contains(event.target))
        return;
    }
    if (!this.app.isMobile) {
      if (this.settings.desktopClickTag == "native" && modKey == "" || this.settings.desktopCMDClickTag == "native" && modKey == "CMD" || this.settings.desktopOPTClickTag == "native" && modKey == "OPT") {
        return;
      } else if (this.settings.desktopClickTag == "edit" && modKey == "" || this.settings.desktopCMDClickTag == "edit" && modKey == "CMD" || this.settings.desktopOPTClickTag == "edit" && modKey == "OPT") {
        if (!target.matches(".tag"))
          return;
        event.stopPropagation();
        event.preventDefault();
        this.gui.showTagEditor(event.target.closest(".tag"));
        return;
      }
    } else {
      setTimeout(() => {
        const selection = window.getSelection();
        if (selection)
          selection.removeAllRanges();
      }, 400);
      if (this.settings.mobileTagSearch && event.type == "touchend") {
        return;
      }
    }
    if (target && target.matches(".tag")) {
      if (this.tagProcessor.outOfSync) {
        new import_obsidian10.Notice("Markdown source and HTML tags are out of sync. Check for tag syntax errors.");
        return;
      }
      let editType;
      if (modKey == "")
        editType = this.settings.desktopClickTag;
      else if (modKey == "CMD")
        editType = this.settings.desktopCMDClickTag;
      else if (modKey == "OPT")
        editType = this.settings.desktopOPTClickTag;
      event.stopPropagation();
      event.preventDefault();
      const clickedTag = target.closest(".tag");
      const tag = clickedTag.innerText;
      let tagIndex = clickedTag.getAttribute("md-index");
      let tagFile = clickedTag.getAttribute("file-source");
      if (tagFile) {
        this.tagEditor.edit(
          target,
          event,
          null,
          editType
        );
      } else {
        setTimeout(async () => {
          tagIndex = clickedTag.getAttribute("md-index");
          tagFile = clickedTag.getAttribute("file-source");
          this.tagEditor.edit(
            target,
            event,
            null,
            editType
          );
        }, 300);
      }
    } else if (!view && target.matches(".tag")) {
      new import_obsidian10.Notice("Tag Buddy: Can't edit tag. Might be in an unsupported view type.");
    }
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  getTagsFromApp() {
    const tagsObject = this.app.metadataCache.getTags();
    const tagsArray = Object.entries(tagsObject);
    tagsArray.sort((a, b) => b[1] - a[1]);
    const recentTags = this.getRecentTags();
    if (recentTags.length > 0) {
      const recentTagsAsTuples = recentTags.map((tag) => [tag, 0]);
      const recentAndAllTags = recentTagsAsTuples.concat(tagsArray);
      return recentAndAllTags.map(([tag, _]) => tag.replace(/^#/, ""));
    } else {
      return tagsArray.map(([tag, _]) => tag.replace(/^#/, ""));
    }
  }
  saveRecentTag(tag) {
    if (isTagValid(tag, true)) {
      const recentTagsString = this.settings.recentlyAddedTags;
      let recentTags;
      if (recentTagsString == "") {
        recentTags = [];
      } else if (recentTagsString.indexOf(", ")) {
        recentTags = this.settings.recentlyAddedTags.split(", ");
      } else {
        recentTags = [this.settings.recentlyAddedTags];
      }
      if (recentTags.includes(tag)) {
        recentTags.splice(recentTags.indexOf(tag), 1);
      }
      recentTags.unshift(tag.trim());
      recentTags = recentTags.slice(0, 3);
      this.settings.recentlyAddedTags = recentTags.join(", ");
      this.saveSettings();
    } else {
    }
  }
  getRecentTags() {
    const recentTags = this.settings.recentlyAddedTags == "" ? [] : this.settings.recentlyAddedTags.split(", ");
    return recentTags;
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyIsICJndWkudHMiLCAidXRpbHMudHMiLCAiTW9kYWwudHMiLCAiVGFnRWRpdG9yTW9kYWwudHMiLCAiRmluZEZpbGVNb2RhbC50cyIsICJUYWdTdW1tYXJ5LnRzIiwgIlRhZ1Byb2Nlc3Nvci50cyIsICJSZWFkaW5nTW9kZVRhZ0VkaXRvci50cyIsICJNb2JpbGUudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IEFwcCwgRWRpdG9yLCBNYXJrZG93blJlbmRlcmVyLCBkZWJvdW5jZSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yLCBNYXJrZG93blBvc3RQcm9jZXNzb3JDb250ZXh0LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blByZXZpZXdWaWV3LCBNYXJrZG93blZpZXcsIE1vZGFsLCBOb3RpY2UsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IFRCU2V0dGluZ3NUYWIgfSBmcm9tIFwiLi9zZXR0aW5nc1wiO1xuaW1wb3J0IHsgR1VJIH0gZnJvbSBcIi4vZ3VpXCI7XG5pbXBvcnQgeyBUYWdTdW1tYXJ5IH0gZnJvbSAnLi9UYWdTdW1tYXJ5JztcbmltcG9ydCB7IFRhZ1Byb2Nlc3NvciB9IGZyb20gJy4vVGFnUHJvY2Vzc29yJztcbmltcG9ydCB7IFJlYWRpbmdNb2RlVGFnRWRpdG9yIH0gZnJvbSAnLi9SZWFkaW5nTW9kZVRhZ0VkaXRvcic7XG5pbXBvcnQgKiBhcyBVdGlscyBmcm9tICcuL3V0aWxzJztcbmltcG9ydCAqIGFzIE1vYmlsZSBmcm9tICcuL01vYmlsZSc7XG5cbmludGVyZmFjZSBUQlNldHRpbmdzIHtcblx0Ly9yZW1vdmVPbkNsaWNrOiBib29sZWFuOyAvLyBjdHJsXG5cdC8vcmVtb3ZlQ2hpbGRUYWdzRmlyc3Q7IC8vIFxuXHQvL29wdFRvQ29udmVydDogYm9vbGVhbjsgLy9hbHRcblx0Ly9tb2JpbGVUYWdTZWFyY2g6IGJvb2xlYW47IFxuXHQvL3RhZ1N1bW1hcnlCbG9ja0J1dHRvbnM6IGJvb2xlYW47IFxuXHQvL3RhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXg6IHN0cmluZztcblxuXG5cdC8vIG5ldyBzZXR0aW5nc1xuXHRkZXNrdG9wQ2xpY2tUYWc6IFN0cmluZztcblx0ZGVza3RvcENNRENsaWNrVGFnOiBTdHJpbmc7XG5cdGRlc2t0b3BPUFRDbGlja1RhZzogU3RyaW5nO1xuXHRtb2JpbGVEb3VibGVUYXBUYWc6IFN0cmluZztcblx0bW9iaWxlTG9uZ1ByZXNzVGFnOiBTdHJpbmc7XG5cdG1vYmlsZVRyaXBsZVRhcFRleHQ6IEJvb2xlYW47XG5cblx0cmVtb3ZlVGFnQnRuOiBTdHJpbmc7XG5cdGNvcHlUb0NCQnRuOiBTdHJpbmc7XG5cdG1vdmVUb1NlY3Rpb25CdG46IFN0cmluZztcblx0Y29weVRvU2VjdGlvbkJ0bjogU3RyaW5nO1xuXHRjb3B5TGlua1RvU2VjdGlvbkJ0bjogU3RyaW5nO1xuXHRjb3B5VG9Ob3RlQnRuOiBTdHJpbmc7XG5cblx0bW9iaWxlTm90aWNlczogYm9vbGVhbjsgXG5cdHJlY2VudGx5QWRkZWRUYWdzOiBzdHJpbmc7XG5cdGxvY2tSZWNlbnRUYWdzOiBib29sZWFuO1xuXHRzaG93U3VtbWFyeUJ1dHRvbnM6Ym9vbGVhbjtcblx0ZGVidWdNb2RlOiBib29sZWFuOyBcblxufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBQYXJ0aWFsPFRCU2V0dGluZ3M+ID0ge1xuXHRyZW1vdmVPbkNsaWNrOiB0cnVlLCBcblx0cmVtb3ZlQ2hpbGRUYWdzRmlyc3Q6IHRydWUsIFxuXHRvcHRUb0NvbnZlcnQ6IHRydWUsIFxuXHRtb2JpbGVUYWdTZWFyY2g6IGZhbHNlLCBcblx0dGFnU3VtbWFyeUJsb2NrQnV0dG9uczogZmFsc2UsXG5cdHRhZ2dlZFBhcmFncmFwaENvcHlQcmVmaXg6ICcnLFxuXG5cblx0Ly8gbmV3XG5cdGRlc2t0b3BDbGlja1RhZzogJ3JlbW92ZScsXG5cdGRlc2t0b3BDTURDbGlja1RhZzogJ2VkaXQnLFxuXHRkZXNrdG9wT1BUQ2xpY2tUYWc6ICduYXRpdmUnLFxuXHRtb2JpbGVEb3VibGVUYXBUYWc6ICdyZW1vdmUnLFxuXHRtb2JpbGVMb25nUHJlc3NUYWc6ICdlZGl0Jyxcblx0bW9iaWxlVHJpcGxlVGFwVGV4dDogdHJ1ZSxcblxuXHRyZW1vdmVUYWdCdG46ICdhbHdheXMnLFxuXHRjb3B5VG9DQkJ0bjogJ2hpZGUnLFxuXHRtb3ZlVG9TZWN0aW9uQnRuOiAnYWx3YXlzJyxcblx0Y29weVRvU2VjdGlvbkJ0bjogJ2Fsd2F5cycsXG5cdGNvcHlMaW5rVG9TZWN0aW9uQnRuOiAnaGlkZScsXG5cdGNvcHlUb05vdGVCdG46ICdhbHdheXMnLFxuXG5cdG1vYmlsZU5vdGljZXM6IHRydWUsXG5cdHJlY2VudGx5QWRkZWRUYWdzOiAnJyxcblx0bG9ja1JlY2VudFRhZ3M6IGZhbHNlLFxuXHRzaG93U3VtbWFyeUJ1dHRvbnM6ZmFsc2UsXG5cdGRlYnVnTW9kZTogZmFsc2Vcbn07IFxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUYWdCdWRkeSBleHRlbmRzIFBsdWdpbiB7ICBcblx0c2V0dGluZ3M6IFRCU2V0dGluZ3M7XG5cdGd1aTogR1VJO1xuXHR0YWdTdW1tYXJ5OiBUYWdTdW1tYXJ5O1xuXHR0YWdQcm9jZXNzb3I6IFRhZ1Byb2Nlc3Nvcjtcblx0dGFnRWRpdG9yOiBSZWFkaW5nTW9kZVRhZ0VkaXRvcjtcblx0cHJpdmF0ZSBhY3RpdmVGaWxlOiBURmlsZTtcblxuXHRvbnVubG9hZCgpIHsgfSAvLyB0aGlzIGlzIG5lZWRlZCBmb3IgaG90cmVsb2FkLiBBY3R1YWwgY2xlYW51cCBpcyBkb25lIHRocm91Z2hvdXQuXG5cblx0YXN5bmMgb25sb2FkKCkge1xuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgUGx1Z2luIGxvYWRlZCBvbiAnIFxuXHRcdFx0KyAodGhpcy5hcHAuaXNNb2JpbGUgPyAnbW9iaWxlIGF0ICc6J2Rlc2t0b3AgYXQgJykgXG5cdFx0XHQrIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKS5zdWJzdHJpbmcoMTcpKTtcblxuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgVEJTZXR0aW5nc1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHRcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblxuXHRcdFx0dGhpcy5ndWkgPSBuZXcgR1VJKHRoaXMuYXBwLCB0aGlzKVxuXHRcdFx0dGhpcy50YWdTdW1tYXJ5ID0gbmV3IFRhZ1N1bW1hcnkgKHRoaXMuYXBwLCB0aGlzKTtcblx0XHRcdHRoaXMudGFnUHJvY2Vzc29yID0gbmV3IFRhZ1Byb2Nlc3NvciAodGhpcy5hcHAsIHRoaXMpO1xuXHRcdFx0dGhpcy50YWdFZGl0b3IgPSBuZXcgUmVhZGluZ01vZGVUYWdFZGl0b3IgKHRoaXMuYXBwLCB0aGlzKTtcdFxuXG5cdFx0XHR0aGlzLnJlZ2lzdGVyTWFya2Rvd25Qb3N0UHJvY2Vzc29yKFxuXHRcdFx0dGhpcy50YWdQcm9jZXNzb3IucmVuZGVyUG9zdFByb2Nlc3Nvci5iaW5kKHRoaXMudGFnUHJvY2Vzc29yKVxuXHRcdFx0KVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFxuXHRcdFx0XHRcdCd0YWctc3VtbWFyeScsIFxuXHRcdFx0XHRcdHRoaXMudGFnU3VtbWFyeS5jb2RlQmxvY2tQcm9jZXNzb3IuYmluZCh0aGlzLnRhZ1N1bW1hcnkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9IGNhdGNoIHt9XG5cdFx0ICAgIFxuXHRcdCAgICAvL3RoaXMucmVnaXN0ZXJFdmVudCggdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCBhc3luYyAoKSA9PiB7IGNvbnNvbGUubG9nKCdhY3RpdmUgbGVhZiBjaGFuZ2UnKSB9KSk7XG5cdFx0ICAgIC8vdGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWNoYW5nZScsIGFzeW5jICgpID0+IHsgY29uc29sZS5sb2coJ2VkaXRvciBjaGFuZ2UnKTsgIH0sIHRydWUpKTtcblx0XHQgICAgLy90aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpKSk7XG5cdFx0ICAgIFxuXHRcdCAgICB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0ICAgIFx0ZG9jdW1lbnQsIFxuXHRcdCAgICBcdCdjb250ZXh0bWVudScsIFxuXHRcdCAgICBcdGFzeW5jIChldmVudDogTW91c2VFdmVudCkgPT4ge1x0XG5cdCAgICBcdFx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdCAgICAgICAgXG5cdFx0XHQgICAgICAgIGlmICh2aWV3ICYmIFxuXHRcdFx0ICAgICAgICBcdFV0aWxzLmN0cmxDbWRLZXkgKGV2ZW50KSAmJlxuXHRcdFx0ICAgICAgICBcdCh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmXG5cdFx0XHQgICAgICAgIFx0KHZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSlcblx0XHQgICAgICAgIFx0KSB7ICAgICAgICAgXG5cdFx0XHQgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0ICAgICAgICAgICAgLy90aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQucGFnZVgsIGV2ZW50LnBhZ2VZKTtcblx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHQgICAgICAgIH1cblx0XHQgICAgfSk7IFxuXHRcdCAgIFxuXHRcdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLm9uKFxuXHRcdFx0XHQnbGF5b3V0LWNoYW5nZScsIFxuXHRcdFx0XHRhc3luYyAoZXZlbnQ6IEVkaXRvckV2ZW50KSA9PiB7ICBcblx0XHRcdFx0XHRjb25zdCBtb2RlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uZ2V0TW9kZSgpO1xuXHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogbGF5b3V0LWNoYW5nZTonLCBtb2RlKTtcblx0XHRcdFx0XHRpZiAobW9kZSA9PSAncHJldmlldycpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnJlc2V0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLnRhZ1Byb2Nlc3Nvci5kZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VscygpO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnc291cmNlJykge1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0KSk7XG5cdFx0XHRcblx0XHRcdC8vZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKFxuXHRcdFx0XHQnZmlsZS1vcGVuJywgXG5cdFx0XHRcdC8vZGVib3VuY2UoXG5cdFx0XHRcdGFzeW5jIChldmVudDogRWRpdG9yRXZlbnQpID0+IHsgXG5cdFx0XHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBsYXN0IGFjdGl2ZSBmaWxlOicsIHRoaXMuYWN0aXZlRmlsZT8ubmFtZSk7XG5cdFx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBmaWxlIG9wZW46JywgYWN0aXZlRmlsZT8ubmFtZSlcblx0XHRcdFx0XHRpZiAoYWN0aXZlRmlsZT8ucGF0aCAhPSB0aGlzLmFjdGl2ZUZpbGU/LnBhdGgpIHtcblx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnJlc2V0KCk7XG5cdFx0XHRcdFx0XHR0aGlzLmFjdGl2ZUZpbGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdFx0XHRcdFx0aWYgKHRoaXMudGFnUHJvY2Vzc29yKSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMudGFnUHJvY2Vzc29yLnByb2Nlc3NBY3RpdmVGaWxlVGFncygpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZygnZmlsZSBvcGVuOicsIGFjdGl2ZUZpbGUubmFtZSlcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0fVxuXHRcdFx0XHQvLywgMzAwMCwgdHJ1ZSlcblx0XHRcdCkpO1xuXG5cdFx0XHQvLyBOb3QgZG9pbmcgdGhpcyBiZWNhdXNlIHRoZXkgbmVlZCB0byBvcHQrY2xpY2sgb24gYSB0YWcgdG8gcGFzcyBpdFxuXHRcdFx0Ly8gSSBkb24ndCB3YW50IHRvIGhhdmUgdG8gYWRkIGEgdGFnIHNlbGVjdG9yIGluIHRoZSBlZGl0b3Jcblx0XHRcdC8vIHRoaW5rIG9uIG1vYmlsZS4uLiB0b28gbWFueSBsYXllcnMgb2YgbW9kYWxzLlxuXHRcdFx0Lyp0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0XHRpZDogXCJ0YWdidWRkeS10YWctYWN0aW9uc1wiLFxuXHRcdFx0XHRuYW1lOiBcIlRhZyBBY3Rpb25cIixcblx0XHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0XHQvL3RoaXMuZ3VpLnNob3dUYWdFZGl0b3IoKVxuXHRcdFx0XHRcdHRoaXMuZ3VpLnNob3dUYWdFZGl0b3IoKVxuXHRcdFx0XHR9LFxuXHRcdFx0fSk7Ki9cblxuXHRcdFx0Ly90aGlzLnJlZ2lzdGVyRG9tRXZlbnQoZG9jdW1lbnQuYm9keSwgJ3Njcm9sbCcsIChldmVudCkgPT4ge30sIHRydWUpO1xuXG5cdFx0XHRpZiAoIXRoaXMuYXBwLmlzTW9iaWxlKSB7XG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgaGFuZGxlcyBhbGwgdGhlIGludGVyYWN0aW9ucyBvbiBkZXNrdG9wXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0J2NsaWNrJywgXG5cdFx0XHRcdFx0dGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSwgXG5cdFx0XHRcdFx0dHJ1ZVxuXHRcdFx0XHQpO1xuXHRcdFx0fSBlbHNlIHsgLy8gTW9iaWxlIGludGVyYWN0aW9uXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgY2F0Y2hlcyBhbGwgdGFwcyBvbiBtb2JpbGUgYmVjYXVzZSB3ZSBoYXZlIGN1c3RvbSBkb3VibGUtdGFwIGFuZCBwcmVzcy1ob2xkIGV2ZW50cy5cblx0XHRcdFx0Ly8gQnV0IHdlIG9ubHkgc3RvcCBhbGwgb3RoZXIgbW9iaWxlIGV2ZW50cyBpZiB0aGlzIGNsaWNrIHdhcyBvbiBhIHRhZy4gXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0J2NsaWNrJywgXG5cdFx0XHRcdFx0KGU6RXZlbnQpID0+IHsgXG5cdFx0XHRcdFx0XHRjb25zdCBpc1RhZyA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndGFnJyk7XG5cdFx0XHRcdFx0XHRjb25zdCB0YWcgPSBlLnRhcmdldC5jbG9zZXN0KCcudGFnJylcblx0XHRcdFx0XHRcdC8vdGFyZ2V0LmNsb3Nlc3QoJy50YWcnKVxuLy9uZXcgTm90aWNlIChpc1RhZylcdFx0XHRcdFx0XHRcbi8vbmV3IE5vdGljZSAodGFnLmlubmVyVGV4dClcbi8vbmV3IE5vdGljZSAodGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcpXG5cdFx0XHRcdFx0XHQvL2lmIChpc1RhZyAmJiAhdGhpcy5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2gpIHtcblx0XHRcdFx0XHRcdC8vaWYgKHRoaXMuc2V0dGluZ3MubW9iaWxlRG91YmxlVGFwVGFnID09ICduYXRpdmUnKSB7XG5cdFx0XHRcdFx0XHRpZiAoaXNUYWcgJiYgdGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcgIT0gJ25hdGl2ZScpIHtcblx0XHRcdFx0XHRcdC8vaWYgKGlzVGFnKSB7IFxuLy9uZXcgTm90aWNlIChpc1RhZylcdFx0XHRcdFx0XHRcbi8vbmV3IE5vdGljZSAodGFnLmlubmVyVGV4dClcbi8vbmV3IE5vdGljZSAodGhpcy5zZXR0aW5ncy5tb2JpbGVEb3VibGVUYXBUYWcpXG4vL25ldyBOb3RpY2UgKCdpcyB0YWcnKVxuXHRcdFx0XHRcdFx0Ly9pZiAoaXNUYWcgJiYgKHRoaXMuc2V0dGluZy5tb2JpbGVEb3VibGVUYXBUYWcgIT0gJ25hdGl2ZScvLyB8fFxuXHRcdFx0XHRcdFx0XHRcdFx0ICAvL3RoaXMucGx1Z2luLnNldHRpbmcubW9iaWxlTG9uZ1ByZXNzVGFnICE9ICduYXRpdmUnXG5cdFx0XHRcdFx0XHQvL1x0XHRcdCAgKSkge1xuXHRcdFx0XHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0XHQvL2UucHJldmVudERlZmF1bHQoKTtcblxuLy9uZXcgTm90aWNlICgndGFwcGVkIHRhZyBhbmQgc3RvcCBhbGwgb3RoZXIgbW9iaWxlIHRvdWNoZXMgZXhjZXB0IG91ciBjdXN0b20gb25lcycpXG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCFpc1RhZykge1xuXHRcdFx0XHRcdFx0XHQvL2UucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdFx0Ly9lLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRcdFx0XHQvL2Uuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0XHRcdC8vZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0sIHRydWVcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRcblx0XHRcdFx0bmV3IE1vYmlsZS5Eb3VibGVUYXBIYW5kbGVyKFxuXHRcdFx0XHRcdHRoaXMsIFxuXHRcdFx0XHRcdGRvY3VtZW50LCAgXG5cdFx0XHRcdFx0KGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHQvL25ldyBOb3RpY2UgKCdkb3VibGUgdGFwJylcblx0XHRcdFx0XHRcdC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0XHRcdGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWcnKSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vYmlsZVRhcEhhbmRsZXIgKGV2ZW50LCB0aGlzLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9LCB0cnVlXG5cdFx0XHRcdFx0Ly90aGlzLm9uQ2xpY2tFdmVudC5iaW5kKHRoaXMpXG5cdFx0XHRcdCk7XG5cdFx0XHRcdG5ldyBNb2JpbGUuUHJlc3NBbmRIb2xkSGFuZGxlcihcblx0XHRcdFx0XHR0aGlzLCBcblx0XHRcdFx0XHRkb2N1bWVudCwgXG5cdFx0XHRcdFx0KGV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0XHQvL25ldyBOb3RpY2UgKCdob2xkJylcblx0XHRcdFx0XHRcdGlmIChldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWcnKSkge1xuXHRcdFx0XHRcdFx0XHR0aGlzLm1vYmlsZVRhcEhhbmRsZXIgKGV2ZW50LCB0aGlzLnNldHRpbmdzLm1vYmlsZUxvbmdQcmVzc1RhZylcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Lyphc3luYyAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcdFxuXHRcdCAgICBcdFx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdFx0ICAgICAgICBpZiAodmlldyAmJiBcblx0XHRcdFx0ICAgICAgICBcdCh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmXG5cdFx0XHRcdCAgICAgICAgXHQodmlldy5jb250YWluZXJFbC5jb250YWlucyhldmVudC50YXJnZXQpKVxuXHRcdFx0ICAgICAgICBcdCkgeyAgICAgICAgIFxuXHRcdFx0XHQgICAgICAgIFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0ICAgICAgICBcdHRoaXMuZ3VpLnNob3dUYWdFZGl0b3IoZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJy50YWcnKS5pbm5lclRleHQpXG5cdFx0XHRcdCAgICAgICAgfVxuXHRcdCAgICBcdFx0fSwgdHJ1ZSovXG5cdFx0XHRcdFx0Ly8oZXZlbnQpID0+IHtcblx0XHRcdFx0XHQvL1x0dGhpcy5ndWkuc2hvd1RhZ0VkaXRvcihldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dClcblx0XHRcdFx0XHQvL31cblx0XHRcdFx0XHQvL3RoaXMub25DbGlja0V2ZW50LmJpbmQodGhpcylcblx0XHRcdFx0KTtcblx0XHRcdFx0bmV3IE1vYmlsZS5UcmlwbGVUYXBIYW5kbGVyKFxuXHRcdFx0XHRcdHRoaXMsXG5cdFx0XHRcdFx0ZG9jdW1lbnQsIFxuXHRcdFx0XHRcdGFzeW5jIChldmVudDogTW91c2VFdmVudCkgPT4ge1x0XG5cdFx0ICAgIFx0XHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0XHQgICAgICAgIGlmICh2aWV3ICYmIFxuXHRcdFx0XHQgICAgICAgIFx0KHZpZXcuZ2V0TW9kZSgpID09ICdwcmV2aWV3JykgJiZcblx0XHRcdFx0ICAgICAgICBcdCh2aWV3LmNvbnRhaW5lckVsLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpXG5cdFx0XHQgICAgICAgIFx0KSB7ICAgICAgICAgXG5cdFx0XHRcdCAgICAgICAgXHQvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRcdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnU2VsZWN0b3IoZXZlbnQpXG5cdFx0XHRcdCAgICAgICAgfVxuXHRcdCAgICBcdFx0fSwgdHJ1ZVxuXHRcdFx0XHRcdC8vdGhpcy5ndWkuc2hvd1RhZ1NlbGVjdG9yLmJpbmQodGhpcy5ndWkpXG5cdFx0XHRcdCk7XG5cdFx0XHR9XHRcblxuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgbW9iaWxlVGFwSGFuZGxlciAoZXZlbnQsIHNldHRpbmcpIHtcbi8vbmV3IE5vdGljZSAoc2V0dGluZylcblx0XHRpZiAoc2V0dGluZyA9PSAnZWRpdCcpIHtcblx0XHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQgICAgICAgIGlmICh2aWV3ICYmICh2aWV3LmdldE1vZGUoKSA9PSAncHJldmlldycpICYmICh2aWV3LmNvbnRhaW5lckVsLmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpKSBcblx0ICAgICAgICB7ICAgICAgICAgXG5cdCAgICAgICAgXHQvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICAgICAgXHQvL2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpXG5cdCAgICAgICAgXHR0aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykpXG5cdCAgICAgICAgfVxuXHRcdH0gZWxzZSBpZiAoc2V0dGluZyA9PSAncmVtb3ZlJykge1xuXHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdChldmVudC50YXJnZXQsIGV2ZW50LCBudWxsLCAncmVtb3ZlJylcblx0XHR9IGVsc2UgaWYgKHNldHRpbmcgPT0gJ2hhc2gnKSB7XG5cdFx0XHR0aGlzLnRhZ0VkaXRvci5lZGl0KGV2ZW50LnRhcmdldCwgZXZlbnQsIG51bGwsICdoYXNoJylcblx0XHR9XG5cdH1cblxuXHRhc3luYyBvbkNsaWNrRXZlbnQgKFxuXHRcdGV2ZW50OiBFdmVudFxuXHQpOnZvaWQge1xuXHRcdC8vIFN1cHBvcnQgZm9yIGRpZmZlcmVudCB2aWV3cz8gXG5cdFx0Ly8gSWYgdGFnIGhhcyBubyBjb250ZXh0IHByb3BlcnRpZXMsIHRoZW4gdHJ5IHRvIGZpZ3VyZSBvdXQgd2hlcmUgaXQgaXM/XG5cdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblxuXHRcdGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBtb2RLZXk6IFN0cmluZyA9IFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpID8gJ0NNRCcgOiAoZXZlbnQuYWx0S2V5ID8gJ09QVCcgOiAnJyk7XG5cblx0XHQvLyBUaGlzIGNvbmRpdGlvbiBpdCBpbiBjYXNlIHdlIGNsaWNrIG9uIGEgdGFnIGluIGFub3RoZXIgcGx1Z2luIGxpa2UgcmVwZWF0IG9yIGNoZWNrbGlzdFxuXHRcdC8vIENhbid0IGVkaXQgdGFncyBpbiB0aGVzZSBjYXNlcy4gRm9yIG5vdy5cblx0XHRpZiAoIXZpZXcgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkgeyBcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gVW5zdXBwb3J0ZWQgdmlldyB0eXBlLiBUcnkgYWdhaW4gd2l0aGluIHRoZSBzb3VyY2Ugbm90ZS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmlldykgeyBcblx0XHRcdGlmICh2aWV3LmdldE1vZGUoKSAhPSAncHJldmlldycgfHwgIXZpZXcuY29udGFpbmVyRWwuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkgcmV0dXJuO1xuXHRcdH0gXG5cdFxuXG5cdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblx0XHRcdC8vY29uc29sZS5sb2coZXZlbnQudHlwZSlcblx0XHRcdC8qaWYgKCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAnbmF0aXZlJyAmJiAoIVV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpICYmICFldmVudC5hbHRLZXkpKSB8fFxuXHRcdFx0XHQodGhpcy5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcgPT0gJ25hdGl2ZScgJiYgVXRpbHMuY3RybENtZEtleShldmVudCkpIHx8XG5cdFx0XHRcdCh0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyA9PSAnbmF0aXZlJyAmJiBldmVudC5hbHRLZXkpKSB7ICovXG5cdFx0XHRpZiAoKHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnJykgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnQ01EJykgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcE9QVENsaWNrVGFnID09ICduYXRpdmUnICYmIG1vZEtleSA9PSAnT1BUJykpIHsgXG4vL2NvbnNvbGUubG9nKCduYXRpdmUgdGFnIGNsaWNrJylcblx0XHRcdFx0cmV0dXJuOyBcbiBcblx0XHRcdC8vfSBlbHNlIGlmIChldmVudC5hbHRLZXkgJiYgdGFyZ2V0ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHsgIFxuXHRcdFx0Lyp9IGVsc2UgaWYgKCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAnZWRpdCcgJiYgKCFVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSAmJiAhZXZlbnQuYWx0S2V5KSkgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnID09ICdlZGl0JyAmJiBVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSkgfHxcblx0XHRcdFx0KHRoaXMuc2V0dGluZ3MuZGVza3RvcE9QVENsaWNrVGFnID09ICdlZGl0JyAmJiBldmVudC5hbHRLZXkpKSB7Ki9cblx0XHRcdH0gZWxzZSBpZiAoKHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID09ICdlZGl0JyAmJiBtb2RLZXkgPT0gJycpIHx8XG5cdFx0XHRcdCh0aGlzLnNldHRpbmdzLmRlc2t0b3BDTURDbGlja1RhZyA9PSAnZWRpdCcgJiYgbW9kS2V5ID09ICdDTUQnKSB8fFxuXHRcdFx0XHQodGhpcy5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcgPT0gJ2VkaXQnICYmIG1vZEtleSA9PSAnT1BUJykpIHtcblx0XHRcdFx0aWYgKCF0YXJnZXQubWF0Y2hlcygnLnRhZycpKSByZXR1cm5cbi8vY29uc29sZS5sb2coJ2VkaXQgdGFnJylcblx0XHRcdFx0Ly8gZ2V0IHRoZSB0YWcgdmlhOiBldmVudC50YXJnZXQuY2xvc2VzdCgnLnRhZycpLmlubmVyVGV4dFxuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdFx0Ly90aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykuaW5uZXJUZXh0KVxuXHRcdFx0XHR0aGlzLmd1aS5zaG93VGFnRWRpdG9yKGV2ZW50LnRhcmdldC5jbG9zZXN0KCcudGFnJykpXG5cdFx0XHRcblx0XHRcdFx0cmV0dXJuOyBcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdC8vIFJlbW92ZXMgdGhlIGF1dG9tYXRpYyBzeXN0ZW0gc2VsZWN0aW9uIG9uIG1vYmlsZS4gXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHsgXG5cdFx0XHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcblx0XHRcdFx0aWYgKHNlbGVjdGlvbikgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xuXHRcdFx0fSwgNDAwKVxuXG5cdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggJiYgZXZlbnQudHlwZSA9PSAndG91Y2hlbmQnKSB7XG5cdFx0XHRcdC8vIGlmIHdlIGdldCB0aGlzIGZhciwgdGhpcyBpcyBhIGRvdWJsZSB0YXBcblx0XHRcdFx0Ly9jb25zb2xlLmxvZygnaGFuZGxlIHRvdWNoIGVuZCcpXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH0gXG5cdFx0fVxuIFxuXHRcdGlmICh0YXJnZXQgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkge1x0XG5cdFx0XHQvLyBjb25zdCBzY3JvbGxTdGF0ZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk/LmN1cnJlbnRNb2RlPy5nZXRTY3JvbGwoKTtcblxuXHRcdFx0aWYgKHRoaXMudGFnUHJvY2Vzc29yLm91dE9mU3luYykge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdNYXJrZG93biBzb3VyY2UgYW5kIEhUTUwgdGFncyBhcmUgb3V0IG9mIHN5bmMuIENoZWNrIGZvciB0YWcgc3ludGF4IGVycm9ycy4nKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXG5cdFx0XHQvL2xldCBlZGl0VHlwZSA9IFxuXHRcdFx0Ly9pZiAodGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrIFxuXHRcdFx0Ly9cdHx8ICghdGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrICYmIFV0aWxzLmN0cmxDbWRLZXkoZXZlbnQpKSkge1xuXHRcdFx0Ly9bJ3JlbW92ZScsICdoYXNoJ10uaW5jbHVkZXModGhpcy5zZXR0aW5ncy5kZXNrdG9wQ2xpY2tUYWcpXG5cdFx0XHQvL2lmIChbdGhpcy5zZXR0aW5ncy5kZXNrdG9wQ2xpY2tUYWcsIHRoaXMuc2V0dGluZ3MuZGVza3RvcENNRENsaWNrVGFnLCB0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZ10uaW5jbHVkZXMoJ3JlbW92ZScpKVxuXHRcdFx0XG5cdFx0XHRsZXQgZWRpdFR5cGU7XG5cdFx0XHRpZiAobW9kS2V5ID09ICcnKSBlZGl0VHlwZSA9IHRoaXMuc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnXG5cdFx0XHRlbHNlIGlmIChtb2RLZXkgPT0gJ0NNRCcpIGVkaXRUeXBlID0gdGhpcy5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWdcblx0XHRcdGVsc2UgaWYgKG1vZEtleSA9PSAnT1BUJykgZWRpdFR5cGUgPSB0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyBcblxuLy8gYXQgdGhpcyBwb2ludCB3ZSBzaG91bGQgb25seSBiZSBkZWFsaW5nIHdpdGggJ3JlbW92ZScgb3IgJ2hhc2gnLiBzbyB3ZSBjYW4gYWx3YXlzIHN0b3AgdGhlIGRlZmF1bHQgbm93LlxuLy9jb25zb2xlLmxvZyAoZWRpdFR5cGUpXG5cdFx0XHQvKmlmICh0aGlzLnNldHRpbmdzLmRlc2t0b3BDbGlja1RhZyA9PSAncmVtb3ZlJyB8fFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmRlc2t0b3BDTURDbGlja1RhZyA9PSAncmVtb3ZlJyB8fFxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmRlc2t0b3BPUFRDbGlja1RhZyA9PSAncmVtb3ZlJykgeyovXG5cdFx0XHQvL2lmIChlZGl0VHlwZSA9PSAncmVtb3ZlJykge1xuXHRcdFx0XHRldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFx0ZXZlbnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdC8vfVxuXG5cdFx0XHRjb25zdCBjbGlja2VkVGFnID0gdGFyZ2V0LmNsb3Nlc3QoJy50YWcnKTsgXG5cdFx0XHRjb25zdCB0YWcgPSBjbGlja2VkVGFnLmlubmVyVGV4dDtcblxuXHRcdFx0bGV0IHRhZ0luZGV4ID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4Jyk7XG5cdFx0XHRsZXQgdGFnRmlsZSA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpO1xuXG5cdFx0XHRpZiAodGFnRmlsZSkge1xuXHRcdFx0XHQvLyBUcnlcblx0XHRcdFx0dGhpcy50YWdFZGl0b3IuZWRpdChcblx0XHRcdFx0XHR0YXJnZXQsIFxuXHRcdFx0XHRcdGV2ZW50LFxuXHRcdFx0XHRcdG51bGwsXG5cdFx0XHRcdFx0ZWRpdFR5cGVcblx0XHRcdFx0KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFRyeSBhZ2FpblxuXHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHR0YWdJbmRleCA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdtZC1pbmRleCcpO1xuXHRcdFx0XHRcdHRhZ0ZpbGUgPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKTtcblx0XHRcdFx0XHR0aGlzLnRhZ0VkaXRvci5lZGl0IChcblx0XHRcdFx0XHRcdHRhcmdldCwgXG5cdFx0XHRcdFx0XHRldmVudCxcblx0XHRcdFx0XHRcdG51bGwsXG5cdFx0XHRcdFx0XHRlZGl0VHlwZVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdH0sIDMwMCk7XG5cdFx0XHR9XG5cblx0XHR9IGVsc2UgaWYgKCF2aWV3ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHtcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gTWlnaHQgYmUgaW4gYW4gdW5zdXBwb3J0ZWQgdmlldyB0eXBlLicpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cdFxuXHRnZXRUYWdzRnJvbUFwcCgpOiBzdHJpbmdbXSB7XG5cdCAgICBjb25zdCB0YWdzT2JqZWN0ID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCk7XG5cblx0ICAgIC8vIENvbnZlcnQgdGFnc09iamVjdCB0byBhbiBhcnJheSBvZiBbdGFnLCBjb3VudF0gdHVwbGVzXG5cdCAgICBjb25zdCB0YWdzQXJyYXkgPSBPYmplY3QuZW50cmllcyh0YWdzT2JqZWN0KTtcblxuXHQgICAgLy8gU29ydCBieSB1c2UgY291bnRcblx0ICAgIHRhZ3NBcnJheS5zb3J0KChhLCBiKSA9PiBiWzFdIC0gYVsxXSk7XG5cblx0ICAgIGNvbnN0IHJlY2VudFRhZ3MgPSB0aGlzLmdldFJlY2VudFRhZ3MoKTtcblx0ICAgLy8gY29uc29sZS5sb2coJ3JlY2VudCB0YWcgbGVuZ3RoOiAnICsgcmVjZW50VGFncy5sZW5ndGgpXG5cblx0ICAgIGlmIChyZWNlbnRUYWdzLmxlbmd0aD4wKSB7XG5cdCAgICBcdC8vY29uc29sZS5sb2cocmVjZW50VGFncylcblx0ICAgIFx0Ly8gY29udmVydCB0aGVtIHRvIFt0YWcsIGNvdW50XSB0dXBsZXMgZm9yIGNvbnNpc3RlbmN5XG5cdCAgIFx0XHRjb25zdCByZWNlbnRUYWdzQXNUdXBsZXMgPSByZWNlbnRUYWdzLm1hcCh0YWcgPT4gW3RhZywgMF0pO1xuXHQgICAgXHQvLyBDb25jYXRlbmF0ZSB0aGUgdHdvIGFycmF5c1xuXHQgICAgXHRjb25zdCByZWNlbnRBbmRBbGxUYWdzID0gcmVjZW50VGFnc0FzVHVwbGVzLmNvbmNhdCh0YWdzQXJyYXkpO1xuXHQgICAgXHQvLyBFeHRyYWN0IHRhZyBuYW1lcyBhZnRlciByZW1vdmluZyB0aGUgI1xuXHQgICAgXHRyZXR1cm4gcmVjZW50QW5kQWxsVGFncy5tYXAoKFt0YWcsIF9dKSA9PiB0YWcucmVwbGFjZSgvXiMvLCBcIlwiKSk7XG4gICAgICAgXHR9IGVsc2Uge1xuICAgICAgIFx0XHRyZXR1cm4gdGFnc0FycmF5Lm1hcCgoW3RhZywgX10pID0+IHRhZy5yZXBsYWNlKC9eIy8sIFwiXCIpKTtcbiAgICAgICBcdH1cblx0fVxuXG5cdHNhdmVSZWNlbnRUYWcgKFxuXHRcdHRhZzpzdHJpbmdcblx0KTp2b2lkIHtcbi8vY29uc29sZS5sb2coJ3NhdmUgcmVjZW50IHRhZzonLCB0YWcpXG5cdFx0aWYgKFV0aWxzLmlzVGFnVmFsaWQodGFnLCB0cnVlKSkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnYWNjZXB0ZWQ6JywgdGFnKVxuLy9jb25zb2xlLmxvZyhcImFzZGZhc2RmYXNkZnNkZlwiKVxuXHRcdFx0Y29uc3QgcmVjZW50VGFnc1N0cmluZyA9IHRoaXMuc2V0dGluZ3MucmVjZW50bHlBZGRlZFRhZ3M7XG5cdFx0XHRsZXQgcmVjZW50VGFnczpBcnJheTtcblx0XHRcdGlmIChyZWNlbnRUYWdzU3RyaW5nID09ICcnKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSBbXTtcblx0XHRcdH0gZWxzZSBpZiAocmVjZW50VGFnc1N0cmluZy5pbmRleE9mKCcsICcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3MgPSB0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzLnNwbGl0KCcsICcpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0cmVjZW50VGFncyA9IFt0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzXVxuXHRcdFx0fVxuXG5cdFx0XHRpZiAocmVjZW50VGFncy5pbmNsdWRlcyh0YWcpKSB7XG5cdFx0XHRcdHJlY2VudFRhZ3Muc3BsaWNlKHJlY2VudFRhZ3MuaW5kZXhPZih0YWcpLCAxKTtcblx0XHRcdH1cblxuXHRcdFx0cmVjZW50VGFncy51bnNoaWZ0KHRhZy50cmltKCkpO1xuXHRcdFx0cmVjZW50VGFncyA9IHJlY2VudFRhZ3Muc2xpY2UoMCwgMyk7XG5cdFx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzID0gcmVjZW50VGFncy5qb2luKCcsICcpO1xuXHRcdFx0dGhpcy5zYXZlU2V0dGluZ3MoKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygncmVqZWN0ZWQ6JywgdGFnKVxuXHRcdH1cblx0fVxuXG5cdGdldFJlY2VudFRhZ3MgKCk6QXJyYXkge1xuXHRcdGNvbnN0IHJlY2VudFRhZ3MgPSBcblx0XHR0aGlzLnNldHRpbmdzLnJlY2VudGx5QWRkZWRUYWdzPT0nJyA/IFtdIDogdGhpcy5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncy5zcGxpdCgnLCAnKTtcblx0XHRyZXR1cm4gcmVjZW50VGFncztcblx0fVxufVxuIiwgImltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBUQlNldHRpbmdzVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5KSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuICAgIFxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpOyBcblxuXG4gICAgICAgIGZ1bmN0aW9uIGlzVmFsaWRUYWcodGFnKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdQYXR0ZXJuID0gL14jW1xcd10rJC87XG4gICAgICAgICAgICByZXR1cm4gdGFnUGF0dGVybi50ZXN0KHRhZyk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaWx0ZXJBbmRKb2luVGFncyh0YWdzU3RyaW5nKSB7XG4gICAgICAgICAgICBjb25zdCB0YWdzQXJyYXkgPSB0YWdzU3RyaW5nLnNwbGl0KFwiLCBcIik7XG4gICAgICAgICAgICBjb25zdCB2YWxpZFRhZ3MgPSB0YWdzQXJyYXkuZmlsdGVyKGlzVmFsaWRUYWcpO1xuICAgICAgICAgICAgcmV0dXJuIHZhbGlkVGFncy5qb2luKFwiLCBcIik7XG4gICAgICAgIH1cblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgzXCIsIHsgdGV4dDogXCJHZW5lcmFsXCIgfSk7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgLy8gQWRkaW5nIHdpbGwgYWx3YXlzIGxpbWl0IHRvIDMuIEJ1dCBpZiB0aGV5IGVkaXQgaXQgaGVyZSwgaXQgY2FuIGJlIGFueSBsZW5ndGguXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVGhlIG1vc3QgcmVjZW50IHRhZ3MgYWRkZWQgdmlhIFRhZyBCdWRkeSBhcmUgc3RvcmVkIGhlcmUuIFRoZXNlIHdpbGwgc2hvdyB1cCBmaXJzdCBpbiB0aGUgbGlzdCB3aGVuIGFkZGluZy5cIilcbiAgICAgICAgLmFkZFRleHQoKHRleHQpID0+IHtcbiAgICAgICAgICAgIHRleHRcbiAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcih0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncylcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZWNlbnRseUFkZGVkVGFncyA9IGZpbHRlckFuZEpvaW5UYWdzKHZhbHVlKTsgLy92YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJMb2NrIHJlY2VudCB0YWdzXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9OIHRvIGxvY2sgdGhlIHJlY2VudCB0YWdzIGxpc3QuIFJlY2VudCB0YWdzIHdpbGwgbm90IGJlIHVwZGF0ZWQuIEluc3RlYWQsIHRoZSB0YWdzIGFib3ZlIHdpbGwgYWN0IGxpa2UgYSBmYXZvcml0ZXMgbGlzdC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiRGVza3RvcFwiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWN0aW9uIHdoZW4gY2xpY2tpbmcgYSB0YWc6XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIldoYXQgc2hvdWxkIGhhcHBlbiB3aGVuIHlvdSBjbGljayBhIHRhZz9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3JlbW92ZScsIFwiUmVtb3ZlIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hhc2gnLCBcIlJlbW92ZSBoYXNoXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZWRpdCcsIFwiRWRpdCB0YWdcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCduYXRpdmUnLCBcIlNlYXJjaCB0YWdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVza3RvcENsaWNrVGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkFjdGlvbiB3aGVuIGNsaWNraW5nIGEgdGFnIHdpdGggQ01EL0NUUkwgbW9kaWZpZXIga2V5OlwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgQ01EIG9yIENUUkwga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbigncmVtb3ZlJywgXCJSZW1vdmUgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGFzaCcsIFwiUmVtb3ZlIGhhc2hcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlZGl0JywgXCJFZGl0IHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ25hdGl2ZScsIFwiU2VhcmNoIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wQ01EQ2xpY2tUYWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiQWN0aW9uIHdoZW4gY2xpY2tpbmcgYSB0YWcgd2l0aCBPUFQvQUxUIG1vZGlmaWVyIGtleTpcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbigncmVtb3ZlJywgXCJSZW1vdmUgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGFzaCcsIFwiUmVtb3ZlIGhhc2hcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlZGl0JywgXCJFZGl0IHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ25hdGl2ZScsIFwiU2VhcmNoIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZXNrdG9wT1BUQ2xpY2tUYWcgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDNcIiwgeyB0ZXh0OiBcIk1vYmlsZVwiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJTaG93IG1vYmlsZSBub3RpY2VzXCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gaGlkZSBub3RpY2VzLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBY3Rpb24gd2hlbiBET1VCTEUtVEFQUElORyBhIHRhZzpcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IERPVUJMRS1UQVAgYSB0YWc/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdyZW1vdmUnLCBcIlJlbW92ZSB0YWdcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoYXNoJywgXCJSZW1vdmUgaGFzaFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2VkaXQnLCBcIkVkaXQgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbmF0aXZlJywgXCJTZWFyY2ggdGFnXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZURvdWJsZVRhcFRhZyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJBY3Rpb24gd2hlbiBMT05HLVBSRVNTSU5HIGEgdGFnOlwiKVxuICAgICAgICAgICAgLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgTE9ORy1QUkVTUyBhIHRhZz9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3JlbW92ZScsIFwiUmVtb3ZlIHRhZ1wiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hhc2gnLCBcIlJlbW92ZSBoYXNoXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZWRpdCcsIFwiRWRpdCB0YWdcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTG9uZ1ByZXNzVGFnKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTG9uZ1ByZXNzVGFnID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlRSSVBMRS1UQVAgbm9uLXRhZywgbm9uLWxpbmsgdGV4dCB0byBhZGQgYSB0YWc6XCIpXG4gICAgICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gZGlzYWJsZSB0cmlwbGUtdGFwLlwiKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUcmlwbGVUYXBUZXh0KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlVHJpcGxlVGFwVGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoM1wiLCB7IHRleHQ6IFwiVGFnIFN1bW1hcmllc1wiIH0pO1xuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJTaG93IHRhZyBzdW1tYXJ5IGJ1dHRvbnNcIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9GRiB0byBoaWRlIHRoZXNlIGJ1dHRvbnMuXCIpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucylcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnNob3dTdW1tYXJ5QnV0dG9ucyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoXCJoNVwiLCB7IHRleHQ6IFwiVGFnIFN1bW1hcmllcyBJdGVtc1wiIH0pO1xuXG4gICAgICAgIC8vIHNob3cgYnV0dG9uIDogYm90aCwgZGVza3RvcCBvbmx5LCBtb2JpbGUgb25seSwgbm9uZVxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIlJlbW92ZSB0YWcgYnV0dG9uOlwiKVxuICAgICAgICAgICAgLy8uc2V0RGVzYyhcIldoYXQgc2hvdWxkIGhhcHBlbiB3aGVuIHlvdSBjbGljayBhIHRhZyB3aGlsZSBob2xkaW5nIHRoZSBPUFQgb3IgQUxUIGtleT9cIilcbiAgICAgICAgICAgIC5hZGREcm9wZG93bigob3B0KSA9PlxuICAgICAgICAgICAgICAgIG9wdFxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Fsd2F5cycsIFwiRGVza3RvcCBhbmQgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignZGVza3RvcCcsIFwiT25seSBkZXNrdG9wXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbW9iaWxlJywgXCJPbmx5IG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2hpZGUnLCBcIkhpZGVcIilcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlVGFnQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gY2xpcGJvYXJkIGJ1dHRvbjpcIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgT1BUIG9yIEFMVCBrZXk/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdhbHdheXMnLCBcIkRlc2t0b3AgYW5kIG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Rlc2t0b3AnLCBcIk9ubHkgZGVza3RvcFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ21vYmlsZScsIFwiT25seSBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoaWRlJywgXCJIaWRlXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlUb0NCQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvQ0JCdG4gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nIChjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKFwiTW92ZSB0byBzZWN0aW9uIGJ1dHRvbjpcIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXaGF0IHNob3VsZCBoYXBwZW4gd2hlbiB5b3UgY2xpY2sgYSB0YWcgd2hpbGUgaG9sZGluZyB0aGUgT1BUIG9yIEFMVCBrZXk/XCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdhbHdheXMnLCBcIkRlc2t0b3AgYW5kIG1vYmlsZVwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2Rlc2t0b3AnLCBcIk9ubHkgZGVza3RvcFwiKVxuICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ21vYmlsZScsIFwiT25seSBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdoaWRlJywgXCJIaWRlXCIpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4pXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb3ZlVG9TZWN0aW9uQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gc2VjdGlvbiBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9TZWN0aW9uQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvU2VjdGlvbkJ0biA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcgKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoXCJDb3B5IGxpbmsgdG8gc2VjdGlvbiBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5TGlua1RvU2VjdGlvbkJ0bilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlMaW5rVG9TZWN0aW9uQnRuID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyAoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZShcIkNvcHkgdG8gbm90ZSBidXR0b246XCIpXG4gICAgICAgICAgICAvLy5zZXREZXNjKFwiV2hhdCBzaG91bGQgaGFwcGVuIHdoZW4geW91IGNsaWNrIGEgdGFnIHdoaWxlIGhvbGRpbmcgdGhlIE9QVCBvciBBTFQga2V5P1wiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignYWx3YXlzJywgXCJEZXNrdG9wIGFuZCBtb2JpbGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdkZXNrdG9wJywgXCJPbmx5IGRlc2t0b3BcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdtb2JpbGUnLCBcIk9ubHkgbW9iaWxlXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignaGlkZScsIFwiSGlkZVwiKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvTm90ZUJ0biA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gaWYgYW55IG9mIHRoZSBvdGhlciBidXR0b25zIGFyZSBzaG93biwgd2Ugc2hvdyB0aGUgZHJvcCBkb3duXG4gICAgICAgICAgICAvLyBkbyB0aGlzIGluIHRoZSB0YWcgc3VtbWFyeVxuXG5cblxuICAgICAgICAvKlxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJPdmVycmlkZSBuYXRpdmUgdGFnIHNlYXJjaCBvbiBjbGlja1wiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gdXNlIENUUkwvQ01EK0NMSUNLIHRvIHJlbW92ZSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlT25DbGljayA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJDb252ZXJ0IHRvIHRhZyB0ZXh0IChyZW1vdmVzICMpXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIE9GRiB0byB1c2UgT1BUL0FMVCtDTElDSyB0byBwZXJmb3JtIG5hdGl2ZSB0YWcgc2VhcmNoLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcHRUb0NvbnZlcnQpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3B0VG9Db252ZXJ0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlJlbW92ZSBuZXN0ZWQgdGFncyBmaXJzdFwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBPRkYgdG8gdXNlIFNISUZUK0NMSUNLIHRvIHJlbW92ZSBuZXN0ZWQgdGFncyBmaXJzdC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiTW9iaWxlIHRhZyBzZWFyY2hcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgT04gdG8gcmVzdG9yZSBtb2JpbGUgbmF0aXZlIHRhZyBzZWFyY2ggb24gdGFwLiBUYWcgcmVtb3ZhbCB3aWxsIHRoZW4gdXNlIExPTkcgUFJFU1MuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG5cbiAgICAgICAgXG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiU2hvdyB0YWcgc3VtbWFyeSBwYXJhZ3JhcGggYnV0dG9uc1wiKVxuICAgICAgICAuc2V0RGVzYyhcIlNob3cgYnV0dG9ucyBiZWxvdyBlYWNoIHRhZ2dlZCBwYXJhZ3JhcGggdGhhdCBsZXQgeW91IGNvcHksIHJlbW92ZSwgYW5kIG1vdmUgdGhlIHBhcmFncmFwaC5cIilcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuICAgICAgICAgICAgdG9nZ2xlXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MudGFnU3VtbWFyeUJsb2NrQnV0dG9ucylcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdTdW1tYXJ5QmxvY2tCdXR0b25zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICAqL1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdocicpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJTdXBwb3J0IGEgYnVkZHlcIiB9KTtcbiAgICAgICAgY29uc3QgZG9uYXRlTGluayA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdhJyk7XG4gICAgICAgIGRvbmF0ZUxpbmsuc2V0QXR0cmlidXRlKCdocmVmJywgJ2h0dHBzOi8vd3d3LmJ1eW1lYWNvZmZlZS5jb20vbW9yZW1leW91Jyk7XG4gICAgICAgIGNvbnN0IGRvbmF0ZUJ1dHRvbiA9IGNyZWF0ZUVsKCdpbWcnKTtcbiAgICAgICAgZG9uYXRlQnV0dG9uLnNldEF0dHJpYnV0ZSgnc3JjJywgJ2h0dHBzOi8vY2RuLmJ1eW1lYWNvZmZlZS5jb20vYnV0dG9ucy92Mi9kZWZhdWx0LXllbGxvdy5wbmcnKTtcbiAgICAgICAgZG9uYXRlQnV0dG9uLnNldEF0dHJpYnV0ZSgnYWx0JywgJ0J1eSBNZSBBIENvZmZlZScpO1xuICAgICAgICBkb25hdGVCdXR0b24uc3R5bGUgPSAnaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQ7d2lkdGg6IDE1MHB4ICFpbXBvcnRhbnQ7J1xuICAgICAgICBkb25hdGVMaW5rLmFwcGVuZENoaWxkKGRvbmF0ZUJ1dHRvbilcbiAgICAgICAgLy8uaW5uZXJIVE1MID0gYDxpbWcgc3JjPVwiaHR0cHM6Ly9jZG4uYnV5bWVhY29mZmVlLmNvbS9idXR0b25zL3YyL2RlZmF1bHQteWVsbG93LnBuZ1wiIGFsdD1cIkJ1eSBNZSBBIENvZmZlZVwiIHN0eWxlPVwiaGVpZ2h0OiA0MHB4ICFpbXBvcnRhbnQ7d2lkdGg6IDE1MHB4ICFpbXBvcnRhbnQ7XCIgPjwvYT5gO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdicicpO1xuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnYnInKTtcbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2JyJyk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiRGVidWcgbW9kZVwiKVxuICAgICAgICAuc2V0RGVzYyhcIk91dHB1dCB0byBjb25zb2xlLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cbn1cblxuIiwgImltcG9ydCB7IEFwcCwgRHJvcGRvd25Db21wb25lbnQsIHNldEljb24sIE1hcmtkb3duUmVuZGVyZXIsIERyb3Bkb3duQ29tcG9uZW50LCBDb21wb25lbnQsIFRGaWxlLCBnZXRBbGxUYWdzLCBNYXJrZG93blZpZXcsIE5vdGljZSwgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IFRhZ0J1ZGR5IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgdHlwZSB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBUYWdTZWxlY3RvciB9IGZyb20gJy4vTW9kYWwnXG5pbXBvcnQgeyBUQlRhZ0VkaXRvck1vZGFsIH0gZnJvbSAnLi9UYWdFZGl0b3JNb2RhbCdcbmltcG9ydCB7IFNlbGVjdEZpbGVNb2RhbCB9IGZyb20gJy4vRmluZEZpbGVNb2RhbCdcblxuZXhwb3J0IGNsYXNzIEdVSSB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblxuXHRjb25zdHJ1Y3Rvcihcblx0XHRhcHA6IEFwcCwgXG5cdFx0cGx1Z2luOiBUYWdCdWRkeSkge1xuXG5cdFx0dGhpcy5hcHAgPSBhcHA7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdH1cbiBcblx0c2hvd1RhZ0VkaXRvciAodGFnRWwpIHtcblxuXHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFxuXHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSkge1xuXHRcdFx0XG5cdFx0fSBlbHNlIHtcblx0XHRcblx0XHR9XG5cblx0XHRjb25zdCBpbmRleCA9IHBhcnNlSW50ICh0YWdFbC5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4JykpO1xuXHRcdGNvbnN0IHRhZyA9IHRhZ0VsLmlubmVyVGV4dDtcblx0XHRjb25zdCBmaWxlUGF0aCA9IHRhZ0VsLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKVxuXHRcdGNvbnN0IHRhZ0NvbnRhaW5lclR5cGUgPSB0YWdFbC5nZXRBdHRyaWJ1dGUoJ3R5cGUnKTtcblxuICAgICAgIFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHRhZ0VkaXRvck1vZGFsOiBUQlRhZ0VkaXRvck1vZGFsID0gbmV3IFRCVGFnRWRpdG9yTW9kYWwgKFxuXHRcdFx0XHR0aGlzLmFwcCwgXG5cdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHR0YWcsXG5cdFx0XHRcdGluZGV4LFxuXHRcdFx0XHRmaWxlUGF0aCxcblx0XHRcdFx0KHRhZ0NvbnRhaW5lclR5cGUgPT0gJ3BsdWdpbi1zdW1tYXJ5JykgPyB0YWdFbCA6IG51bGwsXG5cdFx0XHRcdC8vdGFnLFxuXHRcdFx0XHQvL2luZGV4XG5cdFx0XHRcdC8vKHRhZyk9Pntcblx0XHRcdFx0Ly9cdGNvbnNvbGUubG9nKHRhZykgXG5cdFx0XHRcdC8vfVxuXHRcdFx0KS5vcGVuKCk7XG5cblx0XHR9XG5cblxuXHR9XG5cblx0Lyppc1RhZ1ZhbGlkICh0YWc6c3RyaW5nKTpib29sZWFuIHsgLy8gaW5jbHVkaW5nIHRoZSAjXG5cdFx0Y29uc3QgdGFnUGF0dGVybiA9IC9eI1tcXHddKyQvO1xuXHRcdHJldHVybiB0YWdQYXR0ZXJuLnRlc3QodGFnKTtcblx0fSovXG5cblx0bWFrZUJ1dHRvbiAoXG5cdFx0bGFibGU6IHN0cmluZywgXG5cdFx0Y2xpY2tGbjogKGU6IEV2ZW50KSA9PiB2b2lkLCBcblx0XHRjbGFzc0lkPSd0YWdzdW1tYXJ5LWJ1dHRvbidcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gY3JlYXRlRWwoJ2J1dHRvbicpO1xuXHQgICAgLy9idXR0b24uaW5uZXJUZXh0ID0gbGFibGU7XG4gICAgXHRzZXRJY29uKGJ1dHRvbiwgbGFibGUpO1xuXHQgICAgYnV0dG9uLmNsYXNzTmFtZSA9IGNsYXNzSWQ7XG5cblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuXHRcdFx0YnV0dG9uLCBcblx0XHRcdCdjbGljaycsIFxuXHRcdFx0Y2xpY2tGblxuXHRcdCk7XG5cblx0ICAgIHJldHVybiBidXR0b247XG5cdH1cblxuXG5cdG1ha2VCbG9ja1NlbGVjdG9yIChcblx0XHRpbmRleDogTnVtYmVyXG5cdCk6IEhUTUxFbGVtZW50IHtcblx0XHRcblx0XHRjb25zdCBjaGVja2JveEVsID0gY3JlYXRlRWwgKCdkaXYnKTtcblx0XHQvL2NoZWNrYm94RWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWNoZWNrYm94Jylcblx0XHRjaGVja2JveEVsLnNldEF0dHJpYnV0ZSgnaW5kZXgnLCBpbmRleClcblxuXHRcdGxldCBjaGVja2VkQnRuO1xuXHRcdGxldCB1bmNoZWNrZWRCdG47XG5cblx0XHRjb25zdCBjaGVja0JveCA9IGZ1bmN0aW9uIChib29sOiBCb29sZWFuKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGNoZWNrYm94RWwuZ2V0QXR0cmlidXRlKCdpbmRleCcpKVxuXG5cdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZVNlbGVjdGlvbiAocGFyc2VJbnQoY2hlY2tib3hFbC5nZXRBdHRyaWJ1dGUoJ2luZGV4JykpLCBib29sKTtcblx0XHRcdGlmIChib29sKSB7XG5cdFx0XHRcdHVuY2hlY2tlZEJ0bi5yZW1vdmUoKTtcblx0XHRcdFx0Y2hlY2tib3hFbC5hcHBlbmRDaGlsZChjaGVja2VkQnRuKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNoZWNrZWRCdG4ucmVtb3ZlKCk7XG5cdFx0XHRcdGNoZWNrYm94RWwuYXBwZW5kQ2hpbGQodW5jaGVja2VkQnRuKTtcblx0XHRcdH0gXG5cdFx0fS5iaW5kKHRoaXMpO1xuXG5cdFx0Y2hlY2tlZEJ0biA9IHRoaXMubWFrZUJ1dHRvbiAoJ2NoZWNrLXNxdWFyZScsIChlKSA9PiB7IFxuXHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdGNoZWNrQm94KGZhbHNlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3ggY2hlY2tlZCcpO1xuXHRcdGNoZWNrZWRCdG4udGl0bGUgPSAnVW5zZWxlY3QgdGhpcyBwYXJhZ3JhcGguJztcblx0XHRcblx0XHR1bmNoZWNrZWRCdG4gPSB0aGlzLm1ha2VCdXR0b24gKCdzcXVhcmUnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjaGVja0JveCh0cnVlKVxuXG5cdFx0fSwgJ3RhZ3N1bW1hcnktYnV0dG9uIHRhZ3N1bW1hcnktY2hlY2tib3gnKTtcblx0XHR1bmNoZWNrZWRCdG4udGl0bGUgPSAnU2VsZWN0IHRoaXMgcGFyYWdyYXBoLic7XG5cblx0XHRjaGVja0JveCAoZmFsc2UpXG5cblx0XHRyZXR1cm4gY2hlY2tib3hFbDtcblxuXHR9XG5cblx0bWFrZVJlbW92ZVRhZ0J1dHRvbiAoXG5cdFx0Y2xpY2tGbjogRnVuY3Rpb24sXG5cdFx0cGFyYWdyYXBoRWw6IEVsZW1lbnQsIFxuXHRcdHRhZzogc3RyaW5nLy8sIFxuXHRcdC8vZmlsZVBhdGg6IHN0cmluZ1xuXHQpOkhUTUxCdXR0b25FbGVtZW50IHtcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24gKCdsaXN0LXgnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdGNsaWNrRm4oZSwgcGFyYWdyYXBoRWwsIHRhZylcblxuXHRcdFx0Ly9jb25zdCB0YWdFbCA9IFV0aWxzLmdldFRhZ0VsZW1lbnQocGFyYWdyYXBoRWwsIHRhZyk7XG5cdFx0XHQvL3RoaXMucGx1Z2luLnRhZ0VkaXRvci5lZGl0KHRhZ0VsKTtcblx0XHR9KTtcblx0XHRidXR0b24udGl0bGUgPSAnUmVtb3ZlZCAnICsgdGFnICsgJyBmcm9tIHBhcmFncmFwaC4nO1xuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlU3VtbWFyeVJlZnJlc2hCdXR0b24gKFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudFxuXHQpOiBIVE1MRWxlbWVudCB7XHRcblx0XHRcblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24oXG5cdFx0XHQncmVmcmVzaC1jY3cnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUoc3VtbWFyeUVsKTtcblx0XHRcdFx0Ly90aGlzLnVwZGF0ZVN1bW1hcnkoc3VtbWFyeUVsKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1RhZyBTdW1tYXJ5IHVwZGF0ZWQnKTtcblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHRcdC8vdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnJ1bigpOyBcblx0XHRcdFx0fSwgMTApO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnUmVmcmVzaCB0YWcgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlUb1NlY3Rpb24gKFxuXHRcdGNsaWNrRm46RnVuY3Rpb24sXG5cdFx0Y29udGVudDogc3RyaW5nLCBcblx0XHRzZWN0aW9uczogc3RyaW5nW10sIFxuXHRcdHRhZ3M6IEFycmF5LCBcblx0XHRmaWxlUGF0aDogc3RyaW5nLCBcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnRcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgY29weVRvRWw6IEhUTUxFbGVtZW50ID0gY3JlYXRlRWwoJ3NwYW4nKTtcblx0XHRjb25zdCBzZWxlY3RFbDogSFRNTFNlbGVjdEVsZW1lbnQgPSBjcmVhdGVFbCgnc2VsZWN0RWwnKTtcblx0XHRsZXQgZHJvcGRvd24gPSBuZXcgRHJvcGRvd25Db21wb25lbnQoc2VsZWN0RWwpO1xuXHRcdHNlY3Rpb25zLmZvckVhY2goKHNlYykgPT4ge1xuXHRcdFx0ZHJvcGRvd24uYWRkT3B0aW9uKHNlYywgVXRpbHMudHJ1bmNhdGVTdHJpbmdBdFdvcmQoc2VjLCAxNikpOyBcblx0XHR9KTtcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ3RvcCcsICdOb3RlIHRvcCcpOyBcblx0XHRkcm9wZG93bi5hZGRPcHRpb24oJ2VuZCcsICdOb3RlIGVuZCcpOyBcblx0XHQvL2Ryb3Bkb3duLmFkZE9wdGlvbignbm90ZScsICdOb3RlJyk7IFxuXHRcdC8vZHJvcGRvd24uYWRkT3B0aW9uKCduZXdOb3RlJywgJ05ldyBub3RlJyk7IFxuXHRcdFxuXHRcdHNlbGVjdEVsLnF1ZXJ5U2VsZWN0b3IoJ3NlbGVjdCcpLmNsYXNzTmFtZSA9ICd0YWdzdW1tYXJ5LWRyb3Bkb3duJztcblx0XHRcblx0XHRpZiAoVXRpbHMucGxhdGZvcm1TZXR0aW5nQ2hlY2sgKHRoaXMuYXBwLCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuKSkge1xuXHRcdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdFx0Y2xpY2tGbixcblx0XHRcdFx0XHQnbm90ZScsXHRcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlMaW5rVG9TZWN0aW9uQnRuKSkge1xuXHRcdFx0Y29weVRvRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdHRoaXMubWFrZUNvcHlUb0J1dHRvbiAoXG5cdFx0XHRcdFx0Y2xpY2tGbixcblx0XHRcdFx0XHQnbGluaycsXHRcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLmNvcHlUb1NlY3Rpb25CdG4pKSB7XG5cdFx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdFx0dGhpcy5tYWtlQ29weVRvQnV0dG9uIChcblx0XHRcdFx0XHRjbGlja0ZuLFxuXHRcdFx0XHRcdCdjb3B5Jyxcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4pKSB7XG5cdFx0XHRjb3B5VG9FbC5hcHBlbmRDaGlsZChcblx0XHRcdFx0dGhpcy5tYWtlQ29weVRvQnV0dG9uIChcblx0XHRcdFx0XHRjbGlja0ZuLFxuXHRcdFx0XHRcdCdtb3ZlJyxcblx0XHRcdFx0XHRkcm9wZG93bixcblx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0c3VtbWFyeUVsLFxuXHRcdFx0XHRcdGNvbnRlbnQsXG5cdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRmaWxlUGF0aCBcblx0XHRcdFx0KVxuXHRcdFx0KVxuXHRcdH1cblxuXHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVja011bHRpcGxlICh0aGlzLmFwcCwgW3RoaXMucGx1Z2luLnNldHRpbmdzLm1vdmVUb1NlY3Rpb25CdG4sXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvU2VjdGlvbkJ0bixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5TGlua1RvU2VjdGlvbkJ0bixcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb3B5VG9Ob3RlQnRuXSkpIHtcblx0XHRcdGNvcHlUb0VsLmFwcGVuZENoaWxkKHNlbGVjdEVsKTtcblx0XHR9XG5cblxuXHRcdHJldHVybiBjb3B5VG9FbDtcblx0fVxuXG5cdG1ha2VDb3B5VG9CdXR0b24gKFxuXHRcdGNsaWNrRm46IEZ1bmN0aW9uLFxuXHRcdG1vZGU6IFN0cmluZyxcblx0XHRkcm9wZG93bjogRHJvcGRvd25Db21wb25lbnQsXG5cdFx0cGFyYWdyYXBoRWw6IEhUTUxFbGVtZW50LCBcblx0XHRzdW1tYXJ5RWw6IEhUTUxFbGVtZW50LFxuXHRcdGNvbnRlbnQ6IHN0cmluZywgIFxuXHRcdHRhZ3M6IEFycmF5LCBcblx0XHRmaWxlUGF0aDogc3RyaW5nIFxuXHQpOiBIVE1MRWxlbWVudCB7XG5cblx0XHRsZXQgYnV0dG9uTGFiZWw7XG5cdFx0aWYgKG1vZGUgPT0gJ2xpbmsnKSBidXR0b25MYWJlbCA9ICdsaW5rJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdjb3B5JykgYnV0dG9uTGFiZWwgPSAnY29weS1wbHVzJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdtb3ZlJykgYnV0dG9uTGFiZWwgPSAncmVwbGFjZSc7IC8vJ2NvcHktY2hlY2snO1xuXHRcdGVsc2UgaWYgKG1vZGUgPT0gJ25vdGUnKSBidXR0b25MYWJlbCA9ICdmaWxlLXBsdXMtMic7XG5cblx0XHRjb25zdCBidXR0b24gPSB0aGlzLm1ha2VCdXR0b24gKGJ1dHRvbkxhYmVsLCBhc3luYyAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cblx0XHRcdGlmIChtb2RlID09ICdub3RlJykge1xuXHRcdFx0Ly9pZiAoZHJvcGRvd24uZ2V0VmFsdWUoKSA9PSAnbm90ZScpIHtcblxuXHRcdFx0XHRuZXcgU2VsZWN0RmlsZU1vZGFsKHRoaXMuYXBwLCAoZmlsZSkgPT4ge1xuXG4gIFx0XHRcdFx0XHQvL25ldyBOb3RpY2UoYEZpbGU6ICR7cmVzdWx0Lm5hbWV9YCk7XG5cbiAgXHRcdFx0XHRcdGNsaWNrRm4oZSwgbW9kZSwgZHJvcGRvd24sIHBhcmFncmFwaEVsLCBzdW1tYXJ5RWwsIGNvbnRlbnQsIHRhZ3MsIGZpbGVQYXRoLCBmaWxlKTtcblxuXHRcdFx0XHR9KS5vcGVuKCk7XG5cblx0XHRcdC8qfSBlbHNlIGlmIChkcm9wZG93bi5nZXRWYWx1ZSgpID09ICduZXdOb3RlJykge1xuXG4vL2NvbnNvbGUubG9nKHZpZXcsIGZpbGVOYW1lKVxuXHRcdFx0XHRjbGlja0ZuKGUsIG1vZGUsIGRyb3Bkb3duLCBwYXJhZ3JhcGhFbCwgc3VtbWFyeUVsLCBjb250ZW50LCB0YWdzLCBmaWxlUGF0aCk7XG4qL1xuXHRcdFx0fSBlbHNlIHtcblxuXHRcdFx0XHRjbGlja0ZuKGUsIG1vZGUsIGRyb3Bkb3duLCBwYXJhZ3JhcGhFbCwgc3VtbWFyeUVsLCBjb250ZW50LCB0YWdzLCBmaWxlUGF0aCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0bGV0IGJ1dHRvbkhvdmVyVGV4dDtcblx0XHRpZiAobW9kZSA9PSAnbGluaycpIGJ1dHRvbkhvdmVyVGV4dCA9ICdDb3B5IHBhcmFncmFwaCBsaW5rLicgO1xuXHRcdGVsc2UgaWYgKG1vZGUgPT0gJ2NvcHknKSBidXR0b25Ib3ZlclRleHQgPSAnQ29weSBwYXJhZ3JhcGguJztcblx0XHRlbHNlIGlmIChtb2RlID09ICdtb3ZlJykgYnV0dG9uSG92ZXJUZXh0ID0gJ01vdmUgcGFyYWdyYXBoLic7XG5cdFx0ZWxzZSBpZiAobW9kZSA9PSAnbm90ZScpIGJ1dHRvbkhvdmVyVGV4dCA9ICdDb3B5IHBhcmFncmFwaCB0byBzZWN0aW9uIGluIG5vdGUuJztcblxuXHRcdGJ1dHRvbi50aXRsZSA9IGJ1dHRvbkhvdmVyVGV4dDtcblxuXHRcdHJldHVybiBidXR0b247XG5cdFx0XG5cdH1cblxuXHRtYWtlQmFrZUJ1dHRvbiAoXG5cdFx0Y2xpY2tGbjogRnVuY3Rpb24sXG5cdFx0c3VtbWFyeU1kOiBzdHJpbmcsIFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudCwgXG5cdFx0ZmlsZVBhdGg6c3RyaW5nXG5cdCk6IEhUTUxFbGVtZW50IHtcdFxuXHRcdFxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoXG5cdFx0XHQnc3RhbXAnLCBcblx0XHRcdGFzeW5jKGUpID0+IHsgXG5cdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRjbGlja0ZuIChzdW1tYXJ5TWQsIHN1bW1hcnlFbCwgZmlsZVBhdGgpXG5cblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0ZsYXR0ZW4gc3VtbWFyeSAocmVwbGFjZXMgY29kZSBibG9jaykuJztcblxuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlQ29weUJ1dHRvbiAoXG5cdFx0Y2xpY2tGbixcblx0XHRjb250ZW50XG5cdCk6IEhUTUxFbGVtZW50IHtcdFxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoJ2NsaXBib2FyZC1saXN0JywgKGUpID0+IHsgXG5cdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0Y2xpY2tGbihlLCBjb250ZW50KTtcblx0XHR9KTtcblx0XHRidXR0b24udGl0bGUgPSAnQ29weSBwYXJhZ3JhcGggdG8gY2xpcGJvYXJkLic7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZUNvcHlTdW1tYXJ5QnV0dG9uIChcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZylcblx0OkhUTUxFbGVtZW50IHtcblxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoXG5cdFx0XHQnY2xpcGJvYXJkLWxpc3QnLCBcblx0XHRcdChlKSA9PiB7IFxuXHRcdFx0XHRlLnN0b3BQcm9wYWdhdGlvbigpO1xuXHRcdFx0XHRcblx0XHRcdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc3VtbWFyeU1kKTtcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1N1bW1hcnkgY29waWVkIHRvIGNsaXBib2FyZC4nKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0YnV0dG9uLnRpdGxlID0gJ0NvcHkgc3VtbWFyeSc7XG5cblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZVN1bW1hcnlOb3RlQnV0dG9uIChcblx0XHRjbGlja0ZuOiBGdW5jdGlvbixcblx0XHRzdW1tYXJ5TWQ6IHN0cmluZywgXG5cdFx0dGFnczogQXJyYXlcblx0KTogSFRNTEVsZW1lbnQge1xuXG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uIChcblx0XHRcdCdmaWxlLXBsdXMtMicsIFxuXHRcdFx0YXN5bmMgKGUpID0+IHtcblx0XHRcdFx0ZS5zdG9wUHJvcGFnYXRpb24oKTtcbi8vbmV3IE5vdGljZSAoJ21ha2VTdW1tYXJ5Tm90ZUJ1dHRvbicsIDEwMDAwKVxuXHRcdFx0XHRjbGlja0ZuIChzdW1tYXJ5TWQsIHRhZ3MpO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHRidXR0b24udGl0bGUgPSAnQ3JlYXRlIG5vdGUgZnJvbSBzdW1tYXJ5JztcblxuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRzaG93VGFnU2VsZWN0b3IoZXZlbnQpe1xuXHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdGNvbnN0IG1vZGUgPSB2aWV3Py5nZXRNb2RlKCk7XG5cdFx0bGV0IHBhZ2VYLCBwYWdlWVxuXHRcdGxldCBub2RlVHlwZVxuXHRcdGxldCBkZWVwZXN0Tm9kZTtcblx0XHRsZXQgcmFuZ2Vcblx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUpIHtcblx0XHRcdGNvbnN0IHRvdWNoID0gZXZlbnQudG91Y2hlc1swXSB8fCBldmVudC5jaGFuZ2VkVG91Y2hlc1swXTtcblx0XHRcdHBhZ2VYID0gTWF0aC5yb3VuZCh0b3VjaC5wYWdlWCk7XG5cdFx0XHRwYWdlWSA9IE1hdGgucm91bmQodG91Y2gucGFnZVkpO1xuXHRcdFx0Ly9jb25zdCBlbCA9IFV0aWxzLmdldERlZXBlc3RUZXh0Tm9kZShkb2N1bWVudC5lbGVtZW50RnJvbVBvaW50KHBhZ2VYLCBwYWdlWSkpXG5cdFx0XHQvL2NvbnN0IGVsID0gZG9jdW1lbnQuZWxlbWVudEZyb21Qb2ludChwYWdlWCwgcGFnZVkpO1xuXHRcdFx0Ly9kZWVwZXN0Tm9kZSA9IFV0aWxzLmdldERlZXBlc3ROb2RlKGVsKTtcblx0XHRcdHJhbmdlID0gZG9jdW1lbnQuY2FyZXRSYW5nZUZyb21Qb2ludChwYWdlWCwgcGFnZVkpXG5cdFx0XHRub2RlVHlwZSA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlIC8vZGVlcGVzdE5vZGUubm9kZVR5cGU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHBhZ2VYID0gZXZlbnQucGFnZVg7XG5cdFx0XHRwYWdlWSA9IGV2ZW50LnBhZ2VZO1xuXHRcdFx0cmFuZ2UgPSBkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KHBhZ2VYLCBwYWdlWSlcblx0XHRcdG5vZGVUeXBlID0gcmFuZ2Uuc3RhcnRDb250YWluZXIubm9kZVR5cGU7XG5cdFx0fVxuXG5cdFx0Ly9jb25zdCB0YXJnZXRDbGFzc2VzID0gWyd0YWcnXTtcbiAgICAgICAgLy9pZiAobW9kZSA9PSAncHJldmlldycgJiYgIXRhcmdldENsYXNzZXMuc29tZShjbHMgPT4gZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhjbHMpKSkge1xuICAgICAgIFx0aWYgKG1vZGUgPT0gJ3ByZXZpZXcnKSB7XG5cdFx0XHRpZiAobm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG5cdFx0XHRcdGNvbnN0IHRhZ1NlbGVjdG9yOiBUYWdTZWxlY3RvciA9IG5ldyBUYWdTZWxlY3Rvcihcblx0XHRcdFx0XHR0aGlzLmFwcCwgXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4sIFxuXHRcdFx0XHRcdGV2ZW50LCAodGFnKT0+e1xuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh0YWcpXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdFZGl0b3IuYWRkKFxuXHRcdFx0ICAgICAgICBcdFx0JyMnICsgdGFnLCBcblx0XHRcdCAgICAgICAgXHRcdHBhZ2VYLCBcblx0XHRcdCAgICAgICAgXHRcdHBhZ2VZLy8sXG5cdFx0XHQgICAgICAgIFx0XHQvL3tyYW5nZTogcmFuZ2UsIGVsOiBkZWVwZXN0Tm9kZX1cblx0ICAgICAgICBcdFx0XHQpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHQpLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRyZW1vdmVFbGVtZW50V2l0aEFuaW1hdGlvbiggXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcblx0XHRjYWxsYmFjazogKGU6IEV2ZW50KSA9PiB2b2lkLCBcblx0KTp2b2lkIHtcblxuXHQgIC8vIEdldCB0aGUgYWN0dWFsIGhlaWdodCBvZiB0aGUgZWxlbWVudFxuXHQgIGNvbnN0IGhlaWdodCA9IGVsLm9mZnNldEhlaWdodDtcblxuXHQgIC8vIFNldCBoZWlnaHQgdG8gdGhlIGN1cnJlbnQgdmFsdWUgZm9yIENTUyB0cmFuc2l0aW9uXG5cdCAgZWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcblxuXHQgIC8vIEFsbG93IHRoZSBicm93c2VyIHRvIHVwZGF0ZSwgdGhlbiBzZXQgdG8gMCB0byB0cmlnZ2VyIHRoZSB0cmFuc2l0aW9uXG5cdCAgLy9zZXRUaW1lb3V0KCgpID0+IHsgZWwuc3R5bGUuaGVpZ2h0ID0gJzBweCc7IH0sIDApO1xuXHQgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBlbC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcbiAgICAgICAgZWwuc3R5bGUub3BhY2l0eSA9ICcwJztcbiAgICAgICAgZWwuc3R5bGUubWFyZ2luID0gJzAnO1xuICAgICAgICBlbC5zdHlsZS5wYWRkaW5nID0gJzAnO1xuICAgIFx0fSwgMCk7XG5cdCAgXG5cdCAgZWwuYWRkRXZlbnRMaXN0ZW5lcihcblx0ICBcdCd0cmFuc2l0aW9uZW5kJywgZnVuY3Rpb24gb25FbmQoKSB7XG4gICAgXHRcdGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RyYW5zaXRpb25lbmQnLCBvbkVuZCk7XG4gICAgXHRcdGNhbGxiYWNrKCk7XG5cdCAgICBcdC8vc2V0VGltZW91dCgoKSA9PiB7IGVsLnJlbW92ZSgpOyB9LCAxMCk7IC8vIHJlbW92ZSBpbiB0aGUgY2FsbGJhY2tcblx0ICB9KTtcblx0fVxuXG5cdFxuXG59IiwgImltcG9ydCB7IFRGaWxlLCBQbGF0Zm9ybSB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldFRhZ0VsZW1lbnQoXG4gICAgcGFyYWdyYXBoRWw6IEhUTUxFbGVtZW50LCBcbiAgICB0YWdUZXh0OiBzdHJpbmdcbik6IEhUTUxFbGVtZW50IHtcbiAgICBjb25zdCBlbHMgPSBwYXJhZ3JhcGhFbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyk7IFxuICAgIGxldCB0YWdFbFRleHQgPSAnJztcbiAgICBsZXQgdGFnRWxIYXNTdWI6Ym9vbGVhbjtcbiAgICBmb3IgKGxldCBlbCBvZiBlbHMpIHtcbiAgICAgICAgdGFnRWxUZXh0ID0gZWwuaW5uZXJUZXh0LnRyaW0oKTtcbiAgICAgICAgaWYgKHRhZ0VsVGV4dCA9PT0gdGFnVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIGVsXG4gICAgICAgIH1cbiAgICB9ICAgIFxuICAgIC8vY29uc29sZS53YXJuKGBFbGVtZW50IHdpdGggdGV4dCBcIiR7dGFnVGV4dH1cIiBub3QgZm91bmRgKTtcbiAgICByZXR1cm4gbnVsbDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBsYXRmb3JtU2V0dGluZ0NoZWNrIChhcHA6IEFwcCwgdmFsdWUpIHtcbiAgICByZXR1cm4gKHZhbHVlID09ICdhbHdheXMnIHx8ICh2YWx1ZSA9PSAnZGVza3RvcCcgJiYgIWFwcC5pc01vYmlsZSkgfHwgKHZhbHVlID09ICdtb2JpbGUnICYmIGFwcC5pc01vYmlsZSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwbGF0Zm9ybVNldHRpbmdDaGVja011bHRpcGxlIChhcHA6IEFwcCwgdmFsdWVzOiBBcnJheSBbXSkge1xuICAgIGZvciAobGV0IHZhbHVlIG9mIHZhbHVlcykge1xuICAgICAgICBpZiAocGxhdGZvcm1TZXR0aW5nQ2hlY2soYXBwLCB2YWx1ZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlOyBcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpc1dvcmROZWFyRW5kKFxuICAgIHN0cjogc3RyaW5nLCBcbiAgICB3b3JkOiBzdHJpbmcsIFxuICAgIGNoYXJEaXN0YW5jZTogbnVtYmVyID0gMFxuKTogYm9vbGVhbiB7XG4gICAgLy8gRmluZCB0aGUgbGFzdCBvY2N1cnJlbmNlIG9mIHRoZSB3b3JkXG4gICAgY29uc3QgbGFzdEluZGV4ID0gc3RyLmxhc3RJbmRleE9mKHdvcmQpO1xuXG4gICAgLy8gSWYgdGhlIHdvcmQgaXNuJ3QgZm91bmQsIHJldHVybiBmYWxzZVxuICAgIGlmIChsYXN0SW5kZXggPT09IC0xKSByZXR1cm4gZmFsc2U7XG5cbiAgICAvLyBDYWxjdWxhdGUgdGhlIHBvc2l0aW9uIHdoZXJlIHRoZSB3b3JkIGVuZHNcbiAgICBjb25zdCB3b3JkRW5kSW5kZXggPSBsYXN0SW5kZXggKyB3b3JkLmxlbmd0aDtcblxuICAgIC8vIENoZWNrIHRoZSBkaXN0YW5jZSBmcm9tIHRoZSB3b3JkJ3MgZW5kIHRvIHRoZSBzdHJpbmcncyBlbmRcbiAgICBjb25zdCBkaXN0YW5jZVRvRW5kID0gc3RyLmxlbmd0aCAtIHdvcmRFbmRJbmRleDtcblxuICAgIC8vIFJldHVybiB0cnVlIGlmIHRoZSB3b3JkIGlzIHRoZSBsYXN0IHdvcmQgb3IgaWYgdGhlIGRpc3RhbmNlIGlzIGxlc3MgdGhhbiBvciBlcXVhbCB0byBjaGFyRGlzdGFuY2VcbiAgICByZXR1cm4gZGlzdGFuY2VUb0VuZCA9PT0gMCB8fCBkaXN0YW5jZVRvRW5kIDw9IGNoYXJEaXN0YW5jZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFdvcmRPYmpGcm9tU3RyaW5nKFxuICAgIHNvdXJjZVRleHQ6IHN0cmluZywgXG4gICAgb2Zmc2V0OiBudW1iZXJcbik6T2JqZWN0IHtcbiAgICBcbiAgICBsZXQgd29yZFJlZ2V4ID0gL1teXFxzXSsoPz1bLiw6IT9dPyhcXHN8JCkpL2c7XG4gICAgbGV0IG1hdGNoO1xuICAgIGxldCBpbmRleDtcbiAgICBsZXQgd29yZCA9IG51bGw7XG4gICAgd2hpbGUgKChtYXRjaCA9IHdvcmRSZWdleC5leGVjKHNvdXJjZVRleHQpKSAhPT0gbnVsbCkge1xuICAgICAgICBpZiAobWF0Y2guaW5kZXggPD0gb2Zmc2V0ICYmIG9mZnNldCA8PSBtYXRjaC5pbmRleCArIG1hdGNoWzBdLmxlbmd0aCkge1xuICAgICAgICAgICAgIHdvcmQgPSBtYXRjaFswXTtcbiAgICAgICAgICAgIGluZGV4ID0gbWF0Y2guaW5kZXg7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICB0ZXh0OiB3b3JkLCBcbiAgICAgICAgaW5kZXg6IGluZGV4XG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldENsaWNrZWRUZXh0T2JqRnJvbURvYyhcbiAgICB4LCBcbiAgICB5LCBcbiAgICBtaW5Ob2RlTGVuZ3RoOiBzdHJpbmc9MTBcbik6c3RyaW5nIHtcbiAgICBcbiAgICAvLyBHZXQgdGhlIHdvcmQgdW5kZXIgdGhlIGNsaWNrIHBvc2l0aW9uXG4gICAgbGV0IHJhbmdlLCBub2RlVGV4dCwgb2Zmc2V0O1xuXG4gICAgaWYgKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpIHtcbiAgICAgICAgcmFuZ2UgPSBkb2N1bWVudC5jYXJldFJhbmdlRnJvbVBvaW50KHgsIHkpO1xuLy9jb25zb2xlLmxvZyh4LCB5LCByYW5nZSlcbiAgICAgICAgaWYgKHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xuICAgICAgICAgICAgbm9kZVRleHQgPSByYW5nZS5zdGFydENvbnRhaW5lci5ub2RlVmFsdWUudHJpbSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgb2Zmc2V0ID0gcmFuZ2Uuc3RhcnRPZmZzZXQ7XG4gICAgfVxuXG4gICAgaWYgKG5vZGVUZXh0Lmxlbmd0aCA8IG1pbk5vZGVMZW5ndGgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuLy9jb25zb2xlLmxvZyhub2RlVGV4dCwgb2Zmc2V0LCByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlKVxuICAgIHJldHVybiB7XG4gICAgICAgIHRleHQ6IG5vZGVUZXh0LCBcbiAgICAgICAgaW5kZXg6IG9mZnNldCwgXG4gICAgICAgIGVsOiByYW5nZS5zdGFydENvbnRhaW5lci5wYXJlbnROb2RlXG4gICAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hcmtkb3duSGVhZGluZ3MoXG4gICAgYm9keUxpbmVzOiBzdHJpbmdbXSxcbiAgICBoZWFkaW5nRmlsdGVyOiBzdHJpbmcgPSAnJ1xuKTogSGVhZGluZ1tdIHtcbiAgICBcbiAgICBjb25zdCBoZWFkZXJzOiBIZWFkaW5nW10gPSBbXTtcbiAgICBsZXQgYWNjdW11bGF0ZWRJbmRleCA9IDA7XG5cbiAgICBib2R5TGluZXMuZm9yRWFjaCgobGluZSwgaW5kZXgpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSBsaW5lLm1hdGNoKC9eKCMrKVtcXHNdPyguKikkLyk7XG5cbiAgICAgICAgaWYgKG1hdGNoICYmIFxuICAgICAgICAgICAgKGhlYWRpbmdGaWx0ZXIgPT0gJycgfHwgbWF0Y2hbMl0gPT0gaGVhZGluZ0ZpbHRlcikpIHtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaCh7XG4gICAgICAgICAgICAgICAgZnVsbFRleHQ6IG1hdGNoWzBdLFxuICAgICAgICAgICAgICAgIGxldmVsOiBtYXRjaFsxXS5sZW5ndGgsXG4gICAgICAgICAgICAgICAgdGV4dDogbWF0Y2hbMl0sXG4gICAgICAgICAgICAgICAgbGluZTogaW5kZXgsXG4gICAgICAgICAgICAgICAgc3RhcnRJbmRleDogYWNjdW11bGF0ZWRJbmRleCxcbiAgICAgICAgICAgICAgICBlbmRJbmRleDogKGFjY3VtdWxhdGVkSW5kZXggKyBtYXRjaFswXS5sZW5ndGggLSAxKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYWNjdW11bGF0ZWRJbmRleCArPSBsaW5lLmxlbmd0aCArIDE7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaGVhZGVycztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRDbG9zZXN0SGVhZGVyV2l0aExpbmsocGFyYWdyYXBoOiBzdHJpbmcpOiB7IHRleHQ6IHN0cmluZzsgbGluazogc3RyaW5nIH0ge1xuICAgIC8vIFNwbGl0IHRoZSBpbnB1dCBtYXJrZG93biBpbnRvIGxpbmVzXG4gICAgY29uc3QgbGluZXMgPSBwYXJhZ3JhcGguc3BsaXQoJ1xcbicpO1xuICAgIGxldCBjbG9zZXN0SGVhZGVyID0gJyc7XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggdGhlIGxpbmVzIGluIHJldmVyc2Ugb3JkZXIgdG8gZmluZCB0aGUgY2xvc2VzdCBwcmVjZWRpbmcgaGVhZGVyXG4gICAgZm9yIChsZXQgaSA9IGxpbmVzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIGNvbnN0IGxpbmUgPSBsaW5lc1tpXS50cmltKCk7XG5cbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgbGluZSBpcyBhIGhlYWRlclxuICAgICAgICBpZiAoL14jezEsNn1cXHMvLnRlc3QobGluZSkpIHtcbiAgICAgICAgICAgIGNsb3Nlc3RIZWFkZXIgPSBsaW5lO1xuICAgICAgICAgICAgYnJlYWs7IC8vIFN0b3Agc2VhcmNoaW5nIG9uY2UgYSBoZWFkZXIgaXMgZm91bmRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjbG9zZXN0SGVhZGVyKSB7XG4gICAgICAgIC8vIEV4dHJhY3QgdGhlIGhlYWRlciB0ZXh0IChyZW1vdmUgaGFzaGVzIGFuZCB0cmltIHNwYWNlcylcbiAgICAgICAgY29uc3QgdGV4dCA9IGNsb3Nlc3RIZWFkZXIucmVwbGFjZSgvXiN7MSw2fVxccyovLCAnJykudHJpbSgpO1xuXG4gICAgICAgIC8vIEdlbmVyYXRlIGEgbGluayBpbiB0aGUgZm9ybWF0IG9mICNoZWFkZXIgdGV4dFxuICAgICAgICBjb25zdCBsaW5rID0gYCMke3RleHR9YDtcblxuICAgICAgICByZXR1cm4geyB0ZXh0LCBsaW5rIH07XG4gICAgfVxuXG4gICAgLy8gUmV0dXJuIGVtcHR5IHZhbHVlcyBpZiBubyBoZWFkZXIgaXMgZm91bmRcbiAgICByZXR1cm4geyB0ZXh0OiAnJywgbGluazogJycgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbGVDb250YWluc0hlYWRpbmcoXG4gICAgZmlsZUNvbnRlbnQ6IHN0cmluZyxcbiAgICBoZWFkaW5nOiBzdHJpbmdcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGZpbGVDb250ZW50TGluZXM6IHN0cmluZ1tdID0gZ2V0TGluZXNJblN0cmluZyhmaWxlQ29udGVudCk7XG4gICAgY29uc3QgbWRIZWFkaW5ncyA9IGdldE1hcmtkb3duSGVhZGluZ3MoZmlsZUNvbnRlbnRMaW5lcywgaGVhZGluZyk7XG4gICAgcmV0dXJuIChtZEhlYWRpbmdzLmxlbmd0aCA+IDApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kRmlyc3RMaW5lQWZ0ZXJGcm9udE1hdHRlcihtYXJrZG93bjogU3RyaW5nKTogTnVtYmVyIHtcbiAgICAvLyBTcGxpdCB0aGUgbWFya2Rvd24gc3RyaW5nIGludG8gbGluZXMuXG4gICAgY29uc3QgbGluZXMgPSBnZXRMaW5lc0luU3RyaW5nKG1hcmtkb3duKTsgLy9tYXJrZG93bi5zcGxpdCgnXFxuJyk7XG5cbiAgICBsZXQgaW5Gcm9udE1hdHRlciA9IGZhbHNlO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgbGluZSA9IGxpbmVzW2ldLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBpZiB0aGUgY3VycmVudCBsaW5lIGlzIGEgZnJvbnQgbWF0dGVyIGRlbGltaXRlci5cbiAgICAgICAgaWYgKGxpbmUgPT09ICctLS0nKSB7XG4gICAgICAgICAgICAvLyBJZiB3ZSBlbmNvdW50ZXIgdGhlIHN0YXJ0IG9mIHRoZSBmcm9udCBtYXR0ZXIsIHNldCB0aGUgZmxhZy5cbiAgICAgICAgICAgIC8vIElmIHdlJ3JlIGFscmVhZHkgaW4gdGhlIGZyb250IG1hdHRlciwgdGhpcyBtYXJrcyBpdHMgZW5kLlxuICAgICAgICAgICAgaW5Gcm9udE1hdHRlciA9ICFpbkZyb250TWF0dGVyO1xuXG4gICAgICAgICAgICAvLyBJZiB3ZSBqdXN0IGVuZGVkIHRoZSBmcm9udCBtYXR0ZXIsIHJldHVybiB0aGUgbmV4dCBsaW5lJ3MgbnVtYmVyLlxuICAgICAgICAgICAgaWYgKCFpbkZyb250TWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkgLy8rIDI7IC8vICsyIHRvIGFkanVzdCBmb3IgemVyby1iYXNlZCBpbmRleGluZyBhbmQgdG8gZ2V0IHRoZSBsaW5lIGFmdGVyIHRoZSBjbG9zaW5nIGRlbGltaXRlci5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIElmIHRoZXJlJ3Mgbm8gZnJvbnQgbWF0dGVyIG9yIHdlIGRpZG4ndCBmaW5kIGEgY2xvc2luZyBkZWxpbWl0ZXIsIHJldHVybiAxICh0aGUgZmlyc3QgbGluZSkuXG4gICAgcmV0dXJuIDA7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpbmVzSW5TdHJpbmcoXG4gICAgaW5wdXQ6IHN0cmluZ1xuKTogQXJyYXkge1xuICAgIC8qY29uc3QgbGluZXM6IHN0cmluZ1tdID0gW107XG4gICAgbGV0IHRlbXBTdHJpbmcgPSBpbnB1dDtcblxuICAgIHdoaWxlICh0ZW1wU3RyaW5nLmluY2x1ZGVzKFwiXFxuXCIpKSB7XG4gICAgICAgIGNvbnN0IGxpbmVFbmRJbmRleCA9IHRlbXBTdHJpbmcuaW5kZXhPZihcIlxcblwiKTtcbiAgICAgICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nLnNsaWNlKDAsIGxpbmVFbmRJbmRleCkpO1xuICAgICAgICB0ZW1wU3RyaW5nID0gdGVtcFN0cmluZy5zbGljZShsaW5lRW5kSW5kZXggKyAxKTtcbiAgICB9XG4gICAgbGluZXMucHVzaCh0ZW1wU3RyaW5nKTtcblxuICAgIHJldHVybiBsaW5lczsqL1xuXG4gICAgY29uc3QgbGluZXMgPSBpbnB1dC5zcGxpdCgnXFxuJyk7XG5cbiAgICAvLyBDaGVjayBpZiB0aGUgbGFzdCBsaW5lIGlzIGVtcHR5IGFuZCByZW1vdmUgaXQgaWYgbmVjZXNzYXJ5LlxuICAgIGlmIChsaW5lcy5sZW5ndGggPiAwICYmIGxpbmVzW2xpbmVzLmxlbmd0aCAtIDFdID09PSAnJykge1xuICAgICAgICBsaW5lcy5wb3AoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbGluZXM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRMaW5lQ2hySW5kZXgoY29udGVudCwgbGluZU51bWJlcikge1xuICBjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuICBpZiAobGluZU51bWJlciA+PSBsaW5lcy5sZW5ndGgpIHtcbiAgICByZXR1cm4gLTE7XG4gIH1cblxuICBsZXQgY2hhcmFjdGVySW5kZXggPSAwO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGxpbmVOdW1iZXI7IGkrKykge1xuICAgIC8vIEFkZCB0aGUgbGVuZ3RoIG9mIGVhY2ggbGluZSBwbHVzIDEgZm9yIHRoZSAnXFxuJyBjaGFyYWN0ZXIgdGhhdCB3YXMgcmVtb3ZlZCBieSBzcGxpdFxuICAgIGNoYXJhY3RlckluZGV4ICs9IGxpbmVzW2ldLmxlbmd0aCArIDE7XG4gIH1cblxuICByZXR1cm4gY2hhcmFjdGVySW5kZXg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0QWZ0ZXJMaW5lKFxuICAgIHRleHQ6IHN0cmluZywgXG4gICAgYm9keTogc3RyaW5nLCBcbiAgICBsaW5lOiBudW1iZXIsIFxuICAgIGZpbGVQYXRoXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIGNvbnN0IHNwbGl0Q29udGVudCA9IGJvZHkuc3BsaXQoXCJcXG5cIik7XG4gICAgY29uc3QgcHJlID0gc3BsaXRDb250ZW50LnNsaWNlKDAsIGxpbmUgKyAxKS5qb2luKFwiXFxuXCIpO1xuICAgIGNvbnN0IHBvc3QgPSBzcGxpdENvbnRlbnQuc2xpY2UobGluZSArIDEpLmpvaW4oXCJcXG5cIik7XG5cbiAgICByZXR1cm4gYCR7cHJlfVxcbiR7dGV4dH1cXG4ke3Bvc3R9YDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldExpc3RUeXBlRnJvbUxpbmVOdW1iZXIoZnVsbFRleHQ6IHN0cmluZywgbGluZU51bWJlcjogbnVtYmVyKTogc3RyaW5nIHtcbiAgICBjb25zdCBsaW5lcyA9IGZ1bGxUZXh0LnNwbGl0KFwiXFxuXCIpO1xuICAgIGlmIChsaW5lTnVtYmVyID49IDAgJiYgbGluZU51bWJlciA8IGxpbmVzLmxlbmd0aCkge1xuICAgICAgICBjb25zdCBsaW5lID0gbGluZXNbbGluZU51bWJlcl07XG5cbiAgICAgICAgY29uc3QgbGVhZGluZ1doaXRlc3BhY2UgPSBsaW5lLm1hdGNoKC9eXFxzKi8pWzBdO1xuXG4gICAgICAgIC8vIENoZWNrIGZvciB1bmNoZWNrZWQgY2hlY2tib3ggbGlzdCBpdGVtcyBmaXJzdFxuICAgICAgICBpZiAoL15cXHMqLVxcc1xcW1xcc1xcXVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGFuIHVuY2hlY2tlZCBjaGVja2JveFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhIFwiY2hlY2tlZFwiIGNoZWNrYm94XG4gICAgICAgIGVsc2UgaWYgKC9eXFxzKi1cXHNcXFt4XFxdXFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKFwiRGV0ZWN0ZWQgYSBjaGVja2VkIGNoZWNrYm94LCBjb252ZXJ0aW5nIHRvIHVuY2hlY2tlZFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBbIF0gXCI7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIFRoZW4gY2hlY2sgZm9yIG5vcm1hbCBkYXNoIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqLVxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhcIkRldGVjdGVkIGEgbm9ybWFsIGJ1bGxldFwiKTtcbiAgICAgICAgICAgIHJldHVybiBsZWFkaW5nV2hpdGVzcGFjZSArIFwiLSBcIjtcbiAgICAgICAgfSBcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG51bWJlcmVkIGxpc3QgaXRlbXNcbiAgICAgICAgZWxzZSBpZiAoL15cXHMqXFxkK1xcLlxccy8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgY29uc3QgbnVtID0gcGFyc2VJbnQobGluZS5tYXRjaCgvXlxccyooXFxkKylcXC4vKVsxXSwgMTApO1xuICAgICAgICAgICAgcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtfS4gYDtcbiAgICAgICAgICAgIC8vcmV0dXJuIGxlYWRpbmdXaGl0ZXNwYWNlICsgYCR7bnVtICsgMX0uIGA7XG4gICAgICAgIH0gXG4gICAgICAgIC8vIENoZWNrIGZvciBhcnJvdyBpdGVtc1xuICAgICAgICBlbHNlIGlmICgvXlxccyo+XFxzLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbGVhZGluZ1doaXRlc3BhY2UgKyBcIj4gXCI7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgIH1cbiAgICByZXR1cm4gXCJcIjsgXG59XG5cblxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGFnRnJvbVN0cmluZyhcbiAgICBpbnB1dFRleHQsIFxuICAgIGhhc2h0YWdUb1JlbW92ZSwgXG4gICAgYWxsOmJvb2xlYW49dHJ1ZVxuKTogc3RyaW5nIHsgIFxuICAgIFxuICAgIC8vY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKFwiXFxcXHM/XCIgKyBoYXNodGFnVG9SZW1vdmUgKyBcIlxcXFxiXCIsIGFsbD9cImdpXCI6XCJpXCIpO1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcbiAgICAgICAgXCJcXFxccz9cIiArIFxuICAgICAgICBoYXNodGFnVG9SZW1vdmUucmVwbGFjZSgvIy9nLCAnXFxcXCMnKSArIFxuICAgICAgICBcIig/IVxcXFx3fFxcXFwvKVwiLCBcbiAgICAgICAgYWxsP1wiZ2lcIjpcImlcIlxuICAgICk7XG5cbiAgICByZXR1cm4gaW5wdXRUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBpbnNlcnRUZXh0SW5TdHJpbmcgKFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBjaGFyUG9zOiBudW1iZXJcbik6c3RyaW5nIHsgLy8gcGFzcyAwIGZvciB0aGUgc3RhcnQgb3Igc291cmNlVGV4dC5sZW5ndGgtMSBmb3IgdGhlIGVuZFxuICAgIC8vY29uc29sZS5sb2coSlNPTi5zdHJpbmdpZnkobmV3VGV4dCkpO1xuICAgIHJldHVybiAoc291cmNlVGV4dC5zdWJzdHJpbmcoMCwgY2hhclBvcykgKyBuZXdUZXh0ICsgJyAnICsgc291cmNlVGV4dC5zdWJzdHJpbmcoY2hhclBvcykpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlVGV4dEZyb21TdHJpbmcgKFxuICAgIHJlbW92ZVRleHQ6IHN0cmluZywgXG4gICAgc291cmNlVGV4dDogc3RyaW5nLCBcbiAgICBhbGw6Ym9vbGVhbj1mYWxzZVxuKTpzdHJpbmcge1xuICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cCh0aGlzLmVzY2FwZVJlZ0V4cChyZW1vdmVUZXh0KSwgYWxsID8gXCJnaVwiIDogXCJpXCIpO1xuICAgIHJldHVybiBzb3VyY2VUZXh0LnJlcGxhY2UocmVnZXgsICcnKS50cmltKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlVGV4dEluU3RyaW5nIChcbiAgICByZXBsYWNlVGV4dDogc3RyaW5nLCBcbiAgICBzb3VyY2VUZXh0OiBzdHJpbmcsIFxuICAgIG5ld1RleHQ6IHN0cmluZywgXG4gICAgYWxsOiBib29sZWFuID0gZmFsc2Vcbik6c3RyaW5nIHtcbi8qY29uc29sZS5sb2coJ1JFUExBQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKSsnPDwnKTtcbmNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbmNvbnNvbGUubG9nKCdTT1VSQ0UgVEVYVCcpO1xuY29uc29sZS5sb2coJz4+Jytzb3VyY2VUZXh0Kyc8PCcpXG5jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG5jb25zb2xlLmxvZygnTkVXIFRFWFQnKTtcbmNvbnNvbGUubG9nKCc+PicrbmV3VGV4dCsnPDwnKSovXG4vL2NvbnNvbGUubG9nKGVzY2FwZVJlZ0V4cChyZXBsYWNlVGV4dC50cmltKCkpKVxuICAgICAgICBjb25zdCBlc2NhcGVkUmVwbGFjZVRleHQgPSBlc2NhcGVSZWdFeHAocmVwbGFjZVRleHQudHJpbSgpKS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG4gICAgICAgIC8vY29uc3QgZXNjYXBlZFJlcGxhY2VUZXh0ID0gZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0KS5yZXBsYWNlKC9cXG4vZywgJ1xcXFxzKlxcXFxuXFxcXHMqJyk7XG5cbiAgICAgICAgLy9jb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKHJlcGxhY2VUZXh0LnRyaW0oKSksIGFsbCA/IFwiZ2lcIiA6IFwiaVwiKTtcbiAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGVzY2FwZWRSZXBsYWNlVGV4dCwgYWxsID8gXCJnc2lcIiA6IFwic2lcIik7XG5cbiAgICAgICAgcmV0dXJuIHNvdXJjZVRleHQudHJpbSgpLnJlcGxhY2UocmVnZXgsIG5ld1RleHQudHJpbSgpKS50cmltKCk7XG4gICAgICAgIC8vcmV0dXJuIHNvdXJjZVRleHQucmVwbGFjZShyZWdleCwgbmV3VGV4dCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0cnVuY2F0ZVN0cmluZ0F0V29yZChcbiAgICBzdHI6IHN0cmluZywgXG4gICAgbWF4Q2hhcnM6bnVtYmVyPTE2XG4pOnN0cmluZyB7XG5cbiAgICBpZiAoc3RyLmxlbmd0aCA8PSBtYXhDaGFycykgcmV0dXJuIHN0cjtcbiAgICBsZXQgdHJ1bmNhdGVkID0gc3RyLnN1YnN0cigwLCBtYXhDaGFycyk7ICBcbiAgICBjb25zdCBsYXN0U3BhY2UgPSB0cnVuY2F0ZWQubGFzdEluZGV4T2YoJyAnKTsgXG4gICAgaWYgKGxhc3RTcGFjZSA+IDApIHRydW5jYXRlZCA9IHRydW5jYXRlZC5zdWJzdHIoMCwgbGFzdFNwYWNlKTtcblxuICAgIHJldHVybiB0cnVuY2F0ZWRcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRlbnRDaGFuZ2VkVG9vTXVjaChcbiAgICBvcmlnaW5hbDogc3RyaW5nLCBcbiAgICBtb2RpZmllZDogc3RyaW5nLCBcbiAgICB0YWc6IHN0cmluZywgXG4gICAgYnVmZmVyID0gNVxuKTogYm9vbGVhbiB7XG4gIGNvbnN0IGV4cGVjdGVkQ2hhbmdlID0gdGFnLmxlbmd0aDsgLy8gaW5jbHVkaW5nIHRoZSAnIycgc3ltYm9sXG4gIGNvbnN0IHRocmVzaG9sZCA9IGV4cGVjdGVkQ2hhbmdlICsgYnVmZmVyOyAvLyBhbGxvdyBmb3Igc29tZSBtaW5vciB1bmludGVuZGVkIG1vZGlmaWNhdGlvbnNcbiAgY29uc3QgYWN0dWFsQ2hhbmdlID0gTWF0aC5hYnMob3JpZ2luYWwubGVuZ3RoIC0gbW9kaWZpZWQubGVuZ3RoKTtcblxuICByZXR1cm4gYWN0dWFsQ2hhbmdlID4gdGhyZXNob2xkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZmlsZU9iakZyb21UYWdzKFxuICAgIHRhZ3M6IEFycmF5XG4pOiBPYmplY3Qge1xuXG4gICAgLy8gUmVtb3ZlIGhhc2hlcyBhbmQgc3BsaXQgdGFncyBpbnRvIGFuIGFycmF5XG4gICAgbGV0IHRhZ3NBcnJheSA9IHRhZ3MubWFwKHRhZyA9PiB0YWcucmVwbGFjZSgvIy9nLCAnJykudG9Mb3dlckNhc2UoKSk7XG5cbiAgICAvLyBGaWx0ZXIgb3V0IGR1cGxpY2F0ZXNcbiAgICB0YWdzQXJyYXkgPSB0YWdzQXJyYXkuZmlsdGVyKCh0YWcsIGluZGV4LCBzZWxmKSA9PiBzZWxmLmluZGV4T2YodGFnKSA9PT0gaW5kZXgpO1xuXG4gICAgLy8gQ29uc3RydWN0IHRoZSBmaWxlIG5hbWVcbiAgICBjb25zdCB0YWdzUGFydCA9IHRhZ3NBcnJheS5qb2luKCcrJyk7XG4gICAgY29uc3QgY3VycmVudERhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIGNvbnN0IGRhdGVQYXJ0ID0gY3VycmVudERhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKSArIC8vJy0nICtcbiAgICAgICAgICAgICAgICAgICAgIChjdXJyZW50RGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgLy8nLScgK1xuICAgICAgICAgICAgICAgICAgICAgY3VycmVudERhdGUuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpLnNsaWNlKC0yKTtcbiAgICBjb25zdCB0aW1lUGFydCA9IC8vY3VycmVudERhdGUuZ2V0SG91cnMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJykgKyAnLScgK1xuICAgICAgICAgICAgICAgICAgICAgLy9jdXJyZW50RGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpICsgJy0nICtcbiAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnREYXRlLmdldFNlY29uZHMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7XG4gICAgLy9jb25zdCBmaWxlTmFtZSA9IGBUYWcgU3VtbWFyeSAoJHt0YWdzUGFydH0pICgke2RhdGVQYXJ0fSkubWRgO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0aW1lUGFydClcbiAgICBjb25zdCBmaWxlTmFtZSA9IGBUYWcgU3VtbWFyeSAoJHtkYXRlUGFydH0gJHt0aW1lUGFydH0pLm1kYDtcblxuICAgIC8vIENvbnN0cnVjdCB0aGUgdGl0bGVcbiAgICBjb25zdCB0aXRsZVRhZ3NQYXJ0ID0gdGFnc0FycmF5Lm1hcCh0YWcgPT4gdGFnLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgdGFnLnNsaWNlKDEpKS5qb2luKCcgKyAnKTtcbiAgICBjb25zdCB0aXRsZSA9IGAke3RpdGxlVGFnc1BhcnR9IFRhZyBTdW1tYXJ5YDtcblxuICAgIC8vIFJldHVybiB0aGUgb2JqZWN0IHdpdGggZmlsZU5hbWUgYW5kIHRpdGxlIHByb3BlcnRpZXNcbiAgICByZXR1cm4ge1xuICAgICAgICBmaWxlTmFtZTogZmlsZU5hbWUsXG4gICAgICAgIHRpdGxlOiB0aXRsZVxuICAgIH07XG59XG5cblxuXG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY3RpdmVGaWxlRm9sZGVyKFxuICAgIGFjdGl2ZUZpbGU6IFRGaWxlXG4pOiBzdHJpbmcge1xuICAgIFxuICAgIC8vY29uc3QgYWN0aXZlRmlsZSA9IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi52aWV3LmZpbGU7XG4gICAgLy9jb25zdCBhY3RpdmVGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBpZiAoIWFjdGl2ZUZpbGUpIHJldHVybiBudWxsO1xuICAgIGxldCBmb2xkZXJQYXRoXG4gICAgaWYgKGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnXFxcXCcpIHx8IGFjdGl2ZUZpbGUucGF0aC5pbmNsdWRlcygnLycpKSB7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBjb3JyZWN0IHBhdGggc2VwYXJhdG9yXG4gICAgICAgIGNvbnN0IHBhdGhTZXBhcmF0b3IgPSBhY3RpdmVGaWxlLnBhdGguaW5jbHVkZXMoJ1xcXFwnKSA/ICdcXFxcJyA6ICcvJztcblxuICAgICAgICBjb25zdCBwYXRoUGFydHMgPSBhY3RpdmVGaWxlLnBhdGguc3BsaXQocGF0aFNlcGFyYXRvcik7XG4gICAgICAgIHBhdGhQYXJ0cy5wb3AoKTsgIC8vIFJlbW92ZSB0aGUgZmlsZSBuYW1lIHBhcnRcbiAgICAgICAgZm9sZGVyUGF0aCA9IHBhdGhQYXJ0cy5qb2luKHBhdGhTZXBhcmF0b3IpO1xuXG4gICAgICAgIC8vIEVuc3VyZSB0aGUgZm9sZGVyIHBhdGggZW5kcyB3aXRoIHRoZSBjb3JyZWN0IHBhdGggc2VwYXJhdG9yXG4gICAgICAgIGlmICghZm9sZGVyUGF0aC5lbmRzV2l0aChwYXRoU2VwYXJhdG9yKSkge1xuICAgICAgICAgICAgZm9sZGVyUGF0aCArPSBwYXRoU2VwYXJhdG9yO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm9sZGVyUGF0aCA9ICcnXG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlclBhdGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRUYWdzRnJvbUFwcChcbiAgICBhcHA6IEFwcCxcbiAgICByZWNlbnRUYWdzOiBBcnJheVxuKTogc3RyaW5nW10ge1xuICAgIGNvbnN0IHRhZ3NPYmplY3QgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCk7XG5cbiAgICAvLyBDb252ZXJ0IHRhZ3NPYmplY3QgdG8gYW4gYXJyYXkgb2YgW3RhZywgY291bnRdIHR1cGxlc1xuICAgIGNvbnN0IHRhZ3NBcnJheSA9IE9iamVjdC5lbnRyaWVzKHRhZ3NPYmplY3QpO1xuXG4gICAgLy8gU29ydCBieSB1c2UgY291bnRcbiAgICB0YWdzQXJyYXkuc29ydCgoYSwgYikgPT4gYlsxXSAtIGFbMV0pO1xuXG4gICAgLy9jb25zdCByZWNlbnRUYWdzID0gdGhpcy5nZXRSZWNlbnRUYWdzKCk7XG4gICAgLy9jb25zdCByZWNlbnRUYWdzID0gcGx1Z2luLmdldFJlY2VudFRhZ3MoKTtcbiAgICAvL2NvbnNvbGUubG9nKCdyZWNlbnQgdGFnIGxlbmd0aDogJyArIHJlY2VudFRhZ3MubGVuZ3RoKVxuXG4gICAgaWYgKHJlY2VudFRhZ3MubGVuZ3RoPjApIHtcbiAgICAgICAgLy9jb25zb2xlLmxvZyhyZWNlbnRUYWdzKVxuICAgICAgICAvLyBjb252ZXJ0IHRoZW0gdG8gW3RhZywgY291bnRdIHR1cGxlcyBmb3IgY29uc2lzdGVuY3lcbiAgICAgICAgY29uc3QgcmVjZW50VGFnc0FzVHVwbGVzID0gcmVjZW50VGFncy5tYXAodGFnID0+IFt0YWcsIDBdKTtcbiAgICAgICAgLy8gQ29uY2F0ZW5hdGUgdGhlIHR3byBhcnJheXNcbiAgICAgICAgY29uc3QgcmVjZW50QW5kQWxsVGFncyA9IHJlY2VudFRhZ3NBc1R1cGxlcy5jb25jYXQodGFnc0FycmF5KTtcbiAgICAgICAgLy8gRXh0cmFjdCB0YWcgbmFtZXMgYWZ0ZXIgcmVtb3ZpbmcgdGhlICNcbiAgICAgICAgcmV0dXJuIHJlY2VudEFuZEFsbFRhZ3MubWFwKChbdGFnLCBfXSkgPT4gdGFnLnJlcGxhY2UoL14jLywgXCJcIikpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0YWdzQXJyYXkubWFwKChbdGFnLCBfXSkgPT4gdGFnLnJlcGxhY2UoL14jLywgXCJcIikpO1xuICAgIH1cbn1cblxuIGV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZUZpbGVQYXRoIChcbiAgICBmaWxlUGF0aDogc3RyaW5nXG4pOiBURmlsZSB7XG4gICAgY29uc3QgbWF0Y2hpbmdGaWxlcyA9IGF3YWl0IGFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihmaWxlID0+IGZpbGUubmFtZSA9PT0gZmlsZVBhdGgpO1xuICAgIGlmIChtYXRjaGluZ0ZpbGVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IG1hdGNoaW5nRmlsZXNbMF0ucGF0aDtcbiAgICAgICAgY29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ1ZhbGlkYXRlIGZpbGU6ICcgKyBlbWJlZEZpbGUubmFtZSk7XG4gICAgICAgIHJldHVybiBmaWxlO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPiAxKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogTXVsdGlwbGUgZmlsZXMgZm91bmQgd2l0aCB0aGUgc2FtZSBuYW1lLiBDYW5cXCd0IHNhZmVseSBlZGl0IHRhZy4nKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgbmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBObyBmaWxlIGZvdW5kLiBUcnkgYWdhaW4sIG9yIHRoaXMgdGFnIG1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIGVtYmVkIHR5cGUuJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cblxuXG5cbi8vIFVwZGF0ZWQgdG8gYWxsb3cgc2FtZSBmaWxlIG5hbWVzIGFzIGxvbmcgYXMgcGF0aCBpcyBkaWZmZXJlbnRcbi8vIFRvIHVzZSB0aGlzIHdlIG5lZWQgdG8gYmUgc3RvcmluZyB0aGUgd2hvbGUgZmlsZSBwYXRoIGluIHRoZSBIVE1MLCBub3QganVzdCB0aGUgbmFtZVxuLy8gVGhpcyBpcyBhIGJpZ2dlciBjaGFuZ2Ugd2UgbmVlZCB0byBkZWRpY2F0ZSB0aW1lIGZvci4gQW5kIHRlc3RpbmcuIFdoYXQgZG9lcyB0aGlzIGltcGFjdD9cbi8qZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZhbGlkYXRlRmlsZVBhdGgoXG4gICAgZmlsZVBhdGg6IHN0cmluZ1xuKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcbiAgICAvLyBUcnkgdG8gZ2V0IHRoZSBmaWxlIGJ5IHRoZSBmdWxsIHBhdGhcbiAgICBjb25zdCBmaWxlID0gYXdhaXQgYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cbiAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgLy8gUmV0dXJuIHRoZSBmaWxlIGlmIGl0IGV4aXN0cyBhbmQgaXMgYSB2YWxpZCBURmlsZVxuICAgICAgICByZXR1cm4gZmlsZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBIYW5kbGUgdGhlIGNhc2Ugd2hlcmUgdGhlIGZpbGUgaXMgbm90IGZvdW5kIG9yIGlzIG5vdCBhIFRGaWxlXG4gICAgICAgIG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogRmlsZSBub3QgZm91bmQgb3IgaW52YWxpZC4gUGxlYXNlIGNoZWNrIHRoZSBwYXRoIGFuZCB0cnkgYWdhaW4uJyk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbiovXG5cbmV4cG9ydCBmdW5jdGlvbiBjdHJsQ21kS2V5IChcbiAgICBldmVudDogRXZlbnRcbik6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGlzTWFjID0gUGxhdGZvcm0uaXNNYWNPUyAvLyAobmF2aWdhdG9yLnBsYXRmb3JtLnRvVXBwZXJDYXNlKCkuaW5kZXhPZignTUFDJykgPj0gMCk7XG5cbiAgICBpZiAoaXNNYWMpIHJldHVybiBldmVudC5tZXRhS2V5O1xuICAgIGVsc2UgcmV0dXJuIGV2ZW50LmN0cmxLZXk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB0YWdzSW5TdHJpbmcoXG4gICAgc3RyaW5nOiBzdHJpbmcsIFxuICAgIHRhZz86IHN0cmluZ1xuKTogc3RyaW5nW10ge1xuICAgIGxldCByZWdleDtcbiAgICBpZiAodGFnKSB7XG4gICAgICAgIHJlZ2V4ID0gbmV3IFJlZ0V4cCh0YWcucmVwbGFjZSgvXFwvL2csICdcXFxcLycpICsgXCIoPyFbXFxcXHdcXFxcL1xcXFwjXSlcIiwgXCJnXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE1hdGNoIGFueSB0YWctbGlrZSBwYXR0ZXJuIHN0YXJ0aW5nIHdpdGggJyMnXG4gICAgICAgIHJlZ2V4ID0gLyMoXFx3KykoPyFbXFx3XFwvI10pL2c7XG4gICAgfVxuICAgIGNvbnN0IG1hdGNoZXMgPSBzdHJpbmcubWF0Y2gocmVnZXgpO1xuXG4gICAgcmV0dXJuIG1hdGNoZXMgfHwgW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb3VudE9jY3VycmVuY2VzKFxuICAgIHN1bW1hcnlUYWdzOiBBcnJheSwgXG4gICAgY29udGVudFRhZ3Ncbik6IG51bWJlciB7XG4gICAgbGV0IGNvdW50ID0gMDtcbiAgICBmb3IgKGxldCB0YWcgb2Ygc3VtbWFyeVRhZ3MpIHtcbiAgICAgICAgY291bnQgKz0gY29udGVudFRhZ3MuZmlsdGVyKGl0ZW0gPT4gaXRlbSA9PT0gdGFnKS5sZW5ndGg7XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gb3V0ZXJIVE1MVG9FbGVtZW50KG91dGVySFRNTDogc3RyaW5nKTogSFRNTEVsZW1lbnQgfCBudWxsIHtcbiAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICB0ZW1wRGl2LmlubmVySFRNTCA9IG91dGVySFRNTDtcbiAgcmV0dXJuIHRlbXBEaXYuZmlyc3RDaGlsZCBhcyBIVE1MRWxlbWVudDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVzY2FwZVJlZ0V4cChcbiAgICBzdHJpbmc6IHN0cmluZ1xuKTpzdHJpbmcge1xuICAgIHJldHVybiBzdHJpbmcucmVwbGFjZSgvWy4qKz9eJHt9KCl8W1xcXVxcXFxdL2csICdcXFxcJCYnKTsgLy8gJCYgbWVhbnMgdGhlIHdob2xlIG1hdGNoZWQgc3RyaW5nXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRFbWJlZEZpbGUgKFxuICAgIGVsOiBIVE1MRWxlbWVudFxuKTpURmlsZSB7XG4gICAgbGV0IGZpbGVQYXRoID0gZWwuZ2V0QXR0cmlidXRlKCdzcmMnKTtcbiAgICBjb25zdCBsaW5rQXJyYXkgPSBmaWxlUGF0aC5zcGxpdCgnIycpO1xuICAgIGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB2YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKTtcbiAgICByZXR1cm4gZmlsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVGFnVmFsaWQgKFxuICAgIHRhZzogU3RyaW5nLFxuICAgIGZ1bGxUYWc6IEJvb2xlYW4gPSBmYWxzZVxuKTpib29sZWFuIHsgXG4gICAgbGV0IHRhZ1BhdHRlcm4gXG4gICAgaWYgKGZ1bGxUYWcpIHRhZ1BhdHRlcm4gPSAvXiNbYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIC8vZWxzZSB0YWdQYXR0ZXJuID0gLyg/PVteXFxkXFxzXSspW2EtekEtWjAtOV9cXC1cXC9dKy9nXG4gICAgZWxzZSB0YWdQYXR0ZXJuID0gL15bYS16QS1aMC05X1xcLVxcL10qW2EtekEtWl9cXC1cXC9dW2EtekEtWjAtOV9cXC1cXC9dKiQvO1xuICAgIHJldHVybiB0YWdQYXR0ZXJuLnRlc3QodGFnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGV4dHJhY3RWYWxpZFRhZ3ModGFnc1N0cmluZzogc3RyaW5nKTogc3RyaW5nW10ge1xuICAgIC8vIFNwbGl0IHRoZSBzdHJpbmcgYnkgY29tbWFzIHRvIGdldCBpbmRpdmlkdWFsIHRhZ3NcbiAgICBjb25zdCBwb3RlbnRpYWxUYWdzID0gdGFnc1N0cmluZy5zcGxpdCgnLCcpO1xuXG4gICAgLy8gRmlsdGVyIG91dCB2YWxpZCB0YWdzXG4gICAgY29uc3QgdmFsaWRUYWdzID0gcG90ZW50aWFsVGFnc1xuICAgICAgICAubWFwKHRhZyA9PiB0YWcudHJpbSgpKSAvLyBUcmltIGVhY2ggdGFnXG4gICAgICAgIC5maWx0ZXIodGFnID0+IGlzVGFnVmFsaWQodGFnLCB0cnVlKSk7IC8vIFVzZSB0aGUgaXNUYWdWYWxpZCBmdW5jdGlvbiB0byBjaGVjayB2YWxpZGl0eVxuXG4gICAgcmV0dXJuIHZhbGlkVGFncztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGN0cmxDbWRTdHIgKCk6IHN0cmluZyB7XG4gICAgY29uc3QgaXNNYWMgPSBQbGF0Zm9ybS5pc01hY09TIC8vKG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpID49IDApO1xuICAgIGlmIChpc01hYykgcmV0dXJuICdDTUQnO1xuICAgIGVsc2UgcmV0dXJuICdDVFJMJztcbn1cbiIsICJpbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBTdWdnZXN0TW9kYWwsIE1vZGFsLCBTZXR0aW5nLCBOb3RpY2UsIFRGaWxlLCByZW5kZXJSZXN1bHRzLCBwcmVwYXJlRnV6enlTZWFyY2gsIEZ1enp5TWF0Y2gsIGZ1enp5U2VhcmNoLCBwcmVwYXJlUXVlcnkgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIFRhZ1NlbGVjdG9yIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8c3RyaW5nPiB7XG4gICAgcGx1Z2luOiBUYWdCdWRkeVxuICAgIGFwcDogQXBwO1xuICAgIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWRcbiAgICB0YWc6IHN0cmluZ1xuICAgIGlucHV0TGlzdGVuZXI6IEV2ZW50TGlzdGVuZXJcbiAgICB0YWdDYWNoZTogc3RyaW5nW11cbiAgICBsb2NhdGlvbjogT2JqZWN0O1xuICAgIGhlaWdodCA9IDIxNTtcbiAgICBub1NlbGVjdGlvbiA9IGZhbHNlO1xuICAgIFxuICAgIFxuICAgIGNvbnN0cnVjdG9yIChhcHA6IEFwcCwgcGx1Z2luOiBUYWdCdWRkeSwgZXZlbnQ6RXZlbnQsIG9uQ2hvb3NlSXRlbUNhbGxiYWNrOiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpe1xuICAgICAgICBzdXBlcihhcHApXG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpblxuICAgICAgICB0aGlzLnRhZyA9ICcnXG4gICAgICAgIHRoaXMub25DaG9vc2VJdGVtQ2FsbGJhY2sgPSBvbkNob29zZUl0ZW1DYWxsYmFja1xuICAgICAgICB0aGlzLmlucHV0TGlzdGVuZXIgPSB0aGlzLmxpc3RlbklucHV0LmJpbmQodGhpcylcbiAgICAgICAgdGhpcy50YWdDYWNoZSA9IFtdXG4gICAgICAgIGlmIChldmVudCAhPSBudWxsKSB0aGlzLmxvY2F0aW9uID0ge3g6IGV2ZW50LnBhZ2VYLCB5OiBldmVudC5wYWdlWX1cbiAgICAgICAgLy90aGlzLmxpbWl0ID0gMTBcbiAgICAgICAgLy90aGlzLmVtcHR5U3RhdGVUZXh0ID0gJ0FkZCBuZXcgdGFnJ1xuICAgICAgICAvLyB0byBhZGQgYSBicmFuZCBuZXcgdGFnIHdlJ2QgZWl0aGVyIG5lZWQgdG86XG4gICAgICAgIC8vIC0gU0hJRlQgYWxyZWFkeSB3b3Jrcy4gYnV0IGZvciBtb2JpbGU/XG4gICAgICAgIC8vIC0gaGF2ZSBhbm90aGVyIGJ1dHRvbiBvbiBmYXIgcmlnaHQgb24gaW5wdXQgdG8gYWRkIChmb3IgbW9iaWxlKVxuICAgICAgICAvLyB0aGlzIHNlbGVjdG9yIGlzIGFsc28gd2hlcmUgd2UgY2FuIGFkZCBhbiBlZGl0IGljb24gbmV4dCB0byBlYWNoIHRhZy4gXG4gICAgICAgIC8vIGNsaWNraW5nIHRoaXMgd291bGQgYnJpbmcgdXAgdGhlIGVkaXQgbW9kYWxcbiAgICAgICBcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuc2V0UGxhY2Vob2xkZXIoXCJcIilcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBpZiAoIXRoaXMuYXBwLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICB0aGlzLnJlc3VsdENvbnRhaW5lckVsLnBhcmVudE5vZGUuc3R5bGUud2lkdGggPSAnMjAwcHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5zdHlsZS5oZWlnaHQgPSAnMjE1cHgnO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLmxlZnQgPSBgJHt0aGlzLmxvY2F0aW9uLnh9cHhgO1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRDb250YWluZXJFbC5wYXJlbnROb2RlLnN0eWxlLnRvcCA9IGAke3RoaXMubG9jYXRpb24ueX1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57IHRoaXMuaW5wdXRFbC5mb2N1cygpIH0sIDUwMCk7IC8vIG5vdCB3b3JraW5nP1xuICAgICAgICB9XG4gICAgICAgIHN1cGVyLm9uT3BlbigpXG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5pbnB1dExpc3RlbmVyKVxuICAgICAgICBzdXBlci5vbkNsb3NlKClcbiAgICB9XG5cbiAgICBsaXN0ZW5JbnB1dChldmVudDogS2V5Ym9hcmRFdmVudCl7XG4gICAgICAgIHRoaXMubm9TZWxlY3Rpb24gPSBmYWxzZTtcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgY29uc3QgaXRlbXNIZWlnaHQgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKHRoaXMuaW5wdXRFbC52YWx1ZSkubGVuZ3RoICogNDI7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLm1pbih0aGlzLmhlaWdodCwgTWF0aC5tYXgoNjUsIGl0ZW1zSGVpZ2h0KSlcbiAgICAgICAgICAgIHRoaXMucmVzdWx0Q29udGFpbmVyRWwuc3R5bGUuaGVpZ2h0ID0gYCR7aGVpZ2h0fXB4YDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChldmVudC5rZXkgPT0gXCJFbnRlclwiICYmICF0aGlzLm5vU2VsZWN0aW9uKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0gdGhpcy5pbnB1dEVsLnZhbHVlLnRyaW0oKTtcbiAgICAgICAgICAgIGNvbnN0IHBhdHRlcm4gPSAvKD89W15cXGRcXHNdKylbYS16QS1aMC05X1xcLVxcL10rL2dcbiAgICAgICAgICAgIGlmIChwYXR0ZXJuLnRlc3QodGV4dCkpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW0odGhpcy5pbnB1dEVsLnZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnSW52YWxpZCB0YWcuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKmdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpIDogc3RyaW5nW117XG4gICAgICAgIGNvbnN0IGZpbHRlcmVkVGFncyA9IFV0aWxzLmdldFRhZ3NGcm9tQXBwKFxuICAgICAgICAgICAgdGhpcy5hcHAsIFxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uZ2V0UmVjZW50VGFncygpKS5maWx0ZXIodGFnID0+IFxuICAgICAgICAgICAgLy90YWcudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxdWVyeS50b0xvd2VyQ2FzZSgpKVxuICAgICAgICAgICAgcXVlcnkgPT0gJycgPyB0cnVlIDogdGFnLnRvTG93ZXJDYXNlKCkgPT0gcXVlcnkudG9Mb3dlckNhc2UoKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZmlsdGVyZWRUYWdzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oaGVhZGVyOiBzdHJpbmcsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBlbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IGhlYWRlciB9KTtcbiAgICB9Ki9cblxuICAgIG9uTm9TdWdnZXN0aW9uKCl7XG4gICAgICAgIHN1cGVyLm9uTm9TdWdnZXN0aW9uKClcbiAgICAgICAgdGhpcy5ub1NlbGVjdGlvbiA9IHRydWU7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ25vIHN1Z2dlc3Rpb25zJylcbiAgICB9XG5cbiAgICBnZXRJdGVtcygpOiBzdHJpbmdbXSB7XG4gICAgICAgY29uc3QgZmlsdGVyZWRUYWdzID0gVXRpbHMuZ2V0VGFnc0Zyb21BcHAoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5nZXRSZWNlbnRUYWdzKClcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmaWx0ZXJlZFRhZ3M7XG4gICAgfVxuXG4gICAgZ2V0SXRlbVRleHQodGFnOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGFnXG4gICAgfVxuXG4gICAgYXN5bmMgb25DaG9vc2VJdGVtKHJlc3VsdDogc3RyaW5nKSB7XG4vL2NvbnNvbGUubG9nKHJlc3VsdClcbiAgICAgICAgaWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuICAgICAgICAgICAgdGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpPT57dGhpcy5vbkNob29zZUl0ZW1DYWxsYmFjayhyZXN1bHQpfSwgMjUwKVxuICAgICAgICB9XG4gICAgfVxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBURmlsZSwgU2V0dGluZywgU2VsZWN0RmlsZU1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBUZXh0Q29tcG9uZW50LCBQcm9ncmVzc0JhckNvbXBvbmVudH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVEJUYWdFZGl0b3JNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICAvL29yaWdpbmFsVGFnOiBTdHJpbmdzXG4gICAgb3B0aW9uc0RpdjogSFRNTEVsZW1lbnQ7XG4gICAgZWRpdERpdjogSFRNTEVsZW1lbnQ7XG4gICAgaW5wdXQ6IFRleHRDb21wb25lbnQ7XG4gICAgLy9zdWJtaXRCdG46IEJ1dHRvbkNvbXBvbmVudDtcbiAgICB0YWdBY3Rpb25Ecm9wZG93bjogRHJvcGRvd25Db21wb25lbnQ7XG4gICAgcGx1Z2luOiBUYWdCdWRkeTtcblxuICAgIHNldHRpbmdzID0ge1xuICAgICAgICBvcmlnaW5hbFRhZzogJycsXG4gICAgICAgIG9yaWdpbmFsSW5kZXg6IG51bGwsXG4gICAgICAgIHRhZ0VsOiBudWxsLFxuICAgICAgICBmaWxlUGF0aDogbnVsbCxcbiAgICAgICAgYmF0Y2hBY3Rpb246ICdpbnN0YW5jZScsXG4gICAgICAgIG5ld05hbWU6ICcnLFxuICAgICAgICBzdW1tYXJ5UG9zOiAndG9wJyxcbiAgICAgICAgYWN0aW9uOiAncmVuYW1lJ1xuICAgIH07XG5cbiAgICAvL2NvbnN0cnVjdG9yKGFwcDogQXBwLCB0YWc6IFN0cmluZywgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5LCB0YWc6IHN0cmluZywgaW5kZXg6IG51bWJlciwgZmlsZVBhdGg6IHN0cmluZyA9IG51bGwsIHRhZ0VsOiBIVE1MRWxlbWVudCA9IG51bGwpIHtcbiAgICAvL2NvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFRhZ0J1ZGR5LCB0YWdFbDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4vL2NvbnNvbGUubG9nKHRhZ0VsKVxuICAgICAgICB0aGlzLnNldHRpbmdzLnRhZ0VsID0gdGFnRWw7XG4gICAgICAgIC8vdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4ID0gcGFyc2VJbnQgKHRhZ0VsLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKSk7XG4gICAgICAgIC8vdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyA9IHRhZ0VsLmlubmVyVGV4dDtcbiAgICAgICAgLy90aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9vbiA9IHRhZ0VsLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblxuICAgICAgICB0aGlzLnNldHRpbmdzLmZpbGVQYXRoID0gZmlsZVBhdGhcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyA9IHRhZztcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4ID0gaW5kZXg7XG4gICAgICAgIC8vdGhpcy5vcmlnaW5hbFRhZyA9IHRhZztcbiAgICAgICAgLy90aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgfVxuIFxuICAgIG9uT3BlbiAoKSB7XG4gICAgICAgIGxldCB7IGNvbnRlbnRFbCwgdGl0bGVFbCAsIG1vZGFsRWwsIGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG4gICAgICAgIHRpdGxlRWwuc2V0VGV4dChcIlRhZyBBY3Rpb25zXCIpXG5cbiAgICAgICAgdGhpcy5lZGl0RGl2ID0gY3JlYXRlRWwoJ2RpdicpXG4gICAgICAgIHRoaXMuZWRpdERpdi5jbGFzc0xpc3QuYWRkICgndGFnLWVkaXRvci1lZGl0LWRpdicpXG5cbiAgICAgICAgdGhpcy5vcHRpb25zRGl2ID0gY3JlYXRlRWwgKCdkaXYnKTtcbiAgICAgICAgdGhpcy5vcHRpb25zRGl2LmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLW9wdGlvbnMnKVxuXG4gICAgICAgIHRoaXMuaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh0aGlzLmVkaXREaXYpO1xuICAgICAgICB0aGlzLmlucHV0LmlucHV0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItaW5wdXQnKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHRoaXMuZWRpdERpdilcbiAgICAgICAgLmFkZE9wdGlvbigncmVuYW1lJywgXCJSZW5hbWVcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ2xvd2VyJywgXCJDb252ZXJ0IHRvIGxvd2VyIGNhc2VcIikgXG4gICAgICAgIC5hZGRPcHRpb24oJ3RvdGV4dCcsIFwiUmVtb3ZlIGhhc2ggKCMpXCIpIFxuICAgICAgICAuYWRkT3B0aW9uKCdzdW1tYXJ5JywgXCJDcmVhdGUgc3VtbWFyeVwiKTsgXG4gICAgICAgIHRoaXMudGFnQWN0aW9uRHJvcGRvd24uc2VsZWN0RWwuY2xhc3NMaXN0LmFkZCAoJ3RhZy1lZGl0b3ItZHJvcGRvd24nKTtcblxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKHRoaXMuZWRpdERpdilcbiAgICAgICAgY29udGVudEVsLmFwcGVuZENoaWxkKHRoaXMub3B0aW9uc0RpdilcblxuICAgICAgICB0aGlzLnNob3dFZGl0VGFnT3B0aW9ucygncmVuYW1lJyk7ICAgXG4gICAgXG4gICAgICAgIGNvbnN0IGhyID0gY3JlYXRlRWwgKCdocicpXG4gICAgICAgIGhyLmNsYXNzTGlzdC5hZGQgKCd0YWctZWRpdG9yLWhyJyk7IFxuICAgICAgICBjb250ZW50RWwuYXBwZW5kQ2hpbGQgKGhyKTtcblxuICAgICAgICB0aGlzLnRhZ0FjdGlvbkRyb3Bkb3duLm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5hY3Rpb24gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBcInN1bW1hcnlcIikge1xuICAgICAgICAgICAgICAgIHRoaXMuc2hvd1N1bW1hcnlPcHRpb25zICgpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvL2lmIChlZGl0RGl2LmNvbnRhaW5zKHN1bW1hcnlPcHRTZWxlY3RFbCkpIGVkaXREaXYucmVtb3ZlQ2hpbGQoc3VtbWFyeU9wdFNlbGVjdEVsKVxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0VkaXRUYWdPcHRpb25zICh2YWx1ZSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7IFxuXG4gICAgICAgIGNvbnN0IHN1Ym1pdEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGVudEVsKVxuICAgICAgICAgICAgLnNldENsYXNzICgndGFnLWVkaXRvci1zdWJtaXQnKVxuICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoJ1N1Ym1pdCcpXG4gICAgICAgICAgICAub25DbGljayAoKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3VibWl0VGFnRWRpdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApXG4gICAgfVxuXG4gICAgc3VibWl0VGFnRWRpdCAoKSB7XG5cbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzKVxuXG4gICAgICAgIC8vY29uc3Qgc3RhcnRzV2l0aEhhc2g6IEJvb2xlYW4gPSB0aGlzLnNldHRpbmdzLm5ld05hbWUudHJpbSgpWzBdID09ICcjJztcbiAgICAgICAgY29uc3QgaXNWYWxpZFRhZzogQm9vbGVhbiA9IFV0aWxzLmlzVGFnVmFsaWQodGhpcy5zZXR0aW5ncy5uZXdOYW1lLnRyaW0oKSwgdHJ1ZSlcbiAgICAgICAgY29uc3QgYWN0aW9uOiBTdHJpbmcgPSB0aGlzLnNldHRpbmdzLmFjdGlvbjtcbiAgICAgICAgbGV0IG5ld05hbWU6IFN0cmluZyA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWc7XG5cbiAgICAgICAgaWYgKGFjdGlvbiA9PSAnc3VtbWFyeScpIHtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcnlUYWdzOiBBcnJheSA9IFV0aWxzLmV4dHJhY3RWYWxpZFRhZ3MgKHRoaXMuaW5wdXQuZ2V0VmFsdWUoKSk7XG4gICAgICAgICAgICBpZiAoc3VtbWFyeVRhZ3MubGVuZ3RoIDwgMSkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UgKCdJbnZhbGlkIHRhZyBmb3JtYXQuJylcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5jcmVhdGVDb2RlQmxvY2soc3VtbWFyeVRhZ3MsIHRoaXMuc2V0dGluZ3Muc3VtbWFyeVBvcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGFjdGlvbiA9PSAncmVuYW1lJyAmJiAhaXNWYWxpZFRhZykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSAoJ0ludmFsaWQgdGFnIGZvcm1hdC4nKVxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9oZWxwLm9ic2lkaWFuLm1kL0VkaXRpbmcrYW5kK2Zvcm1hdHRpbmcvVGFncyNUYWcrZm9ybWF0XG4gICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgIGlmIChhY3Rpb24gPT0gJ3JlbmFtZScpIG5ld05hbWUgPSB0aGlzLnNldHRpbmdzLm5ld05hbWU7XG4gICAgICAgICAgICBlbHNlIGlmIChhY3Rpb24gPT0gJ2xvd2VyJykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgIGVsc2UgaWYgKGFjdGlvbiA9PSAndG90ZXh0JykgbmV3TmFtZSA9IHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcuc3Vic3RyaW5nKDEpO1xuXG4gICAgICAgICAgICAvL2lmICh0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uID09ICdpbnN0YW5jZScpIHtcbi8vIHRoaXMgaXNuJ3Qgd29ya2luZy4gc29lbXRoaW5nIGFib3V0IGhvdyBJJ20gbG9vcGluZyBhcm91bmQgd2l0aCBlZGl0IGFuZCByZW5hbWUuIG1pZ2h0IG5vdCB3b3JrLiBcbiAgICAgICAgICAgICAgICAvLyBhbmQgaWYgbm90IHdlIGNhbid0IG1ha2UgZW1iZGVkIG9yIHN1bW1hcnkgZWRpdHMgZWRpdHMgXG4gICAgICAgICAgICAgICAgLy90aGlzLnBsdWdpbi50YWdFZGl0b3IuZWRpdCAodGhpcy5zZXR0aW5ncy50YWdFbCwgbnVsbCwgbnVsbCwgJ3JlbmFtZScsIG5ld05hbWUpXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnRWRpdG9yLnJlbmFtZVRhZyAoXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxUYWcsXG4gICAgICAgICAgICAgICAgICAgIG5ld05hbWUsXG4gICAgICAgICAgICAgICAgICAgICgodGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9PSAnaW5zdGFuY2UnKSA/IHBhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCkgOiB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5maWxlUGF0aCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy50YWdFbFxuICAgICAgICAgICAgICAgICAgICAvL3BhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCksXG5cbiAgICAgICAgICAgICAgICAgICAgLy8oKHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPT0gJ2luc3RhbmNlJykgPyBwYXJzZUludCh0aGlzLnNldHRpbmdzLm9yaWdpbmFsSW5kZXgpIDogdGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbilcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUodGFnRWwuY2xvc2VzdCgpKTsgXG4gICAgICAgICAgICAgICAgICAgIHBhcmFncmFwaEVsLnJlbW92ZSgpOyBcbiAgICAgICAgICAgICAgICB9LCA1MDApOyAgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgLyogZWxzZSB7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi50YWdFZGl0b3IucmVuYW1lVGFnIChcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyxcbiAgICAgICAgICAgICAgICAgICAgLy90aGlzLnNldHRpbmdzLnRhZ0VsLFxuICAgICAgICAgICAgICAgICAgICBuZXdOYW1lLFxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uXG4gICAgICAgICAgICAgICAgICAgIC8vcGFyc2VJbnQodGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4KSxcblxuICAgICAgICAgICAgICAgICAgICAvLygodGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9PSAnaW5zdGFuY2UnKSA/IHBhcnNlSW50KHRoaXMuc2V0dGluZ3Mub3JpZ2luYWxJbmRleCkgOiB0aGlzLnNldHRpbmdzLmJhdGNoQWN0aW9uKVxuICAgICAgICAgICAgICAgIClcblxuICAgICAgICAgICAgfSovXG5cbiAgICAgICAgICAgIFxuICAgICAgICAvL31cblxuICAgIH1cblxuICAgIHNob3dTdW1tYXJ5T3B0aW9ucyAoKSB7XG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQoZmFsc2UpXG5cbiAgICAgICAgbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgZG8geW91IHdhbnQgdG8gYWRkIHRoZSB0YWcgc3VtbWFyeT9cIilcbiAgICAgICAgICAgIC5zZXREZXNjKFwiQWRkIG11bHRpcGxlIHRhZ3MgYWJvdmUgc2VwYXJhdGVkIGJ5IGEgY29tbWEuXCIpXG4gICAgICAgICAgICAuYWRkRHJvcGRvd24oKG9wdCkgPT5cbiAgICAgICAgICAgICAgICBvcHRcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCd0b3AnLCBcIlRvcCBvZiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdlbmQnLCBcIkJvdHRvbSBvZiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgICAgICAvLy5hZGRPcHRpb24oJ2hlcmUnLCBcIkluIHBsYWNlIG9mIHRoaXMgdGFnXCIpXG4gICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbm90ZScsIFwiSW4gYSBuZXcgbm90ZVwiKSBcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5zdW1tYXJ5UG9zID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnNldHRpbmdzLnN1bW1hcnlQb3MpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICApOyBcbiAgICB9XG5cblxuICAgIHNob3dFZGl0VGFnT3B0aW9ucyAoZWRpdFR5cGU6IFN0cmluZykge1xuXG4gICAgICAgIHRoaXMub3B0aW9uc0Rpdi5lbXB0eSgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXQuc2V0VmFsdWUodGhpcy5zZXR0aW5ncy5vcmlnaW5hbFRhZyk7XG4gICAgICAgIHRoaXMuaW5wdXQuc2V0RGlzYWJsZWQodHJ1ZSlcblxuICAgICAgICBpZiAoZWRpdFR5cGUgPT0gJ3JlbmFtZScpIHtcbiAgICAgICAgICAgIGNvbnN0IG5ld05hbWUgPSBuZXcgU2V0dGluZyh0aGlzLm9wdGlvbnNEaXYpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoXCJOZXcgbmFtZVwiKVxuICAgICAgICAgICAgICAgIC5zZXREZXNjKFwiVGFncyBjYW4gaW5jbHVkZSBsZXR0ZXJzLCBudW1iZXJzLCB1bmRlcnNjb3JlcyAoXyksIGh5cGhlbnMgKC0pLCBhbmQgZm9yd2FyZCBzbGFzaGVzICgvKSBmb3IgbmVzdGVkIHRhZ3MuXCIpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQoKG9wdCkgPT5cbiAgICAgICAgICAgICAgICAgICAgb3B0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSgnJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWx1ZSkgPT4geyBcbiAgICAgICAgICAgICAgICAgICAgICAgLy90aGlzLmlucHV0Q2hhbmdlSGFuZGxlciAodmFsdWUsIGVkaXRUeXBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5uZXdOYW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgd2hlcmVFZGl0T3B0ID0gbmV3IFNldHRpbmcgKHRoaXMub3B0aW9uc0RpdilcbiAgICAgICAgICAgIC5zZXROYW1lKFwiV2hlcmUgdG8gbWFrZSB0aGlzIGNoYW5nZT9cIilcbiAgICAgICAgICAgIC8vLnNldERlc2MoXCJXQVJOSU5HOiBUaGVyZSBpcyBOTyBVTkRPIGZvciB0aGlzIHRoaXMgYWN0aW9uLlwiKVxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKChvcHQpID0+XG4gICAgICAgICAgICBvcHRcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ2luc3RhbmNlJywgXCJKdXN0IHRoaXMgaW5zdGFuY2VcIilcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ25vdGUnLCBcIkFsbCBpbiB0aGlzIG5vdGVcIilcbiAgICAgICAgICAgIC5hZGRPcHRpb24oJ3ZhdWx0JywgXCJBY3Jvc3MgZW50aXJlIHZhdWx0XCIpXG4gICAgICAgICAgICAub25DaGFuZ2UoKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlID09ICd2YXVsdCcpIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmVFZGl0T3B0LnNldERlc2MoXCJXQVJOSU5HOiBUaGVyZSBpcyBOTyBVTkRPIGZvciB2YXVsdCBjaGFuZ2VzLiBDb25zaWRlciBtYWtpbmcgYSBiYWNrdXAgb2YgeW91ciB2YXVsdCBmaXJzdC5cIilcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbiA9ICd2YXVsdCc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSAnbm90ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgd2hlcmVFZGl0T3B0LnNldERlc2MoXCJPbmx5IHRhZ3MgaW4gdGhpcyBub3RlIHdpbGwgYmUgdXBkYXRlZC4gQ2hvb3NlIFxcJ0Fjcm9zcyBlbnRpcmUgdmF1bHRcXCcgdG8gdXBkYXRlIHRoaXMgdGFnIGV2ZXJ5d2hlcmUuXCIpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPSAnbm90ZSc7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSAnaW5zdGFuY2UnKSB7XG4gICAgICAgICAgICAgICAgICAgIHdoZXJlRWRpdE9wdC5zZXREZXNjKFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb24gPSAnaW5zdGFuY2UnO1xuICAgICAgICAgICAgICAgICAgICAvL3RoaXMuc2V0dGluZ3MuYmF0Y2hBY3Rpb29uID0gdGhpcy5zZXR0aW5ncy5vcmlnaW5hbEluZGV4XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2codGhpcy5zZXR0aW5ncy5iYXRjaEFjdGlvbilcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgb25DbG9zZSgpIHtcbiAgICAgICAgbGV0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcbiAgICB9XG5cblxufVxuXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlLCBGdXp6eVN1Z2dlc3RNb2RhbCwgU3VnZ2VzdE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbmV4cG9ydCBjbGFzcyBTZWxlY3RGaWxlTW9kYWwgZXh0ZW5kcyBTdWdnZXN0TW9kYWw8VEZpbGU+IHtcbiAgcmVzdWx0OiBURmlsZTtcbiAgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkO1xuICBmaWxlTGlzdDogVEZpbGVbXTtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IFRGaWxlKSA9PiB2b2lkKSB7XG4gICAgc3VwZXIoYXBwKTtcbiAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG5cbiAgICB0aGlzLmZpbGVMaXN0ID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICB9XG5cbiAgLy8gUmV0dXJucyBhbGwgYXZhaWxhYmxlIHN1Z2dlc3Rpb25zLlxuICBnZXRTdWdnZXN0aW9ucyhxdWVyeTogc3RyaW5nKTogVEZpbGVbXSB7XG4gICAgLy9pZiAodGhpcy5maWxlTGlzdC5sZW5ndGggPT0gMClcbiAgICByZXR1cm4gdGhpcy5maWxlTGlzdC5maWx0ZXIoKGZpbGUpID0+XG4gICAgICBmaWxlLnBhdGguaW5jbHVkZXMocXVlcnkpXG4gICAgKTtcbiAgfVxuXG4gIC8vIFJlbmRlcnMgZWFjaCBzdWdnZXN0aW9uIGl0ZW0uXG4gIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCkge1xuICAgIGVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogZmlsZS5uYW1lIH0pO1xuICAgIGVsLmNyZWF0ZUVsKFwic21hbGxcIiwgeyB0ZXh0OiBmaWxlLnBhdGggfSk7XG4gIH1cblxuICAvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cbiAgb25DaG9vc2VTdWdnZXN0aW9uKGZpbGU6IFRGaWxlLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KSB7XG4gICAgLy9uZXcgTm90aWNlKGBTZWxlY3RlZCAke2ZpbGUucGF0aH1gKTtcbiAgICAvL2NvbnNvbGUubG9nKGV2dC50YXJnZXQudmFsdWUpXG4gICAgLy9pZiAoZmlsZS5uYW1lKVxuICAgIHRoaXMub25TdWJtaXQoZmlsZSlcbiAgfVxuXG4gIC8vb25Ob1N1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAvL25ldyBOb3RpY2UoYE5vIHNlbGVjdGlvbmApO1xuICAgIC8vdGhpcy5vblN1Ym1pdChmaWxlKVxuICAvL31cbn0iLCAiaW1wb3J0IHsgQXBwLCBNYXJrZG93blJlbmRlcmVyLCBDYWNoZWRNZXRhZGF0YSwgTWFya2Rvd25Qb3N0UHJvY2Vzc29yQ29udGV4dCwgRHJvcGRvd25Db21wb25lbnQsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFnU3VtbWFyeSB7XG5cdGFwcDogQXBwOyBcblx0cGx1Z2luOiBUYWdCdWRkeTtcblx0c2VsZWN0ZWRCbG9ja3M6IE51bWJlcltdO1xuXHRibG9ja3M6IFN0cmluZ1tdO1xuXHRwcml2YXRlIHN0YXRpYyBmaWxlU3VtbWFyaWVzOiBNYXA8VEZpbGUsIFNldDxIVE1MRWxlbWVudD4+ID0gbmV3IE1hcCgpO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdGFzeW5jIGJha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBzdHJpbmcsIFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudCwgXG5cdFx0ZmlsZVBhdGg6c3RyaW5nXG5cdCkge1xuXHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZSdcblx0XHQpO1xuXHRcdFxuXHRcdGlmIChtZFNvdXJjZSkge1xuXHRcdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBuZXdGaWxlQ29udGVudCA9IFV0aWxzLnJlcGxhY2VUZXh0SW5TdHJpbmcgKFxuXHRcdFx0XHRtZFNvdXJjZSwgXG5cdFx0XHRcdGZpbGVDb250ZW50LCBcblx0XHRcdFx0c3VtbWFyeU1kXG5cdFx0XHQpXG5cdFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG5cdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnVGFnIHN1bW1hcnkgZmxhdHRlbmVkIHRvIGFjdGl2ZSBub3RlLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIFRhZyBCdWRkeTogQ2FuXFx0IGZpbmQgY29kZSBibG9jayBzb3VyY2UuIFRoaXMgaXMgYSBCVUcuIFx1RDgzRVx1REVCMicpO1xuXHRcdH1cblx0fVxuXG5cdC8qcHVibGljIHN0YXRpYyBhZGRTdW1tYXJ5KGZpbGU6IFRGaWxlLCBzdW1tYXJ5OiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBpZiAoIXRoaXMuZmlsZVN1bW1hcmllcy5oYXMoZmlsZSkpIHtcbiAgICAgICAgICAgIHRoaXMuZmlsZVN1bW1hcmllcy5zZXQoZmlsZSwgbmV3IFNldChbc3VtbWFyeV0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHN1bW1hcmllcyA9IHRoaXMuZmlsZVN1bW1hcmllcy5nZXQoZmlsZSk7XG4gICAgICAgICAgICBzdW1tYXJpZXM/LmFkZChzdW1tYXJ5KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIE1ldGhvZCB0byByZXRyaWV2ZSBhbiBhcnJheSBvZiB1bmlxdWUgc3VtbWFyeSBlbGVtZW50cyBmb3IgYSBnaXZlbiBmaWxlXG4gICAgcHVibGljIHN0YXRpYyBnZXRTdW1tYXJpZXNCeUZpbGUoZmlsZTogVEZpbGUpOiBIVE1MRWxlbWVudFtdIHtcbiAgICAgICAgY29uc3Qgc3VtbWFyaWVzID0gdGhpcy5maWxlU3VtbWFyaWVzLmdldChmaWxlKTtcbiAgICAgICAgcmV0dXJuIHN1bW1hcmllcyA/IEFycmF5LmZyb20oc3VtbWFyaWVzKSA6IFtdO1xuICAgIH0qL1xuXG5cdGNvcHlCdG5IYW5kbGVyIChlLCBjb250ZW50KTp2b2lkIHtcblxuXHRcdC8vZS5zdG9wUHJvcGFnYXRpb24oKTtcblxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdGxldCBub3RpY2U7XG5cblx0XHRpZiAoc2VsZWN0aW9uICE9ICcnKSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChzZWxlY3Rpb24pO1xuXHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ1NlbGVjdGlvbiBjb3BpZWQgdG8gY2xpcGJvYXJkLicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWdnZWQgcGFyYWdyYXBoIGNvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cdFx0fVxuXG5cdFx0Ly9uYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHQvL2NvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IENvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cblx0fVxuXG5cdHJlbW92ZVRhZ0J0bkhhbmRsZXIgKGUsIHBhcmFncmFwaEVsLCB0YWcpOnZvaWQge1xuXHRcdGNvbnN0IHRhZ0VsID0gVXRpbHMuZ2V0VGFnRWxlbWVudChwYXJhZ3JhcGhFbCwgdGFnKTtcblx0XHR0aGlzLnBsdWdpbi50YWdFZGl0b3IuZWRpdCh0YWdFbCk7XG5cdH1cblxuXHRhc3luYyBjb3B5VG9CdG5IYW5kbGVyIChcblx0XHRlOiBFdmVudCwgXG5cdFx0bW9kZTogU3RyaW5nLFxuXHRcdGRyb3Bkb3duOiBEcm9wZG93bkNvbXBvbmVudCxcblx0XHRwYXJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsIFxuXHRcdHN1bW1hcnlFbDogSFRNTEVsZW1lbnQsXG5cdFx0Y29udGVudDogc3RyaW5nLCAgXG5cdFx0dGFnczogQXJyYXksIFxuXHRcdGZpbGVQYXRoOiBzdHJpbmcsXG5cdFx0c2VsZWN0ZWRGaWxlOiBURmlsZVxuXHQpIHtcblx0XHRsZXQgbmV3Q29udGVudFxuXHRcdGNvbnN0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKS50b1N0cmluZygpO1xuXHRcdFxuXHRcdGlmIChzZWxlY3Rpb24gPT0gJycpIG5ld0NvbnRlbnQgPSBjb250ZW50O1xuXHRcdGVsc2UgbmV3Q29udGVudCA9IHNlbGVjdGlvbjtcblx0XHRsZXQgbm90aWNlO1xuXHRcdFx0XHRcblx0XHRpZiAobW9kZSA9PSAnbGluaycpIHtcblx0XHRcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZVBhdGguc3BsaXQoJy8nKS5wb3AoKS5yZXBsYWNlKC9cXC5tZCQvLCAnJyk7XG5cdFx0XHRuZXdDb250ZW50ID0gJ1tbJyArIGZpbGVQYXRoICsgJ3wnICsgZmlsZU5hbWUgKyAnXV0nO1xuXHRcdFxuXHRcdH0gXG5cblx0XHRpZiAobW9kZSAhPSAnbGluaycgJiYgIXNlbGVjdGlvbikge1xuXHRcdFx0dGFncy5mb3JFYWNoKCh0YWcsIGkpID0+IHtcblx0XHRcdFx0Ly8gbWFrZSB0aGlzIGEgc2V0dGluZy4gd2UnbGwgZGVmYXVsdCB0byBhbHdheXMgZm9yIG5vd1xuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMucmVtb3ZlVGFnRnJvbVN0cmluZyhuZXdDb250ZW50LCB0YWcpLnRyaW0oKTtcblx0XHRcdH0pO1xuXHRcdH1cblxuLy9jb25zb2xlLmxvZyhkcm9wZG93bi5nZXRWYWx1ZSgpKVxuXG5cdFx0Y29uc3QgY29weVN1Y2Nlc3MgPSBhd2FpdCB0aGlzLmNvcHlUZXh0VG9TZWN0aW9uKFxuXHRcdFx0Ly90aGlzLnBsdWdpbi5zZXR0aW5ncy50YWdnZWRQYXJhZ3JhcGhDb3B5UHJlZml4ICsgXG5cdFx0XHRuZXdDb250ZW50LCBcblx0XHRcdGRyb3Bkb3duLmdldFZhbHVlKCksIFxuXHRcdFx0ZmlsZVBhdGgsXG5cdFx0XHQobW9kZSE9J2xpbmsnKSxcblx0XHRcdHNlbGVjdGVkRmlsZVxuXHRcdCk7XG5cblx0XHRpZiAoY29weVN1Y2Nlc3MpIHtcblxuXHRcdFx0aWYgKG1vZGUgPT0gJ25vdGUnKSB7XG5cblx0XHRcdFx0bm90aWNlID0gbmV3IE5vdGljZShcblx0XHRcdFx0XHQnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpICsgJyBpbiAnICsgc2VsZWN0ZWRGaWxlLm5hbWUgKyAnIFx1RDgzRFx1REQxNycsXG5cdFx0XHRcdFx0NTAwMCk7XG5cdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQoc2VsZWN0ZWRGaWxlLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcbiBcdFx0XHRcdH0pO1xuXG5cdFx0XHR9IGVsc2UgaWYgKG1vZGUgPT0gJ21vdmUnICYmICFzZWxlY3Rpb24pIHtcblxuXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0XHRsZXQgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGZpbGVDb250ZW50LnRyaW0oKTtcblx0XHRcdFx0Y29uc3QgbmV3RmlsZUNvbnRlbnQgPSBVdGlscy5yZXBsYWNlVGV4dEluU3RyaW5nKFxuXHRcdFx0XHRcdGNvbnRlbnQudHJpbSgpLCBcblx0XHRcdFx0XHRmaWxlQ29udGVudCwgXG5cdFx0XHRcdFx0bmV3Q29udGVudCkudHJpbSgpO1xuXHRcdFx0XHRpZiAoZmlsZUNvbnRlbnQgIT0gbmV3RmlsZUNvbnRlbnQpIHtcblx0XHRcdFx0XHQvLyByZW5pdmUgdGhlIHRhZyBiZWZvcmUgY29weWluZ1xuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdGaWxlQ29udGVudCk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc3QgY29waWVkVG9XaGVyZTogU3RyaW5nID0gZHJvcGRvd24uZ2V0VmFsdWUoKT09J3RvcCcgPyAndG9wIG9mIG5vdGUnIDogZHJvcGRvd24uZ2V0VmFsdWUoKT09J2VuZCcgPyAnZW5kIG9mIG5vdGUnIDogZHJvcGRvd24uZ2V0VmFsdWUoKVxuXHRcdFx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UoXG5cdFx0XHRcdFx0XHQvLydNb3ZlZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArXG5cdFx0XHRcdFx0XHQvLycuXFxuXHVEODNEXHVERDE3IE9wZW4gc291cmNlIG5vdGUuJywgXG5cdFx0XHRcdFx0XHQnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpICsgJy4gJyArICgoZHJvcGRvd24uZ2V0VmFsdWUoKT09J3RvcCcgfHwgZHJvcGRvd24uZ2V0VmFsdWUoKT09J2VuZCcpID8gJycgOiAnXHVEODNEXHVERDE3JyksXG5cdFx0XHRcdFx0XHQ1MDAwKTtcblxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5yZW1vdmVFbGVtZW50V2l0aEFuaW1hdGlvbihwYXJhZ3JhcGhFbCwgKCkgPT4geyBcblx0ICAgIFx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHQgICAgXHRcdFx0XHRcdHRoaXMudXBkYXRlKHN1bW1hcnlFbCk7IFxuXHQgICAgXHRcdFx0XHRcdHBhcmFncmFwaEVsLnJlbW92ZSgpOyBcblx0ICAgIFx0XHRcdFx0fSwgNTAwKTtcdFx0XHRcdFx0XHRcblx0XHRcdFx0ICAgIFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHQgICAgXHRcdC8vdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnJ1bigpOyBcblx0XHRcdFx0ICAgIFx0fSwgODAwKTtcblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChkcm9wZG93bi5nZXRWYWx1ZSgpICE9ICd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCkgIT0gJ2VuZCcpIHtcblxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlUGF0aCwgJycpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkucGF0aCsnIycrZHJvcGRvd24uZ2V0VmFsdWUoKSwgJycpO1xuXHRcdCBcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0gXG5cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlICgnQ29waWVkIHRvIHNlY3Rpb246ICcgKyBkcm9wZG93bi5nZXRWYWx1ZSgpIFxuXHRcdFx0XHRcdFx0KyAnLlxcbkNhblxcJ3QgdXBkYXRlIHNvdXJjZSBmaWxlLicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdH0gZWxzZSBpZiAobW9kZSA9PSAnY29weScgfHwgbW9kZSA9PSAnbGluaycpIHtcblx0XHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ0NvcGllZCB0byBzZWN0aW9uOiAnICsgZHJvcGRvd24uZ2V0VmFsdWUoKSArICcuICcgKyAoKGRyb3Bkb3duLmdldFZhbHVlKCk9PSd0b3AnIHx8IGRyb3Bkb3duLmdldFZhbHVlKCk9PSdlbmQnKSA/ICcnIDogJ1x1RDgzRFx1REQxNycpKTtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dCh0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpLnBhdGgrJyMnK2Ryb3Bkb3duLmdldFZhbHVlKCksICcnKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XHRcblx0fVxuXG5cdGFzeW5jIG1ha2VTdW1tYXJ5QnRuSGFuZGxlciAoXG5cdFx0c3VtbWFyeU1kOiBTdHJpbmcsIFxuXHRcdHRhZ3M6IEFycmF5LFxuXHRcdGNvZGU6IEJvb2xlYW4gPSBmYWxzZSxcblx0XHRpbmNyZW1lbnRGaWxlOiBCb29sZWFuID0gZmFsc2Vcblx0KSB7XG5cbi8vbmV3IE5vdGljZSAoJ21ha2VTdW1tYXJ5QnRuSGFuZGxlcicsIDEwMDAwKVxuXG5cdFx0Ly8gdHJ5IHRvIGFic3RyYWN0IHRoZSBoYW5kbGVycyBmcm9tIHRoZWlyIGZ1bmN0aW9uc1xuXHRcdC8vY29uc3QgbmV3Tm90ZU9iaiA9IHRoaXMuZmlsZU9iakZyb21UYWdzKHRhZ3MpO1xuXHRcdGNvbnN0IG5ld05vdGVPYmogPSBVdGlscy5maWxlT2JqRnJvbVRhZ3ModGFncyk7XG5cdFx0bGV0IGZpbGVDb250ZW50ID0gY29kZSA/IHN1bW1hcnlNZCA6ICcjIyAnICsgbmV3Tm90ZU9iai50aXRsZSArICdcXG5cXG4nICsgc3VtbWFyeU1kO1xuXHRcdGNvbnN0IHZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdC8vY29uc3QgZmlsZU5hbWUgPSB0aGlzLmdldEFjdGl2ZUZpbGVGb2xkZXIoKStuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdC8vIGNvbnN0IGZpbGVOYW1lID0gVXRpbHMuZ2V0QWN0aXZlRmlsZUZvbGRlcih2aWV3KStuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdGNvbnN0IGZpbGVQYXRoID0gVXRpbHMuZ2V0QWN0aXZlRmlsZUZvbGRlcih0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpKVxuXHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZVBhdGggKyBuZXdOb3RlT2JqLmZpbGVOYW1lO1xuXHRcdGNvbnN0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU5hbWUpO1xuXHRcdGxldCBub3RpY2U7XG5cblx0XHQvL2NvbnNvbGUubG9nIChuZXdOb3RlT2JqLmZpbGVOYW1lKTtcblxuXHRcdGlmICghY29kZSkge1xuXHRcdFx0dGFncy5mb3JFYWNoICgodGFnKSA9PiB7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gVXRpbHMucmVwbGFjZVRleHRJblN0cmluZyAodGFnLCBmaWxlQ29udGVudCwgdGFnLnN1YnN0cmluZygxKSwgdHJ1ZSlcblx0XHRcdH0pO1xuXHRcdH1cblxuXHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgIWluY3JlbWVudEZpbGUpIHtcblxuXHRcdFx0bm90aWNlID0gbmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBOb3RlIGFscmVhZHkgZXhpc3RzLlxcbkNsaWNrIGhlcmUgdG8gb3ZlcndyaXRlLicsIDgwMDApO1xuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBmaWxlQ29udGVudCk7XG5cdFx0XHRcdG5vdGljZSA9IG5ldyBOb3RpY2UgKCdOb3RlIHVwZGF0ZWQuXFxuXHVEODNEXHVERDE3IE9wZW4gbm90ZS4nLCA1MDAwKTtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlTmFtZSwgJycpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0Lyp9IGVsc2UgaWYgKChmaWxlIGluc3RhbmNlb2YgVEZpbGUpICYmIGluY3JlbWVudEZpbGUpIHtcblxuXHRcdFx0Y29uc3QgYmFzZU5hbWUgPSBmaWxlLm5hbWUucmVwbGFjZSgvXFwubWQkLywgXCJcIik7XG5cdFx0XHRjb25zdCBleHRlbnNpb24gPSBcIi5tZFwiO1xuXHRcdFx0Y29uc3QgcmVnZXggPSAvKFxcZCspJC87XG5cdFx0XHRjb25zdCBtYXRjaCA9IGJhc2VOYW1lLm1hdGNoKHJlZ2V4KTtcblx0XHRcdGxldCBpbmNyZW1lbnRlZEZpbGVOYW1lO1xuXHRcdFx0bGV0IHN1ZmZpeCA9IDE7IFxuXHRcdFx0aWYgKG1hdGNoKSB7XG5cdFx0XHQgICAgc3VmZml4ID0gcGFyc2VJbnQobWF0Y2hbMV0sIDEwKSArIDE7XG5cdFx0XHQgICAgLy8gSWYgdGhlcmUncyBhIG1hdGNoLCB5b3UgbmVlZCB0byByZW1vdmUgdGhlIG1hdGNoZWQgbnVtYmVyIGZyb20gdGhlIGJhc2VOYW1lIGJlZm9yZSBhcHBlbmRpbmcgdGhlIGluY3JlbWVudGVkIG51bWJlclxuXHRcdFx0ICAgIGNvbnN0IG51bWJlckxlbmd0aCA9IG1hdGNoWzFdLmxlbmd0aDtcblx0XHRcdCAgICBjb25zdCBiYXNlTmFtZVdpdGhvdXROdW1iZXIgPSBiYXNlTmFtZS5zbGljZSgwLCAtbnVtYmVyTGVuZ3RoKTtcblx0XHRcdCAgICBpbmNyZW1lbnRlZEZpbGVOYW1lID0gYmFzZU5hbWVXaXRob3V0TnVtYmVyICsgJyAnICsgc3VmZml4ICsgZXh0ZW5zaW9uO1xuXHRcdFx0ICAgIGNvbnNvbGUubG9nKHN1ZmZpeCwgZmlsZVBhdGggKyBpbmNyZW1lbnRlZEZpbGVOYW1lKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHQgICAgLy8gSWYgdGhlcmUncyBubyBudW1iZXIgYXQgdGhlIGVuZCwgdGhlIGFwcHJvYWNoIHJlbWFpbnMgdGhlIHNhbWVcblx0XHRcdCAgICBpbmNyZW1lbnRlZEZpbGVOYW1lID0gYmFzZU5hbWUgKyAnICcgKyBzdWZmaXggKyBleHRlbnNpb247XG5cdFx0XHQgICAgY29uc29sZS5sb2coc3VmZml4LCBmaWxlUGF0aCArIGluY3JlbWVudGVkRmlsZU5hbWUpO1xuXHRcdFx0fVxuXHRcdFx0dGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoK2luY3JlbWVudGVkRmlsZU5hbWUsIGZpbGVDb250ZW50KTtcblx0XHRcdGNvbnN0IG5vdGljZSA9IG5ldyBOb3RpY2UgKCdOb3RlIGNyZWF0ZWQuIFx1RDgzRFx1RENEQ1xcblx1RDgzRFx1REQxNyBPcGVuIG5vdGUuJyk7XG5cdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KG5vdGljZS5ub3RpY2VFbCwgJ2NsaWNrJywgKGUpID0+IHtcblx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChuZXdOb3RlT2JqLmZpbGVOYW1lLCAnJyk7XG5cdFx0XHR9KTtcblx0XHRcdCovXG5cblx0XHR9IGVsc2UgaWYgKCFmaWxlKSB7XG5cblx0XHRcdHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlTmFtZSwgZmlsZUNvbnRlbnQpO1xuXHRcdFx0Y29uc3Qgbm90aWNlID0gbmV3IE5vdGljZSAoJ1N1bW1hcnkgbm90ZSBjcmVhdGVkLiBcdUQ4M0RcdURDRENcXG5cdUQ4M0RcdUREMTcgT3BlbiBub3RlLicpO1xuXHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChub3RpY2Uubm90aWNlRWwsICdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vcGVuTGlua1RleHQobmV3Tm90ZU9iai5maWxlTmFtZSwgJycpO1xuXHRcdFx0fSk7XG5cblxuXHRcdH1cblx0fVxuXG5cdGNyZWF0ZUNvZGVCbG9jayAodGFnc0FycmF5OiBTdHJpbmdbXSwgcG9zOiBTdHJpbmcpIHtcblx0XHQvL2NvbnNvbGUubG9nKHN1bW1hcnlQb3MpXG5cdFx0Y29uc3QgY29kZUJsb2NrU3RyaW5nID0gXG5cdFx0XHQnYGBgdGFnLXN1bW1hcnlcXG4nICtcblx0XHRcdCd0YWdzOiAnICsgdGFnc0FycmF5LmpvaW4oJyAnKSArICdcXG4nICtcblx0XHRcdCdgYGAnO1xuXG5cdFx0aWYgKHBvcyA9PSAnbm90ZScpIHtcblxuXHRcdFx0dGhpcy5tYWtlU3VtbWFyeUJ0bkhhbmRsZXIgKGNvZGVCbG9ja1N0cmluZywgdGFnc0FycmF5LCB0cnVlKTtcblxuXHRcdH0gZWxzZSB7XG5cblx0XHRcdHRoaXMuY29weVRleHRUb1NlY3Rpb24oXG5cdFx0XHQgICAgY29kZUJsb2NrU3RyaW5nLFxuXHRcdFx0ICAgIHBvcywgXG5cdFx0XHQgICAgJycsXG5cdFx0XHQgICAgZmFsc2Vcblx0XHQgICAgKVxuXHRcdH1cblxuXHR9XG5cblx0YXN5bmMgY29kZUJsb2NrUHJvY2Vzc29yIChcblx0XHRzb3VyY2U6IHN0cmluZywgXG5cdFx0ZWw6SFRNTEVsZW1lbnQsIFxuXHRcdGN0eFxuXHQpOiB2b2lkIHtcblx0XHRcblx0XHQvLyBJbml0aWFsaXplIHRhZyBsaXN0XG5cdFx0bGV0IHRhZ3M6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgaW5jbHVkZTogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdGxldCBleGNsdWRlOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IHNlY3Rpb25zOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IG1heDogbnVtYmVyID0gNTA7XG5cdFx0Y29uc3QgbWF4UGF0dGVybiA9IC9eXFxzKm1heDpcXHMqKFxcZCspXFxzKiQvO1xuXHRcdGxldCBtYXRjaDtcblxuXHRcdC8vIFByb2Nlc3Mgcm93cyBpbnNpZGUgY29kZWJsb2NrXG5cdFx0Y29uc3Qgcm93cyA9IHNvdXJjZS5zcGxpdChcIlxcblwiKS5maWx0ZXIoKHJvdykgPT4gcm93Lmxlbmd0aCA+IDApO1xuXHRcdHJvd3MuZm9yRWFjaCgobGluZSkgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIChPUilcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKnRhZ3M6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqdGFnczovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSB0YWdzIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR0YWdzID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIHRvIGluY2x1ZGUgKEFORClcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKmluY2x1ZGU6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqaW5jbHVkZTovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBpbmNsdWRlIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpbmNsdWRlID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIHRvIGV4Y2x1ZGUgKE5PVClcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKmV4Y2x1ZGU6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqZXhjbHVkZTovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBleGNsdWRlIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRleGNsdWRlID0gbGlzdDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHNlY3Rpb25zIG9mIGEgbm90ZVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqc2VjdGlvbnM6W1xccHtMfTAtOV9cXC0vIywgXSskL2d1KSkge1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gbGluZS5yZXBsYWNlKC9eXFxzKnNlY3Rpb25zOi8sIFwiXCIpLnRyaW0oKTtcblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHNlY3Rpb25zIGFuZCBhc3NpZ24gdGhlbSB0byB0aGUgc2VjdGlvbnMgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KCcsJykubWFwKChzZWMpID0+IHNlYy50cmltKCkpO1xuXHRcdFx0XHRzZWN0aW9ucyA9IGxpc3Q7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoZSBsaW5lIHNwZWNpZmllcyBtYXggbnVtYmVyIG9mIGJsb2NrcyB0byBkaXNwbGF5XG5cdFx0XHRtYXRjaCA9IGxpbmUubWF0Y2gobWF4UGF0dGVybik7XG5cdFx0XHRpZiAobWF0Y2gpIHtcbiAgICBcdFx0XHRtYXggPSBNYXRoLm1pbig1MCwgTnVtYmVyKG1hdGNoWzFdKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0Y29uc3QgY29kZUJsb2NrID0gJ2BgYHRhZy1zdW1tYXJ5XFxuJytzb3VyY2UudHJpbSgpKydcXG5gYGAnXG5cdFx0Ly8gQ3JlYXRlIHN1bW1hcnkgb25seSBpZiB0aGUgdXNlciBzcGVjaWZpZWQgc29tZSB0YWdzXG5cdFx0aWYgKHRhZ3MubGVuZ3RoID4gMCB8fCBpbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlKFxuXHRcdFx0XHRlbCwgXG5cdFx0XHRcdHRhZ3MsIFxuXHRcdFx0XHRpbmNsdWRlLCBcblx0XHRcdFx0ZXhjbHVkZSwgXG5cdFx0XHRcdHNlY3Rpb25zLCBcblx0XHRcdFx0bWF4LCBcblx0XHRcdFx0Y3R4LnNvdXJjZVBhdGgsIFxuXHRcdFx0XHRjb2RlQmxvY2tcblx0XHRcdCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3JlYXRlRW1wdHkoXG5cdFx0XHRcdGVsLCBcblx0XHRcdFx0dGFncyA/IHRhZ3MgOiBbXSwgXG5cdFx0XHRcdGluY2x1ZGUgPyBpbmNsdWRlIDogW10sIFxuXHRcdFx0XHRleGNsdWRlID8gZXhjbHVkZSA6IFtdLCBcblx0XHRcdFx0c2VjdGlvbnMgPyBzZWN0aW9ucyA6IFtdLCBcblx0XHRcdFx0bWF4ID8gbWF4IDogW10sIFxuXHRcdFx0XHRjdHguc291cmNlUGF0aCA/IGN0eC5zb3VyY2VQYXRoIDogJycsIFxuXHRcdFx0XHRjb2RlQmxvY2tcblx0XHRcdCk7XG5cdFx0fSBcblx0fTsgXG5cblx0Y3JlYXRlRW1wdHkoXG5cdFx0ZWxlbWVudDogSFRNTEVsZW1lbnQsIFxuXHRcdHRhZ3M6IFN0cmluZ1tdLCBcblx0XHRpbmNsdWRlOiBzdHJpbmdbXSwgXG5cdFx0ZXhjbHVkZTogc3RyaW5nW10sIFxuXHRcdHNlY3Rpb25zOiBzdHJpbmdbXSwgXG5cdFx0bWF4OiBudW1iZXIsIFxuXHRcdGZpbGVDdHg6IHN0cmluZywgXG5cdFx0bWRTb3VyY2U6c3RyaW5nXG5cdCk6IHZvaWQge1xuXG5cdFx0Y29uc3QgY29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuXHRcdGNvbnN0IHRleHREaXYgPSBjcmVhdGVFbChcImJsb2NrcXVvdGVcIik7XG5cdFx0dGV4dERpdi5pbm5lckhUTUwgPSBcIlRoZXJlIGFyZSBubyBub3RlcyB3aXRoIHRhZ2dlZCBwYXJhZ3JhcGhzIHRoYXQgbWF0Y2ggdGhlIHRhZ3M6PGJyPlwiXG5cdFx0XHQrICh0YWdzLmxlbmd0aD4wID8gdGFncy5qb2luKCcsICcpIDogXCJObyB0YWdzIHNwZWNpZmllZC5cIikgKyBcIjxicj5cIjtcblx0XHRcblx0XHRjb250YWluZXIuYXBwZW5kQ2hpbGQodGV4dERpdik7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncycsIFxuXHRcdFx0KCh0YWdzLmxlbmd0aCA+IDApID8gdGFncy5qb2luKCcsJykgOiAnJylcblx0XHQpO1xuXHRcdGNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZScsIFxuXHRcdFx0KGluY2x1ZGUgPyBpbmNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdCk7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncy1leGNsdWRlJywgXG5cdFx0XHQoZXhjbHVkZSA/IGV4Y2x1ZGUuam9pbignLCcpIDogJycpXG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1zZWN0aW9ucycsIFxuXHRcdFx0KHNlY3Rpb25zID8gc2VjdGlvbnMuam9pbignLCcpIDogJycpXG5cdFx0KTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0J2NvZGVibG9jay1tYXgnLCBcblx0XHRcdG1heFxuXHRcdCk7XG5cdFx0Y29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZScsIFxuXHRcdFx0bWRTb3VyY2Vcblx0XHQpO1xuXG5cdFx0Y29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMucGx1Z2luLmd1aS5tYWtlU3VtbWFyeVJlZnJlc2hCdXR0b24oY29udGFpbmVyKSk7O1xuXG5cdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChjb250YWluZXIpO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlKFxuXHRcdGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBcblx0XHR0YWdzOiBzdHJpbmdbXSwgXG5cdFx0aW5jbHVkZTogc3RyaW5nW10sIFxuXHRcdGV4Y2x1ZGU6IHN0cmluZ1tdLCBcblx0XHRzZWN0aW9uczogc3RyaW5nW10sXG5cdFx0bWF4OiBudW1iZXIsIFxuXHRcdGZpbGVDdHg6IHN0cmluZyxcblx0XHRtZFNvdXJjZTpzdHJpbmdcblx0KTogdm9pZCB7XG5cdFx0XG4vL2NvbnNvbGUubG9nKCdjcmVhdGUgc3VtbWFyeScpXG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0Y29uc3QgdmFsaWRUYWdzID0gdGFncy5jb25jYXQoaW5jbHVkZSk7XG5cdFx0Y29uc3QgdGVtcENvbXBvbmVudCA9IG5ldyBUZW1wQ29tcG9uZW50KCk7XG5cdFx0Y29uc3Qgc3VtbWFyeUNvbnRhaW5lciA9IGNyZWF0ZUVsKCdkaXYnKTtcblx0XHQvL3N1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWwoJ2hyJykpO1xuXHRcdHRoaXMuc2VsZWN0ZWRCbG9ja3MgPSBbXTtcblx0XHR0aGlzLmJsb2NrcyA9IFtdO1xuXG5cdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY2xhc3MnLCBcblx0XHRcdCd0YWctc3VtbWFyeS1ibG9jaydcblx0XHQpO1xuXHRcdFxuXHRcdC8vIEdldCBmaWxlc1xuXHRcdGxldCBsaXN0RmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG5cblx0XHQvLyBGaWx0ZXIgZmlsZXNcblx0XHRsaXN0RmlsZXMgPSBsaXN0RmlsZXMuZmlsdGVyKChmaWxlKSA9PiB7XG5cdFx0XHQvLyBSZW1vdmUgZmlsZXMgdGhhdCBkbyBub3QgY29udGFpbiB0aGUgdGFncyBzZWxlY3RlZCBieSB0aGUgdXNlclxuXHRcdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcblx0XHRcdGNvbnN0IHRhZ3NJbkZpbGUgPSBnZXRBbGxUYWdzKGNhY2hlKTtcblx0XHRcdC8vIFJlbW92ZSBmaWxlcyB3aGVyZSB0aGUgcGF0aCBpbmNsdWRlcyAnX2V4Y2x1ZGUnXG5cdFx0XHRpZiAoZmlsZS5wYXRoLmluY2x1ZGVzKCdfZXhjbHVkZScpKSByZXR1cm4gZmFsc2Vcblx0XHRcdFxuXHRcdFx0Ly8gUmVtb3ZlIHRoZSBmaWxlIGlmIGl0J3MgdGhlIHNhbWUgZmlsZSBhcyB0aGlzIHN1bW1hcnlcblx0XHRcdGlmIChhY3RpdmVGaWxlKSBpZiAoYWN0aXZlRmlsZS5wYXRoID09IGZpbGUucGF0aCkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0XHRpZiAodmFsaWRUYWdzLnNvbWUoKHZhbHVlKSA9PiB0YWdzSW5GaWxlPy5pbmNsdWRlcyh2YWx1ZSkpKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuXHRcdC8vIFNvcnQgZmlsZXMgYWxwaGFiZXRpY2FsbHlcblx0XHQvLyBtYWtlIHRoaXMgYSBwcm9wZXJ0eSBvZiB0aGUgY29kZSBibG9jay4gYnV0IGRlZmF1bHQgdG8gbW9kaWZpZWQgZGF0ZVxuXHRcdC8qbGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdFx0aWYgKGZpbGUxLnBhdGggPCBmaWxlMi5wYXRoKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoZmlsZTEucGF0aCA+IGZpbGUyLnBhdGgpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHR9KTsqL1xuIFxuXG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdCAgICAvLyBTaW5jZSBtdGltZSBpcyBhIFVuaXggdGltZXN0YW1wIGluIG1pbGxpc2Vjb25kcywgd2UgY2FuIGRpcmVjdGx5IHN1YnRyYWN0IHRoZW1cblx0XHQgICAgLy9jb25zb2xlLmxvZyhmaWxlMi5zdGF0LmN0aW1lIC0gZmlsZTEuc3RhdC5jdGltZSlcblx0XHQgICAgcmV0dXJuIGZpbGUyLnN0YXQuY3RpbWUgLSBmaWxlMS5zdGF0LmN0aW1lO1xuXHRcdH0pO1xuXG5cdFx0Ly8gR2V0IGZpbGVzIGNvbnRlbnRcblx0XHRsZXQgbGlzdENvbnRlbnRzOiBbVEZpbGUsIHN0cmluZ11bXSA9IGF3YWl0IHRoaXMucmVhZEZpbGVzKGxpc3RGaWxlcyk7XG5cdFx0bGV0IGNvdW50ID0gMDtcblxuXHRcdC8vIENyZWF0ZSBzdW1tYXJ5XG5cdFx0bGV0IHN1bW1hcnk6IHN0cmluZyA9IFwiXCI7XG5cdFx0bGlzdENvbnRlbnRzLmZvckVhY2goKGl0ZW0pID0+IHtcblxuXHRcdFx0Ly8gR2V0IGZpbGVzIG5hbWVcblx0XHRcdC8vIGl0ZW1bMF0gaXMgdGhlIGZpbGUsIGl0ZW1bMV0gaXMgdGhlIGZpbGUgY29udGVudFxuXHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBpdGVtWzBdLm5hbWUucmVwbGFjZSgvLm1kJC9nLCBcIlwiKTtcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gaXRlbVswXS5wYXRoO1xuXHRcdFx0XG5cdFx0XHQvLyBHZXQgcGFyYWdyYXBoc1xuXHRcdFx0Ly9sZXQgbGlzdFBhcmFncmFwaHM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRcdC8vY29uc3QgYmxvY2tzID0gaXRlbVsxXS5zcGxpdCgvXFxuXFxzKlxcbi8pLmZpbHRlcigocm93KSA9PiByb3cudHJpbSgpLmxlbmd0aCA+IDApO1xuXHRcdFx0XG5cdFx0XHQvLyBVcGRhdGUgdG8gdHJlYXQgbGlzdCBpdGVtcyBhcyBwYXJhZ3JhcGggYnJlYWtzXG5cdFx0XHRsZXQgbGlzdFBhcmFncmFwaHM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRcdGNvbnN0IGJsb2NrcyA9IGl0ZW1bMV1cblx0XHRcdCAgLnNwbGl0KC8oPzpcXG5cXHMqXFxufCg/PD1efFxcbilbKi1dXFxzfCg/PD1efFxcbilcXGQrXFwuXFxzKS8pXG5cdFx0XHQgIC5maWx0ZXIoKHJvdykgPT4gcm93LnRyaW0oKS5sZW5ndGggPiAwKTtcblxuXG5cdFx0XHQvLyBHZXQgbGlzdCBpdGVtc1xuXHRcdFx0YmxvY2tzLmZvckVhY2goKHBhcmFncmFwaCkgPT4ge1xuXHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHBhcmFncmFwaCBpcyBhbm90aGVyIHBsdWdpblxuXHRcdFx0XHRsZXQgdmFsaWQgPSBmYWxzZTtcblx0XHRcdFx0Ly9sZXQgbGlzdFRhZ3MgPSBwYXJhZ3JhcGgubWF0Y2goLyNbXFxwe0x9MC05X1xcLS8jXSsvZ3UpO1xuXHRcdFx0XHRsZXQgbGlzdFRhZ3MgPSBwYXJhZ3JhcGgubWF0Y2goLyg/PD1efFxccykoI1teXFxzIy4sOyE/Ol0rKS9nKTsgLy8gcmV2aXNlZCB0byBub3QgbWF0Y2ggaGFzaCBpbiBtaWRkbGUgb2Ygd29yZFxuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGxpc3RUYWdzICE9IG51bGwgJiYgbGlzdFRhZ3MubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGlmICghcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpICYmICFwYXJhZ3JhcGguY29udGFpbnMoXCItLS1cIikpIHtcblx0XHRcdFx0XHRcdHZhbGlkID0gdGhpcy5pc1ZhbGlkVGV4dChsaXN0VGFncywgdGFncywgaW5jbHVkZSwgZXhjbHVkZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0aWYgKHZhbGlkKSBsaXN0UGFyYWdyYXBocy5wdXNoKHBhcmFncmFwaCk7ICBcblxuXHRcdFx0fSlcblxuXHRcdFx0Ly8gVGhlcmUgaXMgYWxzbyBzb21lIHJlZHVuZGFuY3kgaGVyZSBiZWNhdXNlIHdlIGFyZSBwcm9jZXNzaW5nIGEgbG90IG9mIGNvbnRlbnQgdGhhdCB3ZSBkb24ndCBuZWVkLCBpZiBhIG1heCBpcyBzZXQuIFxuXHRcdFx0Ly8gYWRqdXN0IHRoZSBjb3VudCBjaGVjayBcblx0XHRcdC8vIFByb2Nlc3MgZWFjaCBibG9jayBvZiB0ZXh0XG5cdFx0XHRsaXN0UGFyYWdyYXBocy5mb3JFYWNoKGFzeW5jKHBhcmFncmFwaCkgPT4ge1xuXHRcdFx0XHRpZiAoY291bnQrKyA+PSBtYXgpIHJldHVybjtcblxuXHRcdFx0XHQvLyBSZXN0b3JlIG5ld2xpbmUgYXQgdGhlIGVuZFxuXHRcdFx0XHRwYXJhZ3JhcGggKz0gXCJcXG5cIjtcblxuXHRcdFx0XHR2YXIgcmVnZXggPSBuZXcgUmVnRXhwO1xuXG5cdFx0XHRcdC8vIENoZWNrIHdoaWNoIHRhZyBtYXRjaGVzIGluIHRoaXMgcGFyYWdyYXBoLlxuXHRcdFx0XHR2YXIgdGFnVGV4dCA9IG5ldyBTdHJpbmc7XG5cdFx0XHRcdHZhciB0YWdTZWN0aW9uID0gbnVsbDtcblx0XHRcdFx0dGFncy5mb3JFYWNoKCh0YWcpID0+IHtcblx0XHRcdFx0XHR0YWdUZXh0ID0gdGFnLnJlcGxhY2UoJyMnLCAnXFxcXCMnKTtcblx0XHRcdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoYCR7dGFnVGV4dH0oXFxcXFd8JClgLCAnZycpO1xuICAgICAgICAgICAgICBcdFx0aWYgKHBhcmFncmFwaC5tYXRjaChyZWdleCkgIT0gbnVsbCkgeyBcbiAgICAgICAgICAgICAgXHRcdFx0dGFnU2VjdGlvbiA9IHRhZ1xuICAgICAgICAgICAgICBcdFx0fSBcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgXHRcdFxuICAgICAgICAgIFx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgICAgXHRcdC8vY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICAgIFx0XHRidXR0b25Db250YWluZXIuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWdzdW1tYXJ5LWJ1dHRvbnMnKVxuICAgICAgICAgIFx0XHRjb25zdCBwYXJhZ3JhcGhFbCA9IGNyZWF0ZUVsKFwiYmxvY2txdW90ZVwiKTtcblx0XHRcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScsIGZpbGVQYXRoKTtcblxuXHRcdFx0XHRwYXJhZ3JhcGhFbC5zZXRBdHRyaWJ1dGUoJ2luZGV4JywgY291bnQtMSk7XG5cblx0XHRcdFx0cGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICd0YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblxuXHRcdFx0XHRjb25zdCBibG9ja0xpbmsgPSBwYXJhZ3JhcGgubWF0Y2goL1xcXltcXHB7TH0wLTlfXFwtL15dKy9ndSk7IFxuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlcmUncyBhIGhlYWRlciBpbiB0aGlzIHBhcmFnYXBoXG5cdFx0XHRcdGNvbnN0IGhlYWRlciA9IFV0aWxzLmZpbmRDbG9zZXN0SGVhZGVyV2l0aExpbmsocGFyYWdyYXBoKTtcblx0XHRcdFx0Ly8gY29uc29sZS5sb2coaGVhZGVyLnRleHQsIGhlYWRlci5saW5rKVxuXG5cblx0XHRcdFx0bGV0IGxpbms7XG4gICAgICAgIFx0XHRcbiAgICAgICAgXHRcdGlmIChibG9ja0xpbmspIGxpbmsgPSAnW1snICsgZmlsZVBhdGggKyAnIycgKyBibG9ja0xpbmsgKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG5cbiAgICAgICAgXHRcdGVsc2UgaWYgKGhlYWRlci50ZXh0ICE9ICcnKSBsaW5rID0gJ1tbJyArIGZpbGVQYXRoICsgJyMnICsgaGVhZGVyLmxpbmsgKyAnfCcgKyBmaWxlTmFtZSArICddXSc7XG5cbiAgICAgICAgXHRcdGVsc2UgbGluayA9ICdbWycgKyBmaWxlUGF0aCArICd8JyArIGZpbGVOYW1lICsgJ11dJztcblx0XHRcdFx0XHRcdFxuXG4gICAgXHRcdFx0LypidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VCbG9ja1NlbGVjdG9yKFxuXHRcdFx0XHRcdFx0Y291bnQtMVxuXHRcdFx0XHRcdClcblx0XHRcdFx0KTsqL1xuXG5cdFx0XHRcdC8vaWYgKHNlY3Rpb25zLmxlbmd0aCA+PSAxKSB7XG4gICAgICAgIFx0XHQvKmlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVUYWdCdG4gPT0gJ2Fsd2F5cycgXG4gICAgICAgIFx0XHRcdHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0biA9PSAnZGVza3RvcCcgJiYgIXRoaXMuYXBwLmlzTW9iaWxlXG4gICAgICAgIFx0XHRcdHx8IHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0biA9PSAnbW9iaWxlJyAmJiB0aGlzLmFwcC5pc01vYmlsZVxuICAgICAgICBcdFx0XHQpXG4gICAgICAgIFx0XHRcdCovXG4gICAgICAgIFx0XHQvL2lmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0bikpIHtcblxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5tYWtlQ29weVRvU2VjdGlvbihcblx0XHRcdFx0XHRcdFx0dGhpcy5jb3B5VG9CdG5IYW5kbGVyLmJpbmQodGhpcyksXG5cdFx0XHRcdFx0XHRcdHBhcmFncmFwaCwgXG5cdFx0XHRcdFx0XHRcdHNlY3Rpb25zLCBcblx0XHRcdFx0XHRcdFx0dGFncyxcblx0XHRcdFx0XHRcdFx0KGJsb2NrTGluayA/IChmaWxlUGF0aCArICcjJyArIGJsb2NrTGlua1swXSkgOiBmaWxlUGF0aCksIFxuXHRcdFx0XHRcdFx0XHRwYXJhZ3JhcGhFbCwgXG5cdFx0XHRcdFx0XHRcdHN1bW1hcnlDb250YWluZXJcblx0XHRcdFx0XHRcdClcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHQvL31cblx0XHRcdFx0aWYgKFV0aWxzLnBsYXRmb3JtU2V0dGluZ0NoZWNrICh0aGlzLmFwcCwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29weVRvQ0JCdG4pKSB7XG5cblx0XHRcdFx0XHRidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5ndWkubWFrZUNvcHlCdXR0b24oXG5cdFx0XHRcdFx0XHRcdHRoaXMuY29weUJ0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0XHRcdFx0XHRcdFx0cGFyYWdyYXBoLnRyaW0oKVxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCk7XG5cblx0XHRcdFx0fVxuLy9jb25zb2xlLmxvZyhVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0bikpXG5cdFx0XHRcdGlmIChVdGlscy5wbGF0Zm9ybVNldHRpbmdDaGVjayAodGhpcy5hcHAsIHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZVRhZ0J0bikpIHtcblxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZChcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLmd1aS5tYWtlUmVtb3ZlVGFnQnV0dG9uKFxuXHRcdFx0XHRcdFx0XHR0aGlzLnJlbW92ZVRhZ0J0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0XHRcdFx0XHRcdFx0cGFyYWdyYXBoRWwsIFxuXHRcdFx0XHRcdFx0XHR0YWdTZWN0aW9uLy8sIFxuXHRcdFx0XHRcdFx0XHQvLyhibG9ja0xpbmsgPyAoZmlsZVBhdGggKyAnIycgKyBibG9ja0xpbmtbMF0pIDogZmlsZVBhdGgpXG5cdFx0XHRcdFx0XHQpXG5cdFx0XHRcdFx0KTtcblxuXHRcdFx0XHR9XG5cblxuICAgICAgICBcdFx0Y29uc3QgbWRQYXJhZ3JhcGggPSBwYXJhZ3JhcGg7XG4gICAgICAgIFx0XHRwYXJhZ3JhcGggPSAnKionICsgbGluayArICcqKlxcbicgKyBwYXJhZ3JhcGg7XG4gICAgICAgICAgXHRcdHN1bW1hcnkgKz0gcGFyYWdyYXBoICsgJ1xcbic7IFxuXG4gICAgICAgICAgXHRcdHBhcmFncmFwaEVsLnNldEF0dHJpYnV0ZSgnbWQtc291cmNlJywgbWRQYXJhZ3JhcGgpOyBcbiAgICAgICAgICBcdFx0YmxvY2tzLnB1c2gobWRQYXJhZ3JhcGgpXG4vL2NvbnNvbGUubG9nKG1kUGFyYWdyYXBoLCAnXFxuLS0tLS1cXG4nLCBwYXJhZ3JhcGgpXG4vL2NvbnNvbGUubG9nKGFjdGl2ZUZpbGUucGF0aClcblxuXG5cbi8qY29uc3QgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpIC8vIHVzaW5nIGBjcmVhdGVFbGVtZW50YCBpbnN0ZWFkIG9mIGBjcmVhdGVFbGAgdG8gYXZvaWQgYXBwZW5kaW5nIHRvIHRoZSBET01cbmNvbnN0IGNvbXAgPSBuZXcgQ29tcG9uZW50KClcbi8vIEB0cy1leHBlY3QtZXJyb3IgYG9ic2lkaWFuYCBwYWNrYWdlIG5vdCB5ZXQgdXBkYXRlZFxuYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXIodGhpcy5hcHAsIFwiIVtbZXhhbXBsZS5wbmddXVwiLCBlbCwgXCJcIiwgY29tcClcbmNvbXAubG9hZCgpIC8vIGxvYWRzIGVtYmVkc1xuY29uc29sZS5sb2coZWwuY2xvbmVOb2RlKHRydWUpKSAvLyBkbyBzb21ldGhpbmcgd2l0aCBlbFxuY29tcC51bmxvYWQoKSAvLyB3aGVuIGRvbmUgd2l0aCBpdCB0byByZWxlYXNlIHJlc291cmNlc1xuKi9cbmF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyKHRoaXMuYXBwLCBwYXJhZ3JhcGgsIHBhcmFncmFwaEVsLCBcIlwiLCB0ZW1wQ29tcG9uZW50KVxuXG5cbiAgICAgICAgICBcdFx0Lyphd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKFxuICAgICAgICAgIFx0XHRcdHBhcmFncmFwaCwgXG4gICAgICAgICAgXHRcdFx0cGFyYWdyYXBoRWwsIFxuICAgICAgICAgIFx0XHRcdGFjdGl2ZUZpbGUucGF0aCxcbiAgICAgICAgICBcdFx0XHQvL2ZpbGVQYXRoLCAvLycnLCBcbiAgICAgICAgICBcdFx0XHR0ZW1wQ29tcG9uZW50XG4gICAgICBcdFx0XHQpOyovXG5cbi8vY29uc29sZS5sb2coJ21hcmtkb3duIHJlbmRlciBzdW1tYXJ5JylcbiAgICAgICAgICBcdFx0XG4gICAgICAgICAgXHRcdGNvbnN0IHRpdGxlRWwgPSBjcmVhdGVFbCgnc3BhbicpO1xuICAgICAgICAgIFx0XHR0aXRsZUVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGFnc3VtbWFyeS1pdGVtLXRpdGxlJyk7XG5cbiAgICAgICAgICBcdFx0Ly8gTm90IGRvaW5nIHRoaXMgdW50aWwvd2hlbi9pZiB3ZSBldmVyIGNsZWFuIHVwIGFsbCB0aGUgY29weVRvIG1ldGhvZHNcbiAgICAgICAgICBcdFx0Ly8gYXMgZGVzY3JpYmVkIGluIHRoZSBnZXRTZWxlY3Rpb24gbWV0aG9kLlxuXHRcdFx0XHQvKnRpdGxlRWwuYXBwZW5kQ2hpbGQoXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VCbG9ja1NlbGVjdG9yKFxuXHRcdFx0XHRcdFx0cGFyc2VJbnQgKHBhcmFncmFwaEVsLmdldEF0dHJpYnV0ZSgnaW5kZXgnKSlcblx0XHRcdFx0XHQpXG5cdFx0XHRcdCk7Ki9cblxuICAgICAgICAgIFx0XHR0aXRsZUVsLmFwcGVuZENoaWxkKHBhcmFncmFwaEVsLnF1ZXJ5U2VsZWN0b3IoJ3N0cm9uZycpLmNsb25lTm9kZSh0cnVlKSlcblx0Ly9jb25zb2xlLmxvZyhwYXJhZ3JhcGhFbC5vdXRlckhUTUwpXG4gICAgICAgICAgXHRcdC8vaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnRhZ1N1bW1hcnlCbG9ja0J1dHRvbnMpIFxuICAgICAgICAgIFx0XHRcdHBhcmFncmFwaEVsLmFwcGVuZENoaWxkKGJ1dHRvbkNvbnRhaW5lcik7XG4gICAgICAgICAgXHRcdHBhcmFncmFwaEVsLnF1ZXJ5U2VsZWN0b3IoJ3N0cm9uZycpLnJlcGxhY2VXaXRoKHRpdGxlRWwpXG4gICAgICAgICAgXHRcdC8vcGFyYWdyYXBoRWwuc2V0QXR0cmlidXRlKCdtZC1zb3VyY2UnLCBtZFBhcmFncmFwaClcblxuICAgICAgICAgIFx0XHRzdW1tYXJ5Q29udGFpbmVyLmFwcGVuZENoaWxkKHBhcmFncmFwaEVsKTtcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHRcblx0XHRcblx0XHQvLyBBZGQgU3VtbWFyeVxuXHRcdGlmIChzdW1tYXJ5ICE9ICcnKSB7XG5cdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgXG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5zaG93U3VtbWFyeUJ1dHRvbnMpIHtcblx0XHRcdFx0XHRzdW1tYXJ5Q29udGFpbmVyLmFwcGVuZENoaWxkKFxuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VTdW1tYXJ5UmVmcmVzaEJ1dHRvbihcblx0XHRcdFx0XHRcdFx0c3VtbWFyeUNvbnRhaW5lclxuXHRcdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCk7XG5cdCAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdCAgICAgICAgXHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VDb3B5U3VtbWFyeUJ1dHRvbihcblx0ICAgICAgICBcdFx0XHRcdHN1bW1hcnlcbiAgICAgICAgXHRcdFx0XHQpXG4gICAgICAgIFx0XHRcdCk7XG5cdCAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdCAgICAgICAgXHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VTdW1tYXJ5Tm90ZUJ1dHRvbihcblx0ICAgICAgICBcdFx0XHRcdHRoaXMubWFrZVN1bW1hcnlCdG5IYW5kbGVyLmJpbmQodGhpcyksXG5cdCAgICAgICAgXHRcdFx0XHRzdW1tYXJ5LCBcblx0ICAgICAgICBcdFx0XHRcdHRhZ3NcbiAgICAgICAgXHRcdFx0XHQpXG4gICAgICAgIFx0XHRcdCk7XG5cdCAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoXG5cdCAgICAgICAgXHRcdFx0dGhpcy5wbHVnaW4uZ3VpLm1ha2VCYWtlQnV0dG9uKFxuXHQgICAgICAgIFx0XHRcdFx0dGhpcy5iYWtlU3VtbWFyeUJ0bkhhbmRsZXIuYmluZCh0aGlzKSxcblx0ICAgICAgICBcdFx0XHRcdHN1bW1hcnksIFxuXHQgICAgICAgIFx0XHRcdFx0c3VtbWFyeUNvbnRhaW5lciwgXG5cdCAgICAgICAgXHRcdFx0XHRhY3RpdmVGaWxlLnBhdGhcbiAgICAgICAgXHRcdFx0XHQpXG4gICAgICAgIFx0XHRcdCk7XG5cblx0ICAgICAgICBcdFx0c3VtbWFyeUNvbnRhaW5lci5hcHBlbmRDaGlsZChjcmVhdGVFbCgnYnInKSk7IFxuXHRcdFx0XHR9IFxuXHRcdFx0XHQvL3N1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQoY3JlYXRlRWwoJ2hyJykpOyBcblx0XHRcdH0sIDApO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stdGFncycsIFxuXHRcdFx0XHR0YWdzLmpvaW4oJywnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZScsIFxuXHRcdFx0XHQoKGluY2x1ZGUubGVuZ3RoID4gMCkgPyBpbmNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXRhZ3MtZXhjbHVkZScsIFxuXHRcdFx0XHQoKGV4Y2x1ZGUubGVuZ3RoID4gMCkgPyBleGNsdWRlLmpvaW4oJywnKSA6ICcnKVxuXHRcdFx0KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKFxuXHRcdFx0XHQnY29kZWJsb2NrLXNlY3Rpb25zJywgXG5cdFx0XHRcdCgoc2VjdGlvbnMubGVuZ3RoID4gMCkgPyBzZWN0aW9ucy5qb2luKCcsJykgOiAnJylcblx0XHRcdCk7XG5cdFx0XHRzdW1tYXJ5Q29udGFpbmVyLnNldEF0dHJpYnV0ZShcblx0XHRcdFx0J2NvZGVibG9jay1tYXgnLCBcblx0XHRcdFx0bWF4XG5cdFx0XHQpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXG5cdFx0XHRcdCdjb2RlYmxvY2stY29kZScsIFxuXHRcdFx0XHRtZFNvdXJjZVxuXHRcdFx0KTtcblxuXHRcdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChzdW1tYXJ5Q29udGFpbmVyKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jcmVhdGVFbXB0eShcblx0XHRcdFx0ZWxlbWVudCwgXG5cdFx0XHRcdHRhZ3MgPyB0YWdzIDogW10sIFxuXHRcdFx0XHRpbmNsdWRlID8gaW5jbHVkZSA6IFtdLCBcblx0XHRcdFx0ZXhjbHVkZSA/IGV4Y2x1ZGUgOiBbXSwgXG5cdFx0XHRcdHNlY3Rpb25zID8gc2VjdGlvbnMgOiBbXSwgXG5cdFx0XHRcdG1heCA/IG1heCA6IFtdLCBcblx0XHRcdFx0JycsIFxuXHRcdFx0XHRtZFNvdXJjZVxuXHRcdFx0KTtcblx0XHR9XG5cdH1cblxuXHR1cGRhdGUgKFxuXHRcdHN1bW1hcnlFbDpIVE1MRWxlbWVudFxuXHQpOiB2b2lkIHtcblx0XHRcblx0XHRjb25zdCB0YWdzU3RyID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stdGFncydcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3MgPSB0YWdzU3RyID8gdGFnc1N0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCB0YWdzSW5jbHVkZVN0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZSdcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3NJbmNsdWRlID0gdGFnc0luY2x1ZGVTdHIgPyB0YWdzSW5jbHVkZVN0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCB0YWdzRXhjbHVkZVN0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXRhZ3MtZXhjbHVkZSdcblx0XHQpO1xuXHRcdGNvbnN0IHRhZ3NFeGNsdWRlID0gdGFnc0V4Y2x1ZGVTdHIgPyB0YWdzRXhjbHVkZVN0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCBzZWN0aW9uc1N0ciA9IHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLXNlY3Rpb25zJ1xuXHRcdFx0KTtcblx0XHRjb25zdCBzZWN0aW9ucyA9IHNlY3Rpb25zU3RyID8gc2VjdGlvbnNTdHIuc3BsaXQoJywnKSA6IFtdO1xuXG5cdFx0Y29uc3QgbWF4ID0gTnVtYmVyKHN1bW1hcnlFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnY29kZWJsb2NrLW1heCdcblx0XHQpKTtcblxuXHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdjb2RlYmxvY2stY29kZSdcblx0XHQpO1xuXG5cdFx0dGhpcy5jcmVhdGUoXG5cdFx0XHRzdW1tYXJ5RWwsIFxuXHRcdFx0dGFncywgXG5cdFx0XHR0YWdzSW5jbHVkZSwgXG5cdFx0XHR0YWdzRXhjbHVkZSwgXG5cdFx0XHRzZWN0aW9ucywgXG5cdFx0XHRtYXgsIFxuXHRcdFx0JycsIFxuXHRcdFx0bWRTb3VyY2UpO1xuXHR9XG5cblxuXHQvLyBOb3QgZmFjdG9yZWQgeWV0XG5cdGFzeW5jIGNvcHlUZXh0VG9TZWN0aW9uKFxuXHQgICAgdGV4dDogc3RyaW5nLCBcblx0ICAgIHNlY3Rpb246IHN0cmluZywgXG5cdCAgICBmaWxlUGF0aDogc3RyaW5nLFxuXHQgICAgYWRkTGluazogQm9vbGVhbiA9IHRydWUsXG5cdCAgICBzZWxlY3RlZEZpbGU6IFRGaWxlLFxuXHQgICAgZGV0ZWN0UHJlZml4OiBCb29sZWFuID0gdHJ1ZSlcblx0OlByb21pc2U8Ym9vbGVhbj57XG5cblx0ICAgIGNvbnN0IGZpbGUgPSBzZWxlY3RlZEZpbGUgPyBzZWxlY3RlZEZpbGUgOiAoYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKSk7XG5cdCAgICBsZXQgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHQgICAgY29uc3QgZmlsZUNvbnRlbnRMaW5lczogc3RyaW5nW10gPSBVdGlscy5nZXRMaW5lc0luU3RyaW5nKGZpbGVDb250ZW50KTtcblx0ICAgIGNvbnN0IG1kSGVhZGluZ3MgPSBVdGlscy5nZXRNYXJrZG93bkhlYWRpbmdzKGZpbGVDb250ZW50TGluZXMpO1xuXHQgICAgbGV0IHRhcmdldExpbmU7XG5cblx0ICAgIC8vaWYgKG1kSGVhZGluZ3MubGVuZ3RoIDw9IDAgfHwgc2VjdGlvbiA9PSAnZW5kJyB8fCBzZWN0aW9uID09ICd0b3AnIHx8IHNlY3Rpb24gPT0gJ25vdGUnIHx8IHNlY3Rpb24gPT0gJ25ld05vdGUnKSB7XG4gICAgXHRpZiAobWRIZWFkaW5ncy5sZW5ndGggPD0gMCB8fCBzZWN0aW9uID09ICdlbmQnIHx8IHNlY3Rpb24gPT0gJ3RvcCcpIHtcblxuXHQgICAgXHRpZiAoc2VjdGlvbiA9PSAndG9wJykge1x0ICAgIFx0XG5cdFx0ICAgIFx0dGFyZ2V0TGluZSA9IFV0aWxzLmZpbmRGaXJzdExpbmVBZnRlckZyb250TWF0dGVyKGZpbGVDb250ZW50KVxuXHRcdCAgICBcdGlmICh0YXJnZXRMaW5lID09IDApIGZpbGVDb250ZW50ID0gJ1xcbicgKyBmaWxlQ29udGVudFxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKHRhcmdldExpbmUpXG4gICAgXHRcdC8qfSBlbHNlIGlmIChzZWN0aW9uID09ICduZXdOb3RlJykge1xuXHRcdCAgICBcdHRoaXMubWFrZVN1bW1hcnlCdG5IYW5kbGVyICh0ZXh0LCBbXSwgdHJ1ZSwgdHJ1ZSk7XG5cdFx0ICAgIFx0cmV0dXJuIHRydWU7XG5cdFx0ICAgIFx0Ki9cblx0XHQgICAgLy99IGVsc2UgaWYgKHNlY3Rpb24gPT0gJ2VuZCcgfHwgbWRIZWFkaW5ncy5sZW5ndGggPD0gMCB8fCBzZWN0aW9uID09ICdub3RlJykge1xuXHQgICAgXHR9IGVsc2UgaWYgKHNlY3Rpb24gPT0gJ2VuZCcpIHtcblx0XHQgICAgXHR0YXJnZXRMaW5lID0gZmlsZUNvbnRlbnRMaW5lcy5sZW5ndGggLSAxO1xuXHRcdCAgICAvL30gZWxzZSBpZiAobWRIZWFkaW5ncy5sZW5ndGggPD0gMCkge1xuXHRcdCAgICB9XG5cdCAgICB9IGVsc2UgaWYgKG1kSGVhZGluZ3MubGVuZ3RoID4gMCkgeyAvLyBpZiB0aGVyZSBhcmUgYW55IGhlYWRpbmdzXG5cdCAgICAgICAgY29uc3QgaGVhZGluZ09iaiA9IG1kSGVhZGluZ3MuZmluZChoZWFkaW5nID0+IGhlYWRpbmcudGV4dC50cmltKCkgPT09IHNlY3Rpb24pO1xuXHQgICAgICAgIGlmIChoZWFkaW5nT2JqKSB7XG5cdCAgICAgICAgXHR0YXJnZXRMaW5lID0gaGVhZGluZ09iai5saW5lO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIG5ldyBOb3RpY2UgKGAke3NlY3Rpb259IG5vdCBmb3VuZC5gKTtcblx0ICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgY29uc3QgbGluZVByZWZpeDogU3RyaW5nID0gZGV0ZWN0UHJlZml4ID8gVXRpbHMuZ2V0TGlzdFR5cGVGcm9tTGluZU51bWJlcihmaWxlQ29udGVudCwgdGFyZ2V0TGluZSsxKSA6ICcnO1xuICAgICAgICBsZXQgZmluYWxUZXh0O1xuICAgICAgICBpZiAoYWRkTGluaykgZmluYWxUZXh0ID0gbGluZVByZWZpeCArIHRleHQgKyBgIFtbJHtmaWxlUGF0aH18XHVEODNEXHVERDE3XV1gO1xuICAgICAgICBlbHNlIGZpbmFsVGV4dCA9IGxpbmVQcmVmaXggKyB0ZXh0O1xuICAgICAgICAvL2xldCBuZXdDb250ZW50ID0gdGhpcy5pbnNlcnRUZXh0QWZ0ZXJMaW5lKHRleHQsIGZpbGVDb250ZW50LCBoZWFkaW5nT2JqLmxpbmUpO1xuICAgICAgICBsZXQgbmV3Q29udGVudCA9IFV0aWxzLmluc2VydFRleHRBZnRlckxpbmUoZmluYWxUZXh0LCBmaWxlQ29udGVudCwgdGFyZ2V0TGluZSk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG5cdH1cblxuXHRhc3luYyByZWFkRmlsZXMoXG5cdFx0bGlzdEZpbGVzOiBURmlsZVtdXG5cdCk6IFByb21pc2U8W1RGaWxlLCBzdHJpbmddW10+IHtcblx0XHRcblx0XHRsZXQgbGlzdDogW1RGaWxlLCBzdHJpbmddW10gPSBbXTtcblx0XHRmb3IgKGxldCB0ID0gMDsgdCA8IGxpc3RGaWxlcy5sZW5ndGg7IHQgKz0gMSkge1xuXHRcdFx0Y29uc3QgZmlsZSA9IGxpc3RGaWxlc1t0XTtcblx0XHRcdGxldCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKTtcblx0XHRcdGxpc3QucHVzaChbZmlsZSwgY29udGVudF0pO1xuXHRcdH1cblxuXHRcdHJldHVybiBsaXN0O1xuXHR9XG5cblx0aXNWYWxpZFRleHQoXG5cdCAgICBsaXN0VGFnczogc3RyaW5nW10sIFxuXHQgICAgdGFnczogc3RyaW5nW10sIFxuXHQgICAgaW5jbHVkZTogc3RyaW5nW10sIFxuXHQgICAgZXhjbHVkZTogc3RyaW5nW11cblx0KTogYm9vbGVhbiB7XG5cblx0ICAgIGxldCB2YWxpZCA9IHRydWU7XG5cblx0ICAgIC8vIENoZWNrIE9SICh0YWdzKVxuXHQgICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuXHQgICAgICAgIHZhbGlkID0gdmFsaWQgJiYgdGFncy5zb21lKCh2YWx1ZSkgPT4gbGlzdFRhZ3MuaW5jbHVkZXModmFsdWUpKTtcblx0ICAgIH1cblx0ICAgIC8vIENoZWNrIEFORCAoaW5jbHVkZSlcblx0ICAgIGlmIChpbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0ICAgICAgICB2YWxpZCA9IHZhbGlkICYmIGluY2x1ZGUuZXZlcnkoKHZhbHVlKSA9PiBsaXN0VGFncy5pbmNsdWRlcyh2YWx1ZSkpO1xuXHQgICAgfVxuXHQgICAgLy8gQ2hlY2sgTk9UIChleGNsdWRlKVxuXHQgICAgaWYgKHZhbGlkICYmIGV4Y2x1ZGUubGVuZ3RoID4gMCkge1xuXHQgICAgICAgIHZhbGlkID0gIWV4Y2x1ZGUuc29tZSgodmFsdWUpID0+IGxpc3RUYWdzLmluY2x1ZGVzKHZhbHVlKSk7XG5cdCAgICB9XG5cdCAgICByZXR1cm4gdmFsaWQ7ICAgICAgIFxuXHR9XG5cblx0c3RhdGljIGdldFRhZ3NUb0NoZWNrRnJvbUVsIChcblx0XHR0YWdTdW1tYXJ5RWw6IEhUTUxFbGVtZW50XG5cdCk6IEFycmF5IHtcblx0XHRjb25zdCB0YWdzU3RyID0gdGFnU3VtbWFyeUVsLmdldEF0dHJpYnV0ZSgnY29kZWJsb2NrLXRhZ3MnKTtcblx0XHRjb25zdCB0YWdzID0gdGFnc1N0ciA/IHRhZ3NTdHIuc3BsaXQoJywnKSA6IFtdO1xuXHRcdGNvbnN0IHRhZ3NJbmNsdWRlU3RyID0gdGFnU3VtbWFyeUVsLmdldEF0dHJpYnV0ZSgnY29kZWJsb2NrLXRhZ3MtaW5jbHVkZScpO1xuXHRcdGNvbnN0IHRhZ3NJbmNsdWRlID0gdGFnc0luY2x1ZGVTdHIgPyB0YWdzSW5jbHVkZVN0ci5zcGxpdCgnLCcpIDogW107XG5cdFx0cmV0dXJuIHRhZ3MuY29uY2F0KHRhZ3NJbmNsdWRlKTtcblx0fVxuXG5cdGFzeW5jIGdldEZpbGUgKFxuXHRcdGVsOiBIVE1MRWxlbWVudFxuXHQpOlRGaWxlIHtcblx0XHRjb25zdCBmaWxlUGF0aCA9IGVsLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKTsgXG5cdFx0Y29uc3QgZmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0cmV0dXJuIGZpbGU7XG5cdH1cblxuXHR1cGRhdGVTZWxlY3Rpb24gKFxuXHRcdGluZGV4OiBOdW1iZXIsIFxuXHRcdGJvb2w6IEJvb2xlYW5cblx0KTogdm9pZCB7XG5cblx0XHQvLyBJZiBpc1NlbGVjdGVkIGlzIHRydWUsIGFkZCB0aGUgaW5kZXggaWYgaXQncyBub3QgYWxyZWFkeSBpbiB0aGUgYXJyYXlcblx0XHRpZiAoYm9vbCkge1xuXHRcdCAgICBpZiAoIXRoaXMuc2VsZWN0ZWRCbG9ja3MuaW5jbHVkZXMoaW5kZXgpKSB7XG5cdFx0ICAgICAgICB0aGlzLnNlbGVjdGVkQmxvY2tzLnB1c2goaW5kZXgpO1xuXHRcdCAgICB9XG5cdFx0fSBlbHNlIHtcblx0XHQgICAgLy8gSWYgaXNTZWxlY3RlZCBpcyBmYWxzZSwgcmVtb3ZlIHRoZSBpbmRleCBmcm9tIHRoZSBhcnJheVxuXHRcdCAgICB0aGlzLnNlbGVjdGVkQmxvY2tzID0gdGhpcy5zZWxlY3RlZEJsb2Nrcy5maWx0ZXIoaXRlbUluZGV4ID0+IGl0ZW1JbmRleCAhPT0gaW5kZXgpO1xuXHRcdH1cblxuLy9jb25zb2xlLmxvZyh0aGlzLnNlbGVjdGVkQmxvY2tzKVxuXG5cdH1cblxuXG5cdGdldFNlbGVjdGVkTWFya2Rvd25CbG9ja3MgKCk6IFN0cmluZ1tdIHtcblx0XHRcblx0XHQvLyBUaGlzIGlzIHRvbyBtZXNzeSB3aXRoIGN1cnJlbnQgaW1wbG1lbnRhdGlvbi5cblx0XHQvLyBUbyBtYWtlIHRoaXMgd29yaywgd2UgbmVlZCB0byBicmVhayBvdXQgYWxsIHRoZSBjb3B5VG8sIGdldFByZWZpeCwgYWRkTGluaywgZXRjIG1ldGhvZHMvcHJvcHNcblx0XHQvLyB3ZSBuZWVkIHRvIGJlIGJ1aWxkaW5nIHRoZSBjb250ZW50IGFzIHdlIHNlbGVjdC5cblxuXHRcdC8vIG1vdmU6IEkgZG9uJ3QgdGhpbmsgd2UgY2FuIHJlbW92ZSBpbiBidWxrPyBtYXliZSBqdXN0IGRvIGl0IHdpdGhvdXQgbW90aW9uLlxuXHRcdC8vIGJha2Ugc2hvdWxkIGJlIGVhc3lcblx0XHQvLyBjb3B5LCBlYXN5XG5cdFx0Ly8gbmV3IG5vdGVcblx0XHQvLyBjb3B5IHRvOiBlYXN5LCBidXQgbmVlZCB0byBhZGQgdGhlIGJ1bGxldCB0byBlYWNoXG5cdFx0Ly8gaSBndWVzcyBsaW5rIGlzIHRoZSBzYW1lIGVhc3lcblx0fVxuXG59XG5cbmNsYXNzIFRlbXBDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuXHRkb05vdFBvc3RQcm9jZXNzID0gdHJ1ZTtcblx0b25sb2FkKCkge31cblx0b251bmxvYWQoKSB7fVxufSIsICJpbXBvcnQgeyBBcHAsIE1hcmtkb3duUmVuZGVyZXIsIE1hcmtkb3duUG9zdFByb2Nlc3NvciwgZGVib3VuY2UsIE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHQsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duUHJldmlld1ZpZXcsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCAqIGFzIFV0aWxzIGZyb20gJy4vdXRpbHMnO1xuXG5leHBvcnQgY2xhc3MgVGFnUHJvY2Vzc29yIHtcblx0YXBwOiBBcHA7IFxuXHRwbHVnaW46IFRhZ0J1ZGR5O1xuXHRwcml2YXRlIG91dE9mU3luYzogYm9vbGVhbiA9IGZhbHNlO1xuXHRkZWJvdW5jZWRQcm9jZXNzQWN0aXZlRmlsZVRhZ0VsczogRnVuY3Rpb247XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0YXBwOiBBcHAsIFxuXHRcdHBsdWdpbjogVGFnQnVkZHlcblx0KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblxuXHRcdHRoaXMuZGVib3VuY2VkUHJvY2Vzc0FjdGl2ZUZpbGVUYWdFbHMgPSBkZWJvdW5jZSh0aGlzLnByb2Nlc3NBY3RpdmVGaWxlVGFncy5iaW5kKHRoaXMpLCA1MDApXG5cblx0XHR0aGlzLmRlYm91bmNlZFByb2Nlc3NBY3RpdmVGaWxlVGFnRWxzKCk7XG5cblx0fVxuXG5cdHJlc2V0KCkge1xuLy9jb25zb2xlLmxvZygndGFnIHByb2Nlc3NvciByZXNldCcpO1xuXHRcdHRoaXMub3V0T2ZTeW5jID0gZmFsc2U7XG5cdH1cblxuXHRmaWx0ZXJBY3RpdmVGaWxlVGFnRWxzIChcblx0XHR0YWdzOiBIVE1MRWxlbWVudFtdXG5cdCk6IEFycmF5IHtcdFx0XG4vL2NvbnNvbGUubG9nKHRhZ3MubGVuZ3RoKVxuXHRcdGNvbnN0IGZpbHRlcmVkVGFnRWxlbWVudHMgPSBBcnJheS5mcm9tKHRhZ3MpLmZpbHRlcih0YWcgPT4ge1xuXG5cdFx0ICAgIC8vIEV4Y2x1ZGUgdGFncyB0aGF0IGFyZSBkZXNjZW5kYW50cyBvZiAuZnJvbnRtYXR0ZXItc2VjdGlvbi1kYXRhXG5cdFx0ICAgIC8vIFRoaXMgaXMgYSBidWcgb24gbW9iaWxlLiBNb2JpbGUgaW5jbHVkZXMgdGhlIHlhbWwgdGFncyBpbiByZW5kZXJlZCBodG1sXG5cdFx0ICAgIGlmICh0YWcuY2xvc2VzdCgnLmZyb250bWF0dGVyLXNlY3Rpb24tZGF0YScpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC5tYXJrZG93bi1lbWJlZFxuXHRcdCAgICBpZiAodGFnLnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLm1hcmtkb3duLWVtYmVkXG5cdFx0ICAgIGlmICh0YWcuY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLm1hcmtkb3duLWVtYmVkXG5cdFx0ICAgIC8vaWYgKHRhZy5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoJy5pbnRlcm5hbC1lbWJlZCcpKSByZXR1cm4gZmFsc2U7XG5cblx0XHQgICAgLy8gRXhjbHVkZSB0YWdzIHRoYXQgYXJlIGRlc2NlbmRhbnRzIG9mIC5tYXJrZG93bi1lbWJlZFxuXHRcdCAgICAvL2lmICh0YWcuY2xvc2VzdCgnLmludGVybmFsLWVtYmVkJykpIHJldHVybiBmYWxzZTtcblxuXHRcdCAgICAvLyBFeGNsdWRlIHRhZ3MgdGhhdCBhcmUgZGVzY2VuZGFudHMgb2YgLnRhZy1zdW1tYXJ5LWJsb2NrXG5cdFx0ICAgIGlmICh0YWcucGFyZW50RWxlbWVudC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKSkgcmV0dXJuIGZhbHNlO1xuXG5cdFx0ICAgIHJldHVybiB0cnVlO1xuXHRcdH0pO1xuXG4vL2NvbnNvbGUubG9nKGZpbHRlcmVkVGFnRWxlbWVudHMubGVuZ3RoKVxuXHRcdHJldHVybiBmaWx0ZXJlZFRhZ0VsZW1lbnRzO1xuXHR9XG5cblx0YXN5bmMgcmVuZGVyUG9zdFByb2Nlc3NvciAoXG5cdFx0ZWw6IEhUTUxFbGVtZW50LCBcblx0XHRjdHg6IE1hcmtkb3duUG9zdFByb2Nlc3NvckNvbnRleHRcblx0KTogdm9pZCB7XHRcblx0XHRjb25zdCBwcm9jZXNzaW5nRmlsZTogVEZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoY3R4LnNvdXJjZVBhdGgpO1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGU6IFRGaWxlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRjb25zdCBhY3RpdmVGaWxlUGF0aDogc3RyaW5nID0gYWN0aXZlRmlsZT8ucGF0aDtcblx0XHRcblx0XHRjb25zdCBuYXRpdmVFbWJlZEVsOiBIVE1MRWxlbWVudCA9IGVsLnF1ZXJ5U2VsZWN0b3IoJy5pbnRlcm5hbC1lbWJlZCcpO1xuXHRcdGNvbnN0IHRhZ3M6IEhUTUxFbGVtZW50W10gPSBlbC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyk7XG5cblx0XHRpZiAoKG5hdGl2ZUVtYmVkRWwgJiYgY3R4LnNvdXJjZVBhdGggPT0gYWN0aXZlRmlsZVBhdGgpIC8vIGVtYmVkc1xuXHRcdFx0fHwgKGN0eC5zb3VyY2VQYXRoID09IGFjdGl2ZUZpbGVQYXRoICYmIHRhZ3MubGVuZ3RoID4gMCkgLy8gYWN0aXZlIGZpbGUgdGFnc1xuXHRcdFx0fHwgZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWctc3VtbWFyeS1wYXJhZ3JhcGgnKSAvLyBzdW1tYXJ5IHRhZ3Ncblx0XHQpIHtcblx0XHRcdC8vaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogcmVuZGVyUG9zdFByb2Nlc3NvcicpOyBcblx0XHR9XG5cdFx0ZWxzZSB7IHJldHVybjsgfVxuXHRcblx0XHRpZiAobmF0aXZlRW1iZWRFbCkge1xuXHRcdFx0Ly90aGlzLm5hdGl2ZUVtYmVkcy5wdXNoKG5hdGl2ZUVtYmVkRWwpO1xuXHRcdFx0bGV0IG5hdGl2ZUVtYmVkT2JzZXJ2ZXI6IE11dGF0aW9uT2JzZXJ2ZXI7XG5cdFx0XHRuYXRpdmVFbWJlZE9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9uc0xpc3QpID0+IHtcdFx0XHRcblx0XHRcdFx0Y29uc3QgdGFyZ2V0OiBIVE1MRWxlbWVudCA9IG11dGF0aW9uc0xpc3RbMF0udGFyZ2V0O1xuXHRcdFx0XHRpZiAodGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0bmF0aXZlRW1iZWRPYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0XHRcdFx0dGhpcy5wcm9jZXNzTmF0aXZlRW1iZWQodGFyZ2V0KTtcblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0XHRuYXRpdmVFbWJlZE9ic2VydmVyLm9ic2VydmUobmF0aXZlRW1iZWRFbCwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XG5cdFx0fVxuXHRcblx0XHRpZiAoZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCd0YWctc3VtbWFyeS1wYXJhZ3JhcGgnKSkge1xuXHRcdFx0dGhpcy5wcm9jZXNzVGFnU3VtbWFyeVBhcmFncmFwaChlbCk7XG5cdFx0XHRyZXR1cm47IFxuXHRcdH0gXG5cblx0XHR0aGlzLmRlYm91bmNlZFByb2Nlc3NBY3RpdmVGaWxlVGFnRWxzKCk7XHRcblx0fVxuXG5cdGFzeW5jIHByb2Nlc3NBY3RpdmVGaWxlVGFncyAoXG5cdFx0Ly90YWdzOiBIVE1MRWxlbWVudFtdLFxuXHQpOiB2b2lkIHtcdFx0XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogcHJvY2Vzc2luZyBhY3RpdmUgZmlsZSB0YWdzJylcdFx0XG5cblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRjb25zdCBtb2RlID0gdmlldz8uZ2V0TW9kZSgpO1xuXHRcdC8vY29uc3QgcHJlVmlldyA9IGF3YWl0IHZpZXcuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLXJlYWRpbmctdmlldycpO1xuXHRcdGlmIChtb2RlID09ICdwcmV2aWV3Jykge1xuXHRcdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoYWN0aXZlRmlsZSk7XG5cdFx0XHRjb25zdCBzZWN0aW9ucyA9IHZpZXcuY3VycmVudE1vZGUucmVuZGVyZXIuc2VjdGlvbnM7XG5cdFx0XHRjb25zdCBhY3RpdmVGaWxlVGFnRWxzID0gW107XG5cblx0XHRcdGNvbnN0IGFjdGl2ZUZpbGVUYWdzID0gYXdhaXQgdGhpcy5nZXRNYXJrZG93blRhZ3MoXG5cdFx0XHRcdGFjdGl2ZUZpbGUsIFxuXHRcdFx0XHRmaWxlQ29udGVudFxuXHRcdFx0KTtcblxuXHRcdFx0c2VjdGlvbnMuZm9yRWFjaChzZWN0aW9uID0+IHtcblx0XHRcdFx0QXJyYXkuZnJvbShzZWN0aW9uLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSkuZm9yRWFjaCh0YWcgPT4ge1xuXHRcdFx0XHRcdGFjdGl2ZUZpbGVUYWdFbHMucHVzaCh0YWcpO1xuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBGaWx0ZXIgdGFncyBcblx0XHRcdGNvbnN0IGZpbHRlcmVkVGFnRWxlbWVudHMgPSB0aGlzLmZpbHRlckFjdGl2ZUZpbGVUYWdFbHMoYWN0aXZlRmlsZVRhZ0Vscyk7XG5cdFx0XHRcblx0XHRcdGlmIChmaWx0ZXJlZFRhZ0VsZW1lbnRzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0dGhpcy5hc3NpZ25NYXJrZG93blRhZ3MoXG5cdFx0XHRcdFx0YWN0aXZlRmlsZVRhZ3MsIFxuXHRcdFx0XHRcdGZpbHRlcmVkVGFnRWxlbWVudHMsICBcblx0XHRcdFx0XHQwLCAvL3N0YXJ0SW5kZXgsXG5cdFx0XHRcdFx0J2FjdGl2ZSdcblx0XHRcdFx0KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRhc3luYyBwcm9jZXNzVGFnU3VtbWFyeVBhcmFncmFwaCAoXG5cdFx0cGFyYWdyYXBoRWw6IEhUTUxFbGVtZW50LFxuXHQpOnZvaWQge1xuXHRcdC8vaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogcHJvY2Vzc1RhZ1N1bW1hcnlQYXJhZ3JhcGgnKVxuXG5cdFx0Y29uc3QgZmlsZVBhdGggPSBwYXJhZ3JhcGhFbC5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cdFx0Y29uc3QgbWFya2Rvd25CbG9jayA9IHBhcmFncmFwaEVsLmdldEF0dHJpYnV0ZSgnbWQtc291cmNlJykudHJpbSgpO1xuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRjb25zdCBzdGFydEluZGV4ID0gZmlsZUNvbnRlbnQuaW5kZXhPZihtYXJrZG93bkJsb2NrKTtcblx0XHRjb25zdCBtZFRhZ3MgPSB0aGlzLmdldE1hcmtkb3duVGFncyhcblx0XHRcdGZpbGUsIFxuXHRcdFx0ZmlsZUNvbnRlbnRcblx0XHQpO1xuXHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKFxuXHRcdFx0bWRUYWdzLCBcblx0XHRcdHBhcmFncmFwaEVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSwgXG5cdFx0XHRzdGFydEluZGV4LCBcblx0XHRcdCdwbHVnaW4tc3VtbWFyeSdcblx0XHQpO1xuXHR9XG5cblxuLypcblx0Ly8gYWRhcHQgdGhpcyBtZXRob2QgdG8gdXNlIHRoZSBjYWNoZSB0YWcgaW5mbyAobGluZSwgb2Zmc2V0LCBldGMpXG5cdGdldE1hcmtkb3duVGFncyAoXG5cdFx0ZmlsZTogVEZpbGUsICBcblx0XHRmaWxlQ29udGVudDogc3RyaW5nIFxuXHQpOiBBcnJheSB7XG5cblx0XHRjb25zdCB0YWdQb3NpdGlvbnMgPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cdFx0Ly8gT2JzaWRpYW4gdGFnIHNwZWM6IGh0dHBzOi8vaGVscC5vYnNpZGlhbi5tZC9FZGl0aW5nK2FuZCtmb3JtYXR0aW5nL1RhZ3MjVGFnK2Zvcm1hdFxuXHRcdC8vY29uc3QgcmVnZXggPSAvKD86XnxcXHMpI1teXFxzI10rfGBgYC9nOyAvLyBCVUc6IHdyb25nIG1hdGNoLmluZGV4LiBtYXRjaGVzIHRoZSBzcGFjZSBiZWZvcmUgdGhlIHRhZy5cblx0XHQvL2NvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykjW15cXHMjXSt8YGBgL2cgLy8gRklYLiBCdXQgc3RpbGwgbWF0Y2hpbmcgcHVuY3R1YXRpb24gYWZ0ZXJcblx0XHQvL2NvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykoI1teXFxzIy4sOyE/Ol0rKSg/PVsuLDshPzpcXHNdfCQpfGBgYC9nICAvLyBtYXRjaGVzIHB1bmN0dWF0aW9uIGFmdGVyLCBidXQgbm90IGluY2x1ZGVkIGluIHRoZSBtYXRjaFxuXHRcdC8vY29uc3QgcmVnZXggPSAvKD88PV58XFxzKSgjW15cXHMjLiw7IT86XSspKD89Wy4sOyE/Olxcc118JCl8KD88IWApYGBgKD8hYCkvZzsgLy8gRml4IGZvciBtYXRjaGluZyBgYGBgIFxuXHRcdC8vY29uc3QgcmVnZXggPSAvKD88PV58XFxzKSgjW15cXHMjLicsOyE/Ol0rKSg/PVsuLDshPzonXFxzXXwkKXwoPzwhYClgYGAoPyFgKS9nOyAvLyBGaXggZm9yIG1hdGNoaW5nIGJ1dCBleGNsdWRpbmcgJydzJyBpbiAnI3RhZydzJ1xuXHRcdGNvbnN0IHJlZ2V4ID0gLyg/PD1efFxccykoIyg/PVteXFxzIy4nXHUyMDE5LDshPzpdKlteXFxkXFxzIy4nXHUyMDE5LDshPzpdKVteXFxzIy4nXHUyMDE5LDshPzpdKykoPz1bLiw7IT86J1x1MjAxOVxcc118JCl8KD88IWApYGBgKD8hYCkvZzsgLy8gZml4IGZvciBudW1iZXItb25seSBhbmQgdHlwb2dyYXBoaWMgYXBvc3Ryb3BoeSdzXG5cblxuXG5cdFx0bGV0IGluc2lkZUNvZGVCbG9jayA9IGZhbHNlO1xuXG5cdFx0d2hpbGUgKChtYXRjaCA9IHJlZ2V4LmV4ZWMoZmlsZUNvbnRlbnQpKSAhPT0gbnVsbCkge1xuXHRcdCAgICBpZiAobWF0Y2hbMF0udHJpbSgpID09PSBcImBgYFwiKSB7XG5cdFx0ICAgICAgICBpbnNpZGVDb2RlQmxvY2sgPSAhaW5zaWRlQ29kZUJsb2NrOyBcblx0XHQgICAgICAgIGNvbnRpbnVlOyAvLyBSZWplY3QgaWYgdGFnIGluIGEgY29kZSBibG9ja1xuXHRcdCAgICB9XHQgICAgXG5cdFx0ICAgIGlmIChpbnNpZGVDb2RlQmxvY2spIGNvbnRpbnVlO1xuXHRcdCAgICBjb25zdCB0YWcgPSBtYXRjaFswXS50cmltKCk7XG5cdFx0ICAgIHRhZ1Bvc2l0aW9ucy5wdXNoKHt0YWc6dGFnLCBpbmRleDptYXRjaC5pbmRleCwgc291cmNlOmZpbGUubmFtZX0pOyBcbi8vY29uc29sZS5sb2codGFnKVxuXHRcdH1cblx0XHRyZXR1cm4gdGFnUG9zaXRpb25zO1xuXHR9XG4qL1xuXG5cbmdldE1hcmtkb3duVGFncyhcbiAgICBmaWxlOiBURmlsZSxcbiAgICBmaWxlQ29udGVudDogc3RyaW5nXG4pOiBBcnJheSB7XG4gICAgY29uc3QgdGFnUG9zaXRpb25zID0gW107XG4gICAgY29uc3QgcHJvY2Vzc2VkUG9zaXRpb25zID0gbmV3IFNldCgpOyAvLyBUcmFjayBwb3NpdGlvbnMgdG8gcHJldmVudCBkdXBsaWNhdGUgcHJvY2Vzc2luZ1xuICAgIGxldCBtYXRjaDtcbiAgICBjb25zdCByZWdleCA9IC8oPzw9XnxcXHMpKCMoPz1bXlxccyMuJ1x1MjAxOSw7IT86XSpbXlxcZFxccyMuJ1x1MjAxOSw7IT86XSlbXlxccyMuJ1x1MjAxOSw7IT86XSspKD89Wy4sOyE/OidcdTIwMTlcXHNdfCQpfCg/PCFgKWBgYCg/IWApL2c7IC8vIE9yaWdpbmFsIHJlZ2V4XG5cbiAgICAvLyBDb250ZXh0IHRyYWNraW5nXG4gICAgbGV0IGN1cnJlbnRDb250ZXh0ID0gXCJub3JtYWxcIjtcbiAgICBsZXQgaW5zaWRlQ29kZUJsb2NrID0gZmFsc2U7IC8vIFRyYWNrIGlmIHdlIGFyZSBpbnNpZGUgYSBjb2RlIGJsb2NrXG4gICAgbGV0IGludmFsaWRCbG9ja3F1b3RlID0gZmFsc2U7IC8vIFRyYWNrIGlmIGEgYmxvY2txdW90ZSBoYXMgYmVlbiBpbnZhbGlkYXRlZFxuXG4gICAgLy8gTWF0Y2ggYWxsIHRhZ3MgYW5kIHNwZWNpYWwgY29udGV4dHMgaW4gb25lIHBhc3NcbiAgICB3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhmaWxlQ29udGVudCkpICE9PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoZWRTdHJpbmcgPSBtYXRjaFswXS50cmltKCk7XG4gICAgICAgIGNvbnN0IG1hdGNoSW5kZXggPSBtYXRjaC5pbmRleDtcblxuICAgICAgICAvLyBTa2lwIGlmIHRoaXMgcG9zaXRpb24gaGFzIGFscmVhZHkgYmVlbiBwcm9jZXNzZWRcbiAgICAgICAgaWYgKHByb2Nlc3NlZFBvc2l0aW9ucy5oYXMobWF0Y2hJbmRleCkpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBTa2lwcGluZyBkdXBsaWNhdGUgdGFnIGF0IHBvc2l0aW9uICR7bWF0Y2hJbmRleH06ICR7bWF0Y2hlZFN0cmluZ31gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVG9nZ2xlIGNvZGUgYmxvY2sgc3RhdGUgd2hlbiBlbmNvdW50ZXJpbmcgYSBmZW5jZVxuICAgICAgICBpZiAobWF0Y2hlZFN0cmluZyA9PT0gXCJgYGBcIikge1xuICAgICAgICAgICAgaW5zaWRlQ29kZUJsb2NrID0gIWluc2lkZUNvZGVCbG9jaztcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBUb2dnbGVkIGluc2lkZUNvZGVCbG9jayB0byAke2luc2lkZUNvZGVCbG9ja31gKTtcbiAgICAgICAgICAgIGNvbnRpbnVlOyAvLyBTa2lwIHByb2Nlc3NpbmcgdGhlIGZlbmNlIGxpbmUgaXRzZWxmXG4gICAgICAgIH1cblxuICAgICAgICAvLyBTa2lwIHByb2Nlc3NpbmcgaWYgaW5zaWRlIGEgY29kZSBibG9ja1xuICAgICAgICBpZiAoaW5zaWRlQ29kZUJsb2NrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZyhgU2tpcHBpbmcgdGFnICR7bWF0Y2hlZFN0cmluZ30gaW5zaWRlIGNvZGUgYmxvY2suYCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERldGVybWluZSB0aGUgY29udGV4dCBvZiB0aGUgY3VycmVudCBsaW5lXG4gICAgICAgIGNvbnN0IGxpbmVTdGFydCA9IGZpbGVDb250ZW50Lmxhc3RJbmRleE9mKFwiXFxuXCIsIG1hdGNoSW5kZXgpICsgMTsgLy8gR2V0IHN0YXJ0IG9mIHRoZSBsaW5lXG4gICAgICAgIGNvbnN0IGxpbmVFbmQgPSBmaWxlQ29udGVudC5pbmRleE9mKFwiXFxuXCIsIG1hdGNoSW5kZXgpOyAvLyBHZXQgZW5kIG9mIHRoZSBsaW5lXG4gICAgICAgIGNvbnN0IGxpbmUgPSBmaWxlQ29udGVudC5zbGljZShsaW5lU3RhcnQsIGxpbmVFbmQgIT09IC0xID8gbGluZUVuZCA6IHVuZGVmaW5lZCk7XG5cbiAgICAgICAgaWYgKGxpbmUudHJpbSgpLnN0YXJ0c1dpdGgoXCI+XCIpKSB7XG4gICAgICAgICAgICBjdXJyZW50Q29udGV4dCA9IFwiYmxvY2txdW90ZVwiO1xuXG4gICAgICAgICAgICAvLyBDaGVjayBmb3IgaW52YWxpZCBibG9ja3F1b3RlIGNvbmRpdGlvbiAoZS5nLiwgdGFiIGFmdGVyIGA+YClcbiAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoXCI+IFxcdFwiKSB8fCBsaW5lLnN0YXJ0c1dpdGgoXCI+XFx0XCIpIHx8IGxpbmUuaW5jbHVkZXMoXCIobm90IGEgdGFnKVwiKSkge1xuICAgICAgICAgICAgICAgIGludmFsaWRCbG9ja3F1b3RlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZyhgSW52YWxpZCBibG9ja3F1b3RlIHRyaWdnZXJlZCBhdCBsaW5lOiAke2ZpbGVDb250ZW50LnN1YnN0cmluZygwLCBtYXRjaEluZGV4KS5zcGxpdChcIlxcblwiKS5sZW5ndGh9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAobGluZS50cmltKCkuc3RhcnRzV2l0aChcIi1cIikgfHwgbGluZS50cmltKCkubWF0Y2goL15cXGQrXFwuLykpIHtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0ID0gXCJsaXN0XCI7XG4gICAgICAgICAgICBpbnZhbGlkQmxvY2txdW90ZSA9IGZhbHNlOyAvLyBSZXNldCBpbnZhbGlkIGJsb2NrcXVvdGUgc3RhdGVcbiAgICAgICAgfSBlbHNlIGlmIChsaW5lLnN0YXJ0c1dpdGgoXCJcXHRcIikpIHtcbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0ID0gXCJpbmRlbnRlZFwiOyAvLyBDb3JyZWN0bHkgbWFyayB0YWItaW5kZW50ZWQgbGluZXNcbiAgICAgICAgICAgIGludmFsaWRCbG9ja3F1b3RlID0gZmFsc2U7IC8vIFJlc2V0IGludmFsaWQgYmxvY2txdW90ZSBzdGF0ZVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudENvbnRleHQgPSBcIm5vcm1hbFwiO1xuICAgICAgICAgICAgaW52YWxpZEJsb2NrcXVvdGUgPSBmYWxzZTsgLy8gUmVzZXQgaW52YWxpZCBibG9ja3F1b3RlIHN0YXRlXG4gICAgICAgIH1cblxuICAgICAgICAvLyBEZWJ1ZyBsb2dnaW5nIGZvciBjb250ZXh0XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBMaW5lICR7ZmlsZUNvbnRlbnQuc3Vic3RyaW5nKDAsIG1hdGNoSW5kZXgpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aH06ICR7Y3VycmVudENvbnRleHR9IC0gJHtsaW5lLnRyaW0oKX1gKTtcblxuICAgICAgICAvLyBTa2lwIHByb2Nlc3NpbmcgaWYgaW4gYW4gaW52YWxpZCBibG9ja3F1b3RlIGNvbnRleHRcbiAgICAgICAgaWYgKGludmFsaWRCbG9ja3F1b3RlKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlKWNvbnNvbGUubG9nKGBTa2lwcGluZyB0YWcgJHttYXRjaGVkU3RyaW5nfSBkdWUgdG8gaW52YWxpZCBibG9ja3F1b3RlIGNvbnRleHQuYCk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENvbnRleHQtc3BlY2lmaWMgZXhjbHVzaW9uc1xuICAgICAgICBjb25zdCBpc1ZhbGlkID1cbiAgICAgICAgICAgIGN1cnJlbnRDb250ZXh0ICE9PSBcImluZGVudGVkXCIgJiYgLy8gRXhjbHVkZSBsaW5lcyBzdGFydGluZyB3aXRoIHRhYnNcbiAgICAgICAgICAgICEoY3VycmVudENvbnRleHQgPT09IFwibGlzdFwiICYmIGxpbmUuaW5jbHVkZXMoXCIobm90IGEgdGFnKVwiKSkgJiYgLy8gRXhjbHVkZSBpbnZhbGlkIGxpc3QgdGFnc1xuICAgICAgICAgICAgIShjdXJyZW50Q29udGV4dCA9PT0gXCJibG9ja3F1b3RlXCIgJiYgaW52YWxpZEJsb2NrcXVvdGUpOyAvLyBFeGNsdWRlIGFsbCBpbnZhbGlkIGJsb2NrcXVvdGVzXG5cbiAgICAgICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgICAgICAgIHRhZ1Bvc2l0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgICAgICB0YWc6IG1hdGNoZWRTdHJpbmcsXG4gICAgICAgICAgICAgICAgaW5kZXg6IG1hdGNoSW5kZXgsXG4gICAgICAgICAgICAgICAgc291cmNlOiBmaWxlLm5hbWUsXG4gICAgICAgICAgICAgICAgY29udGV4dDogY3VycmVudENvbnRleHQsXG4gICAgICAgICAgICAgICAgbGluZTogZmlsZUNvbnRlbnQuc3Vic3RyaW5nKDAsIG1hdGNoSW5kZXgpLnNwbGl0KFwiXFxuXCIpLmxlbmd0aCwgLy8gQ2FsY3VsYXRlIGxpbmUgbnVtYmVyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBGb3VuZCB0YWc6ICR7bWF0Y2hlZFN0cmluZ30gaW4gY29udGV4dDogJHtjdXJyZW50Q29udGV4dH1gKTtcbiAgICAgICAgICAgIHByb2Nlc3NlZFBvc2l0aW9ucy5hZGQobWF0Y2hJbmRleCk7IC8vIE1hcmsgdGhpcyBwb3NpdGlvbiBhcyBwcm9jZXNzZWRcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKGBFeGNsdWRlZCB0YWc6ICR7bWF0Y2hlZFN0cmluZ30gaW4gaW52YWxpZCBjb250ZXh0OiAke2N1cnJlbnRDb250ZXh0fWApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHRhZ1Bvc2l0aW9ucztcbn1cblxuXHRcblxuXG5cdGFzeW5jIGFzc2lnbk1hcmtkb3duVGFncyAoXG5cdFx0dGFnUG9zaXRpb25zOkFycmF5LCBcblx0XHR0YWdFbGVtZW50czogSFRNTEVsZW1lbnRbXSxcblx0XHRzdGFydEluZGV4OiBudW1iZXIsIFxuXHRcdHR5cGU6IHN0cmluZ1xuXHQpOiBIVE1MRWxlbWVudFtdIHtcblxuXHRcdGlmICh0eXBlID09ICdhY3RpdmUnKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKHN0YXJ0SW5kZXgpO1xuXHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkge1xuXHRcdFx0XHRjb25zdCBhY3RpdmVGaWxlUGF0aCA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCkucGF0aDtcblx0XHRcdFx0Y29uc29sZS5sb2codGFnUG9zaXRpb25zLmxlbmd0aCwgdGFnRWxlbWVudHMubGVuZ3RoKSBcblx0XHRcdFx0Ly9jb25zb2xlLmxvZyh0YWdQb3NpdGlvbnMsIHRhZ0VsZW1lbnRzLCB0aGlzLnRhZ0ZpbGVNYW5hZ2VyLmdldFRhZ3MoYWN0aXZlRmlsZVBhdGgpKSBcblx0XHRcdFx0Y29uc3QgdGVtcDEgPSBbXTtcblx0XHRcdFx0dGFnUG9zaXRpb25zLmZvckVhY2gobm9kZU9iaiA9PiB7IHRlbXAxLnB1c2gobm9kZU9iai50YWcpIH0pO1xuXHRcdFx0XHRjb25zdCB0ZW1wMiA9IFtdO1xuXHRcdFx0XHR0YWdFbGVtZW50cy5mb3JFYWNoKG5vZGVPYmogPT4geyB0ZW1wMi5wdXNoKG5vZGVPYmouaW5uZXJUZXh0KSB9KTtcblx0XHRcdFx0XG5cdFx0XHRcdGNvbnNvbGUubG9nKHRlbXAxLCB0ZW1wMilcblx0XHRcdFx0XG5cdFx0XHRcdC8vaWYgKHRhZ1Bvc2l0aW9ucy5sZW5ndGggIT0gdGFnRWxlbWVudHMubGVuZ3RoIHx8IHRhZ1Bvc2l0aW9ucy5sZW5ndGggIT0gdGhpcy50YWdGaWxlTWFuYWdlci5nZXRUYWdzKGFjdGl2ZUZpbGVQYXRoKS5sZW5ndGgpIHtcdFx0XHRcblx0XHRcdH1cblxuXHRcdFx0aWYgKHRhZ1Bvc2l0aW9ucy5sZW5ndGggIT0gdGFnRWxlbWVudHMubGVuZ3RoKSB7XG5cdFx0XHRcdHRoaXMub3V0T2ZTeW5jID0gdHJ1ZTtcblx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBNYXJrZG93biBzb3VyY2UgYW5kIHByZXZpZXcgdGFncyBvdXQgb2Ygc3luYy4gVHJ5IHJlZnJlc2hpbmcgdGhpcyBzdW1tYXJ5LiBUaGVuIGNoZWNrIGZvciB0YWcgc3ludGF4IGVycm9ycyBvciBjb25mbGljdHMgaW4gbWV0YWRhdGEuIFBsZWFzZSByZXBvcnQgaWYgdGhpcyBlcnJvciBwZXJzaXN0cy4nLDEwMDAwKTtcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgdGhpcy5sb2dEaWZmZXJlbmNlcyh0YWdQb3NpdGlvbnMsIHRhZ0VsZW1lbnRzKVxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0bGV0IHRhZ0VsO1xuXHRcdGNvbnN0IHRhZ0VsQXJyYXkgPSBBcnJheS5mcm9tKHRhZ0VsZW1lbnRzKTsgXG5cdFx0bGV0IHRhZ0VsSW5kZXggPSAwO1xuXHRcdGxldCB0YWdQb3M7XG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0YWdQb3NpdGlvbnMubGVuZ3RoOyBpKyspIHtcblx0XHQvL3RhZ1Bvc2l0aW9ucy5mb3JFYWNoKCh0YWdQb3MsIGkpID0+IHtcblx0XHRcdHRhZ1BvcyA9IHRhZ1Bvc2l0aW9uc1tpXTtcbi8vY29uc29sZS5sb2codGFnRWxBcnJheVt0YWdFbEluZGV4XSlcblx0XHRcdGlmICh0YWdQb3MuaW5kZXggPj0gc3RhcnRJbmRleCkge1xuXHRcdFx0XHR0YWdFbCA9IHRhZ0VsQXJyYXlbdGFnRWxJbmRleF0gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGlmICh0YWdFbCkge1xuLy9jb25zb2xlLmxvZyh0YWdFbCwgdGFnUG9zaXRpb25zW2ldLnRhZywgdGFnUG9zaXRpb25zW2ldLmluZGV4KTtcblx0XHRcdFx0XHRpZiAodGFnRWwuaW5uZXJUZXh0LnRyaW0oKSA9PSB0YWdQb3MudGFnLnRyaW0oKSkge1xuXHRcdCAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ21kLWluZGV4JywgdGFnUG9zLmluZGV4KTtcblx0XHQgICAgXHRcdFx0dGFnRWwuc2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScsIHRhZ1Bvcy5zb3VyY2UpO1xuXHRcdCAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCB0eXBlKTtcblx0XHQgICAgXHRcdFx0dGFnRWwuc2V0QXR0cmlidXRlKCdwb3MnLCBpKTtcblx0XHQgICAgXHRcdCAgICB0YWdFbEluZGV4Kys7XG5cdFx0ICAgIFx0XHR9IGVsc2Uge1xuXHRcdCAgICBcdFx0XHQvL2NvbnNvbGUubG9nKHRhZ0VsLmlubmVyVGV4dC50cmltKCksIHRhZ1Bvcy50YWcudHJpbSgpKVxuXHRcdCAgICBcdFx0XHR0aGlzLm91dE9mU3luYyA9IHRydWU7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IE1hcmtkb3duIHNvdXJjZSBhbmQgcHJldmlldyB0YWdzIG91dCBvZiBzeW5jLiBUcnkgcmVmcmVzaGluZyB0aGlzIHN1bW1hcnkuIFRoZW4gY2hlY2sgZm9yIHRhZyBzeW50YXggZXJyb3JzIG9yIGNvbmZsaWN0cyBpbiBtZXRhZGF0YS4gUGxlYXNlIHJlcG9ydCBpZiB0aGlzIGVycm9yIHBlcnNpc3RzLicpO1xuLy9jb25zb2xlLmxvZyh0YWdQb3NpdGlvbnMsIHRhZ0VsZW1lbnRzKVxuXG5cdFx0XHRcdFx0XHR0aGlzLmxvZ0RpZmZlcmVuY2VzKHRhZ1Bvc2l0aW9ucywgdGFnRWxlbWVudHMpXG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0ICAgIFx0XHR9XG4gICAgXHRcdFx0fVxuICAgIFx0XHR9IFxuXHRcdH07XG5cdFx0XG5cdFx0cmV0dXJuIHRhZ0VsQXJyYXk7IFxuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc05hdGl2ZUVtYmVkIChcblx0XHQvL3RhZ3M6IEhUTUxFbGVtZW50W10gXG5cdFx0ZW1iZWQ6IEhUTUxFbGVtZW50LFxuXHRcdGNoZWNrRHVwbGljYXRlczogYm9vbGVhbiA9IGZhbHNlXG5cdCk6dm9pZCB7XG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeTogcHJvY2Vzc05hdGl2ZUVtYmVkJylcblx0XHRlbWJlZCA9IGVtYmVkLmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpO1xuIFx0XHRpZiAoZW1iZWQ/LmdldEF0dHJpYnV0ZSgnc3JjJykpIHtcblx0XHRcdGNvbnN0IGxpbmtFbGVtZW50ID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdzcmMnKTtcblx0XHRcdGxldCBmaWxlUGF0aCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cdFx0XHRjb25zdCBsaW5rQXJyYXkgPSBmaWxlUGF0aC5zcGxpdCgnIycpO1xuXHRcdFx0Y29uc3QgaGFzQW5jaG9yTGluayA9IGxpbmtBcnJheS5sZW5ndGggPiAxO1xuXHRcdFx0bGV0IGFuY2hvckxpbmtUeXBlID0gJyc7XG5cdFx0XHRsZXQgYW5jaG9yTGluaztcblx0XHRcdGlmIChoYXNBbmNob3JMaW5rKSB7XG5cdFx0XHRcdGFuY2hvckxpbmsgPSBsaW5rQXJyYXlbMV07XG5cdFx0XHRcdGFuY2hvckxpbmtUeXBlID0gYW5jaG9yTGluay5zdGFydHNXaXRoKCdeJykgPyAnYmxvY2snIDogJ2hlYWRlcic7XG5cdFx0XHR9XG5cdFx0XHRmaWxlUGF0aCA9IGxpbmtBcnJheVswXS50cmltKCkgKyAnLm1kJztcblx0XHRcdGNvbnN0IGZpbGUgPSBhd2FpdCBVdGlscy52YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKVx0XHRcdFxuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRjb25zdCBlbWJlZGVkVGFnRmlsZSA9IGF3YWl0IHRoaXMuZ2V0TWFya2Rvd25UYWdzKGZpbGUsIGZpbGVDb250ZW50KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChoYXNBbmNob3JMaW5rICYmIGFuY2hvckxpbmtUeXBlICE9ICcnKSB7XG5cdFx0XHRcdFx0aWYgKFxuXHRcdFx0XHRcdFx0YW5jaG9yTGlua1R5cGUgPT0gJ2hlYWRlcicgXG5cdFx0XHRcdFx0XHQmJiAhVXRpbHMuZmlsZUNvbnRhaW5zSGVhZGluZyhmaWxlQ29udGVudCwgYW5jaG9yTGluaylcblx0XHRcdFx0XHQpIHtcblx0XHRcdFx0XHRcdGVtYmVkLnNldEF0dHJpYnV0ZSgnZW1iZWQtc3VjY2VzcycsICdmYWxzZScpO1xuXHRcdFx0XHRcdFx0cmV0dXJuOyAvLyBSZWplY3QgaWYgdGhpcyBpcyBhIG5hdGl2ZSBcImNhbid0IGZpbmQgI3NlY3Rpb25cIiBlcnJvclxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRlbWJlZC5zZXRBdHRyaWJ1dGUoJ2VtYmVkLXN1Y2Nlc3MnLCAndHJ1ZScpO1x0XG5cdFx0XHRcdFx0fSBcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IHRlbXBDb21wb25lbnQgPSBuZXcgVGVtcENvbXBvbmVudCgpO1xuXHRcdFx0XHRjb25zdCB0ZW1wQ29udGFpbmVySFRNTCA9IGNyZWF0ZUVsKFwiZGl2XCIpO1xuXHRcdFx0XHRcblx0XHRcdFx0YXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcblx0XHRcdFx0XHRmaWxlQ29udGVudCwgXG5cdFx0XHRcdFx0dGVtcENvbnRhaW5lckhUTUwsIFxuXHRcdFx0XHRcdCdub0ZpbGUnLCAvL2ZpbGUucGF0aCwgXG5cdFx0XHRcdFx0dGVtcENvbXBvbmVudFxuXHRcdFx0XHQpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgaW5uZXJUZXh0ID0gYXdhaXQgZW1iZWQucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLWVtYmVkLWNvbnRlbnQnKS5pbm5lclRleHQ7XG5cdFx0XHRcdGNvbnN0IHN0YXJ0SW5kZXggPSB0ZW1wQ29udGFpbmVySFRNTC5pbm5lclRleHQuaW5kZXhPZihpbm5lclRleHQpO1xuXHRcdFx0XHRcblx0XHRcdFx0dGhpcy5hc3NpZ25NYXJrZG93blRhZ3MoXG5cdFx0XHRcdFx0ZW1iZWRlZFRhZ0ZpbGUsIFxuXHRcdFx0XHRcdGVtYmVkLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKSwgXG5cdFx0XHRcdFx0c3RhcnRJbmRleCwgXG5cdFx0XHRcdFx0J25hdGl2ZS1lbWJlZCdcblx0XHRcdFx0KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRsb2dEaWZmZXJlbmNlcyh0YWdQb3NpdGlvbnM6IEFycmF5LCB0YWdFbGVtZW50czogQXJyYXkpIHtcblx0XHQvLyBFeHRyYWN0IHRhZ3MgYW5kIGlubmVyVGV4dHMgaW50byBzZXBhcmF0ZSBhcnJheXNcblxuXHRcdGNvbnN0IHRhZ3MgPSB0YWdQb3NpdGlvbnMubWFwKGl0ZW0gPT4gaXRlbS50YWcpO1xuXHRcdGNvbnN0IGlubmVyVGV4dHMxID0gdGFnRWxlbWVudHMubWFwKGl0ZW0gPT4gaXRlbS5pbm5lclRleHQpO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSBhcnJheXMgdG8gc3RvcmUgdW5pcXVlIGVsZW1lbnRzXG5cdFx0bGV0IHVuaXF1ZVRvVGFnUG9zaXRpb25zID0gW107XG5cdFx0bGV0IHVuaXF1ZVRvVGFnRWxlbWVudHMgPSBbXTtcblxuXHRcdC8vIEhlbHBlciBmdW5jdGlvbiB0byBmaW5kIHVuaXF1ZSBlbGVtZW50cyBpbiBvbmUgYXJyYXkgY29tcGFyZWQgdG8gb3RoZXJzXG5cdFx0Y29uc3QgZmluZFVuaXF1ZSA9IChhcnIxLCBhcnIyKSA9PiB7XG5cdFx0XHRyZXR1cm4gYXJyMS5maWx0ZXIoaXRlbSA9PiAhYXJyMi5pbmNsdWRlcyhpdGVtKSk7XG5cdFx0fTtcblxuXHRcdHVuaXF1ZVRvVGFnUG9zaXRpb25zID0gZmluZFVuaXF1ZSh0YWdzLCBpbm5lclRleHRzMSk7XG5cdFx0dW5pcXVlVG9UYWdFbGVtZW50cyA9IGZpbmRVbmlxdWUoaW5uZXJUZXh0czEsIHRhZ3MpO1xuXG5cdFx0Y29uc29sZS5sb2coJ2RpZmZlcmVuY2VzOicsIHVuaXF1ZVRvVGFnUG9zaXRpb25zLmxlbmd0aCwgdW5pcXVlVG9UYWdFbGVtZW50cy5sZW5ndGgpO1xuXHRcdC8vIExvZyB0aGUgZGlmZmVyZW5jZXNcblx0XHRpZiAodW5pcXVlVG9UYWdQb3NpdGlvbnMubGVuZ3RoKSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcIlVuaXF1ZSB0byB0YWdQb3NpdGlvbnMgYmFzZWQgb24gdGFnOlwiLCB1bmlxdWVUb1RhZ1Bvc2l0aW9ucyk7XG5cdFx0fVxuXHRcdGlmICh1bmlxdWVUb1RhZ0VsZW1lbnRzLmxlbmd0aCkge1xuXHRcdFx0Y29uc29sZS5sb2coXCJVbmlxdWUgdG8gdGFnRWxlbWVudHMgYmFzZWQgb24gaW5uZXJUZXh0OlwiLCB1bmlxdWVUb1RhZ0VsZW1lbnRzKTtcblx0XHR9XG5cdH1cblxufVxuXG5jbGFzcyBUZW1wQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblx0b25sb2FkKCkge31cblx0b251bmxvYWQoKSB7fVxufSIsICJpbXBvcnQgeyBBcHAsIE1hcmtkb3duUmVuZGVyZXIsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTm90aWNlLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IFRhZ1N1bW1hcnkgfSBmcm9tICcuL1RhZ1N1bW1hcnknO1xuaW1wb3J0ICogYXMgVXRpbHMgZnJvbSAnLi91dGlscyc7XG5cblxuZXhwb3J0IGNsYXNzIFJlYWRpbmdNb2RlVGFnRWRpdG9yIHtcblx0YXBwOiBBcHA7IFxuXHRwbHVnaW46IFRhZ0J1ZGR5O1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdGFwcDogQXBwLCBcblx0XHRwbHVnaW46IFRhZ0J1ZGR5KSB7XG5cblx0XHR0aGlzLmFwcCA9IGFwcDtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fVxuXG5cdC8vYXN5bmMgcmVuYW1lVGFnICh0YWcsIG5ld05hbWUsIGJhdGNoQWN0aW9uOiBzdHJpbmcgfCBudW1iZXIsIHNwZWNpZmljRmlsZTpURmlsZSA9IG51bGwpIHtcblx0YXN5bmMgcmVuYW1lVGFnICh0YWcsIG5ld05hbWUsIGJhdGNoQWN0aW9uOiBzdHJpbmcgfCBudW1iZXIsIGZpbGVQYXRoOiBzdHJpbmcgPSBudWxsLCB0YWdFbDogSFRNTEVsZW1lbnQpIHtcblx0XHRcblx0XHQvL2NvbnNvbGUubG9nIChuZXdOYW1lLCBiYXRjaEFjdGlvbiwgZmlsZVBhdGgpXG5cdFxuXHRcdC8vY29uc3QgdGFnQ29udGFpbmVyVHlwZSA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHQvL1x0J3R5cGUnXG5cdFx0Ly8pO1xuXHRcdC8vY29uc3QgaW5kZXggPSB0YWdFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0Ly9cdCdtZC1pbmRleCdcblx0XHQvLyk7XG5cdFx0Ly9jb25zdCBmaWxlUGF0aCA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHQvL1x0J2ZpbGUtc291cmNlJ1xuXHRcdC8vKTtcblx0XHRcblx0XHRjb25zdCBhY3RpdmVGaWxlOiBURmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0Y29uc3QgZmlsZTogVEZpbGUgPSBmaWxlUGF0aCA9PSBudWxsID8gYWN0aXZlRmlsZSA6IGF3YWl0IFV0aWxzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpO1xuXHRcdFxuXHRcdGlmICghZmlsZSkgcmV0dXJuO1xuXG5cdFx0Y29uc3QgZmlsZUNvbnRlbnQ6IHN0cmluZyA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0Ly9jb25zdCBmaWxlOiBURmlsZSA9IGF3YWl0IFV0aWxzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpO1xuXG5cdFx0aWYgKHR5cGVvZiBiYXRjaEFjdGlvbiA9PT0gJ251bWJlcicpIHtcblxuICAgICAgICBcdC8vY29uc3QgZmlsZTogVEZpbGUgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpXG4gICAgICAgIFx0Ly9jb25zdCBmaWxlQ29udGVudDogU3RyaW5nID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcbiAgICAgICAgXHRjb25zdCBuZXdGaWxlQ29udGVudCA9IHRoaXMucmVuYW1lVGFnSW5TdHJpbmdCeUluZGV4IChcbiAgICAgICAgXHRcdHRhZyxcbiAgICAgICAgXHRcdG5ld05hbWUsXG4gICAgICAgIFx0XHRwYXJzZUludChiYXRjaEFjdGlvbiksXG4gICAgICAgIFx0XHRmaWxlQ29udGVudFxuICAgIFx0XHQpXG4gICAgXHRcdHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdGaWxlQ29udGVudCk7XG5cbiAgICAgICAgfSBlbHNlIGlmIChiYXRjaEFjdGlvbiA9PSAnbm90ZScpIHtcblxuICAgICAgICBcdC8vY29uc3QgZmlsZTogVEZpbGUgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuICAgICAgICBcdHRoaXMucmVuYW1lVGFnc0luRmlsZUJ5SW5kZXggKFxuICAgICAgICBcdFx0dGFnLFxuICAgICAgICBcdFx0bmV3TmFtZSxcbiAgICAgICAgXHRcdGZpbGVcbiAgICBcdFx0KVxuXG4gICAgXHRcdFxuICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIGlmIChiYXRjaEFjdGlvbiA9PSAndmF1bHQnKSB7XG4gICAgICAgIFx0XG5cdCAgICBcdHRoaXMucmVuYW1lVGFnc0luVmF1bHRCeUluZGV4IChcblx0ICAgIFx0XHR0YWcsXG5cdCAgICBcdFx0bmV3TmFtZVxuXHRcdFx0KVxuXG5cdFx0XHQvL2lmIChhY3RpdmVGaWxlICE9IGZpbGUpIHtcbiAgICAgICAgXHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYucmVidWlsZFZpZXcoKVxuICAgICAgICBcdFx0Ly9uZXcgTm90aWNlICgnVGFncyBoYXZlIGJlZW4gdXBkYXRlZCBpbiBleHRlcm5hbCBub3Rlcy4gUGxlYXNlIHJlZnJlc2ggdGhpcyBzdW1tYXJ5IG9yIHJlbG9hZCB0aGlzIG5vdGUuJylcbiAgICAgICAgXHQvL31cbiAgICAgICAgICAgXG4gICAgICAgIH1cblxuICAgICAgICBpZiAoYWN0aXZlRmlsZSAhPSBmaWxlICYmIHRhZ0VsKSB7XG4gICAgICAgIFx0XHQvL3RoaXMuYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmLnJlYnVpbGRWaWV3KClcbiAgICAgICAgXHRcdG5ldyBOb3RpY2UgKCdSZWZyZXNoIHRoaXMgc3VtbWFyeSB0byBzZWUgY2hhbmdlcy4nLCA1MDAwKVxuICAgICAgICBcdC8vY29uc29sZS5sb2codGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LWJsb2NrJykpXG4gICAgICAgIFx0Ly90aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZSh0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKSk7IFxuICAgIFx0fVxuICAgICAgICBcblxuICAgIH1cblxuICAgIGFzeW5jIHJlbmFtZVRhZ3NJblZhdWx0QnlJbmRleCAodGFnLCBuZXdOYW1lKSB7XG5cbiAgICBcdGNvbnN0IHZhbGlkVGFncyA9IFt0YWddXG5cdFx0bGV0IGxpc3RGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcblxuXHRcdGxpc3RGaWxlcyA9IGxpc3RGaWxlcy5maWx0ZXIoKGZpbGUpID0+IHtcblx0XHRcdC8vIFJlbW92ZSBmaWxlcyB0aGF0IGRvIG5vdCBjb250YWluIHRoZSB0YWdzIHNlbGVjdGVkIGJ5IHRoZSB1c2VyXG5cdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0Y29uc3QgdGFnc0luRmlsZSA9IGdldEFsbFRhZ3MoY2FjaGUpO1xuXG5cdFx0XHRpZiAodmFsaWRUYWdzLnNvbWUoKHZhbHVlKSA9PiB0YWdzSW5GaWxlPy5pbmNsdWRlcyh2YWx1ZSkpKSB7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICBsZXQgbGlzdENvbnRlbnRzOiBbVEZpbGUsIHN0cmluZ11bXSA9IGF3YWl0IHRoaXMucGx1Z2luLnRhZ1N1bW1hcnkucmVhZEZpbGVzKGxpc3RGaWxlcyk7XG4gICAgICAgIC8vIGxpc3RDb250ZW50c1tuXVswXSBpcyB0aGUgZmlsZSwgbGlzdENvbnRlbnRzW25dW1sxXSBpcyB0aGUgZmlsZSBjb250ZW50XG4gICAgICAgIFxuICAgICAgICBsaXN0Q29udGVudHMuZm9yRWFjaChhc3luYyAobm90ZSkgPT4ge1xuICAgICAgICBcdC8vdGhpcy5yZW5hbWVUYWdJbkZpbGUgKHRhZywgbmV3TmFtZSwgbm90ZVswXSk7XG4gICAgICAgIFx0dGhpcy5yZW5hbWVUYWdzSW5GaWxlQnlJbmRleCAoXG4gICAgICAgIFx0XHR0YWcsXG4gICAgICAgIFx0XHRuZXdOYW1lLFxuICAgICAgICBcdFx0bm90ZVswXVxuXHRcdFx0KVxuXG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG4gICAgYXN5bmMgcmVuYW1lVGFnc0luRmlsZUJ5SW5kZXggKFxuICAgIFx0dGFnOiBTdHJpbmcsIFxuICAgIFx0bmV3TmFtZTogU3RyaW5nLCBcbiAgICBcdGZpbGU6IFRGaWxlXG5cdCk6Vm9pZCB7XG5cbiAgICBcdGNvbnN0IGZpbGVDb250ZW50OiBTdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuICAgICAgICBsZXQgbmV3RmlsZUNvbnRlbnQ6IFN0cmluZyA9IGZpbGVDb250ZW50O1xuICAgIFx0Y29uc3QgdGFnUG9zaXRpb25zID0gdGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLmdldE1hcmtkb3duVGFncyAoZmlsZSwgZmlsZUNvbnRlbnQpO1xuICAgIFx0Ly8ge3RhZzp0YWcsIGluZGV4Om1hdGNoLmluZGV4LCBzb3VyY2U6ZmlsZS5uYW1lfVxuXG4gICAgXHRsZXQgZmlsdGVyZWRUYWdPYmpzID0gdGFnUG9zaXRpb25zLmZpbHRlcih0YWdPYmogPT4gdGFnT2JqLnRhZyA9PT0gdGFnKTtcblxuICAgIFx0aWYgKGZpbHRlcmVkVGFnT2Jqcy5sZW5ndGggPiAwKSB7XG5cbiAgICBcdFx0ZmlsdGVyZWRUYWdPYmpzLnNvcnQoKGEsIGIpID0+IGEuaW5kZXggLSBiLmluZGV4KTtcbiAgICBcdFx0bGV0IG9mZnNldCA9IDA7XG5cdFx0ICAgIGZpbHRlcmVkVGFnT2Jqcy5mb3JFYWNoKHRhZ09iaiA9PiB7XG5cdFx0ICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIG5ldyBpbmRleCBjb25zaWRlcmluZyB0aGUgb2Zmc2V0XG5cdFx0ICAgICAgICBjb25zdCBuZXdJbmRleDogTnVtYmVyID0gdGFnT2JqLmluZGV4ICsgb2Zmc2V0O1xuXHRcdCAgICAgICAgLy8gUmVwbGFjZSB0aGUgdGFnIGF0IHRoZSBjb3JyZWN0IHBvc2l0aW9uXG5cdFx0ICAgICAgICBuZXdGaWxlQ29udGVudCA9IG5ld0ZpbGVDb250ZW50LnN1YnN0cmluZygwLCBuZXdJbmRleCkgKyBuZXdOYW1lICsgbmV3RmlsZUNvbnRlbnQuc3Vic3RyaW5nKG5ld0luZGV4ICsgdGFnT2JqLnRhZy5sZW5ndGgpO1xuXHRcdCAgICAgICAgLy9uZXdGaWxlQ29udGVudCA9IHRoaXMucmVuYW1lVGFnSW5TdHJpbmdCeUluZGV4ICh0YWcsIG5ld05hbWUsIG5ld0luZGV4LCBmaWxlQ29udGVudClcblx0XHQgICAgICAgIC8vIFVwZGF0ZSB0aGUgb2Zmc2V0IGZvciB0aGUgbmV4dCBpdGVyYXRpb25cblx0XHQgICAgICAgIG9mZnNldCArPSBuZXdOYW1lLmxlbmd0aCAtIHRhZ09iai50YWcubGVuZ3RoO1xuXHRcdCAgICB9KTtcblxuICAgIFx0XHR0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3RmlsZUNvbnRlbnQpO1xuXG4gICAgXHR9IGVsc2Uge1xuICAgIFx0XHQvL25ldyBOb3RpY2UgKCdObyB0YWdzIHRvIHJlbmFtZS4nKVxuICAgIFx0fVxuICAgIH1cblxuICAgIHJlbmFtZVRhZ0luU3RyaW5nQnlJbmRleCAoXG4gICAgXHR0YWc6IFN0cmluZywgXG4gICAgXHRuZXdOYW1lOiBTdHJpbmcsIFxuICAgIFx0aW5kZXg6IE51bWJlcixcbiAgICBcdGZpbGVDb250ZW50OiBTdHJpbmdcblx0KTpTdHJpbmcge1xuICAgIFx0Ly9jb25zb2xlLmxvZyhmaWxlQ29udGVudClcbiAgICBcdGNvbnN0IG5ld0NvbnRlbnQ6IFN0cmluZyA9IGZpbGVDb250ZW50LnN1YnN0cmluZyAoMCwgcGFyc2VJbnQoaW5kZXgpKSArIG5ld05hbWUgKyBmaWxlQ29udGVudC5zdWJzdHJpbmcoKHBhcnNlSW50KGluZGV4KSArIHBhcnNlSW50KHRhZy5sZW5ndGgpKSlcbiAgICBcdC8vY29uc29sZS5sb2cobmV3Q29udGVudClcbiAgICBcdC8vY29uc29sZS5sb2coaW5kZXggKyB0YWcubGVuZ3RoKVxuICAgIFx0cmV0dXJuIChuZXdDb250ZW50KTtcbiAgICBcdC8vdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0ZpbGVDb250ZW50KTtcblxuICAgIH1cblxuXG5cdGFzeW5jIGFkZCAoXG5cdFx0dGFnOiBzdHJpbmcsIFxuXHRcdHg6IG51bWJlciwgXG5cdFx0eTogbnVtYmVyLy8sXG5cdFx0Ly9tb2JpbGVPYmo6IE9iamVjdFxuXHQpOnZvaWQge1xuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpIHsgY29uc29sZS5sb2coJ1RhZyBCdWRkeSBhZGQgJyArIHRhZyArICcgYXQgKCcgKyB4ICsgJywgJyArIHkgKyAnKScpOyB9XG5cblx0XHRsZXQgZmlsZUNvbnRlbnQ6IHN0cmluZztcblx0XHRsZXQgZmlsZTogVEZpbGU7XG5cdFx0Y29uc3QgY2xpY2tlZFRleHRPYmogPSBVdGlscy5nZXRDbGlja2VkVGV4dE9iakZyb21Eb2MoeCwgeSk7XG5cdFx0Y29uc3QgY2xpY2tlZFRleHQ6IHN0cmluZyA9IGNsaWNrZWRUZXh0T2JqPy50ZXh0O1xuXHRcdGNvbnN0IGNsaWNrZWRUZXh0SW5kZXg6bnVtYmVyID0gY2xpY2tlZFRleHRPYmo/LmluZGV4OyAvLyB0aGlzIGlzIHRoZSBpbmRleCBpbiBkb2N1bWVudCwgZm9yIG5hcnJvd2luZyBkb3duIHRvIHRoZSBjbGlja2VkIHdvcmQuXG5cdFx0Y29uc3QgY2xpY2tlZFRleHRFbDogSFRNTEVsZW1lbnQgPSBjbGlja2VkVGV4dE9iaj8uZWw7XG5cdFx0bGV0IGNvbnRlbnRTb3VyY2VUeXBlOiBzdHJpbmcgPSBudWxsXG5cdFx0bGV0IHN1bW1hcnlFbDogSFRNTEVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cdFx0bGV0IGVtYmVkRWw6IEhUTUxFbGVtZW50ID0gdW5kZWZpbmVkO1xuXG4vL2NvbnNvbGUubG9nKGNsaWNrZWRUZXh0T2JqKVx0XHRcblx0XHRpZiAoY2xpY2tlZFRleHRPYmopIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdHN1bW1hcnlFbCA9IGNsaWNrZWRUZXh0RWw/LmNsb3Nlc3QoJy50YWctc3VtbWFyeS1wYXJhZ3JhcGgnKTtcblx0XHRcdFx0ZW1iZWRFbCA9IGNsaWNrZWRUZXh0RWw/LmNsb3Nlc3QoJy5tYXJrZG93bi1lbWJlZCcpO1xuXHRcdFx0fSBjYXRjaCB7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzdW1tYXJ5RWwpIHtcbi8vY29uc29sZS5sb2coJ2lzIHN1bW1hcnknKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgdGhpcy5wbHVnaW4udGFnU3VtbWFyeS5nZXRGaWxlKHN1bW1hcnlFbCk7XG5cdFx0XHRcdGZpbGVDb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29udGVudFNvdXJjZVR5cGUgPSAncGx1Z2luLXN1bW1hcnknO1xuXHRcdFx0XHRcblx0XHRcdH0gZWxzZSBpZiAoZW1iZWRFbCkge1xuLy9jb25zb2xlLmxvZygnaXMgZW1iZWQnKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgVXRpbHMuZ2V0RW1iZWRGaWxlKGVtYmVkRWwpO1xuXHRcdFx0XHRmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGNvbnRlbnRTb3VyY2VUeXBlID0gJ25hdGl2ZS1lbWJlZCc7XG5cblx0XHRcdH0gZWxzZSB7IFxuLy9jb25zb2xlLmxvZygnaXMgYWN0aXZlIGZpbGUnKVxuXHRcdFx0XHRmaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRjb250ZW50U291cmNlVHlwZSA9ICdhY3RpdmUnO1xuXHRcdFx0fSBcblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCB0ZXh0IHBvc2l0aW9uIG9yIGFyZWEgdG9vIGJ1c3kuXFxuVHJ5IGEgYW5vdGhlciB0ZXh0IGFyZWEuJyk7XG5cdFx0ICAgIHJldHVybjtcblx0XHR9XG5cblxuXHRcdGlmIChjbGlja2VkVGV4dCkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoY2xpY2tlZFRleHQpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgYWRkIHRhZy5cXG5UcnkgYSBkaWZmZXJlbnQgdGV4dCBhcmVhLicpXG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgZXNjYXBlZENsaWNrZWRUZXh0ID0gVXRpbHMuZXNjYXBlUmVnRXhwKGNsaWNrZWRUZXh0KTtcblx0XHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlZENsaWNrZWRUZXh0LCBcImdcIik7ICBcblx0XHRjb25zdCBtYXRjaGVzID0gZmlsZUNvbnRlbnQubWF0Y2gocmVnZXgpO1xuXG5cdFx0aWYgKG1hdGNoZXMgJiYgbWF0Y2hlcy5sZW5ndGggPiAxKSB7XG5cdFx0ICAgIG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBhZGQgdGFnOiBDbGlja2VkIHRleHQgcmVwZWF0ZWQgaW4gbm90ZS4gVHJ5IGEgYW5vdGhlciB0ZXh0IGJsb2NrLicpO1xuXHRcdCAgICByZXR1cm47XG5cblx0XHR9IGVsc2UgaWYgKChtYXRjaGVzICYmIG1hdGNoZXMubGVuZ3RoID09PSAwKSB8fCAhbWF0Y2hlcykge1xuXHRcdFx0bmV3IE5vdGljZSAoJ1x1MjZBMFx1RkUwRiBDYW5cXCd0IGZpbmQgdGV4dCBwb3NpdGlvbiBvciBhcmVhIHRvbyBidXN5LlxcblRyeSBhIGFub3RoZXIgdGV4dCBhcmVhLicpO1xuXHRcdCAgICByZXR1cm47XG5cdFx0fSBcblxuXHRcdGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MubG9ja1JlY2VudFRhZ3MpIHRoaXMucGx1Z2luLnNhdmVSZWNlbnRUYWcodGFnKTsgXG5cdFx0XG5cdFx0Y29uc3Qgc3RhcnRJbmRleCA9IHJlZ2V4LmV4ZWMoZmlsZUNvbnRlbnQpLmluZGV4OyAvLyB0aGlzIGlzIHRoZSBpbmRleCBpbiB0aGUgbWQgc291cmNlXG5cdFx0Y29uc3QgZW5kSW5kZXggPSBzdGFydEluZGV4ICsgY2xpY2tlZFRleHQubGVuZ3RoOyAvLyB1c2UgdGhpcyB0byBhZGQgdGFnIGF0IGVuZCBvZiBibG9ja1xuXG5cdFx0Y29uc3QgY2xpY2tlZFdvcmRPYmogPSBVdGlscy5nZXRXb3JkT2JqRnJvbVN0cmluZyAoY2xpY2tlZFRleHQsIGNsaWNrZWRUZXh0SW5kZXgpO1xuXHRcdGNvbnN0IGNsaWNrZWRXb3JkID0gY2xpY2tlZFdvcmRPYmoudGV4dDtcblx0XHRjb25zdCBjbGlja2VkV29yZEluZGV4ID0gY2xpY2tlZFdvcmRPYmouaW5kZXg7XG5cdFx0bGV0IG5ld0NvbnRlbnQ7XG5cblx0XHRpZiAoY2xpY2tlZFdvcmQpIHtcblx0XHRcdGlmIChVdGlscy5pc1dvcmROZWFyRW5kKGNsaWNrZWRUZXh0LCBjbGlja2VkV29yZCkpIFxuXHRcdFx0XHRuZXdDb250ZW50ID0gVXRpbHMuaW5zZXJ0VGV4dEluU3RyaW5nKCcgJyArIHRhZywgZmlsZUNvbnRlbnQsIGVuZEluZGV4KTtcblx0XHRcdGVsc2Vcblx0XHRcdFx0bmV3Q29udGVudCA9IFV0aWxzLmluc2VydFRleHRJblN0cmluZyh0YWcsIGZpbGVDb250ZW50LCBzdGFydEluZGV4K2NsaWNrZWRXb3JkSW5kZXgpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCBjbGlja2VkIHdvcmQuXFxuUGxlYXNlIHRyeSBhZ2Fpbi4nKTtcblx0XHQgICAgcmV0dXJuO1xuXHRcdH1cblx0XHRcblx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG5cblx0XHRpZiAoY29udGVudFNvdXJjZVR5cGUgPT0gJ3BsdWdpbi1zdW1tYXJ5Jykge1xuXHRcdFx0Y29uc3Qgc3VtbWFyeUNvbnRhaW5lciA9IHN1bW1hcnlFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktYmxvY2snKVxuXHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUoc3VtbWFyeUNvbnRhaW5lcik7IFxuXHRcdH0gZWxzZSBpZiAoY29udGVudFNvdXJjZVR5cGUgPT0gJ25hdGl2ZS1lbWJlZCcpIHtcblx0XHRcdC8vY29uc29sZS5sb2coJ2FkZGVkIHRvIG5hdGl2ZSBlbWJlZDonLCBlbWJlZEVsKVxuXHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHR0aGlzLnBsdWdpbi50YWdQcm9jZXNzb3IucHJvY2Vzc05hdGl2ZUVtYmVkKGVtYmVkRWwsIHRydWUpO1xuXHRcdFx0fSwgMjAwKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBlZGl0IChcblx0XHR0YWdFbDogSFRNTEVsZW1lbnQsIFxuXHRcdGV2ZW50OiBFdmVudCwgXG5cdFx0cHJhZ3JhcGhFbDogSFRNTEVsZW1lbnQsXG5cdFx0ZWRpdFR5cGU6IFN0cmluZyxcblx0XHRuZXdOYW1lOiBTdHJpbmdcblx0KTp2b2lkIHtcbi8vY29uc29sZS5sb2codGFnRWwpXG5cdFx0bGV0IHRhZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cdFx0Y29uc3QgdGFnQ29udGFpbmVyVHlwZSA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHRcdCd0eXBlJ1xuXHRcdCk7XG5cdFx0Y29uc3QgaW5kZXggPSB0YWdFbC5nZXRBdHRyaWJ1dGUoXG5cdFx0XHQnbWQtaW5kZXgnXG5cdFx0KTtcblx0XHRjb25zdCBmaWxlUGF0aCA9IHRhZ0VsLmdldEF0dHJpYnV0ZShcblx0XHRcdCdmaWxlLXNvdXJjZSdcblx0XHQpO1xuXG5cdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlYnVnTW9kZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1RhZyBCdWRkeSBlZGl0IHRhZzogJyArIHRhZ0VsLmlubmVyVGV4dCBcblx0XHRcdFx0KyAnXFxuSW4gZmlsZTogJyArIGZpbGVQYXRoKTtcblx0XHR9XG5cblx0XHRpZiAodGFnQ29udGFpbmVyVHlwZSA9PSAnbmF0aXZlLWVtYmVkJykgdGFnQ29udGFpbmVyID0gdGFnRWwuY2xvc2VzdCgnLm1hcmtkb3duLWVtYmVkJyk7XG5cdFx0ZWxzZSBpZiAodGFnQ29udGFpbmVyVHlwZSA9PSAncGx1Z2luLXN1bW1hcnknKSB0YWdDb250YWluZXIgPSB0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktcGFyYWdyYXBoJyk7XG5cdFx0ZWxzZSB0YWdDb250YWluZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcubWFya2Rvd24tcmVhZGluZy12aWV3Jyk7XG5cdFx0XG5cdFx0aWYgKGZpbGVQYXRoKSB7XG4gXG5cdFx0XHRjb25zdCBmaWxlOiBURmlsZSA9IGF3YWl0IFV0aWxzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0bGV0IGZpbGVDb250ZW50OiBTdHJpbmc7XG5cdFx0XHRsZXQgZmlsZUNvbnRlbnRCYWNrdXA6IFN0cmluZztcblx0XHRcdGNvbnN0IHRhZzogc3RyaW5nID0gdGFnRWwuaW5uZXJUZXh0LnRyaW0oKTtcblxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRmaWxlQ29udGVudEJhY2t1cCA9IGZpbGVDb250ZW50O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHkgZmlsZSByZWFkIGVycm9yOlxcbicgKyBlcnJvci5tZXNzYWdlKTtcblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIGNoZWNrIGlmIHRoZSBmaWxlIGhhcyBvbmx5IG9uZSB0YWcgbGVmdCAoYW5kIHRoYXQncyBhbGwgdGhhdHMgbGVmdCBpbiB0aGUgZmlsZSlcblx0XHRcdGxldCBzYWZlVG9FbXB0eUZpbGUgPSBmYWxzZTtcblx0XHRcdGNvbnN0IHRhZ1JlZ2V4ID0gL15cXHMqIyhcXHcrKVxccyokLztcblx0XHRcdGlmICh0YWdSZWdleC50ZXN0KGZpbGVDb250ZW50LnRyaW0oKSkpIHtcblx0XHQgICAgXHRzYWZlVG9FbXB0eUZpbGUgPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRsZXQgYmVmb3JlVGFnID0gZmlsZUNvbnRlbnQuc3Vic3RyaW5nKDAsIGluZGV4KTtcblx0XHRcdC8vbGV0IGFmdGVyVGFnID0gZmlsZUNvbnRlbnQuc3Vic3RyaW5nKChOdW1iZXIoaW5kZXgpK051bWJlcih0YWcubGVuZ3RoKSsxKSk7XG5cdFx0XHRsZXQgYWZ0ZXJUYWcgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoXG5cdFx0XHRcdE51bWJlcihpbmRleCkgKyBOdW1iZXIodGFnLmxlbmd0aClcblx0XHRcdCk7XG5cblx0XHRcdC8vY29uc29sZS5sb2cgKEpTT04uc3RyaW5naWZ5KGJlZm9yZVRhZykpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoSlNPTi5zdHJpbmdpZnkodGFnKSk7XG5cdFx0XHQvL2NvbnNvbGUubG9nIChKU09OLnN0cmluZ2lmeShhZnRlclRhZykpO1xuXG5cdFx0XHRsZXQgYWZ0ZXJUYWdDaHIgPSAnJztcblx0XHRcdFxuXHRcdFx0XG5cdFx0XHQvLyBDYW4ndCByZW1lbWJlciB3aHkgSSBoYXZlIHRoaXMuLi5cblx0XHRcdC8vIG5lZWQgdG8gcmVmYWN0b3IgYWxsIHRoaXMgbGluZSBicmVhayBzcGFjZSBzdHVmZlxuXHRcdFx0aWYgKGZpbGVDb250ZW50W2luZGV4XSA9PT0gJ1xcbicpIGJlZm9yZVRhZyArPSAnXFxuJztcblx0XHRcdGxldCBuZXdDb250ZW50ID0gJyc7XG5cblx0XHRcdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XHRcdC8vIFRPLURPOiBSRUZBQ1RPUlxuXHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5cdFx0XHRpZiAoZWRpdFR5cGUgPT0gJ3JlbmFtZScpIHsgLy8gdGhpcyBvbmx5IGhhcHBlbnMgZnJvbSBlZGl0IG1vZGFsXG5cblx0XHRcdFx0Ly9uZXdDb250ZW50ID0gdGhpcy5yZW5hbWVUYWdJblN0cmluZ0J5SW5kZXggKCcjJyt0YWcsIG5ld05hbWUsIGluZGV4LCBmaWxlQ29udGVudCk7XG5cblx0XHRcdH0gZWxzZSBpZiAoIWV2ZW50KSB7IC8vIHRoZW4gd2UncmUgY2FsbGluZyB0aGlzIG1ldGhvZCBmcm9tIGEgYnV0dG9uLiBuZWVkIHRvIHJldGhpbmsgaG93IHRoaXMgaXMgb3JnYW5pemVkLlxuXHRcdFx0XHRcblx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArIGFmdGVyVGFnQ2hyICsgYWZ0ZXJUYWc7XG5cblx0XHRcdH0gZWxzZSBpZiAoZWRpdFR5cGUgPT0gJ2hhc2gnKSB7IFxuXHRcdFx0XHQvLyBSZW1vdmUgdGhlIGhhc2ggb25seVxuXHRcdFx0XHRjb25zdCBub0hhc2ggPSB0YWcuc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHQvL25ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyAoIWJlZm9yZVRhZy5lbmRzV2l0aCgnICcpPycgJzonJykgKyBub0hhc2ggKyBhZnRlclRhZztcblx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArIG5vSGFzaCArIGFmdGVyVGFnQ2hyICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUgJiYgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcykgXG5cdFx0XHRcdFx0eyBuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiAnICsgdGFnICsgJyBjb252ZXJ0ZWQgdG8gdGV4dC4nKTsgfVxuXHRcdFx0XG5cdFx0XHQvKn0gZWxzZSBpZiAoKChldmVudC50eXBlID09ICd0b3VjaGVuZCcpIFxuXHRcdFx0XHR8fCB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2gpIFxuXHRcdFx0XHRcdHx8IChVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSAmJiAhdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlT25DbGljaykgXG5cdFx0XHRcdFx0fHwgKCFVdGlscy5jdHJsQ21kS2V5KGV2ZW50KSAmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKVxuXHRcdFx0XHQpIFxuXHRcdFx0eyovXG5cdFx0XHR9IGVsc2UgaWYgKCgoZXZlbnQudHlwZSA9PSAndG91Y2hlbmQnKSBcblx0XHRcdFx0fHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlVGFnU2VhcmNoKSAvLyBkb24ndCBuZWVkIHRoaXMgY2hlY2sgYW55IG1vcmUuIFxuXHRcdFx0XHRcdHx8IChlZGl0VHlwZSA9PSAncmVtb3ZlJykgXG5cdFx0XHRcdCkgXG5cdFx0XHR7XG5cblx0XHRcdFx0Ly8gUmVtb3ZlIHRhZyAob3IgY2hpbGQgZmlyc3QsIGlmIGV4aXN0cylcblx0XHRcdFx0bGV0IHBhcmVudFRhZyA9ICcnO1xuXG5cdFx0XHRcdGlmICh0YWcuaW5jbHVkZXMoJy8nKSBcblxuXHRcdFx0XHRcdC8vJiYgKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZUNoaWxkVGFnc0ZpcnN0IFxuXHRcdFx0XHRcdC8vfHwgKGV2ZW50LnNoaWZ0S2V5IFxuXHRcdFx0XHRcdFx0Ly8mJiAhdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QpXG5cdFx0XHRcdFx0KVxuXHRcdFx0XHRcdCBcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGxldCBwYXJ0cyA9IHRhZy5zcGxpdCgnLycpO1xuXHRcdFx0XHRcdGNvbnN0IHJlbW92ZWRDaGlsZCA9IHBhcnRzLnBvcCgpO1xuXHRcdFx0XHRcdHBhcmVudFRhZyA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnIFxuXHRcdFx0XHRcdFx0KyBwYXJlbnRUYWcgXG5cdFx0XHRcdFx0XHQrIGFmdGVyVGFnQ2hyIFxuXHRcdFx0XHRcdFx0KyBhZnRlclRhZztcblxuXHRcdFx0XHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSBcblx0XHRcdFx0XHRcdCYmIHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpIFxuXHRcdFx0XHRcdHsgXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiBcXCcnIFxuXHRcdFx0XHRcdFx0XHQrIHJlbW92ZWRDaGlsZCBcblx0XHRcdFx0XHRcdFx0KyAnXFwnIHJlbW92ZWQgZnJvbSBwYXJlbnQgdGFnLicpOyBcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIHJlbW92ZSBleHRyYSBzcGFjZVxuXHRcdFx0XHRcdFxuLy9jb25zb2xlLmxvZyAoJz4nICsgYmVmb3JlVGFnLnN1YnN0cmluZyhiZWZvcmVUYWcubGVuZ3RoLTEpICsgYWZ0ZXJUYWcuc3Vic3RyaW5nKDAsMSkgKyAnPCcpXG5cdFx0XHRcdFx0LyppZiAoYmVmb3JlVGFnLnN1YnN0cmluZyhiZWZvcmVUYWcubGVuZ3RoLTEpID09ICcgJyAmJiBhZnRlclRhZy5zdWJzdHJpbmcoMCwxKSA9PSAnICcpIHtcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZy5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZztcblx0XHRcdFx0XHR9Ki9cblxuXHRcdFx0XHRcdGNvbnN0IHN0YXJ0c1dpdGhQdW5jdHVhdGlvbiA9IC9eWy4sITo/O10vLnRlc3QoYWZ0ZXJUYWcudHJpbVN0YXJ0KClbMF0pO1xuLy9jb25zb2xlLmxvZygnPicrYWZ0ZXJUYWcudHJpbVN0YXJ0KClbMF0rJzwnKVxuXHRcdFx0XHRcdGlmIChiZWZvcmVUYWcuZW5kc1dpdGgoJyAnKSAmJiBhZnRlclRhZy5zdGFydHNXaXRoKCcgJykpIHtcblx0XHRcdFx0ICAgICAgICBuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgYWZ0ZXJUYWcuc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHQgICAgfSBlbHNlIGlmIChzdGFydHNXaXRoUHVuY3R1YXRpb24pIHtcblx0XHRcdFx0ICAgIFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZy50cmltRW5kKCkgKyBhZnRlclRhZy50cmltU3RhcnQoKTtcblx0XHRcdFx0ICAgIH0gZWxzZSB7XG5cdFx0XHRcdCAgICAgICAgLy8gSWYgdGhlcmUncyBubyBsZWFkaW5nIHNwYWNlIGluIGFmdGVyVGFnIG9yIHNwZWNpYWwgaGFuZGxpbmcgZm9yIHB1bmN0dWF0aW9uIGlzbid0IG5lZWRlZCwgY29uY2F0ZW5hdGUgZGlyZWN0bHlcblx0XHRcdFx0ICAgICAgICBuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdCAgICB9XG5cblx0XHRcdFx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUgXG5cdFx0XHRcdFx0XHQmJiB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKSB7IFxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZSAoJ1RhZyBCdWRkeTogJyArIHRhZyArICcgcmVtb3ZlZC4nKTsgXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IFxuXHRcdFx0XG5cdFx0XHRpZiAodGFnRWwuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT0gJ3BsdWdpbi1zdW1tYXJ5Jykge1xuXHRcdFx0Ly8gY2FuIHdlIGJlIHVzaW5nIHRhZ0NvbnRhaW5lclR5cGUgZnJvbSBhYm92ZT9cblxuXHRcdFx0XHQvLyBTYWZldHkgY2hlY2sgMVxuXHRcdFx0XHRjb25zdCBzdW1tYXJ5RWwgPSB0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktcGFyYWdyYXBoJyk7XG5cdFx0XHRcdGNvbnN0IG1kU291cmNlID0gc3VtbWFyeUVsLmdldEF0dHJpYnV0ZSgnbWQtc291cmNlJykudHJpbSgpO1xuXHRcdFx0XHRcblx0XHRcdFx0Y29uc3QgZXNjYXBlZFRleHQgPSBVdGlscy5lc2NhcGVSZWdFeHAobWRTb3VyY2UpO1xuXHRcdFx0XHRjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoZXNjYXBlZFRleHQsICdnJyk7XG5cdFx0XHRcdGNvbnN0IG1hdGNoZXMgPSBmaWxlQ29udGVudC5tYXRjaChyZWdleCk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA+IDEpIHtcblx0XHRcdFx0ICAgIG5ldyBOb3RpY2UgKCdcdTI2QTBcdUZFMEYgQ2FuXFwndCBzYWZlbHkgcmVtb3ZlL2VkaXQgdGFnOlxcblN1cnJvdW5kaW5nIHRleHQgcmVwZWF0ZWQgaW4gc291cmNlIG5vdGUuJyk7XG5cdFx0XHRcdCAgICByZXR1cm47XG5cblx0XHRcdFx0fSBlbHNlIGlmICgobWF0Y2hlcyAmJiBtYXRjaGVzLmxlbmd0aCA9PT0gMCkgfHwgIW1hdGNoZXMpIHtcblx0XHRcdFx0XHRuZXcgTm90aWNlICgnXHUyNkEwXHVGRTBGIENhblxcJ3QgZmluZCB0YWcgaW4gc291cmNlIG5vdGUuXFxuJyk7XG5cdFx0XHRcdCAgICByZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBTYWZldHkgY2hlY2sgMlxuXHRcdFx0XHRpZiAoKG5ld0NvbnRlbnQgPT0gJycgJiYgIXNhZmVUb0VtcHR5RmlsZSkgXG5cdFx0XHRcdFx0fHwgVXRpbHMuY29udGVudENoYW5nZWRUb29NdWNoKFxuXHRcdFx0XHRcdFx0ZmlsZUNvbnRlbnRCYWNrdXAsIFxuXHRcdFx0XHRcdFx0bmV3Q29udGVudCwgXG5cdFx0XHRcdFx0XHR0YWcsIFxuXHRcdFx0XHRcdFx0Milcblx0XHRcdFx0XHQpIFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBGaWxlIGNoYW5nZSBlcnJvci4nKTtcblx0XHRcdFx0XHRuZXdDb250ZW50ID0gZmlsZUNvbnRlbnRCYWNrdXA7XG5cblx0XHRcdFx0fSBlbHNlIGlmIChuZXdDb250ZW50ID09ICcnICYmIHNhZmVUb0VtcHR5RmlsZSkge1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogVGFnIHJlbW92ZWQuIFRoZSBub3RlIGlzIGVtcHR5LicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc3QgdGFnUGFyYWdyYXBoRWwgPSB0YWdFbC5jbG9zZXN0KCcudGFnLXN1bW1hcnktcGFyYWdyYXBoJyk7XG5cdFx0XHRcdFx0Y29uc3QgdGFnU3VtbWFyeUJsb2NrID0gdGFnRWwuY2xvc2VzdCgnLnRhZy1zdW1tYXJ5LWJsb2NrJyk7XG5cdFx0XHRcdFx0Y29uc3QgdGFnc1RvQ2hlY2sgPSBUYWdTdW1tYXJ5LmdldFRhZ3NUb0NoZWNrRnJvbUVsKHRhZ1N1bW1hcnlCbG9jayk7XG5cdFx0XHRcdFx0Y29uc3QgdGFnc0luQ29udGVudCA9IFV0aWxzLnRhZ3NJblN0cmluZyh0YWdQYXJhZ3JhcGhFbC5pbm5lclRleHQpO1xuXG5cdFx0XHRcdFx0aWYgKHRhZ3NUb0NoZWNrLmluY2x1ZGVzKHRhZykpIHtcblx0XHRcdFx0XHRcdGNvbnN0IHRhZ0NvdW50ID0gVXRpbHMuY291bnRPY2N1cnJlbmNlcyh0YWdzVG9DaGVjaywgdGFnc0luQ29udGVudClcblx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0aWYgKHRhZ0NvdW50ID49IDIpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4udGFnU3VtbWFyeS51cGRhdGUodGFnU3VtbWFyeUJsb2NrKTsgXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCdsYXN0IG9uZSwgd2lsbCByZW1vdmUgcGFyYWdyYXBoJylcblx0XHRcdFx0XHRcdFx0Y29uc3Qgbm90aWNlID0gbmV3IE5vdGljZSAodGFnICsgJyByZW1vdmVkIGZyb20gcGFyYWdyYXBoLlxcblx1RDgzRFx1REQxNyBPcGVuIHNvdXJjZSBub3RlLicsIDUwMDApO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZ3VpLnJlbW92ZUVsZW1lbnRXaXRoQW5pbWF0aW9uKFxuXHRcdFx0XHRcdFx0XHRcdHRhZ1BhcmFncmFwaEVsLCBcblx0XHRcdFx0XHRcdFx0XHQoKSA9PiB7XG5cdFx0XHQgICAgXHRcdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdCAgICBcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZSh0YWdTdW1tYXJ5QmxvY2spOyBcblx0XHRcdCAgICBcdFx0XHRcdFx0XHR0YWdQYXJhZ3JhcGhFbC5yZW1vdmUoKTsgXG5cdFx0ICAgIFx0XHRcdFx0XHRcdH0sIDUwMCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdFx0XHRcdFx0XHRcdFx0bm90aWNlLm5vdGljZUVsLCBcblx0XHRcdFx0XHRcdFx0XHQnY2xpY2snLCBcblx0XHRcdFx0XHRcdFx0XHQoZTogRXZlbnQpID0+IHtcblx0XHRcdFx0XHRcdCBcdCBcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChmaWxlUGF0aCwgJycpO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi50YWdTdW1tYXJ5LnVwZGF0ZSh0YWdTdW1tYXJ5QmxvY2spOyBcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0sIDIwMCk7XG5cblx0XHRcdH0gZWxzZSBpZiAodGFnRWwuZ2V0QXR0cmlidXRlKCd0eXBlJykgPT0gJ25hdGl2ZS1lbWJlZCcpIHtcblxuXHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgXG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLnByb2Nlc3NOYXRpdmVFbWJlZCh0YWdDb250YWluZXIsIHRydWUpO1xuXHRcdFx0XHR9LCAyMDApXG5cblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblxuIFx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXG5cdFx0XHRcdHRyeSB7XG5cblx0XHRcdFx0XHRjb25zdCBiYWNrdXBGaWxlTmFtZSA9IFN0cmluZyhmaWxlLm5hbWUuc3Vic3RyaW5nKDAsIGZpbGUubmFtZS5pbmRleE9mKCcubWQnKSkgKyAnIEJBQ0tVUC5tZCcpO1xuXHRcdFx0XHRcdHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShiYWNrdXBGaWxlTmFtZSwgZmlsZUNvbnRlbnRCYWNrdXApO1xuXG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIFRhZy9ub3RlIGVkaXRpbmcgZXJyb3I6ICcgKyBlcnJvci5tZXNzYWdlICsgJ1xcbicgKyBiYWNrdXBGaWxlTmFtZSArICcgc2F2ZWQgdG8gdmF1bHQgcm9vdC4nLCAxMDAwMCk7XG5cdFx0XHRcdFxuXHRcdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXG5cdFx0XHRcdFx0bmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZmlsZUNvbnRlbnRCYWNrdXApO1xuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1x1MjZBMFx1RkUwRiBUYWcvbm90ZSBlZGl0aW5nIGVycm9yOiAnICsgZXJyb3IubWVzc2FnZSArICdcXG5Ob3RlIGNvbnRlbnQgY29waWVkIHRvIGNsaXBib2FyZC4nLCAxMDAwMCk7XG5cblx0XHRcdFx0fVxuXHRcdFx0fSBcblxuXHRcdFx0dGhpcy5wbHVnaW4udGFnUHJvY2Vzc29yLmRlYm91bmNlZFByb2Nlc3NBY3RpdmVGaWxlVGFnRWxzKCk7XG5cblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZSgnXHUyNkEwXHVGRTBGIENhblxcJ3QgaWRlbnRpZnkgdGFnIGxvY2F0aW9uLiBQbGVhc2UgdHJ5IGFnYWluLicpO1xuXHRcdH1cblx0fVxuXG59IiwgImltcG9ydCBUYWdCdWRkeSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBQbHVnaW4gfSBmcm9tICdvYnNpZGlhbic7XG5cblxuZXhwb3J0IGNsYXNzIERvdWJsZVRhcEhhbmRsZXIge1xuXHRcblx0Y29uc3RydWN0b3IocGx1Z2luOiBUYWdCdWRkeSwgZWxlbWVudDogSFRNTEVsZW1lbnQsIGNhbGxiYWNrOiBGdW5jdGlvbil7XG5cdCAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjsgLy8gU3RvcmUgdGhlIHBsdWdpbiBpbnN0YW5jZVxuXHQgICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0ICAgIHRoaXMuY2FsbGJhY2sgPSBjYWxsYmFjaztcblx0ICAgIHRoaXMubGFzdFRhcCA9IDA7XG5cdCAgICBcblx0ICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQoXG5cdCAgICBcdHRoaXMuZWxlbWVudCxcblx0ICAgIFx0J3RvdWNoZW5kJywgXG5cdCAgICBcdHRoaXMuaGFuZGxlVG91Y2hFbmQuYmluZCh0aGlzKSwgXG5cdCAgICBcdHRydWVcbiAgICBcdCk7XG5cdCAgfVxuXG5cdCAgaGFuZGxlVG91Y2hFbmQoZXZlbnQ6IEV2ZW50KSB7XG5cdCAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHQgICAgY29uc3QgdGFwTGVuZ3RoID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUYXA7XG5cdCAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcblx0ICAgIGlmICh0YXBMZW5ndGggPCA1MDAgJiYgdGFwTGVuZ3RoID4gMCkge1xuXHQgICAgICB0aGlzLmNhbGxiYWNrKGV2ZW50KTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuXHQgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuXHQgICAgICB9LCA1MDApO1xuXHQgICAgfVxuXHQgICAgdGhpcy5sYXN0VGFwID0gY3VycmVudFRpbWU7XG5cdCAgfVxufVxuXG5leHBvcnQgY2xhc3MgVHJpcGxlVGFwSGFuZGxlciB7XG5cdFxuICBwcml2YXRlIHBsdWdpbjogYW55O1xuICBwcml2YXRlIGVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuICBwcml2YXRlIGNhbGxiYWNrOiBGdW5jdGlvbjtcbiAgcHJpdmF0ZSBsYXN0VGFwOiBudW1iZXI7XG4gIHByaXZhdGUgdGltZW91dDogYW55O1xuICBwcml2YXRlIHRhcENvdW50OiBudW1iZXI7XG5cbiAgY29uc3RydWN0b3IocGx1Z2luOiBhbnksIGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBjYWxsYmFjazogRnVuY3Rpb24pe1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luOyAvLyBTdG9yZSB0aGUgcGx1Z2luIGluc3RhbmNlXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5sYXN0VGFwID0gMDtcbiAgICB0aGlzLnRhcENvdW50ID0gMDsgLy8gSW5pdGlhbGl6ZSB0YXAgY291bnRcbiAgICBcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KFxuICAgICAgdGhpcy5lbGVtZW50LFxuICAgICAgJ3RvdWNoZW5kJywgXG4gICAgICB0aGlzLmhhbmRsZVRvdWNoRW5kLmJpbmQodGhpcyksIFxuICAgICAgdHJ1ZVxuICAgICk7XG4gIH1cblxuICBoYW5kbGVUb3VjaEVuZChldmVudDogRXZlbnQpIHtcbiAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IHRhcExlbmd0aCA9IGN1cnJlbnRUaW1lIC0gdGhpcy5sYXN0VGFwO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgIFxuICAgIGlmICh0YXBMZW5ndGggPCA1MDAgJiYgdGFwTGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy50YXBDb3VudCsrOyAvLyBJbmNyZW1lbnQgdGFwIGNvdW50XG5cbiAgICAgIC8vIElmIHRyaXBsZSB0YXAgaXMgZGV0ZWN0ZWQsIHRyaWdnZXIgdGhlIGNhbGxiYWNrIGFuZCByZXNldCB0YXBDb3VudFxuICAgICAgaWYgKHRoaXMudGFwQ291bnQgPT09IDIpIHtcbiAgICAgICAgdGhpcy5jYWxsYmFjayhldmVudCk7XG4gICAgICAgIHRoaXMudGFwQ291bnQgPSAwO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnRhcENvdW50ID0gMDsgLy8gUmVzZXQgdGFwIGNvdW50IGlmIHRpbWUgYmV0d2VlbiB0YXBzIGlzIHRvbyBsb25nXG4gICAgfVxuXG4gICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgIHRoaXMudGFwQ291bnQgPSAwOyAvLyBSZXNldCB0YXAgY291bnQgd2hlbiB0aW1lb3V0IGlzIHJlYWNoZWRcbiAgICB9LCA1MDApO1xuXG4gICAgdGhpcy5sYXN0VGFwID0gY3VycmVudFRpbWU7XG4gIH1cbn1cblxuXG5leHBvcnQgY2xhc3MgUHJlc3NBbmRIb2xkSGFuZGxlciB7XG5cdFxuXHRjb25zdHJ1Y3Rvcihcblx0XHRwbHVnaW46IFRhZ0J1ZGR5LCBcblx0XHRlbGVtZW50OiBIVE1MRWxlbWVudCwgXG5cdFx0Y2FsbGJhY2s6IEZ1bmN0aW9uLCBcblx0XHRkdXJhdGlvbjogbnVtYmVyID0gNjAwXG5cdCl7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy5lbGVtZW50ID0gZWxlbWVudDtcblx0XHR0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG5cdFx0dGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOyBcblx0XHR0aGlzLnRpbWVvdXQgPSBudWxsO1xuXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdHRoaXMuZWxlbWVudCwgXG5cdFx0XHQndG91Y2hzdGFydCcsIFxuXHRcdFx0dGhpcy5oYW5kbGVUb3VjaFN0YXJ0LmJpbmQodGhpcyksIFxuXHRcdFx0dHJ1ZVxuXHRcdCk7XG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudChcblx0XHRcdHRoaXMuZWxlbWVudCwgXG5cdFx0XHQndG91Y2hlbmQnLCBcblx0XHRcdHRoaXMuaGFuZGxlVG91Y2hFbmQuYmluZCh0aGlzKSwgXG5cdFx0XHR0cnVlXG5cdFx0KTtcblx0fVxuXG5cdGhhbmRsZVRvdWNoU3RhcnQoZXZlbnQ6IEV2ZW50KSB7XG5cdFx0Ly9ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdC8vZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0dGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHR0aGlzLmNhbGxiYWNrKGV2ZW50KTtcblx0XHRcdHRoaXMudGltZW91dCA9IG51bGw7XG5cdFx0fSwgdGhpcy5kdXJhdGlvbik7XG5cdH1cblxuXHRoYW5kbGVUb3VjaEVuZChldmVudDogRXZlbnQpIHtcblx0XHRpZiAodGhpcy50aW1lb3V0KSB7XG5cdFx0XHRjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcblx0XHRcdHRoaXMudGltZW91dCA9IG51bGw7XG5cdFx0fVxuXHR9XG59XG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBQWdPOzs7QUNDaE8sc0JBQStDO0FBRXhDLElBQU0sZ0JBQU4sY0FBNEIsaUNBQWlCO0FBQUEsRUFHaEQsWUFBWUMsTUFBVSxRQUFrQjtBQUNwQyxVQUFNQSxNQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osUUFBSSxFQUFFLFlBQVksSUFBSTtBQUN0QixnQkFBWSxNQUFNO0FBR2xCLGFBQVMsV0FBVyxLQUFLO0FBQ3JCLFlBQU0sYUFBYTtBQUNuQixhQUFPLFdBQVcsS0FBSyxHQUFHO0FBQUEsSUFDOUI7QUFFQSxhQUFTLGtCQUFrQixZQUFZO0FBQ25DLFlBQU0sWUFBWSxXQUFXLE1BQU0sSUFBSTtBQUN2QyxZQUFNLFlBQVksVUFBVSxPQUFPLFVBQVU7QUFDN0MsYUFBTyxVQUFVLEtBQUssSUFBSTtBQUFBLElBQzlCO0FBR0EsZ0JBQVksU0FBUyxNQUFNLEVBQUUsTUFB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V0FBSyxhQUFhO0FBQUEsSUFDbkIsT0FBTztBQUFBLElBRVA7QUFBQSxFQUNEO0FBQUEsRUFFQSxnQkFBdUI7QUFDdEIsVUFBTSxhQUNOLEtBQUssU0FBUyxxQkFBbUIsS0FBSyxDQUFDLElBQUksS0FBSyxTQUFTLGtCQUFrQixNQUFNLElBQUk7QUFDckYsV0FBTztBQUFBLEVBQ1I7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgInBhcmFncmFwaEVsIiwgImFwcCIsICJhcHAiLCAiZmlsZVBhdGgiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJpbXBvcnRfb2JzaWRpYW4iLCAiYXBwIiwgInRhZ0VsIiwgImltcG9ydF9vYnNpZGlhbiIsICJTZWxlY3RGaWxlTW9kYWwiLCAiYXBwIiwgImFwcCIsICJ0YWdFbCIsICJwYXJhZ3JhcGhFbCIsICJTZWxlY3RGaWxlTW9kYWwiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJwYXJhZ3JhcGhFbCIsICJ0YWdFbCIsICJlIiwgIm5vdGljZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiYXBwIiwgInBhcmFncmFwaEVsIiwgInRhZ0VsIiwgIlRlbXBDb21wb25lbnQiLCAiaW1wb3J0X29ic2lkaWFuIiwgImFwcCIsICJ0YWdFbCIsICJlcnJvciJdCn0K
