/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TagBuddy
});
module.exports = __toCommonJS(main_exports);

// settings.ts
var import_obsidian = require("obsidian");
var TBSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Override native tag search on click").setDesc("Toggle off to use cmd+click to remove tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeOnClick).onChange(async (value) => {
        this.plugin.settings.removeOnClick = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Convert to tag text with opt+click (removes #)").setDesc("Toggle off to use opt+click to perform native tag search.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.optToConvert).onChange(async (value) => {
        this.plugin.settings.optToConvert = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Remove child tags first").setDesc("Toggle off to use shift+click to remove child tags fitst.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeChildTagsFirst).onChange(async (value) => {
        this.plugin.settings.removeChildTagsFirst = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Mobile tag search").setDesc("Toggle on to restore mobile native tag search on tap. Tag removal will then use press+hold.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileTagSearch).onChange(async (value) => {
        this.plugin.settings.mobileTagSearch = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show mobile notices").setDesc("Toggle off to hide notices when editing or removing a tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileNotices).onChange(async (value) => {
        this.plugin.settings.mobileNotices = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Debug mode").setDesc("Output to console.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
        this.plugin.settings.debugMode = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// main.ts
var import_obsidian2 = require("obsidian");
var DEFAULT_SETTINGS = {
  removeOnClick: true,
  // when true, cmd is needed when clicking to remove the tag
  removeChildTagsFirst: true,
  // use shift when false
  optToConvert: true,
  // when false, clicking tag will do nothing
  mobileTagSearch: false,
  // toggle on use double tap for search. press+hold will then remove.
  mobileNotices: true,
  debugMode: false
};
var TagBuddy = class extends import_obsidian2.Plugin {
  onunload() {
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new TBSettingsTab(this.app, this));
    console.log("Tag Buddy Plugin loaded on " + (this.app.isMobile ? "mobile at " : "desktop at ") + new Date().toUTCString().substring(17));
    this.app.workspace.onLayoutReady(async () => {
      setTimeout(async () => {
        this.processTags();
      }, 1e3);
      this.registerEvent(this.app.on("layout-change", (event) => {
        setTimeout(async () => {
          this.processTags();
        }, 300);
      }));
      this.registerEvent(this.app.on("file-open", async (event) => {
        setTimeout(async () => {
          this.processTags();
        }, 1e3);
      }));
      if (!this.app.isMobile) {
        this.registerDomEvent(document, "click", this.onClickEvent.bind(this), true);
      } else {
        this.registerDomEvent(document, "click", (e) => {
          const isTag = e.target.classList.contains("tag");
          if (isTag && !this.settings.mobileTagSearch) {
            e.stopPropagation();
          }
        }, true);
        new PressAndHoldHandler(this, document, this.onClickEvent.bind(this));
        new DoubleTapHandler(this, document, this.onClickEvent.bind(this));
      }
    });
    this.registerMarkdownCodeBlockProcessor("tag-summary", this.summaryCodeBlockProcessor.bind(this));
  }
  async onClickEvent(event) {
    const target = event.target;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    if (!view && target.matches(".tag")) {
      new import_obsidian2.Notice("Tag Buddy: Can't edit tag. Unsupported view type. Try again within that note.");
      return;
    }
    if (view) {
      if (view.getMode() != "preview")
        return;
    } else {
    }
    if (!this.app.isMobile) {
      if (this.settings.removeOnClick && event.metaKey || !this.settings.removeOnClick && !event.metaKey) {
        return;
      } else if (event.altKey && !this.settings.optToConvert) {
        return;
      }
    } else {
      if (this.settings.mobileTagSearch && event.type == "touchend") {
        return;
      }
    }
    if (target && target.matches(".tag")) {
      if (this.settings.removeOnClick || !this.settings.removeOnClick && event.metaKey) {
        event.stopPropagation();
        event.preventDefault();
      }
      const clickedTag = target.closest(".tag");
      const tag = clickedTag.innerText;
      let tagIndex = clickedTag.getAttribute("md-index");
      let tagFile = clickedTag.getAttribute("file-source");
      if (tagFile) {
        this.editTag(event, tagIndex, tagFile);
      } else {
        setTimeout(async () => {
          tagIndex = clickedTag.getAttribute("md-index");
          tagFile = clickedTag.getAttribute("file-source");
          this.editTag(event, tagIndex, tagFile);
        }, 100);
      }
      if (clickedTag.getAttribute("type") == "plugin-summary") {
        setTimeout(async () => {
          const summaryContainer = clickedTag.closest(".summary");
          const tagsStr = summaryContainer.getAttribute("codeblock-tags");
          const tags = tagsStr ? tagsStr.split(",") : [];
          const tagsIncludeStr = summaryContainer.getAttribute("codeblock-tags-include");
          const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
          const tagsExcludeStr = summaryContainer.getAttribute("codeblock-tags-exclude");
          const tagsExclude = tagsExcludeStr ? tagsExcludeStr.split(",") : [];
          this.createSummary(summaryContainer, tags, tagsInclude, tagsExclude);
          setTimeout(async () => {
            this.processTags();
          }, 200);
        }, 150);
      } else {
        setTimeout(async () => {
          this.processTags();
        }, 50);
      }
    } else if (!view && target.matches(".tag")) {
      new import_obsidian2.Notice("Tag Buddy: Can't edit tag. Might be in an unsupported view type.");
    }
  }
  async processTags() {
    if (this.settings.debugMode)
      console.log("Tag Buddy: Processing tags.");
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    const activeNoteContainer = await this.app.workspace.activeLeaf.containerEl;
    const activeFile = await this.app.workspace.getActiveFile();
    const fileContent = await app.vault.read(activeFile);
    const activeFileTagElements = await activeNoteContainer.querySelectorAll(".mod-active .tag:not(.markdown-embed .tag):not(.summary .tag)");
    const activeFileTags = await this.getMarkdownTags(activeFile, fileContent);
    this.assignMarkdownTags(activeFileTags, activeFileTagElements, 0, "active");
    this.processEmbeds(activeNoteContainer);
  }
  async getMarkdownTags(file, fileContent) {
    const tagPositions = [];
    let match;
    const regex = /(?:^|\s)#[^\s#]+|```/g;
    let insideCodeBlock = false;
    while ((match = regex.exec(fileContent)) !== null) {
      if (match[0].trim() === "```") {
        insideCodeBlock = !insideCodeBlock;
        continue;
      }
      if (insideCodeBlock)
        continue;
      const tag = match[0].trim();
      if (fileContent.slice(match.index, match.index + tag.length + 2).endsWith("]]")) {
        continue;
      }
      tagPositions.push({ tag, index: match.index, source: file.name });
    }
    return tagPositions;
  }
  assignMarkdownTags(tagPositions, tagElements, startIndex, type) {
    let tagEl;
    const tagElArray = Array.from(tagElements);
    let tagElIndex = 0;
    tagPositions.forEach((tagPos, index) => {
      if (tagPositions[index].index >= startIndex) {
        tagEl = tagElArray[tagElIndex];
        if (tagEl) {
          tagEl.setAttribute("md-index", tagPositions[index].index);
          tagEl.setAttribute("file-source", tagPositions[index].source);
          tagEl.setAttribute("type", type);
          tagElIndex++;
        }
      }
    });
    return tagElArray;
  }
  async processEmbeds(element) {
    const embeds = await element.querySelectorAll(".summary, .markdown-embed");
    embeds.forEach(async (embed) => {
      if (embed.classList.contains("summary")) {
        this.processTagSummary(embed);
      } else if (embed.classList.contains("markdown-embed")) {
        this.processNativeEmbed(embed);
        if (Array.from(embed.querySelectorAll(".summary")).length > 0) {
          this.processTagSummary(embed);
        }
      } else {
      }
    });
  }
  async processNativeEmbed(embed) {
    const linkElement = embed.getAttribute("src");
    let filePath = embed.getAttribute("src");
    const linkArray = filePath.split("#");
    filePath = linkArray[0].trim() + ".md";
    const file = await this.validateFilePath(filePath);
    if (file) {
      const fileContent = await app.vault.read(file);
      const embededTagFile = await this.getMarkdownTags(file, fileContent);
      const tempComponent = new TempComponent();
      const tempContainerHTML = createEl("div");
      await import_obsidian2.MarkdownRenderer.renderMarkdown(fileContent, tempContainerHTML, file.path, tempComponent);
      const innerText = this.cleanString(embed.querySelector(".markdown-embed-content").innerText);
      const startIndex = this.cleanString(tempContainerHTML.innerText).indexOf(innerText);
      this.assignMarkdownTags(embededTagFile, embed.querySelectorAll(".tag"), startIndex, "native-embed");
    }
  }
  async processTagSummary(embed) {
    let summaryBlocks = embed.querySelectorAll("blockquote");
    summaryBlocks.forEach(async (block, index) => {
      var _a, _b;
      const filePath = block.getAttribute("file-source");
      const file = this.app.vault.getAbstractFileByPath(filePath);
      if (file) {
        const fileContent = await app.vault.read(file);
        const embededTagFile = await this.getMarkdownTags(file, fileContent);
        const tempBlock = block.cloneNode(true);
        (_a = tempBlock.querySelector("br")) == null ? void 0 : _a.remove();
        (_b = tempBlock.querySelector("strong")) == null ? void 0 : _b.remove();
        const blockText = this.cleanString(tempBlock.innerText);
        const startIndex = this.cleanString(fileContent).indexOf(blockText);
        this.assignMarkdownTags(embededTagFile, block.querySelectorAll(".tag"), startIndex, "plugin-summary");
      }
    });
  }
  async editTag(event, index, filePath) {
    if (this.settings.debugMode)
      console.log("Tag Buddy edit tag: " + event.target.innerText + "\nIn file: " + filePath);
    if (filePath) {
      const file = await this.validateFilePath(filePath);
      let fileContent;
      let fileContentBackup;
      const tag = event.target.innerText.trim();
      try {
        fileContent = await this.app.vault.read(file);
        fileContentBackup = fileContent;
      } catch (error) {
        new import_obsidian2.Notice("Tag Buddy file read error:\n" + error.message);
        return;
      }
      let safeToEmptyFile = false;
      const tagRegex = /^\s*#(\w+)\s*$/;
      if (tagRegex.test(fileContent.trim())) {
        safeToEmptyFile = true;
      }
      let beforeTag = fileContent.substring(0, index);
      let afterTag = fileContent.substring(Number(index) + Number(tag.length) + 1);
      if (fileContent[index] === "\n") {
        beforeTag += "\n";
      }
      let newContent = "";
      if (event.altKey || event.type == "touchstart" && !this.settings.mobileTagSearch) {
        const noHash = tag.substring(1);
        newContent = beforeTag + (!beforeTag.endsWith(" ") ? " " : "") + noHash + afterTag;
        if (this.app.isMobile && this.settings.mobileNotices) {
          new import_obsidian2.Notice("Tag Buddy: " + tag + " converted to text.");
        }
      } else if (event.type == "touchend" || this.settings.mobileTagSearch || event.metaKey && !this.settings.removeOnClick || !event.metaKey && this.settings.removeOnClick) {
        let parentTag = "";
        if (tag.includes("/") && (this.settings.removeChildTagsFirst || event.shiftKey && !this.settings.removeChildTagsFirst)) {
          let parts = tag.split("/");
          const removedChild = parts.pop();
          parentTag = parts.join("/");
          newContent = beforeTag + (!beforeTag.endsWith(" ") ? " " : "") + parentTag + afterTag;
          if (this.app.isMobile && this.settings.mobileNotices) {
            new import_obsidian2.Notice("Tag Buddy: '" + removedChild + "' removed from parent tag.");
          }
        } else {
          newContent = beforeTag + afterTag;
          if (this.app.isMobile && this.settings.mobileNotices) {
            new import_obsidian2.Notice("Tag Buddy: " + tag + " removed.");
          }
        }
      }
      if (newContent == "" && !safeToEmptyFile || this.contentChangedTooMuch(fileContentBackup, newContent, tag, 2)) {
        new import_obsidian2.Notice("Tag Buddy: File change error.");
        newContent = fileContentBackup;
      } else if (newContent == "" && safeToEmptyFile) {
        new import_obsidian2.Notice("Tag Buddy: Tag removed. The file is empty.");
      }
      try {
        await this.app.vault.modify(file, newContent);
      } catch (error) {
        try {
          const backupFileName = String(file.name.substring(0, file.name.indexOf(".md")) + " BACKUP.md");
          vault.create("", backupFileName, fileContentBackup);
          new import_obsidian2.Notice("Tag Buddy note editing error: " + error.message + "\n" + backupFileName + " saved to vault root.");
        } catch (error2) {
          navigator.clipboard.writeText(fileContentBackup);
          new import_obsidian2.Notice("Tag Buddy note editing error: " + error2.message + "\nNote content copied to clipboard.");
        }
      }
    } else {
      new import_obsidian2.Notice("Tag Buddy error: Can't identify tag location.");
    }
  }
  async readFiles(listFiles) {
    let list = [];
    for (let t = 0; t < listFiles.length; t += 1) {
      const file = listFiles[t];
      let content = await this.app.vault.cachedRead(file);
      list.push([file, content]);
    }
    return list;
  }
  isValidText(listTags, tags, include, exclude) {
    let valid = true;
    if (tags.length > 0) {
      valid = valid && tags.some((value) => listTags.includes(value));
    }
    if (include.length > 0) {
      valid = valid && include.every((value) => listTags.includes(value));
    }
    if (valid && exclude.length > 0) {
      valid = !exclude.some((value) => listTags.includes(value));
    }
    return valid;
  }
  async validateFilePath(filePath) {
    const matchingFiles = await app.vault.getFiles().filter((file) => file.name === filePath);
    if (matchingFiles.length === 1) {
      const filePath2 = matchingFiles[0].path;
      const file = await this.app.vault.getAbstractFileByPath(filePath2);
      return file;
    } else if (matchingFiles.length > 1) {
      new import_obsidian2.Notice("Tag Buddy: Multiple files found with the same name. Can't safely edit tag.");
      return null;
    } else {
      new import_obsidian2.Notice("Tag Buddy: No file found. Try again, or this tag might be in an unsupported embed type.");
      return null;
    }
  }
  contentChangedTooMuch(original, modified, tag, buffer = 5) {
    const expectedChange = tag.length;
    const threshold = expectedChange + buffer;
    const actualChange = Math.abs(original.length - modified.length);
    return actualChange > threshold;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  cleanString(input) {
    let cleanedStr;
    if (input instanceof Element) {
      cleanedStr = input.outerHTML.trim();
    } else {
      cleanedStr = input.trim();
    }
    cleanedStr = cleanedStr.replace(/\s+/g, " ");
    const textArea = document.createElement("textarea");
    textArea.innerHTML = cleanedStr;
    cleanedStr = textArea.value.trim();
    return cleanedStr;
  }
  async refreshView() {
    new import_obsidian2.Notice("Refresh view.");
    await app.workspace.activeLeaf.rebuildView();
  }
  //////////////// CUSTOM TAG-SUMMARY IMPLEMENTATION //////////////
  // ORIGINAL CODE BY https://github.com/macrojd/tag-summary //////
  /////////////////////////////////////////////////////////////////
  async summaryCodeBlockProcessor(source, el, ctx) {
    let tags = Array();
    let include = Array();
    let exclude = Array();
    const rows = source.split("\n").filter((row) => row.length > 0);
    rows.forEach((line) => {
      if (line.match(/^\s*tags:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*tags:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        tags = list;
      }
      if (line.match(/^\s*include:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*include:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        include = list;
      }
      if (line.match(/^\s*exclude:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*exclude:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        exclude = list;
      }
    });
    if (tags.length > 0 || include.length > 0) {
      await this.createSummary(el, tags, include, exclude, ctx.sourcePath);
    } else {
      this.createEmptySummary(el);
    }
  }
  createEmptySummary(element) {
    const container = createEl("div");
    container.setAttribute("class", "summary");
    container.createEl("span", {
      attr: { style: "color: var(--text-error) !important;" },
      text: "There are no files with blocks that match the specified tags."
    });
    element.replaceWith(container);
  }
  async createSummary(element, tags, include, exclude, filePath) {
    const activeFile = await this.app.workspace.getActiveFile();
    const validTags = tags.concat(include);
    const tempComponent = new TempComponent();
    const summaryContainer = createEl("div");
    summaryContainer.setAttribute("class", "summary");
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian2.getAllTags)(cache);
      if (validTags.some((value) => tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    listFiles = listFiles.sort((file1, file2) => {
      if (file1.path < file2.path) {
        return -1;
      } else if (file1.path > file2.path) {
        return 1;
      } else {
        return 0;
      }
    });
    let listContents = await this.readFiles(listFiles);
    let summary = "";
    listContents.forEach((item) => {
      const fileName = item[0].name.replace(/.md$/g, "");
      const filePath2 = item[0].path;
      if (activeFile.name == item[0].name) {
        return;
      }
      let listParagraphs = Array();
      const blocks = item[1].split(/\n\s*\n/).filter((row) => row.trim().length > 0);
      blocks.forEach((paragraph) => {
        let valid = false;
        let listTags = paragraph.match(/#[\p{L}0-9_\-/#]+/gu);
        if (listTags != null && listTags.length > 0) {
          if (!paragraph.contains("```")) {
            valid = this.isValidText(listTags, tags, include, exclude);
          }
        }
        if (valid) {
          let listItems = Array();
          let itemText = "";
          paragraph.split("\ns*\n").forEach((line) => {
            let isList = false;
            isList = line.search(/(\s*[\-\+\*]){1}|([0-9]\.){1}\s+/) != -1;
            if (!isList) {
              listParagraphs.push(line);
              itemText = "";
            } else {
              line.split("\n").forEach((itemLine) => {
                let level = 0;
                const endIndex = itemLine.search(/[\-\+\*]{1}|([0-9]\.){1}\s+/);
                const tabText = itemLine.slice(0, endIndex);
                const tabs = tabText.match(/\t/g);
                if (tabs) {
                  level = tabs.length;
                }
                if (level == 0) {
                  if (itemText != "") {
                    listItems.push(itemText);
                    itemText = "";
                  }
                  itemText = "" + itemText.concat(itemLine + "\n");
                } else if (level > 0 && itemText != "") {
                  itemText = itemText.concat(itemLine + "\n");
                }
              });
            }
          });
          if (itemText != "") {
            listItems.push(itemText);
            itemText = "";
          }
          listItems.forEach((line) => {
            listTags = line.match(/#[\p{L}0-9_\-/#]+/gu);
            if (listTags != null && listTags.length > 0) {
              if (this.isValidText(listTags, tags, include, exclude)) {
                listParagraphs.push(line);
              }
            }
          });
        }
      });
      listParagraphs.forEach(async (paragraph) => {
        var _a;
        paragraph += "\n";
        var regex = new RegExp();
        var tagText = new String();
        var tagSection = null;
        tags.forEach((tag) => {
          tagText = tag.replace("#", "\\#");
          regex = new RegExp(`${tagText}(\\W|$)`, "g");
          if (paragraph.match(regex) != null) {
            tagSection = tag;
          }
        });
        let blockLink = paragraph.match(/\^[\p{L}0-9_\-/^]+/gu);
        if (blockLink) {
          paragraph = "**[[" + filePath2 + "#" + blockLink + "|" + fileName + "]]**\n" + paragraph;
        } else {
          paragraph = "**[[" + filePath2 + "|" + fileName + "]]**\n" + paragraph;
        }
        paragraph += "\n\n";
        summary += paragraph;
        const paragraphContent = createEl("blockquote");
        paragraphContent.setAttribute("file-source", filePath2);
        await import_obsidian2.MarkdownRenderer.renderMarkdown(paragraph, paragraphContent, (_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path, tempComponent);
        summaryContainer.appendChild(paragraphContent);
      });
    });
    if (summary != "") {
      summaryContainer.setAttribute("codeblock-tags", tags.join(","));
      summaryContainer.setAttribute("codeblock-tags-include", include.length > 0 ? include.join(",") : "");
      summaryContainer.setAttribute("codeblock-tags-exclude", exclude.length > 0 ? exclude.join(",") : "");
      element.replaceWith(summaryContainer);
    } else {
      this.createEmptySummary(element);
    }
  }
  /////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////
};
var TempComponent = class extends import_obsidian2.Component {
  onload() {
  }
  onunload() {
  }
};
var DoubleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.plugin.registerDomEvent(this.element, "touchend", this.handleTouchEnd.bind(this), true);
  }
  handleTouchEnd(event) {
    const currentTime = new Date().getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.callback(event);
    } else {
      this.timeout = setTimeout(() => {
        clearTimeout(this.timeout);
      }, 500);
    }
    this.lastTap = currentTime;
  }
};
var PressAndHoldHandler = class {
  constructor(plugin, element, callback, duration = 600) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.duration = duration;
    this.timeout = null;
    this.plugin.registerDomEvent(this.element, "touchstart", this.handleTouchStart.bind(this), true);
    this.plugin.registerDomEvent(this.element, "touchend", this.handleTouchEnd.bind(this), true);
  }
  handleTouchStart(event) {
    this.timeout = setTimeout(() => {
      this.callback(event);
      this.timeout = null;
    }, this.duration);
  }
  handleTouchEnd(event) {
    if (this.timeout) {
      clearTimeout(this.timeout);
      this.timeout = null;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgVEJTZXR0aW5nc1RhYiB9IGZyb20gXCIuL3NldHRpbmdzXCI7XG5pbXBvcnQgeyBBcHAsIGRlYm91bmNlLCBFZGl0b3IsIE1hcmtkb3duUmVuZGVyZXIsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5cbmludGVyZmFjZSBUQlNldHRpbmdzIHtcblx0cmVtb3ZlT25DbGljazogYm9vbGVhbjsgLy8gY3RybFxuXHRyZW1vdmVDaGlsZFRhZ3NGaXJzdDsgLy8gXG5cdG9wdFRvQ29udmVydDogYm9vbGVhbjsgLy9hbHRcblx0bW9iaWxlVGFnU2VhcmNoOiBib29sZWFuOyBcblx0bW9iaWxlTm90aWNlczogYm9vbGVhbjsgXG5cdGRlYnVnTW9kZTogYm9vbGVhbjtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGFydGlhbDxUQlNldHRpbmdzPiA9IHtcblx0cmVtb3ZlT25DbGljazogdHJ1ZSwgLy8gd2hlbiB0cnVlLCBjbWQgaXMgbmVlZGVkIHdoZW4gY2xpY2tpbmcgdG8gcmVtb3ZlIHRoZSB0YWdcblx0cmVtb3ZlQ2hpbGRUYWdzRmlyc3Q6IHRydWUsIC8vIHVzZSBzaGlmdCB3aGVuIGZhbHNlXG5cdG9wdFRvQ29udmVydDogdHJ1ZSwgLy8gd2hlbiBmYWxzZSwgY2xpY2tpbmcgdGFnIHdpbGwgZG8gbm90aGluZ1xuXHRtb2JpbGVUYWdTZWFyY2g6IGZhbHNlLCAvLyB0b2dnbGUgb24gdXNlIGRvdWJsZSB0YXAgZm9yIHNlYXJjaC4gcHJlc3MraG9sZCB3aWxsIHRoZW4gcmVtb3ZlLlxuXHRtb2JpbGVOb3RpY2VzOiB0cnVlLFxuXHRkZWJ1Z01vZGU6IGZhbHNlLFxufTsgXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGFnQnVkZHkgZXh0ZW5kcyBQbHVnaW4geyAgXG5cdHNldHRpbmdzOiBUQlNldHRpbmdzO1xuXG5cdG9udW5sb2FkKCkge31cblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFRCU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcdFxuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgUGx1Z2luIGxvYWRlZCBvbiAnICsgKHRoaXMuYXBwLmlzTW9iaWxlPydtb2JpbGUgYXQgJzonZGVza3RvcCBhdCAnKSArIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKS5zdWJzdHJpbmcoMTcpKTtcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblx0XHRcdFxuXHRcdFx0Ly8gdGhpcy5yZWxvYWQoKTsgLy8gbm8gbmVlZCBmb3IgdGhpcyBhdG0uXG5cdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCAxMDAwKVxuXHRcdFx0XG5cdFx0XHQvLyBEb24ndCBuZWVkIHRoaXMgZXZlbnQgYmVjYXVzZSB3ZSdsbCBhbHdheXMgbmVlZCB0byBzd2l0Y2ggYmV0d2VlbiB2aWV3cyB0byBlZGl0IG5vdGUgYW5kIGFmZmVjdCB0aGUgdGFnIGluZGljZXMuXG5cdFx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpKSk7XG5cdFx0XHQvLyBEb24ndCBuZWVkIHRoaXMgZXZlbnQgYmVjYXVzZSBsZWFmIGNoYW5nZXMgZG9uJ3QgZWZmZWN0IHRoZSByYXcgY29udGVudC5cblx0XHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudCggdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCBkZWJvdW5jZShhc3luYyAoKSA9PiB7IGNvbnNvbGUubG9nKCdhY3RpdmUgbGVhZiBjaGFuZ2UnKTsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCAzMDAsIHRydWUpKSApO1xuXHRcdFx0Ly8gQnV0IG9uZSBvZiB0aGVzZSBtaWdodCBiZSB1c2VmdWwgd2hlbiB3ZSBjbGljayB0YWdzIGluIG90aGVyIHBsdWdpbnMgbGlrZSByZXBlYXQgb3IgY2hlY2tsaXN0XG5cdFx0XHQvLyBUaGlzIGV2ZW50IGlzIGJlc3QgYmVjYXVzZSB3ZSBhbHdheXMgbmVlZCB0byBzd2l0Y2ggbW9kZXMgdG8gZWRpdCBub3RlIG9yIGludGVyYWN0IHdpdGggdGFnIChyZWFkaW5nIG1vZGUpLlxuXHRcdFx0XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoIHRoaXMuYXBwLm9uKCdsYXlvdXQtY2hhbmdlJywgKGV2ZW50OiBFZGl0b3JFdmVudCkgPT4geyBcblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdsYXlvdXQgY2hhbmdlJyk7IFxuXHRcdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ3MoKTsgXG5cdFx0XHRcdH0sIDMwMCk7IFxuXHRcdFx0fSkpO1xuXHRcdFx0XG5cdFx0XHQvLyBUaGVyZSBpcyBhIGxpdHRsZSByZWR1bmRhbmN5IGhlcmUgYmVjYXVzZSB3ZSBhbHNvIGdldCBsYXlvdXQgZXZlbnRzIHdoZW4gc3dpdGNoaW5nIGZpbGVzXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAub24oJ2ZpbGUtb3BlbicsIGFzeW5jIChldmVudDogRWRpdG9yRXZlbnQpID0+IHsgXG5cdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZygnZmlsZSBvcGVuJyk7IFxuXHRcdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ3MoKTsgXG5cdFx0XHRcdH0sIDEwMDApOyBcblx0XHRcdH0pKTtcblxuXHRcdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgaGFuZGxlcyBhbGwgdGhlIGludGVyYWN0aW9ucyBvbiBkZXNrdG9wXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJywgdGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSwgdHJ1ZSk7XG5cblx0XHRcdH0gZWxzZSB7IC8vIE1vYmlsZSBpbnRlcmFjdGlvblxuXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgY2F0Y2hlcyBhbGwgdGFwcyBvbiBtb2JpbGUgYmVjYXVzZSB3ZSBoYXZlIGN1c3RvbSBkb3VibGUtdGFwIGFuZCBwcmVzcy1ob2xkIGV2ZW50cy5cblx0XHRcdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZSkgPT4geyBcblx0XHRcdFx0XHRjb25zdCBpc1RhZyA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndGFnJyk7XG5cdFx0XHRcdFx0aWYgKGlzVGFnICYmICF0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkge1xuXHRcdFx0XHRcdFx0Ly9uZXcgTm90aWNlICgnc3RvcCBwcm9wJylcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCB0cnVlKTtcblxuXHRcdFx0XHRuZXcgUHJlc3NBbmRIb2xkSGFuZGxlcih0aGlzLCBkb2N1bWVudCwgdGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSk7XG5cdFx0XHRcdG5ldyBEb3VibGVUYXBIYW5kbGVyKHRoaXMsIGRvY3VtZW50LCB0aGlzLm9uQ2xpY2tFdmVudC5iaW5kKHRoaXMpKTtcblx0XHRcdH1cdFxuXHRcdFx0XG5cdFx0fSk7XG5cblx0XHQvLyBUYWcgc3VtbWFyeSBjb2RlIGJsb2NrXG5cdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFwidGFnLXN1bW1hcnlcIiwgdGhpcy5zdW1tYXJ5Q29kZUJsb2NrUHJvY2Vzc29yLmJpbmQodGhpcykpO1xuXHR9XG5cblx0YXN5bmMgb25DbGlja0V2ZW50IChldmVudCkge1xuXHRcdFxuXHRcdC8vIElmIHRhZyBoYXMgbm8gY29udGV4dCBwcm9wZXJ0aWVzLCB0aGVuIHRyeSB0byBmaWd1cmUgb3V0IHdoZXJlIGl0IGlzP1xuXHRcdC8vIE9yIG1heWJlIHRoZXJlJ3MgYSB3YXkgdG8gaGF2ZSBvYnNpZGlhbiBhZGQgdGhlIHByb3BlcnRpZXMgZ2xvYmFsbHkuXG5cdFx0Ly9uZXcgTm90aWNlICgnVGFnIEJ1ZGR5IGV2ZW50IHR5cGU6ICcgKyBldmVudC50eXBlKTtcblxuXHRcdGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblxuXHRcdC8vIFRoaXMgY29uZGl0aW9uIGl0IGluIGNhc2Ugd2UgY2xpY2sgb24gYSB0YWcgaW4gYW5vdGhlciBwbHVnaW4gbGlrZSByZXBlYXQgb3IgY2hlY2tsaXN0XG5cdFx0Ly8gY2FuJ3QgZWRpdCB0YWdzIGluIHRoZXNlIGNhc2VzLiBGb3Igbm93LlxuXHRcdGlmICghdmlldyAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7IFxuXHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBDYW5cXCd0IGVkaXQgdGFnLiBVbnN1cHBvcnRlZCB2aWV3IHR5cGUuIFRyeSBhZ2FpbiB3aXRoaW4gdGhhdCBub3RlLicpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdGlmICh2aWV3KSB7IFxuXHRcdFx0aWYgKHZpZXcuZ2V0TW9kZSgpICE9ICdwcmV2aWV3JykgcmV0dXJuO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvL2lmIChkb2N1bWVudC5jb250YWlucygncmVwZWF0LWVtYmVkZGVkX25vdGUnKSlcblx0XHR9XG5cdFx0XHRcdC8vfHwgKEFycmF5LmZyb20oZW1iZWQucXVlcnlTZWxlY3RvckFsbCgnLnJlcGVhdC1lbWJlZGRlZF9ub3RlJykpLmxlbmd0aCA8PSAwKSkgcmV0dXJuO1xuXHRcdFx0Ly9yZXBlYXQtZW1iZWRkZWRfbm90ZSBtYXJrZG93bi1lbWJlZFxuXHRcdC8vfSBlbHNlIHtcblx0XHQvL1x0cmV0dXJuO1xuXHRcdC8vfVxuXHRcdFxuXHRcdGlmICghdGhpcy5hcHAuaXNNb2JpbGUpIHtcblx0XHRcdGlmICgodGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrICYmIGV2ZW50Lm1ldGFLZXkpIHx8ICghdGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrICYmICFldmVudC5tZXRhS2V5KSkgeyBcblx0XHRcdFx0cmV0dXJuOyBcblx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuYWx0S2V5ICYmICF0aGlzLnNldHRpbmdzLm9wdFRvQ29udmVydCkgeyAgXG5cdFx0XHRcdHJldHVybjsgXG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIG5ldyBOb3RpY2UoJ21vYmlsZSB0YWcgc2VhcmNoIGlzICcgKyB0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaClcblx0XHRcdC8vIG5ldyBOb3RpY2UgKCdUYWcgQnVkZHkgZXZlbnQgdHlwZTogJyArIGV2ZW50LnR5cGUpO1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MubW9iaWxlVGFnU2VhcmNoICYmIGV2ZW50LnR5cGUgPT0gJ3RvdWNoZW5kJykge1xuXHRcdFx0XHQvLyBpZiB3ZSBnZXQgdGhpcyBmYXIsIHRoaXMgaXMgYSBkb3VibGUgdGFwXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gbWF5YmUgYWZ0ZXIgbW9iaWxlIHNldHRpbmdzOiBsb25nIHByZXNzIGNhbiBkbyBjb252ZXJ0IG9yIHJlbW92ZS9lZGl0XG5cdFx0XHQvLyBkb3VibGUgdGFwIGNhbiBkbyByZW1vdmUvZWRpdCBvciBzZWFyY2ggKHZpYSBuYXRpdmUgY2xpY2ssIHdpdGhvdXQgcHJvcCBzdG9wKS4gaWYgZG91YmxlLXRhcCBkaXNhYmxlZCwgdGhlbiBuYXRpdmUgaGFwcGVucy5cblx0XHR9XG5cdFx0XG5cblx0XHQvL2lmICh2aWV3ICYmIHRhcmdldCAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7XHRcblx0XHRpZiAodGFyZ2V0ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHtcdFxuXHRcdFx0Ly8gY29uc3Qgc2Nyb2xsU3RhdGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5jdXJyZW50TW9kZT8uZ2V0U2Nyb2xsKCk7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgfHwgKCF0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgZXZlbnQubWV0YUtleSkpIHtcblx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGNsaWNrZWRUYWcgPSB0YXJnZXQuY2xvc2VzdCgnLnRhZycpOyAvL2V2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGNvbnN0IHRhZyA9IGNsaWNrZWRUYWcuaW5uZXJUZXh0O1xuXG5cdFx0XHRsZXQgdGFnSW5kZXggPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblx0XHRcdGxldCB0YWdGaWxlID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cblx0XHRcdGlmICh0YWdGaWxlKSB7XG5cdFx0XHRcdC8vIFRyeVxuXHRcdFx0XHR0aGlzLmVkaXRUYWcgKGV2ZW50LCB0YWdJbmRleCwgdGFnRmlsZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBUcnkgYWdhaW5cblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0dGFnSW5kZXggPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblx0XHRcdFx0XHR0YWdGaWxlID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cdFx0XHRcdFx0dGhpcy5lZGl0VGFnIChldmVudCwgdGFnSW5kZXgsIHRhZ0ZpbGUpO1xuXHRcdFx0XHR9LCAxMDApO1xuXHRcdFx0fVxuXHRcdFx0Ly9jb25zb2xlLmxvZyhjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgndHlwZScpKVxuXG5cdFx0XHRpZiAoY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ3R5cGUnKSA9PSAncGx1Z2luLXN1bW1hcnknKSB7XG5cdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IHN1bW1hcnlDb250YWluZXIgPSBjbGlja2VkVGFnLmNsb3Nlc3QoJy5zdW1tYXJ5Jyk7XG5cdFx0XHRcdFx0Y29uc3QgdGFnc1N0ciA9IHN1bW1hcnlDb250YWluZXIuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncycpO1xuXHRcdFx0XHRcdGNvbnN0IHRhZ3MgPSB0YWdzU3RyID8gdGFnc1N0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRcdFx0XHRjb25zdCB0YWdzSW5jbHVkZVN0ciA9IHN1bW1hcnlDb250YWluZXIuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJyk7XG5cdFx0XHRcdFx0Y29uc3QgdGFnc0luY2x1ZGUgPSB0YWdzSW5jbHVkZVN0ciA/IHRhZ3NJbmNsdWRlU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdFx0XHRcdGNvbnN0IHRhZ3NFeGNsdWRlU3RyID0gc3VtbWFyeUNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzLWV4Y2x1ZGUnKTtcblx0XHRcdFx0XHRjb25zdCB0YWdzRXhjbHVkZSA9IHRhZ3NFeGNsdWRlU3RyID8gdGFnc0V4Y2x1ZGVTdHIuc3BsaXQoJywnKSA6IFtdO1xuXG5cdFx0XHRcdFx0Ly8gUmVjcmVhdGUgc3VtbWFyeSBhZnRlciB3ZSd2ZSBlZGl0ZWQgdGhlIGZpbGVcblx0XHRcdFx0XHR0aGlzLmNyZWF0ZVN1bW1hcnkoc3VtbWFyeUNvbnRhaW5lciwgdGFncywgdGFnc0luY2x1ZGUsIHRhZ3NFeGNsdWRlKTtcblxuXHRcdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDIwMCk7XG5cblx0XHRcdFx0XHQvLyB0aGlzLnJlZnJlc2hWaWV3KCk7IC8vIG5vIG5lZWQgZm9yIHRoaXMgYXRtXG5cblx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDUwKVxuXHRcdFx0fVx0XG5cdFx0Ly99IGVsc2UgaWYgKHZpZXcgPT0gbnVsbCAmJiB0YXJnZXQgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkge1xuXHRcdH0gZWxzZSBpZiAoIXZpZXcgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkge1xuXHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBDYW5cXCd0IGVkaXQgdGFnLiBNaWdodCBiZSBpbiBhbiB1bnN1cHBvcnRlZCB2aWV3IHR5cGUuJyk7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc1RhZ3MgKCkge1xuXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBQcm9jZXNzaW5nIHRhZ3MuJyk7XG5cblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHQvL3NldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRjb25zdCBhY3RpdmVOb3RlQ29udGFpbmVyID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYuY29udGFpbmVyRWw7XG5cdFx0Ly9jb25zdCBhY3RpdmVOb3RlQ29udGFpbmVyID0gYXdhaXQgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZXctY29udGVudCcpO1xuXHRcdC8vY29uc3QgYWN0aXZlTm90ZUNvbnRhaW5lciA9IGF3YWl0IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYXJrZG93bi1yZWFkaW5nLXZpZXcnKTsvLyB0aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi5jb250YWluZXJFbDtcblx0XHQvL30sIDIwMClcblx0XHQvL3NldFRpbWVvdXQoYXN5bmMgKCkgPT4geyAvLyBBbGwgdGhlc2UgdGltZW91dHMgd2VyZSBmb3IgdGVzdGluZy4gSXNzdWVzIHNlZW1zIHRvIGJlIHJlc29sdmVkIG5vdy5cblx0XHRjb25zdCBhY3RpdmVGaWxlID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKTtcblx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGFjdGl2ZUZpbGUpO1xuXHRcdGNvbnN0IGFjdGl2ZUZpbGVUYWdFbGVtZW50cyA9IGF3YWl0IGFjdGl2ZU5vdGVDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm1vZC1hY3RpdmUgLnRhZzpub3QoLm1hcmtkb3duLWVtYmVkIC50YWcpOm5vdCguc3VtbWFyeSAudGFnKScpO1xuXHRcdC8vY29uc3QgYWN0aXZlRmlsZVRhZ0VsZW1lbnRzID0gYXdhaXQgYWN0aXZlTm90ZUNvbnRhaW5lci5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdjbS1oYXNodGFnJylcblx0XHQvL2NvbnNvbGUubG9nKEFycmF5LmZyb20oYWN0aXZlRmlsZVRhZ0VsZW1lbnRzKS5sZW5ndGgpXG5cdFx0Ly9jb25zb2xlLmxvZyhBcnJheS5mcm9tKGFjdGl2ZUZpbGVUYWdFbGVtZW50cykubWFwKGVsZW1lbnQgPT4gZWxlbWVudC5pbm5lclRleHQpKTtcblxuXG5cdFx0Ly9zZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgY29uc29sZS5sb2coYWN0aXZlRmlsZVRhZ0VsZW1lbnRzKX0sIDEwMDApXG5cdFx0Y29uc3QgYWN0aXZlRmlsZVRhZ3MgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhhY3RpdmVGaWxlLCBmaWxlQ29udGVudCk7XG5cdFx0dGhpcy5hc3NpZ25NYXJrZG93blRhZ3MoYWN0aXZlRmlsZVRhZ3MsIGFjdGl2ZUZpbGVUYWdFbGVtZW50cywgMCwgJ2FjdGl2ZScpO1xuXHRcdHRoaXMucHJvY2Vzc0VtYmVkcyhhY3RpdmVOb3RlQ29udGFpbmVyKTtcblx0XHQvL30sIDUwMClcblx0fVxuXG5cdGFzeW5jIGdldE1hcmtkb3duVGFncyAoZmlsZSwgZmlsZUNvbnRlbnQpIHtcblx0XHRjb25zdCB0YWdQb3NpdGlvbnMgPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cblx0XHRjb25zdCByZWdleCA9IC8oPzpefFxccykjW15cXHMjXSt8YGBgL2c7IC8vIEFkanVzdGVkIHRoZSByZWdleCB0byBhbHNvIG1hdGNoIGNvZGUgYmxvY2sgZGVsaW1pdGVyc1xuXHRcdGxldCBpbnNpZGVDb2RlQmxvY2sgPSBmYWxzZTtcblxuXHRcdHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKGZpbGVDb250ZW50KSkgIT09IG51bGwpIHtcblx0XHQgICAgaWYgKG1hdGNoWzBdLnRyaW0oKSA9PT0gXCJgYGBcIikge1xuXHRcdCAgICAgICAgaW5zaWRlQ29kZUJsb2NrID0gIWluc2lkZUNvZGVCbG9jazsgXG5cdFx0ICAgICAgICBjb250aW51ZTtcblx0XHQgICAgfVxuXHRcdCAgICBcblx0XHQgICAgaWYgKGluc2lkZUNvZGVCbG9jaykgY29udGludWU7XG5cblx0XHQgICAgY29uc3QgdGFnID0gbWF0Y2hbMF0udHJpbSgpO1xuXHRcdCAgICAvLyBMb29rIGFoZWFkIGZyb20gdGhlIGN1cnJlbnQgbWF0Y2ggYW5kIHNlZSBpZiBpdCdzIGZvbGxvd2VkIGJ5IF1dXG5cdFx0ICAgIGlmIChmaWxlQ29udGVudC5zbGljZShtYXRjaC5pbmRleCwgbWF0Y2guaW5kZXggKyB0YWcubGVuZ3RoICsgMikuZW5kc1dpdGgoXCJdXVwiKSkge1xuXHRcdCAgICAgICAgY29udGludWU7IC8vIFNraXAgdGhpcyBtYXRjaCBhcyBpdCdzIHBhcnQgb2YgYSB3aWtpbGlua1xuXHRcdCAgICB9XG5cdFx0ICAgIC8vY29uc29sZS5sb2cobWF0Y2guaW5kZXgpXG5cdFx0ICAgIHRhZ1Bvc2l0aW9ucy5wdXNoKHt0YWc6dGFnLCBpbmRleDptYXRjaC5pbmRleCwgc291cmNlOmZpbGUubmFtZX0pOyBcblx0XHR9XG5cdFx0Ly9jb25zb2xlLmxvZygnbWFya2Rvd24gdGFnIGNvdW50OiAnICsgdGFnUG9zaXRpb25zLmxlbmd0aClcblxuXHRcdHJldHVybiB0YWdQb3NpdGlvbnM7XG5cdH1cblxuXHRhc3NpZ25NYXJrZG93blRhZ3MgKHRhZ1Bvc2l0aW9ucywgdGFnRWxlbWVudHMsIHN0YXJ0SW5kZXgsIHR5cGUpIHtcblx0XHRsZXQgdGFnRWw7XG5cdFx0Y29uc3QgdGFnRWxBcnJheSA9IEFycmF5LmZyb20odGFnRWxlbWVudHMpO1xuXHRcdGxldCB0YWdFbEluZGV4ID0gMDtcblx0XHR0YWdQb3NpdGlvbnMuZm9yRWFjaCgodGFnUG9zLCBpbmRleCkgPT4ge1xuXG5cdFx0XHRpZiAodGFnUG9zaXRpb25zW2luZGV4XS5pbmRleCA+PSBzdGFydEluZGV4KSB7XG5cdFx0XHRcdHRhZ0VsID0gdGFnRWxBcnJheVt0YWdFbEluZGV4XSBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgXHRcdGlmICh0YWdFbCkge1xuICAgICAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ21kLWluZGV4JywgdGFnUG9zaXRpb25zW2luZGV4XS5pbmRleCk7XG4gICAgICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnLCB0YWdQb3NpdGlvbnNbaW5kZXhdLnNvdXJjZSk7XG4gICAgICAgIFx0XHRcdHRhZ0VsLnNldEF0dHJpYnV0ZSgndHlwZScsIHR5cGUpO1xuICAgICAgICBcdFx0XHR0YWdFbEluZGV4Kys7XG4gICAgICAgIFx0XHR9IFxuICAgIFx0XHR9IFxuXHRcdH0pOyBcblx0XHQvL2NvbnNvbGUubG9nKCd0YWcgZWxlbWVudCBhcnJheSBsZW5ndGg6ICcgKyB0YWdFbEFycmF5Lmxlbmd0aCk7XG5cdFx0cmV0dXJuIHRhZ0VsQXJyYXk7IC8vQXJyYXkuZnJvbSh0YWdFbGVtZW50cyk7IFxuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc0VtYmVkcyAoZWxlbWVudCkge1xuIFx0XHQvL2NvbnN0IGFjdGl2ZUZpbGVUYWdFbGVtZW50cyA9IGF3YWl0IGFjdGl2ZU5vdGVDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm1vZC1hY3RpdmUgLnRhZzpub3QoLm1hcmtkb3duLWVtYmVkIC50YWcpOm5vdCguc3VtbWFyeSAudGFnKScpO1xuXHRcdFxuXHRcdGNvbnN0IGVtYmVkcyA9IGF3YWl0IGVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN1bW1hcnksIC5tYXJrZG93bi1lbWJlZCcpO1xuXHRcdC8vbGV0IGVtYmVkZWRUYWdGaWxlcyA9IFtdO1xuXG5cdFx0ZW1iZWRzLmZvckVhY2goYXN5bmMgKGVtYmVkKSA9PiB7XG5cdFx0XHRpZiAoZW1iZWQuY2xhc3NMaXN0LmNvbnRhaW5zKCdzdW1tYXJ5JykpIHtcblx0XHRcdFx0Ly9jb25zb2xlLmxvZygndGhpcyBpcyBhIHN1bW1hcnknKVxuXG5cdFx0XHRcdC8vIE1vdmVkIHRoaXMgY29kZSB0byBzZXBhcmF0ZSBtZXRob2RzIHRvIHByb2Nlc3MgbmVzdGVkIGNvbnRlbnRcblx0XHRcdFx0LypsZXQgc3VtbWFyeUJsb2NrcyA9IGVtYmVkLnF1ZXJ5U2VsZWN0b3JBbGwoJ2Jsb2NrcXVvdGUnKTsgXG5cblx0XHRcdFx0c3VtbWFyeUJsb2Nrcy5mb3JFYWNoKGFzeW5jIChibG9jaywgaW5kZXgpID0+IHtcblx0XHRcdFx0XHQvL2NvbnN0IGxpbmtFbGVtZW50ID0gYmxvY2sucXVlcnlTZWxlY3RvcignYVtkYXRhLWhyZWYkPVwiLm1kXCJdJyk7XG5cdFx0XHRcdFx0Y29uc3QgZmlsZVBhdGggPSBibG9jay5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7IC8vIGxpbmtFbGVtZW50LmdldEF0dHJpYnV0ZSgnZGF0YS1ocmVmJylcblx0XHRcdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuXHRcdFx0XHRcdGlmIChmaWxlKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudClcblx0XHRcdFx0XHRcdC8vZW1iZWRlZFRhZ0ZpbGVzLnB1c2goZW1iZWRlZFRhZ0ZpbGUpO1xuXHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHQvLyBDcmVhdGUgYSB0ZW1wb3J0eSBlbGVtZW50IGJsb2NrIHNvIHdlIGNhbiBtYXRjaCBtYXRjaCB0ZXh0IG9ubHkgY29udGVudCBvZiB0aGlzIGVsZW1lbnQgd2l0aCBpdCdzIHNvdXJjZSBub3RlXG5cdFx0XHRcdFx0XHRjb25zdCB0ZW1wQmxvY2sgPSBibG9jay5jbG9uZU5vZGUodHJ1ZSk7XG5cdFx0XHRcdFx0XHR0ZW1wQmxvY2sucXVlcnlTZWxlY3RvcignYnInKT8ucmVtb3ZlKCk7XG5cdFx0XHRcdFx0XHR0ZW1wQmxvY2sucXVlcnlTZWxlY3Rvcignc3Ryb25nJyk/LnJlbW92ZSgpOyBcblx0XHRcdFx0XHRcdGNvbnN0IGJsb2NrVGV4dCA9IHRoaXMuY2xlYW5TdHJpbmcodGVtcEJsb2NrLmlubmVyVGV4dCk7XG5cblx0XHRcdFx0XHRcdGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLmNsZWFuU3RyaW5nKGZpbGVDb250ZW50KS5pbmRleE9mKGJsb2NrVGV4dCk7XG5cblx0XHRcdFx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBibG9jay5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICdwbHVnaW4tc3VtbWFyeScpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XHQqL1xuXG5cdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ1N1bW1hcnkoZW1iZWQpO1x0XG5cblx0XHRcdH0gZWxzZSBpZiAoZW1iZWQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtYXJrZG93bi1lbWJlZCcpKSB7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coJ3RoaXMgaXMgYW4gZW1iZWQnKVxuXG5cdFx0XHRcdC8vIE1vdmVkIHRoaXMgY29kZSB0byBzZXBhcmF0ZSBtZXRob2RzIHRvIHByb2Nlc3MgbmVzdGVkIGNvbnRlbnRcblxuXHRcdFx0XHQvKmNvbnN0IGxpbmtFbGVtZW50ID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdzcmMnKTsgLy90aGlzLmZpbmRBbmNlc3RvcihjbGlja2VkVGFnLCAnc3BhbicpXG5cdFx0XHRcdGxldCBmaWxlUGF0aCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cdFx0XHRcdGNvbnN0IGxpbmtBcnJheSA9IGZpbGVQYXRoLnNwbGl0KCcjJyk7XG5cdFx0XHRcdGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuXHRcdFx0XHRjb25zdCBmaWxlID0gYXdhaXQgdGhpcy52YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKVxuXHRcdFx0XHRpZiAoZmlsZSkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudClcblx0XHRcdFx0XHQvL2VtYmVkZWRUYWdGaWxlcy5wdXNoKGVtYmVkZWRUYWdGaWxlKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zdCB0ZW1wQ29tcG9uZW50ID0gbmV3IFRlbXBDb21wb25lbnQoKTtcblx0XHRcdFx0XHRjb25zdCB0ZW1wQ29udGFpbmVySFRNTCA9IGNyZWF0ZUVsKFwiZGl2XCIpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oZmlsZUNvbnRlbnQsIHRlbXBDb250YWluZXJIVE1MLCBmaWxlLnBhdGgsIHRlbXBDb21wb25lbnQpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnN0IGlubmVyVGV4dCA9IHRoaXMuY2xlYW5TdHJpbmcoZW1iZWQucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLWVtYmVkLWNvbnRlbnQnKS5pbm5lclRleHQpO1xuXHRcdFx0XHRcdGNvbnN0IHN0YXJ0SW5kZXggPSB0aGlzLmNsZWFuU3RyaW5nKHRlbXBDb250YWluZXJIVE1MLmlubmVyVGV4dCkuaW5kZXhPZihpbm5lclRleHQpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICduYXRpdmUtZW1iZWQnKTtcblx0XHRcdFx0fSovXG5cblx0XHRcdFx0dGhpcy5wcm9jZXNzTmF0aXZlRW1iZWQoZW1iZWQpO1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKCdmb3VuZCBzdW1tYXJ5IGluIGVtYmVkLCBjb3VudDogJyArIEFycmF5LmZyb20oZW1iZWQucXVlcnlTZWxlY3RvckFsbCgnLnN1bW1hcnknKSkubGVuZ3RoKVxuXHRcdFx0XHRpZiAoQXJyYXkuZnJvbShlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCcuc3VtbWFyeScpKS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0Ly9jb25zb2xlLmxvZygnZm91bmQgYSBuZXN0ZWQgc3VtbWFyeScpXG5cdFx0XHRcdFx0dGhpcy5wcm9jZXNzVGFnU3VtbWFyeShlbWJlZCk7XG5cdFx0XHRcdH1cblx0XHRcdFx0Ly99IGVsc2Uge1xuXHRcdFx0XHQvL1x0dGhpcy5wcm9jZXNzTmF0aXZlRW1iZWQoZW1iZWQpO1xuXHRcdFx0XHQvL31cblx0XHRcdFx0Ly9pZiAoZW1iZWQuY2xhc3NMaXN0LnF1ZXJ5U2VsZWN0b3JBbGwoJ3N1bW1hcnknKSkge1xuXHRcdFx0XHRcdC8vY29uc29sZS5sb2coJ2VtYmVkIGNvbnRhaW5zIHN1bW1hcnknKVxuXHRcdFx0XHQvL31cblx0XHRcdFx0Ly90aGlzLnByb2Nlc3NOYXRpdmVFbWJlZChlbWJlZClcblxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9uZXcgTm90aWNlKCdUYWcgQnVkZHk6IFRhZyBlbWJlZCBpbiB1bnN1cHBvcnRlZCBlbGVtZW50LicpO1xuXHRcdFx0XHQvLyBIYW5kbGUgdGhpcyBpc3N1ZSBvbiBjbGljay5cblx0XHRcdH1cblx0XHRcdFxuXHRcdH0pO1xuXHRcdC8vcmV0dXJuIGVtYmVkZWRUYWdGaWxlcztcblx0fVxuXG5cdGFzeW5jIHByb2Nlc3NOYXRpdmVFbWJlZCAoZW1iZWQpIHtcblxuXHRcdGNvbnN0IGxpbmtFbGVtZW50ID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdzcmMnKTsgLy90aGlzLmZpbmRBbmNlc3RvcihjbGlja2VkVGFnLCAnc3BhbicpXG5cdFx0bGV0IGZpbGVQYXRoID0gZW1iZWQuZ2V0QXR0cmlidXRlKCdzcmMnKTtcblx0XHRjb25zdCBsaW5rQXJyYXkgPSBmaWxlUGF0aC5zcGxpdCgnIycpO1xuXHRcdGZpbGVQYXRoID0gbGlua0FycmF5WzBdLnRyaW0oKSArICcubWQnO1xuXHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpXG5cdFx0aWYgKGZpbGUpIHtcblx0XHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRjb25zdCBlbWJlZGVkVGFnRmlsZSA9IGF3YWl0IHRoaXMuZ2V0TWFya2Rvd25UYWdzKGZpbGUsIGZpbGVDb250ZW50KVxuXHRcdFx0Ly9lbWJlZGVkVGFnRmlsZXMucHVzaChlbWJlZGVkVGFnRmlsZSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IHRlbXBDb21wb25lbnQgPSBuZXcgVGVtcENvbXBvbmVudCgpO1xuXHRcdFx0Y29uc3QgdGVtcENvbnRhaW5lckhUTUwgPSBjcmVhdGVFbChcImRpdlwiKTtcblx0XHRcdFxuXHRcdFx0YXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihmaWxlQ29udGVudCwgdGVtcENvbnRhaW5lckhUTUwsIGZpbGUucGF0aCwgdGVtcENvbXBvbmVudCk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGlubmVyVGV4dCA9IHRoaXMuY2xlYW5TdHJpbmcoZW1iZWQucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLWVtYmVkLWNvbnRlbnQnKS5pbm5lclRleHQpO1xuXHRcdFx0Y29uc3Qgc3RhcnRJbmRleCA9IHRoaXMuY2xlYW5TdHJpbmcodGVtcENvbnRhaW5lckhUTUwuaW5uZXJUZXh0KS5pbmRleE9mKGlubmVyVGV4dCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICduYXRpdmUtZW1iZWQnKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBwcm9jZXNzVGFnU3VtbWFyeSAoZW1iZWQpIHtcblxuXG5cdFx0bGV0IHN1bW1hcnlCbG9ja3MgPSBlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCdibG9ja3F1b3RlJyk7IFxuXHRcdC8vY29uc29sZS5sb2coc3VtbWFyeUJsb2Nrcylcblx0XHRzdW1tYXJ5QmxvY2tzLmZvckVhY2goYXN5bmMgKGJsb2NrLCBpbmRleCkgPT4ge1xuXHRcdFx0Ly9jb25zdCBsaW5rRWxlbWVudCA9IGJsb2NrLnF1ZXJ5U2VsZWN0b3IoJ2FbZGF0YS1ocmVmJD1cIi5tZFwiXScpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyhibG9jaylcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gYmxvY2suZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpOyAvLyBsaW5rRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaHJlZicpXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudClcblx0XHRcdFx0Ly9lbWJlZGVkVGFnRmlsZXMucHVzaChlbWJlZGVkVGFnRmlsZSk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDcmVhdGUgYSB0ZW1wb3J0eSBlbGVtZW50IGJsb2NrIHNvIHdlIGNhbiBtYXRjaCBtYXRjaCB0ZXh0IG9ubHkgY29udGVudCBvZiB0aGlzIGVsZW1lbnQgd2l0aCBpdCdzIHNvdXJjZSBub3RlXG5cdFx0XHRcdGNvbnN0IHRlbXBCbG9jayA9IGJsb2NrLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdFx0dGVtcEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJ2JyJyk/LnJlbW92ZSgpO1xuXHRcdFx0XHR0ZW1wQmxvY2sucXVlcnlTZWxlY3Rvcignc3Ryb25nJyk/LnJlbW92ZSgpOyBcblx0XHRcdFx0Y29uc3QgYmxvY2tUZXh0ID0gdGhpcy5jbGVhblN0cmluZyh0ZW1wQmxvY2suaW5uZXJUZXh0KTtcblxuXHRcdFx0XHRjb25zdCBzdGFydEluZGV4ID0gdGhpcy5jbGVhblN0cmluZyhmaWxlQ29udGVudCkuaW5kZXhPZihibG9ja1RleHQpO1xuXG5cdFx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBibG9jay5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICdwbHVnaW4tc3VtbWFyeScpO1xuXHRcdFx0fVxuXHRcdH0pO1x0XHRcblx0fVxuXG5cdGFzeW5jIGVkaXRUYWcgKGV2ZW50LCBpbmRleCwgZmlsZVBhdGgpIHtcblx0XHQvL2NvbnNvbGUubG9nKGV2ZW50LnRhcmdldClcblx0XHQvL2NvbnNvbGUubG9nKGluZGV4KTtcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgZWRpdCB0YWc6ICcgKyBldmVudC50YXJnZXQuaW5uZXJUZXh0ICsgJ1xcbkluIGZpbGU6ICcgKyBmaWxlUGF0aCk7XG5cblx0XHRpZiAoZmlsZVBhdGgpIHtcblxuXHRcdFx0Y29uc3QgZmlsZTogVEZpbGUgPSBhd2FpdCB0aGlzLnZhbGlkYXRlRmlsZVBhdGgoZmlsZVBhdGgpOyAvL2FwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0bGV0IGZpbGVDb250ZW50OiBTdHJpbmc7XG5cdFx0XHRsZXQgZmlsZUNvbnRlbnRCYWNrdXA6IFN0cmluZztcblx0XHRcdGNvbnN0IHRhZzogU3RyaW5nID0gZXZlbnQudGFyZ2V0LmlubmVyVGV4dC50cmltKCk7XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdFxuXHRcdFx0XHRmaWxlQ29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG5cdFx0XHRcdGZpbGVDb250ZW50QmFja3VwID0gZmlsZUNvbnRlbnQ7XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5IGZpbGUgcmVhZCBlcnJvcjpcXG4nICsgZXJyb3IubWVzc2FnZSk7XG5cdFx0XHRcdHJldHVybjtcblxuXHRcdFx0fVxuXG5cdFx0XHQvLyBjaGVjayBpZiB0aGUgZmlsZSBoYXMgb25seSBvbmUgdGFnIGxlZnQgKGFuZCB0aGF0J3MgYWxsIHRoYXRzIGxlZnQgaW4gdGhlIGZpbGUpXG5cdFx0XHRsZXQgc2FmZVRvRW1wdHlGaWxlID0gZmFsc2U7XG5cdFx0XHRjb25zdCB0YWdSZWdleCA9IC9eXFxzKiMoXFx3KylcXHMqJC87XG5cdFx0XHRpZiAodGFnUmVnZXgudGVzdChmaWxlQ29udGVudC50cmltKCkpKSB7XG5cdFx0ICAgIFx0c2FmZVRvRW1wdHlGaWxlID0gdHJ1ZTtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0bGV0IGJlZm9yZVRhZyA9IGZpbGVDb250ZW50LnN1YnN0cmluZygwLCBpbmRleCk7XG5cdFx0XHRsZXQgYWZ0ZXJUYWcgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoKE51bWJlcihpbmRleCkrTnVtYmVyKHRhZy5sZW5ndGgpKzEpKTtcblxuXHRcdFx0aWYgKGZpbGVDb250ZW50W2luZGV4XSA9PT0gJ1xcbicpIHtcbiAgICBcdFx0XHRiZWZvcmVUYWcgKz0gJ1xcbic7IC8vIGFwcGVuZGluZyB0aGUgbmV3bGluZSBjaGFyYWN0ZXIgdG8gYmVmb3JlVGFnXG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vY29uc29sZS5sb2coJ0ZpbGUgY29udGVudDogJywgSlNPTi5zdHJpbmdpZnkoZmlsZUNvbnRlbnQpKTtcblx0XHRcdC8vY29uc29sZS5sb2cgKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcblx0XHRcdC8vY29uc29sZS5sb2coJ0JlZm9yZSBUYWc6ICcsIEpTT04uc3RyaW5naWZ5KGJlZm9yZVRhZykpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnVGhlIFRhZzogJywgSlNPTi5zdHJpbmdpZnkodGFnKSk7XG5cdFx0XHQvL2NvbnNvbGUubG9nICgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdBZnRlciBUYWc6ICcsIEpTT04uc3RyaW5naWZ5KGFmdGVyVGFnKSk7XG5cdFxuXHRcdFx0bGV0IG5ld0NvbnRlbnQgPSAnJztcblxuXHRcdFx0Ly9pZiAodGhpcy5zZXR0aW5ncy5kZWJ1Z01vZGUpIHtcblxuXHRcdFx0XHQvLyBuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgJyBcdTI2QTBcdUZFMEYtLS1cdUQ4M0VcdURFRjgnICsgdGFnICsgJ1x1RDgzRVx1REVGNy0tLVx1MjZBMFx1RkUwRiAnICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdC8vbmV3Q29udGVudCA9IGJlZm9yZVRhZyArICcgXHUyNkEwXHVGRTBGLS0tXHUyN0ExXHVGRTBGJyArIHRhZyArIGFmdGVyVGFnO1xuXG5cdFx0XHQvL30gZWxzZVxuXHRcdFx0Ly9uZXcgTm90aWNlKCdjb252ZXJ0IHRvIHRleHQ6ICcgKyAoKGV2ZW50LnR5cGUgPT0gJ3RvdWNoc3RhcnQnKSAmJiB0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkpXG5cdFx0XHQvL25ldyBOb3RpY2UgKGV2ZW50LnR5cGUpXG5cdFx0XHRpZiAoZXZlbnQuYWx0S2V5IHx8ICgoZXZlbnQudHlwZSA9PSAndG91Y2hzdGFydCcpICYmICF0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkpIHsgXG5cblx0XHRcdFx0Ly8gUmVtb3ZlIHRoZSBoYXNoIG9ubHlcblxuXHRcdFx0XHRjb25zdCBub0hhc2ggPSB0YWcuc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgKCFiZWZvcmVUYWcuZW5kc1dpdGgoJyAnKT8nICc6JycpICsgbm9IYXNoICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUgJiYgdGhpcy5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKSB7IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6ICcgKyB0YWcgKyAnIGNvbnZlcnRlZCB0byB0ZXh0LicpOyB9XG5cdFx0XHRcdC8vIFNldHRpbmc6IG1ha2UgdGhpcyBhIHNldHRpbmcgdG8gc2hvdyBub3RpY2VzIG9uIG1vYmlsZVxuXHRcdFx0XG5cdFx0XHR9IGVsc2UgaWYgKCgoZXZlbnQudHlwZSA9PSAndG91Y2hlbmQnKSB8fCB0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkgfHwgKGV2ZW50Lm1ldGFLZXkgJiYgIXRoaXMuc2V0dGluZ3MucmVtb3ZlT25DbGljaykgfHwgKCFldmVudC5tZXRhS2V5ICYmIHRoaXMuc2V0dGluZ3MucmVtb3ZlT25DbGljaykpIHtcblxuXHRcdFx0XHQvLyBSZW1vdmUgdGFnIChvciBjaGlsZCBmaXJzdCwgaWYgZXhpc3RzKVxuXG5cdFx0XHRcdGxldCBwYXJlbnRUYWcgPSAnJztcblxuXHRcdFx0XHRpZiAodGFnLmluY2x1ZGVzKCcvJykgJiYgKHRoaXMuc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QgfHwgKGV2ZW50LnNoaWZ0S2V5ICYmICF0aGlzLnNldHRpbmdzLnJlbW92ZUNoaWxkVGFnc0ZpcnN0KSkpIHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRsZXQgcGFydHMgPSB0YWcuc3BsaXQoJy8nKTtcblx0XHRcdFx0XHRjb25zdCByZW1vdmVkQ2hpbGQgPSBwYXJ0cy5wb3AoKTtcblx0XHRcdFx0XHRwYXJlbnRUYWcgPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRcdFx0bmV3Q29udGVudCA9IGJlZm9yZVRhZyArICghYmVmb3JlVGFnLmVuZHNXaXRoKCcgJyk/JyAnOicnKSArIHBhcmVudFRhZyArIGFmdGVyVGFnO1xuXG5cdFx0XHRcdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlICYmIHRoaXMuc2V0dGluZ3MubW9iaWxlTm90aWNlcykgeyBuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiBcXCcnICsgcmVtb3ZlZENoaWxkICsgJ1xcJyByZW1vdmVkIGZyb20gcGFyZW50IHRhZy4nKTsgfVxuXHRcdFx0XHRcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgYWZ0ZXJUYWc7XG5cdFx0XHRcdFx0aWYgKHRoaXMuYXBwLmlzTW9iaWxlICYmIHRoaXMuc2V0dGluZ3MubW9iaWxlTm90aWNlcykgeyBuZXcgTm90aWNlICgnVGFnIEJ1ZGR5OiAnICsgdGFnICsgJyByZW1vdmVkLicpOyB9XG5cdFx0XHRcdH1cblx0XHRcdH0gXG5cdFx0XHQvLyBGaWxlIHNhZmV0eSBjaGVja3Ncblx0XHRcdGlmICgobmV3Q29udGVudCA9PSAnJyAmJiAhc2FmZVRvRW1wdHlGaWxlKSB8fCB0aGlzLmNvbnRlbnRDaGFuZ2VkVG9vTXVjaChmaWxlQ29udGVudEJhY2t1cCwgbmV3Q29udGVudCwgdGFnLCAyKSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZiB0aGVyZSB3YXMgb25seSBvbmUgdGFnIGluIHRoZSBmaWxlLCBpZiBzbywgZG9uJ3QgcmVzdG9yZSBiYWNrdXA7XG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogRmlsZSBjaGFuZ2UgZXJyb3IuJyk7XG5cdFx0XHRcdG5ld0NvbnRlbnQgPSBmaWxlQ29udGVudEJhY2t1cDtcblx0XHRcdH0gZWxzZSBpZiAobmV3Q29udGVudCA9PSAnJyAmJiBzYWZlVG9FbXB0eUZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBUYWcgcmVtb3ZlZC4gVGhlIGZpbGUgaXMgZW1wdHkuJyk7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xuXG5cdFx0XHRcdC8vIFdoZW4gZWRpdGluZyBjb250ZW50IGluIHRoZSBhY3RpdmUgbm90ZSwgaXQncyByZWNvbW1lbmRlZCB0byBub3QgdXNlIHRoZSBtb2RpZnkgYmVjYXVzZSB0aGUgZm9sZHMgYW5kIG90aGVyIHN0YXRlIHN0dWZmIGlzIGxvc3Rcblx0XHRcdFx0Ly8gc2VlIHRoaXMgbGluazogaHR0cHM6Ly9kb2NzLm9ic2lkaWFuLm1kL1BsdWdpbnMvRWRpdG9yL0VkaXRvclxuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXG5cdFx0XHRcdHRyeSB7XG5cblx0XHRcdFx0XHRjb25zdCBiYWNrdXBGaWxlTmFtZSA9IFN0cmluZyhmaWxlLm5hbWUuc3Vic3RyaW5nKDAsIGZpbGUubmFtZS5pbmRleE9mKCcubWQnKSkgKyAnIEJBQ0tVUC5tZCcpO1xuXHRcdFx0XHRcdHZhdWx0LmNyZWF0ZSgnJywgYmFja3VwRmlsZU5hbWUsIGZpbGVDb250ZW50QmFja3VwKTtcblxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeSBub3RlIGVkaXRpbmcgZXJyb3I6ICcgKyBlcnJvci5tZXNzYWdlICsgJ1xcbicgKyBiYWNrdXBGaWxlTmFtZSArICcgc2F2ZWQgdG8gdmF1bHQgcm9vdC4nKTtcblx0XHRcdFx0XG5cdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmaWxlQ29udGVudEJhY2t1cCk7XG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5IG5vdGUgZWRpdGluZyBlcnJvcjogJyArIGVycm9yLm1lc3NhZ2UgKyAnXFxuTm90ZSBjb250ZW50IGNvcGllZCB0byBjbGlwYm9hcmQuJyk7XG5cblx0XHRcdFx0fVxuXHRcdFx0fSBcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5IGVycm9yOiBDYW5cXCd0IGlkZW50aWZ5IHRhZyBsb2NhdGlvbi4nKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyByZWFkRmlsZXMobGlzdEZpbGVzOiBURmlsZVtdKTogUHJvbWlzZTxbVEZpbGUsIHN0cmluZ11bXT4ge1xuXHRcdGxldCBsaXN0OiBbVEZpbGUsIHN0cmluZ11bXSA9IFtdO1xuXHRcdGZvciAobGV0IHQgPSAwOyB0IDwgbGlzdEZpbGVzLmxlbmd0aDsgdCArPSAxKSB7XG5cdFx0XHRjb25zdCBmaWxlID0gbGlzdEZpbGVzW3RdO1xuXHRcdFx0bGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuXHRcdFx0bGlzdC5wdXNoKFtmaWxlLCBjb250ZW50XSk7XG5cdFx0fVxuXHRcdHJldHVybiBsaXN0O1xuXHR9XG5cblx0aXNWYWxpZFRleHQobGlzdFRhZ3M6IHN0cmluZ1tdLCB0YWdzOiBzdHJpbmdbXSwgaW5jbHVkZTogc3RyaW5nW10sIGV4Y2x1ZGU6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG5cdFx0bGV0IHZhbGlkID0gdHJ1ZTtcblxuXHRcdC8vIENoZWNrIE9SICh0YWdzKVxuXHRcdGlmICh0YWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhbGlkID0gdmFsaWQgJiYgdGFncy5zb21lKCh2YWx1ZSkgPT4gbGlzdFRhZ3MuaW5jbHVkZXModmFsdWUpKTtcblx0XHR9XG5cdFx0Ly8gQ2hlY2sgQU5EIChpbmNsdWRlKVxuXHRcdGlmIChpbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhbGlkID0gdmFsaWQgJiYgaW5jbHVkZS5ldmVyeSgodmFsdWUpID0+IGxpc3RUYWdzLmluY2x1ZGVzKHZhbHVlKSk7XG5cdFx0fVxuXHRcdC8vIENoZWNrIE5PVCAoZXhjbHVkZSlcblx0XHRpZiAodmFsaWQgJiYgZXhjbHVkZS5sZW5ndGggPiAwKSB7XG5cdFx0XHR2YWxpZCA9ICFleGNsdWRlLnNvbWUoKHZhbHVlKSA9PiBsaXN0VGFncy5pbmNsdWRlcyh2YWx1ZSkpO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsaWQ7XHRcdFxuXHR9XG5cblx0YXN5bmMgdmFsaWRhdGVGaWxlUGF0aCAoZmlsZVBhdGgpIHtcblx0XHRjb25zdCBtYXRjaGluZ0ZpbGVzID0gYXdhaXQgYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5uYW1lID09PSBmaWxlUGF0aCk7XG5cdFx0aWYgKG1hdGNoaW5nRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRjb25zdCBmaWxlUGF0aCA9IG1hdGNoaW5nRmlsZXNbMF0ucGF0aDtcblx0XHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnVmFsaWRhdGUgZmlsZTogJyArIGVtYmVkRmlsZS5uYW1lKTtcblx0XHRcdHJldHVybiBmaWxlO1xuXHRcdH0gZWxzZSBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IE11bHRpcGxlIGZpbGVzIGZvdW5kIHdpdGggdGhlIHNhbWUgbmFtZS4gQ2FuXFwndCBzYWZlbHkgZWRpdCB0YWcuJyk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBObyBmaWxlIGZvdW5kLiBUcnkgYWdhaW4sIG9yIHRoaXMgdGFnIG1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIGVtYmVkIHR5cGUuJyk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRjb250ZW50Q2hhbmdlZFRvb011Y2gob3JpZ2luYWwsIG1vZGlmaWVkLCB0YWcsIGJ1ZmZlciA9IDUpIHtcblx0ICBjb25zdCBleHBlY3RlZENoYW5nZSA9IHRhZy5sZW5ndGg7IC8vIGluY2x1ZGluZyB0aGUgJyMnIHN5bWJvbFxuXHQgIGNvbnN0IHRocmVzaG9sZCA9IGV4cGVjdGVkQ2hhbmdlICsgYnVmZmVyOyAvLyBhbGxvdyBmb3Igc29tZSBtaW5vciB1bmludGVuZGVkIG1vZGlmaWNhdGlvbnNcblx0ICBjb25zdCBhY3R1YWxDaGFuZ2UgPSBNYXRoLmFicyhvcmlnaW5hbC5sZW5ndGggLSBtb2RpZmllZC5sZW5ndGgpO1xuXG5cdCAgcmV0dXJuIGFjdHVhbENoYW5nZSA+IHRocmVzaG9sZDtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0Y2xlYW5TdHJpbmcoaW5wdXQpIHtcblx0XHRsZXQgY2xlYW5lZFN0cjtcblxuXHRcdC8vIENoZWNrIGlmIGlucHV0IGlzIGEgRE9NIGVsZW1lbnRcblx0XHRpZiAoaW5wdXQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdpbnB1dCBpczogRWxlbWVudCcpO1xuXHRcdFx0Y2xlYW5lZFN0ciA9IGlucHV0Lm91dGVySFRNTC50cmltKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vY29uc29sZS5sb2coJ2lucHV0IGlzOiBTdHJpbmcnKTtcblx0XHRcdGNsZWFuZWRTdHIgPSBpbnB1dC50cmltKCk7XG5cdFx0fVxuXG5cdFx0Ly8gV2hpdGVzcGFjZSBub3JtYWxpemF0aW9uXG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC9cXHMrL2csICcgJyk7XG5cblx0XHQvLyBSZW1vdmUgPGJyPiBlbGVtZW50c1xuXHRcdC8vY2xlYW5lZFN0ciA9IGNsZWFuZWRTdHIucmVwbGFjZSgvPGJyPi9nLCAnICcpO1xuXG5cdFx0Ly8gUmVtb3ZlIGJsb2NrcXVvdGUgdGFncyBidXQga2VlcCB0aGVpciBjb250ZW50XG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC88XFwvP2Jsb2NrcXVvdGU+L2csICcnKTtcblxuXHRcdC8vIFJlbW92ZSBibG9ja3F1b3RlIHRhZ3MgYnV0IGtlZXAgdGhlaXIgY29udGVudFxuXHRcdC8vY2xlYW5lZFN0ciA9IGNsZWFuZWRTdHIucmVwbGFjZSgvPFxcLz9kaXY+L2csICcnKTtcblxuXHRcdC8vIFJlbW92ZSBzcGFjZXMgYmV0d2VlbiB0YWdzXG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC8+XFxzKzwvZywgJz48Jyk7XG5cblx0XHQvLyBXaGl0ZXNwYWNlIG5vcm1hbGl6YXRpb25cblx0XHRjbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC9cXHMrL2csICcgJyk7XG5cblx0XHQvLyBIVE1MIGVudGl0eSBkZWNvZGluZ1xuXHRcdGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcblx0XHR0ZXh0QXJlYS5pbm5lckhUTUwgPSBjbGVhbmVkU3RyO1xuXHRcdGNsZWFuZWRTdHIgPSB0ZXh0QXJlYS52YWx1ZS50cmltKCk7XG5cblx0XHQvLyBPcHRpb25hbDogY29udmVydCB0byBsb3dlcmNhc2Vcblx0XHQvLyBjbGVhbmVkU3RyID0gY2xlYW5lZFN0ci50b0xvd2VyQ2FzZSgpO1xuXG5cdFx0cmV0dXJuIGNsZWFuZWRTdHI7XG5cdH1cblxuXHRhc3luYyByZWZyZXNoVmlldyAoKXtcblx0XHQvL2NvbnNvbGUubG9nKCdSZWZyZXNoIHZpZXcuJyk7XG5cdFx0bmV3IE5vdGljZSAoJ1JlZnJlc2ggdmlldy4nKTtcblx0XHQvLyBpZiB1c2luZyByZXJlbmRlcixcblx0XHQvL2NvbnN0IHNjcm9sbFN0YXRlID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KT8uY3VycmVudE1vZGU/LmdldFNjcm9sbCgpO1xuXHRcdC8vYXdhaXQgdmlldy5wcmV2aWV3TW9kZS5yZXJlbmRlcih0cnVlKTtcblxuXHRcdGF3YWl0IGFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi5yZWJ1aWxkVmlldygpO1xuXHRcdC8vIG9ubHkgbmVlZGVkIGlmIHdlIHVzZSByZXJlbmRlciBhYm92ZS4gZG8gdGhpcyBvbiBhIHRpbWVvdXRcblx0XHQvL3RoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldykucHJldmlld01vZGUuYXBwbHlTY3JvbGwoc2Nyb2xsU3RhdGUpO1xuXHR9XG5cblx0Ly8vLy8vLy8vLy8vLy8vLyBDVVNUT00gVEFHLVNVTU1BUlkgSU1QTEVNRU5UQVRJT04gLy8vLy8vLy8vLy8vLy9cblx0Ly8gT1JJR0lOQUwgQ09ERSBCWSBodHRwczovL2dpdGh1Yi5jb20vbWFjcm9qZC90YWctc3VtbWFyeSAvLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0YXN5bmMgc3VtbWFyeUNvZGVCbG9ja1Byb2Nlc3NvciAoc291cmNlLCBlbCwgY3R4KSB7XG5cdFx0Ly8gSW5pdGlhbGl6ZSB0YWcgbGlzdFxuXHRcdGxldCB0YWdzOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IGluY2x1ZGU6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgZXhjbHVkZTogc3RyaW5nW10gPSBBcnJheSgpO1xuXG5cdFx0Ly8gUHJvY2VzcyByb3dzIGluc2lkZSBjb2RlYmxvY2tcblx0XHRjb25zdCByb3dzID0gc291cmNlLnNwbGl0KFwiXFxuXCIpLmZpbHRlcigocm93KSA9PiByb3cubGVuZ3RoID4gMCk7XG5cdFx0cm93cy5mb3JFYWNoKChsaW5lKSA9PiB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgdGhlIHRhZ3MgKE9SKVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqdGFnczpbXFxwe0x9MC05X1xcLS8jIF0rJC9ndSkpIHtcblx0XHRcdFx0Y29uc3QgY29udGVudCA9IGxpbmUucmVwbGFjZSgvXlxccyp0YWdzOi8sIFwiXCIpLnRyaW0oKTtcblxuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2YgdmFsaWQgdGFncyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIHRhZ3MgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubWFwKCh0YWcpID0+IHRhZy50cmltKCkpO1xuXHRcdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoKHRhZykgPT4ge1xuXHRcdFx0XHRcdGlmICh0YWcubWF0Y2goL14jW1xccHtMfV0rW14jXSokL3UpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdHRhZ3MgPSBsaXN0O1xuXHRcdFx0fVxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIHRvIGluY2x1ZGUgKEFORClcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKmluY2x1ZGU6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqaW5jbHVkZTovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBpbmNsdWRlIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpbmNsdWRlID0gbGlzdDtcblx0XHRcdH1cblx0XHRcdC8vIENoZWNrIGlmIHRoZSBsaW5lIHNwZWNpZmllcyB0aGUgdGFncyB0byBleGNsdWRlIChOT1QpXG5cdFx0XHRpZiAobGluZS5tYXRjaCgvXlxccypleGNsdWRlOltcXHB7TH0wLTlfXFwtLyMgXSskL2d1KSkge1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gbGluZS5yZXBsYWNlKC9eXFxzKmV4Y2x1ZGU6LywgXCJcIikudHJpbSgpO1xuXG5cdFx0XHRcdC8vIEdldCB0aGUgbGlzdCBvZiB2YWxpZCB0YWdzIGFuZCBhc3NpZ24gdGhlbSB0byB0aGUgZXhjbHVkZSB2YXJpYWJsZVxuXHRcdFx0XHRsZXQgbGlzdCA9IGNvbnRlbnQuc3BsaXQoL1xccysvKS5tYXAoKHRhZykgPT4gdGFnLnRyaW0oKSk7XG5cdFx0XHRcdGxpc3QgPSBsaXN0LmZpbHRlcigodGFnKSA9PiB7XG5cdFx0XHRcdFx0aWYgKHRhZy5tYXRjaCgvXiNbXFxwe0x9XStbXiNdKiQvdSkpIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0ZXhjbHVkZSA9IGxpc3Q7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBDcmVhdGUgc3VtbWFyeSBvbmx5IGlmIHRoZSB1c2VyIHNwZWNpZmllZCBzb21lIHRhZ3Ncblx0XHRpZiAodGFncy5sZW5ndGggPiAwIHx8IGluY2x1ZGUubGVuZ3RoID4gMCkge1xuXHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVTdW1tYXJ5KGVsLCB0YWdzLCBpbmNsdWRlLCBleGNsdWRlLCBjdHguc291cmNlUGF0aCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3JlYXRlRW1wdHlTdW1tYXJ5KGVsKTtcblx0XHR9IFxuXHR9OyBcblxuXHRjcmVhdGVFbXB0eVN1bW1hcnkoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbChcImRpdlwiKTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKCdjbGFzcycsICdzdW1tYXJ5Jyk7XG5cdFx0Y29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7XG5cdFx0XHRhdHRyOiB7IHN0eWxlOiAnY29sb3I6IHZhcigtLXRleHQtZXJyb3IpICFpbXBvcnRhbnQ7JyB9LFxuXHRcdFx0dGV4dDogXCJUaGVyZSBhcmUgbm8gZmlsZXMgd2l0aCBibG9ja3MgdGhhdCBtYXRjaCB0aGUgc3BlY2lmaWVkIHRhZ3MuXCIgXG5cdFx0fSk7XG5cdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChjb250YWluZXIpO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlU3VtbWFyeShlbGVtZW50OiBIVE1MRWxlbWVudCwgdGFnczogc3RyaW5nW10sIGluY2x1ZGU6IHN0cmluZ1tdLCBleGNsdWRlOiBzdHJpbmdbXSwgZmlsZVBhdGg6IHN0cmluZykge1xuXHRcdFxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdGNvbnN0IHZhbGlkVGFncyA9IHRhZ3MuY29uY2F0KGluY2x1ZGUpOyAvLyBBbGwgdGhlIHRhZ3Mgc2VsZWN0ZWQgYnkgdGhlIHVzZXJcblx0XHRjb25zdCB0ZW1wQ29tcG9uZW50ID0gbmV3IFRlbXBDb21wb25lbnQoKTtcblx0XHRjb25zdCBzdW1tYXJ5Q29udGFpbmVyID0gY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3N1bW1hcnknKTtcblx0XHRcblx0XHQvLyBHZXQgZmlsZXNcblx0XHRsZXQgbGlzdEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdFx0Ly8gRmlsdGVyIGZpbGVzXG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLmZpbHRlcigoZmlsZSkgPT4ge1xuXHRcdFx0Ly8gUmVtb3ZlIGZpbGVzIHRoYXQgZG8gbm90IGNvbnRhaW4gdGhlIHRhZ3Mgc2VsZWN0ZWQgYnkgdGhlIHVzZXJcblx0XHRcdGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0Y29uc3QgdGFnc0luRmlsZSA9IGdldEFsbFRhZ3MoY2FjaGUpO1xuXG5cdFx0XHRpZiAodmFsaWRUYWdzLnNvbWUoKHZhbHVlKSA9PiB0YWdzSW5GaWxlLmluY2x1ZGVzKHZhbHVlKSkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG5cdFx0Ly8gU29ydCBmaWxlcyBhbHBoYWJldGljYWxseVxuXHRcdC8vIGNoYW5nZSB0byBzb3J0IGJ5IGxhc3QgbW9kaWZpZWQ/XG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdFx0aWYgKGZpbGUxLnBhdGggPCBmaWxlMi5wYXRoKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoZmlsZTEucGF0aCA+IGZpbGUyLnBhdGgpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIEdldCBmaWxlcyBjb250ZW50XG5cdFx0bGV0IGxpc3RDb250ZW50czogW1RGaWxlLCBzdHJpbmddW10gPSBhd2FpdCB0aGlzLnJlYWRGaWxlcyhsaXN0RmlsZXMpO1xuXG5cdFx0Ly8gQ3JlYXRlIHN1bW1hcnlcblx0XHRsZXQgc3VtbWFyeTogc3RyaW5nID0gXCJcIjtcblx0XHRsaXN0Q29udGVudHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXG5cdFx0XHQvLyBHZXQgZmlsZXMgbmFtZVxuXHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBpdGVtWzBdLm5hbWUucmVwbGFjZSgvLm1kJC9nLCBcIlwiKTtcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gaXRlbVswXS5wYXRoO1xuXHRcdFx0XG5cdFx0XHQvLyBEbyBub3QgYWRkIHRoaXMgaXRlbSBpZiBpdCdzIGluIHRoZSBzYW1lIGZpbGUgd2UncmUgY3JlYXRpbmcgdGhlIHN1bW1hcnlcblx0XHRcdGlmIChhY3RpdmVGaWxlLm5hbWUgPT0gaXRlbVswXS5uYW1lKSB7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coJ3NhbWUgZmlsZScpXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0IHBhcmFncmFwaHNcblx0XHRcdGxldCBsaXN0UGFyYWdyYXBoczogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdFx0Y29uc3QgYmxvY2tzID0gaXRlbVsxXS5zcGxpdCgvXFxuXFxzKlxcbi8pLmZpbHRlcigocm93KSA9PiByb3cudHJpbSgpLmxlbmd0aCA+IDApO1xuXG5cdFx0XHQvLyBHZXQgbGlzdCBpdGVtc1xuXHRcdFx0YmxvY2tzLmZvckVhY2goKHBhcmFncmFwaCkgPT4ge1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHBhcmFncmFwaCBpcyBhbm90aGVyIHBsdWdpblxuXHRcdFx0XHRsZXQgdmFsaWQgPSBmYWxzZTtcblx0XHRcdFx0bGV0IGxpc3RUYWdzID0gcGFyYWdyYXBoLm1hdGNoKC8jW1xccHtMfTAtOV9cXC0vI10rL2d1KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChsaXN0VGFncyAhPSBudWxsICYmIGxpc3RUYWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCdwYXJhZ3JhcGguY29udGFpbnMoXCJgYGBcIikgOiAnICsgcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpKVxuXHRcdFx0XHRcdGlmICghcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpKSB7XG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKGluY2x1ZGUpXG5cdFx0XHRcdFx0XHR2YWxpZCA9IHRoaXMuaXNWYWxpZFRleHQobGlzdFRhZ3MsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUpO1xuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh2YWxpZClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSZW1vdmVkIGxpc3QgcGFyYWdyYXBocyBmdW5jdGlvbmFsaXR5XG5cdFx0XHRcdGlmICh2YWxpZCkge1xuXG5cdFx0XHRcdFx0Ly8gQWRkIHBhcmFncmFwaHMgYW5kIHRoZSBpdGVtcyBvZiBhIGxpc3Rcblx0XHRcdFx0XHRsZXQgbGlzdEl0ZW1zOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0XHRcdFx0bGV0IGl0ZW1UZXh0ID0gXCJcIjtcblxuXHRcdFx0XHRcdHBhcmFncmFwaC5zcGxpdCgnXFxuXFxzKlxcbicpLmZvckVhY2goKGxpbmUpID0+IHtcblx0XHRcdFx0XHRcdGxldCBpc0xpc3QgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGlzTGlzdCA9IGxpbmUuc2VhcmNoKC8oXFxzKltcXC1cXCtcXCpdKXsxfXwoWzAtOV1cXC4pezF9XFxzKy8pICE9IC0xXG5cblx0XHRcdFx0XHRcdGlmICghaXNMaXN0KSB7XG5cdFx0XHRcdFx0XHRcdC8vIEFkZCBub3JtYWwgcGFyYWdyYXBoc1xuXHRcdFx0XHRcdFx0XHRsaXN0UGFyYWdyYXBocy5wdXNoKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpdGVtVGV4dCA9IFwiXCI7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRsaW5lLnNwbGl0KCdcXG4nKS5mb3JFYWNoKChpdGVtTGluZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdC8vIEdldCB0aGUgaXRlbSdzIGxldmVsXG5cdFx0XHRcdFx0XHRcdFx0bGV0IGxldmVsID0gMDtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBlbmRJbmRleCA9IGl0ZW1MaW5lLnNlYXJjaCgvW1xcLVxcK1xcKl17MX18KFswLTldXFwuKXsxfVxccysvKTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB0YWJUZXh0ID0gaXRlbUxpbmUuc2xpY2UoMCwgZW5kSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHRhYnMgPSB0YWJUZXh0Lm1hdGNoKC9cXHQvZyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRhYnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldmVsID0gdGFicy5sZW5ndGg7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdC8vIEdldCBpdGVtcyB0cmVlXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGxldmVsID09IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpdGVtVGV4dCAhPSBcIlwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpc3RJdGVtcy5wdXNoKGl0ZW1UZXh0KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aXRlbVRleHQgPSBcIlwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbVRleHQgPSBcIlwiICsgaXRlbVRleHQuY29uY2F0KGl0ZW1MaW5lICsgXCJcXG5cIik7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBSZW1vdmVkIGluY2x1ZGUgY2hpbGRyZW4gc2V0dGluZ1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobGV2ZWwgPiAwICYmIGl0ZW1UZXh0ICE9IFwiXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGl0ZW1UZXh0ID0gaXRlbVRleHQuY29uY2F0KGl0ZW1MaW5lICsgXCJcXG5cIik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChpdGVtVGV4dCAhPSBcIlwiKSB7XG5cdFx0XHRcdFx0XHRsaXN0SXRlbXMucHVzaChpdGVtVGV4dCk7XG5cdFx0XHRcdFx0XHRpdGVtVGV4dCA9IFwiXCI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgdGFncyBvbiB0aGUgaXRlbXNcblx0XHRcdFx0XHRsaXN0SXRlbXMuZm9yRWFjaCgobGluZSkgPT4ge1xuXHRcdFx0XHRcdFx0bGlzdFRhZ3MgPSBsaW5lLm1hdGNoKC8jW1xccHtMfTAtOV9cXC0vI10rL2d1KTtcblx0XHRcdFx0XHRcdGlmIChsaXN0VGFncyAhPSBudWxsICYmIGxpc3RUYWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuaXNWYWxpZFRleHQobGlzdFRhZ3MsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0bGlzdFBhcmFncmFwaHMucHVzaChsaW5lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fSlcblxuXHRcdFx0Ly8gUHJvY2VzcyBlYWNoIGJsb2NrIG9mIHRleHRcblx0XHRcdGxpc3RQYXJhZ3JhcGhzLmZvckVhY2goYXN5bmMocGFyYWdyYXBoKSA9PiB7XG5cdFx0XHRcdC8vIFJlc3RvcmUgbmV3bGluZSBhdCB0aGUgZW5kXG5cdFx0XHRcdHBhcmFncmFwaCArPSBcIlxcblwiO1xuXHRcdFx0XHR2YXIgcmVnZXggPSBuZXcgUmVnRXhwO1xuXG5cdFx0XHRcdC8vIENoZWNrIHdoaWNoIHRhZyBtYXRjaGVzIGluIHRoaXMgcGFyYWdyYXBoLlxuXHRcdFx0XHR2YXIgdGFnVGV4dCA9IG5ldyBTdHJpbmc7XG5cdFx0XHRcdHZhciB0YWdTZWN0aW9uID0gbnVsbDtcblx0XHRcdFx0dGFncy5mb3JFYWNoKCh0YWcpID0+IHtcblx0XHRcdFx0XHR0YWdUZXh0ID0gdGFnLnJlcGxhY2UoJyMnLCAnXFxcXCMnKTtcblx0XHRcdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoYCR7dGFnVGV4dH0oXFxcXFd8JClgLCAnZycpO1xuICAgICAgICAgICAgICBcdFx0aWYgKHBhcmFncmFwaC5tYXRjaChyZWdleCkgIT0gbnVsbCkgeyBcbiAgICAgICAgICAgICAgXHRcdFx0dGFnU2VjdGlvbiA9IHRhZ1xuICAgICAgICAgICAgICBcdFx0fSBcbiAgICAgICAgICAgIFx0fSk7XG5cblx0XHRcdFx0Ly8gUG9zc2libGUgQnV0dG9uIGFuZCBRdWlja0FkZCBQbHVnaW4gdXNhZ2Vcblx0XHRcdFx0Ly8gcGFyYWdyYXBoICs9ICdgYGBidXR0b25cXG5uYW1lIENvcHkgdG8gJyArIHRhZ1NlY3Rpb24ucmVwbGFjZSgnIycsICcnKSArICcgc2VjdGlvblxcbnR5cGUgY29tbWFuZFxcbmFjdGlvbiBRdWlja0FkZDogUGFzdGUgQ2xpcGJvYXJkIFRleHRcXG5gYGAnXG5cblx0XHRcdFx0Ly8gQWRkIGxpbmsgdG8gb3JpZ2luYWwgbm90ZS4gVGFnIEJ1ZGR5IGFkZGVkIGRlZXAgbGlua2luZy5cblx0XHRcdFx0bGV0IGJsb2NrTGluayA9IHBhcmFncmFwaC5tYXRjaCgvXFxeW1xccHtMfTAtOV9cXC0vXl0rL2d1KTsgXG4gICAgICAgIFx0XHRpZiAoYmxvY2tMaW5rKSB7IFxuICAgICAgICBcdFx0XHRwYXJhZ3JhcGggPSBcIioqW1tcIiArIGZpbGVQYXRoICsgXCIjXCIgKyBibG9ja0xpbmsgKyBcInxcIiArIGZpbGVOYW1lICsgXCJdXSoqXFxuXCIgKyBwYXJhZ3JhcGg7IFxuICAgICAgICBcdFx0fSBlbHNlIHsgXG4gICAgICAgIFx0XHRcdHBhcmFncmFwaCA9IFwiKipbW1wiICsgZmlsZVBhdGggKyBcInxcIiArIGZpbGVOYW1lICsgXCJdXSoqXFxuXCIgKyBwYXJhZ3JhcGg7IFxuICAgICAgICBcdFx0fVxuXG4gICAgICAgIFx0XHQvLyBPcmlnaW5hbCBmb3JtYXR0aW5nIG1ldGhvZC4gV2lsbCByZW1vdmUuXG4gICAgICAgICAgICBcdHBhcmFncmFwaCArPSBcIlxcblxcblwiO1xuICAgICAgICAgIFx0XHRzdW1tYXJ5ICs9IHBhcmFncmFwaDtcblxuICAgICAgICAgIFx0XHQvLyBUYWcgQnVkZHkgYWRkZWQgY3VzdG9tIGZvcm1hdHRpbmcgZm9yIHRhZyBlZGl0aW5nIGZ1bmN0aW9uYWxpdHkuIEZpeGVkIGNvbXBvbmVudCBlcnJvci5cbiAgICAgICAgICBcdFx0Y29uc3QgcGFyYWdyYXBoQ29udGVudCA9IGNyZWF0ZUVsKFwiYmxvY2txdW90ZVwiKTtcblx0XHRcdFx0cGFyYWdyYXBoQ29udGVudC5zZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJywgZmlsZVBhdGgpO1xuICAgICAgICAgIFx0XHRhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKHBhcmFncmFwaCwgcGFyYWdyYXBoQ29udGVudCwgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZUZpbGUoKT8ucGF0aCwgdGVtcENvbXBvbmVudCk7XG4gICAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQocGFyYWdyYXBoQ29udGVudCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBTdW1tYXJ5XG5cdFx0aWYgKHN1bW1hcnkgIT0gXCJcIikge1xuXHRcdFx0Ly8gT3JpZ2luYWwgZm9ybWF0dGluZyBtZXRob2QuIFdpbGwgcmVtb3ZlLlxuXHRcdFx0Ly8gYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihzdW1tYXJ5LCBzdW1tYXJ5Q29udGFpbmVyLCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpPy5wYXRoLCB0ZW1wQ29tcG9uZW50KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncycsIHRhZ3Muam9pbignLCcpKTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJywgKChpbmNsdWRlLmxlbmd0aD4wKT9pbmNsdWRlLmpvaW4oJywnKTonJykpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzLWV4Y2x1ZGUnLCAoKGV4Y2x1ZGUubGVuZ3RoPjApP2V4Y2x1ZGUuam9pbignLCcpOicnKSk7XG5cdFx0XHRlbGVtZW50LnJlcGxhY2VXaXRoKHN1bW1hcnlDb250YWluZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNyZWF0ZUVtcHR5U3VtbWFyeShlbGVtZW50KTtcblx0XHR9XG5cdH1cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxufVxuXG5jbGFzcyBUZW1wQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblx0b25sb2FkKCkge31cblx0b251bmxvYWQoKSB7fVxufVxuXG5jbGFzcyBEb3VibGVUYXBIYW5kbGVyIHtcbiAgY29uc3RydWN0b3IocGx1Z2luLCBlbGVtZW50LCBjYWxsYmFjaykge1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luOyAvLyBTdG9yZSB0aGUgcGx1Z2luIGluc3RhbmNlXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5sYXN0VGFwID0gMDtcbiAgICAvL25ldyBOb3RpY2UoJ2RvdWJsZSB0YXAgY3JlYXRlZCcpXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudCh0aGlzLmVsZW1lbnQsICd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlVG91Y2hFbmQuYmluZCh0aGlzKSwgdHJ1ZSk7XG4gIH1cblxuICBoYW5kbGVUb3VjaEVuZChldmVudCkge1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgdGFwTGVuZ3RoID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUYXA7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgXG4gICAgaWYgKHRhcExlbmd0aCA8IDUwMCAmJiB0YXBMZW5ndGggPiAwKSB7XG4gICAgICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvL2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgLy9uZXcgTm90aWNlKCdkb3VibGUgdGFwIGZpcmVkJyk7XG4gICAgICB0aGlzLmNhbGxiYWNrKGV2ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgfSwgNTAwKTtcbiAgICB9XG4gICAgdGhpcy5sYXN0VGFwID0gY3VycmVudFRpbWU7XG4gIH1cbn1cblxuY2xhc3MgUHJlc3NBbmRIb2xkSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKHBsdWdpbiwgZWxlbWVudCwgY2FsbGJhY2ssIGR1cmF0aW9uID0gNjAwKSB7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOyAvLyBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMgdG8gY29uc2lkZXIgYXMgXCJob2xkXCJcbiAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuXG4gICAgLy9uZXcgTm90aWNlICgncHJlc3NBbmRIb2xkIGNyZWF0ZWQuJylcblxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQodGhpcy5lbGVtZW50LCAndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlVG91Y2hTdGFydC5iaW5kKHRoaXMpLCB0cnVlKTtcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KHRoaXMuZWxlbWVudCwgJ3RvdWNoZW5kJywgdGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLCB0cnVlKTtcbiAgfVxuXG4gIGhhbmRsZVRvdWNoU3RhcnQoZXZlbnQpIHtcbiAgICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy9ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBcdC8vbmV3IE5vdGljZSAoJ3ByZXNzQW5kSG9sZCBldmVudCBmaXJlZC4nKVxuICAgICAgdGhpcy5jYWxsYmFjayhldmVudCk7XG4gICAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuICAgIH0sIHRoaXMuZHVyYXRpb24pO1xuICB9XG5cbiAgaGFuZGxlVG91Y2hFbmQoZXZlbnQpIHtcbiAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgIHRoaXMudGltZW91dCA9IG51bGw7XG4gICAgfVxuICB9XG59XG4iLCAiXG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgVEJTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogVGFnQnVkZHk7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUYWdCdWRkeSkge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIk92ZXJyaWRlIG5hdGl2ZSB0YWcgc2VhcmNoIG9uIGNsaWNrXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIG9mZiB0byB1c2UgY21kK2NsaWNrIHRvIHJlbW92ZSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlT25DbGljayA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiQ29udmVydCB0byB0YWcgdGV4dCB3aXRoIG9wdCtjbGljayAocmVtb3ZlcyAjKVwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBvZmYgdG8gdXNlIG9wdCtjbGljayB0byBwZXJmb3JtIG5hdGl2ZSB0YWcgc2VhcmNoLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcHRUb0NvbnZlcnQpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3B0VG9Db252ZXJ0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJSZW1vdmUgY2hpbGQgdGFncyBmaXJzdFwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBvZmYgdG8gdXNlIHNoaWZ0K2NsaWNrIHRvIHJlbW92ZSBjaGlsZCB0YWdzIGZpdHN0LlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiTW9iaWxlIHRhZyBzZWFyY2hcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgb24gdG8gcmVzdG9yZSBtb2JpbGUgbmF0aXZlIHRhZyBzZWFyY2ggb24gdGFwLiBUYWcgcmVtb3ZhbCB3aWxsIHRoZW4gdXNlIHByZXNzK2hvbGQuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlNob3cgbW9iaWxlIG5vdGljZXNcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgb2ZmIHRvIGhpZGUgbm90aWNlcyB3aGVuIGVkaXRpbmcgb3IgcmVtb3ZpbmcgYSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiRGVidWcgbW9kZVwiKVxuICAgICAgICAuc2V0RGVzYyhcIk91dHB1dCB0byBjb25zb2xlLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cbn1cblxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FDRUEsc0JBQStDO0FBRXhDLElBQU0sZ0JBQU4sY0FBNEIsaUNBQWlCO0FBQUEsRUFHaEQsWUFBWUEsTUFBVSxRQUFrQjtBQUNwQyxVQUFNQSxNQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUNBLFVBQWdCO0FBQ1osUUFBSSxFQUFFLFlBQVksSUFBSTtBQUV0QixnQkFBWSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUN0QixRQUFRLHFDQUFxQyxFQUM3QyxRQUFR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QUssT0FBTztBQUFBLE1BQzNCLEdBQUcsR0FBRztBQUFBLElBQ1I7QUFDQSxTQUFLLFVBQVU7QUFBQSxFQUNqQjtBQUNGO0FBRUEsSUFBTSxzQkFBTixNQUEwQjtBQUFBLEVBQ3hCLFlBQVksUUFBUSxTQUFTLFVBQVUsV0FBVyxLQUFLO0FBQ3JELFNBQUssU0FBUztBQUNkLFNBQUssVUFBVTtBQUNmLFNBQUssV0FBVztBQUNoQixTQUFLLFdBQVc7QUFDaEIsU0FBSyxVQUFVO0FBSWYsU0FBSyxPQUFPLGlCQUFpQixLQUFLLFNBQVMsY0FBYyxLQUFLLGlCQUFpQixLQUFLLElBQUksR0FBRyxJQUFJO0FBQy9GLFNBQUssT0FBTyxpQkFBaUIsS0FBSyxTQUFTLFlBQVksS0FBSyxlQUFlLEtBQUssSUFBSSxHQUFHLElBQUk7QUFBQSxFQUM3RjtBQUFBLEVBRUEsaUJBQWlCLE9BQU87QUFHdEIsU0FBSyxVQUFVLFdBQVcsTUFBTTtBQUU5QixXQUFLLFNBQVMsS0FBSztBQUNuQixXQUFLLFVBQVU7QUFBQSxJQUNqQixHQUFHLEtBQUssUUFBUTtBQUFBLEVBQ2xCO0FBQUEsRUFFQSxlQUFlLE9BQU87QUFDcEIsUUFBSSxLQUFLLFNBQVM7QUFDaEIsbUJBQWEsS0FBSyxPQUFPO0FBQ3pCLFdBQUssVUFBVTtBQUFBLElBQ2pCO0FBQUEsRUFDRjtBQUNGOyIsCiAgIm5hbWVzIjogWyJhcHAiLCAiaW1wb3J0X29ic2lkaWFuIiwgImVycm9yIiwgImZpbGVQYXRoIl0KfQo=
