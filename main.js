/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => TagBuddy
});
module.exports = __toCommonJS(main_exports);

// settings.ts
var import_obsidian = require("obsidian");
var TBSettingsTab = class extends import_obsidian.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    new import_obsidian.Setting(containerEl).setName("Override native tag search on click").setDesc("Toggle off to use cmd+click to remove tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeOnClick).onChange(async (value) => {
        this.plugin.settings.removeOnClick = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Convert to tag text with opt+click (removes #)").setDesc("Toggle off to use opt+click to perform native tag search.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.optToConvert).onChange(async (value) => {
        this.plugin.settings.optToConvert = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Remove child tags first").setDesc("Toggle off to use shift+click to remove child tags fitst.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.removeChildTagsFirst).onChange(async (value) => {
        this.plugin.settings.removeChildTagsFirst = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Mobile tag search").setDesc("Toggle on to restore mobile native tag search on tap. Tag removal will then use press+hold.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileTagSearch).onChange(async (value) => {
        this.plugin.settings.mobileTagSearch = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Show mobile notices").setDesc("Toggle off to hide notices when editing or removing a tag.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.mobileNotices).onChange(async (value) => {
        this.plugin.settings.mobileNotices = value;
        await this.plugin.saveSettings();
      })
    );
    new import_obsidian.Setting(containerEl).setName("Debug mode").setDesc("Output to console.").addToggle(
      (toggle) => toggle.setValue(this.plugin.settings.debugMode).onChange(async (value) => {
        this.plugin.settings.debugMode = value;
        await this.plugin.saveSettings();
      })
    );
  }
};

// main.ts
var import_obsidian2 = require("obsidian");
var DEFAULT_SETTINGS = {
  removeOnClick: true,
  // when true, cmd is needed when clicking to remove the tag
  removeChildTagsFirst: true,
  // use shift when false
  optToConvert: true,
  // when false, clicking tag will do nothing
  mobileTagSearch: false,
  // toggle on use double tap for search. press+hold will then remove.
  mobileNotices: true,
  debugMode: false
};
var TagBuddy = class extends import_obsidian2.Plugin {
  onunload() {
  }
  async onload() {
    await this.loadSettings();
    this.addSettingTab(new TBSettingsTab(this.app, this));
    console.log("Tag Buddy Plugin loaded on " + (this.app.isMobile ? "mobile at " : "desktop at ") + new Date().toUTCString().substring(17));
    this.app.workspace.onLayoutReady(async () => {
      setTimeout(async () => {
        this.processTags();
      }, 1e3);
      this.registerEvent(this.app.on("layout-change", (event) => {
        setTimeout(async () => {
          this.processTags();
        }, 300);
      }));
      this.registerEvent(this.app.on("file-open", async (event) => {
        setTimeout(async () => {
          this.processTags();
        }, 1e3);
      }));
      this.injectStyles();
      if (!this.app.isMobile) {
        this.registerDomEvent(document, "click", this.onClickEvent.bind(this), true);
      } else {
        this.registerDomEvent(document, "click", (e) => {
          const isTag = e.target.classList.contains("tag");
          if (isTag && !this.settings.mobileTagSearch) {
            e.stopPropagation();
          }
        }, true);
        new PressAndHoldHandler(this, document, this.onClickEvent.bind(this));
        new DoubleTapHandler(this, document, this.onClickEvent.bind(this));
      }
    });
    this.registerMarkdownCodeBlockProcessor("tag-summary", this.summaryCodeBlockProcessor.bind(this));
  }
  async getClickedWord(e) {
    let x = e.clientX, y = e.clientY;
    let range, textNode, offset;
    if (document.caretRangeFromPoint) {
      range = document.caretRangeFromPoint(x, y);
      textNode = range.startContainer;
      offset = range.startOffset;
    }
    if (textNode && textNode.nodeType === Node.TEXT_NODE) {
      let fullText = textNode.textContent;
      let wordRegex = /[^\s]+(?=[.,:!?]?(\s|$))/g;
      let match;
      let clickedWord = null;
      while ((match = wordRegex.exec(fullText)) !== null) {
        if (match.index <= offset && offset <= match.index + match[0].length) {
          if (!/^[^\p{L}\p{N}]/u.test(match[0]) && // Not starting with any non-alphanumeric
          !/[^\p{L}\p{N}\s.,:!?]/u.test(match[0]) && // Not containing other than allowed chars
          !/[.,:!?](?=[^\s$])/u.test(match[0])) {
            clickedWord = match[0];
            break;
          }
        }
      }
      let activeView = await this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
      let editor = activeView.sourceMode.cmEditor;
      let fullNote = editor.getValue();
      const globalStartPosition = fullNote.indexOf(textNode.textContent);
      if (globalStartPosition !== -1) {
        let wordEndPosition = globalStartPosition + offset;
        while (wordEndPosition > 0 && fullNote[wordEndPosition] !== " " && fullNote[wordEndPosition] !== "\n") {
          wordEndPosition--;
        }
        wordEndPosition++;
        const updatedNote = [fullNote.slice(0, wordEndPosition), "#", fullNote.slice(wordEndPosition)].join("");
        console.log(updatedNote);
      }
    }
  }
  async onClickEvent(event) {
    const target = event.target;
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    if (!view && target.matches(".tag")) {
      new import_obsidian2.Notice("Tag Buddy: Can't edit tag. Unsupported view type. Try again within that note.");
      return;
    }
    if (view) {
      if (view.getMode() != "preview")
        return;
    } else {
    }
    if (!this.app.isMobile) {
      if (this.settings.removeOnClick && this.ctrlCmdKey(event) || !this.settings.removeOnClick && !this.ctrlCmdKey(event)) {
        return;
      } else if (event.altKey && !this.settings.optToConvert) {
        return;
      }
    } else {
      if (this.settings.mobileTagSearch && event.type == "touchend") {
        return;
      }
    }
    if (target && target.matches(".tag")) {
      if (this.settings.removeOnClick || !this.settings.removeOnClick && this.ctrlCmdKey(event)) {
        event.stopPropagation();
        event.preventDefault();
      }
      const clickedTag = target.closest(".tag");
      const tag = clickedTag.innerText;
      let tagIndex = clickedTag.getAttribute("md-index");
      let tagFile = clickedTag.getAttribute("file-source");
      if (tagFile) {
        this.editTag(target, event);
      } else {
        setTimeout(async () => {
          tagIndex = clickedTag.getAttribute("md-index");
          tagFile = clickedTag.getAttribute("file-source");
          this.editTag(target, event);
        }, 300);
      }
    } else if (!view && target.matches(".tag")) {
      new import_obsidian2.Notice("Tag Buddy: Can't edit tag. Might be in an unsupported view type.");
    }
  }
  async editTag(tagEl, event) {
    const index = tagEl.getAttribute("md-index");
    const filePath = tagEl.getAttribute("file-source");
    if (this.settings.debugMode)
      console.log("Tag Buddy edit tag: " + tagEl.innerText + "\nIn file: " + filePath);
    if (filePath) {
      const file = await this.validateFilePath(filePath);
      let fileContent;
      let fileContentBackup;
      const tag = tagEl.innerText.trim();
      try {
        fileContent = await this.app.vault.read(file);
        fileContentBackup = fileContent;
      } catch (error) {
        new import_obsidian2.Notice("Tag Buddy file read error:\n" + error.message);
        return;
      }
      let safeToEmptyFile = false;
      const tagRegex = /^\s*#(\w+)\s*$/;
      if (tagRegex.test(fileContent.trim())) {
        safeToEmptyFile = true;
      }
      let beforeTag = fileContent.substring(0, index);
      let afterTag = fileContent.substring(Number(index) + Number(tag.length) + 1);
      if (fileContent[index] === "\n") {
        beforeTag += "\n";
      }
      let newContent = "";
      if (!event) {
        newContent = beforeTag + afterTag;
      } else if (event.altKey || event.type == "touchstart" && !this.settings.mobileTagSearch) {
        const noHash = tag.substring(1);
        newContent = beforeTag + (!beforeTag.endsWith(" ") ? " " : "") + noHash + afterTag;
        if (this.app.isMobile && this.settings.mobileNotices) {
          new import_obsidian2.Notice("Tag Buddy: " + tag + " converted to text.");
        }
      } else if (event.type == "touchend" || this.settings.mobileTagSearch || this.ctrlCmdKey(event) && !this.settings.removeOnClick || !this.ctrlCmdKey(event) && this.settings.removeOnClick) {
        let parentTag = "";
        if (tag.includes("/") && (this.settings.removeChildTagsFirst || event.shiftKey && !this.settings.removeChildTagsFirst)) {
          let parts = tag.split("/");
          const removedChild = parts.pop();
          parentTag = parts.join("/");
          newContent = beforeTag + (!beforeTag.endsWith(" ") ? " " : "") + parentTag + afterTag;
          if (this.app.isMobile && this.settings.mobileNotices) {
            new import_obsidian2.Notice("Tag Buddy: '" + removedChild + "' removed from parent tag.");
          }
        } else {
          newContent = beforeTag + afterTag;
          if (this.app.isMobile && this.settings.mobileNotices) {
            new import_obsidian2.Notice("Tag Buddy: " + tag + " removed.");
          }
        }
      }
      if (newContent == "" && !safeToEmptyFile || this.contentChangedTooMuch(fileContentBackup, newContent, tag, 2)) {
        new import_obsidian2.Notice("Tag Buddy: File change error.");
        newContent = fileContentBackup;
      } else if (newContent == "" && safeToEmptyFile) {
        new import_obsidian2.Notice("Tag Buddy: Tag removed. The note is empty.");
      }
      try {
        await this.app.vault.modify(file, newContent);
        if (tagEl.getAttribute("type") == "plugin-summary") {
          setTimeout(async () => {
            this.updateSummaryParagraph(tagEl);
            setTimeout(async () => {
              this.processTags();
            }, 200);
          }, 150);
        } else {
          setTimeout(async () => {
            this.processTags();
          }, 50);
        }
      } catch (error) {
        try {
          const backupFileName = String(file.name.substring(0, file.name.indexOf(".md")) + " BACKUP.md");
          vault.create("", backupFileName, fileContentBackup);
          new import_obsidian2.Notice("Tag Buddy note editing error: " + error.message + "\n" + backupFileName + " saved to vault root.");
        } catch (error2) {
          navigator.clipboard.writeText(fileContentBackup);
          new import_obsidian2.Notice("Tag Buddy note editing error: " + error2.message + "\nNote content copied to clipboard.");
        }
      }
    } else {
      new import_obsidian2.Notice("Tag Buddy error: Can't identify tag location.");
    }
  }
  updateSummaryParagraph(tagEl) {
    const summaryContainer = tagEl.closest(".summary");
    const tagsStr = summaryContainer.getAttribute("codeblock-tags");
    const tags = tagsStr ? tagsStr.split(",") : [];
    const tagsIncludeStr = summaryContainer.getAttribute("codeblock-tags-include");
    const tagsInclude = tagsIncludeStr ? tagsIncludeStr.split(",") : [];
    const tagsExcludeStr = summaryContainer.getAttribute("codeblock-tags-exclude");
    const tagsExclude = tagsExcludeStr ? tagsExcludeStr.split(",") : [];
    const sectionsStr = summaryContainer.getAttribute("codeblock-sections");
    const sections = sectionsStr ? sectionsStr.split(",") : [];
    this.createSummary(summaryContainer, tags, tagsInclude, tagsExclude, sections);
  }
  async processTags() {
    if (this.settings.debugMode)
      console.log("Tag Buddy: Processing tags.");
    const view = await this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    const activeNoteContainer = await this.app.workspace.activeLeaf.containerEl;
    const activeFile = await this.app.workspace.getActiveFile();
    const fileContent = await app.vault.read(activeFile);
    const activeFileTagElements = await activeNoteContainer.querySelectorAll(".mod-active .tag:not(.markdown-embed .tag):not(.summary .tag)");
    const activeFileTags = await this.getMarkdownTags(activeFile, fileContent);
    if (activeFileTags.length > 0)
      this.assignMarkdownTags(activeFileTags, activeFileTagElements, 0, "active");
    this.processEmbeds(activeNoteContainer);
  }
  async getMarkdownTags(file, fileContent) {
    const tagPositions = [];
    let match;
    const regex = /(?:^|\s)#[^\s#]+|```/g;
    let insideCodeBlock = false;
    while ((match = regex.exec(fileContent)) !== null) {
      if (match[0].trim() === "```") {
        insideCodeBlock = !insideCodeBlock;
        continue;
      }
      if (insideCodeBlock)
        continue;
      const tag = match[0].trim();
      if (fileContent.slice(match.index, match.index + tag.length + 2).endsWith("]]")) {
        continue;
      }
      tagPositions.push({ tag, index: match.index, source: file.name });
    }
    return tagPositions;
  }
  assignMarkdownTags(tagPositions, tagElements, startIndex, type) {
    let tagEl;
    const tagElArray = Array.from(tagElements);
    let tagElIndex = 0;
    tagPositions.forEach((tagPos, index) => {
      if (tagPositions[index].index >= startIndex) {
        tagEl = tagElArray[tagElIndex];
        if (tagEl) {
          tagEl.setAttribute("md-index", tagPositions[index].index);
          tagEl.setAttribute("file-source", tagPositions[index].source);
          tagEl.setAttribute("type", type);
          tagElIndex++;
        }
      }
    });
    return tagElArray;
  }
  async processEmbeds(element) {
    const embeds = await element.querySelectorAll(".summary, .markdown-embed");
    embeds.forEach(async (embed) => {
      if (embed.classList.contains("summary")) {
        this.processTagSummary(embed);
      } else if (embed.classList.contains("markdown-embed")) {
        this.processNativeEmbed(embed);
        if (Array.from(embed.querySelectorAll(".summary")).length > 0) {
          this.processTagSummary(embed);
        }
      } else {
      }
    });
  }
  async processNativeEmbed(embed) {
    const linkElement = embed.getAttribute("src");
    let filePath = embed.getAttribute("src");
    const linkArray = filePath.split("#");
    filePath = linkArray[0].trim() + ".md";
    const file = await this.validateFilePath(filePath);
    if (file) {
      const fileContent = await app.vault.read(file);
      const embededTagFile = await this.getMarkdownTags(file, fileContent);
      const tempComponent = new TempComponent();
      const tempContainerHTML = createEl("div");
      await import_obsidian2.MarkdownRenderer.renderMarkdown(fileContent, tempContainerHTML, file.path, tempComponent);
      const innerText = embed.querySelector(".markdown-embed-content").innerText;
      const startIndex = tempContainerHTML.innerText.indexOf(innerText);
      this.assignMarkdownTags(embededTagFile, embed.querySelectorAll(".tag"), startIndex, "native-embed");
    }
  }
  async processTagSummary(embed) {
    let summaryBlocks = embed.querySelectorAll("blockquote");
    summaryBlocks.forEach(async (block, index) => {
      var _a, _b;
      const filePath = block.getAttribute("file-source");
      const file = this.app.vault.getAbstractFileByPath(filePath);
      if (file) {
        const fileContent = await app.vault.read(file);
        const embededTagFile = await this.getMarkdownTags(file, fileContent);
        const tempBlock = block.cloneNode(true);
        (_a = tempBlock.querySelector(".tagsummary-item-title")) == null ? void 0 : _a.remove();
        (_b = tempBlock.querySelector(".tagsummary-buttons")) == null ? void 0 : _b.remove();
        const blockText = tempBlock.innerText;
        const startIndex = fileContent.indexOf(blockText);
        this.assignMarkdownTags(embededTagFile, block.querySelectorAll(".tag"), startIndex, "plugin-summary");
      }
    });
  }
  //////////////// CUSTOM TAG-SUMMARY IMPLEMENTATION //////////////
  // ORIGINAL CODE BY https://github.com/macrojd/tag-summary //////
  /////////////////////////////////////////////////////////////////
  async summaryCodeBlockProcessor(source, el, ctx) {
    let tags = Array();
    let include = Array();
    let exclude = Array();
    let sections = Array();
    const rows = source.split("\n").filter((row) => row.length > 0);
    rows.forEach((line) => {
      if (line.match(/^\s*tags:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*tags:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        tags = list;
      }
      if (line.match(/^\s*include:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*include:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        include = list;
      }
      if (line.match(/^\s*exclude:[\p{L}0-9_\-/# ]+$/gu)) {
        const content = line.replace(/^\s*exclude:/, "").trim();
        let list = content.split(/\s+/).map((tag) => tag.trim());
        list = list.filter((tag) => {
          if (tag.match(/^#[\p{L}]+[^#]*$/u)) {
            return true;
          } else {
            return false;
          }
        });
        exclude = list;
      }
      if (line.match(/^\s*sections:[\p{L}0-9_\-/#, ]+$/gu)) {
        const content = line.replace(/^\s*sections:/, "").trim();
        let list = content.split(",").map((sec) => sec.trim());
        sections = list;
      }
    });
    if (tags.length > 0 || include.length > 0) {
      await this.createSummary(el, tags, include, exclude, sections, ctx.sourcePath);
    } else {
      this.createEmptySummary(el);
    }
  }
  createEmptySummary(element) {
    const container = createEl("div");
    container.setAttribute("class", "summary");
    container.createEl("span", {
      attr: { style: "color: var(--text-error) !important;" },
      text: "There are no files with blocks that match the specified tags."
    });
    element.replaceWith(container);
  }
  async createSummary(element, tags, include, exclude, sections, filePath) {
    const activeFile = await this.app.workspace.getActiveFile();
    const validTags = tags.concat(include);
    const tempComponent = new TempComponent();
    const summaryContainer = createEl("div");
    summaryContainer.setAttribute("class", "summary");
    let listFiles = this.app.vault.getMarkdownFiles();
    listFiles = listFiles.filter((file) => {
      const cache = app.metadataCache.getFileCache(file);
      const tagsInFile = (0, import_obsidian2.getAllTags)(cache);
      if (validTags.some((value) => tagsInFile.includes(value))) {
        return true;
      }
      return false;
    });
    listFiles = listFiles.sort((file1, file2) => {
      if (file1.path < file2.path) {
        return -1;
      } else if (file1.path > file2.path) {
        return 1;
      } else {
        return 0;
      }
    });
    let listContents = await this.readFiles(listFiles);
    let summary = "";
    listContents.forEach((item) => {
      const fileName = item[0].name.replace(/.md$/g, "");
      const filePath2 = item[0].path;
      if (activeFile.name == item[0].name) {
        return;
      }
      let listParagraphs = Array();
      const blocks = item[1].split(/\n\s*\n/).filter((row) => row.trim().length > 0);
      blocks.forEach((paragraph) => {
        let valid = false;
        let listTags = paragraph.match(/#[\p{L}0-9_\-/#]+/gu);
        if (listTags != null && listTags.length > 0) {
          if (!paragraph.contains("```")) {
            valid = this.isValidText(listTags, tags, include, exclude);
          }
        }
        if (valid) {
          let listItems = Array();
          let itemText = "";
          paragraph.split("\ns*\n").forEach((line) => {
            let isList = false;
            isList = line.search(/(\s*[\-\+\*]){1}|([0-9]\.){1}\s+/) != -1;
            if (!isList) {
              listParagraphs.push(line);
              itemText = "";
            } else {
              line.split("\n").forEach((itemLine) => {
                let level = 0;
                const endIndex = itemLine.search(/[\-\+\*]{1}|([0-9]\.){1}\s+/);
                const tabText = itemLine.slice(0, endIndex);
                const tabs = tabText.match(/\t/g);
                if (tabs) {
                  level = tabs.length;
                }
                if (level == 0) {
                  if (itemText != "") {
                    listItems.push(itemText);
                    itemText = "";
                  }
                  itemText = "" + itemText.concat(itemLine + "\n");
                } else if (level > 0 && itemText != "") {
                  itemText = itemText.concat(itemLine + "\n");
                }
              });
            }
          });
          if (itemText != "") {
            listItems.push(itemText);
            itemText = "";
          }
          listItems.forEach((line) => {
            listTags = line.match(/#[\p{L}0-9_\-/#]+/gu);
            if (listTags != null && listTags.length > 0) {
              if (this.isValidText(listTags, tags, include, exclude)) {
                listParagraphs.push(line);
              }
            }
          });
        }
      });
      listParagraphs.forEach(async (paragraph) => {
        var _a;
        paragraph += "\n";
        var regex = new RegExp();
        var tagText = new String();
        var tagSection = null;
        tags.forEach((tag) => {
          tagText = tag.replace("#", "\\#");
          regex = new RegExp(`${tagText}(\\W|$)`, "g");
          if (paragraph.match(regex) != null) {
            tagSection = tag;
          }
        });
        const buttonContainer = createEl("div");
        buttonContainer.setAttribute("class", "tagsummary-buttons");
        const paragraphContent = createEl("blockquote");
        paragraphContent.setAttribute("file-source", filePath2);
        const blockLink = paragraph.match(/\^[\p{L}0-9_\-/^]+/gu);
        let link;
        if (blockLink) {
          link = "[[" + filePath2 + "#" + blockLink + "|" + fileName + "]]";
          if (this.app.plugins.getPlugin("quickadd")) {
            let count = 0;
            sections.forEach((sec) => {
              if (count++ > 3)
                return;
              buttonContainer.appendChild(this.makeCopyToButton(paragraph, sec, paragraphContent, tagSection, filePath2 + "#" + blockLink));
            });
          }
          buttonContainer.appendChild(this.makeCopyButton(paragraph.trim()));
          buttonContainer.appendChild(this.makeRemoveTagButton(paragraphContent, tagSection, filePath2 + "#" + blockLink));
        } else {
          link = "[[" + filePath2 + "|" + fileName + "]]";
          if (this.app.plugins.getPlugin("quickadd")) {
            let count = 0;
            sections.forEach((sec) => {
              if (count++ > 3)
                return;
              buttonContainer.appendChild(this.makeCopyToButton(paragraph, sec, paragraphContent, tagSection, filePath2));
            });
          }
          buttonContainer.appendChild(this.makeCopyButton(paragraph.trim()));
          buttonContainer.appendChild(this.makeRemoveTagButton(paragraphContent, tagSection, filePath2));
        }
        paragraph = "**" + link + "**" + paragraph;
        paragraph += "\n\n";
        summary += paragraph;
        await import_obsidian2.MarkdownRenderer.renderMarkdown(paragraph, paragraphContent, (_a = this.app.workspace.getActiveFile()) == null ? void 0 : _a.path, tempComponent);
        const titleEl = createEl("div");
        titleEl.setAttribute("class", "tagsummary-item-title");
        titleEl.appendChild(paragraphContent.querySelector("strong").cloneNode(true));
        paragraphContent.appendChild(buttonContainer);
        paragraphContent.querySelector("strong").replaceWith(titleEl);
        summaryContainer.appendChild(paragraphContent);
      });
    });
    if (summary != "") {
      summaryContainer.setAttribute("codeblock-tags", tags.join(","));
      summaryContainer.setAttribute("codeblock-tags-include", include.length > 0 ? include.join(",") : "");
      summaryContainer.setAttribute("codeblock-tags-exclude", exclude.length > 0 ? exclude.join(",") : "");
      summaryContainer.setAttribute("codeblock-sections", sections.length > 0 ? sections.join(",") : "");
      element.replaceWith(summaryContainer);
    } else {
      this.createEmptySummary(element);
    }
  }
  /////////////////////////////////////////////////////////////////
  /////////////////////////////////////////////////////////////////
  makeCopyToButton(content, section, paragraph, tag, filePath) {
    const quickAddPlugin = this.app.plugins.plugins.quickadd.api;
    const button = this.makeButton(" \u274F   " + section, (e) => {
      e.stopPropagation();
      const sectionElObj = this.getSectionTitleWithHashes(section);
      const contentAsList = "- " + content.trim() + "\n";
      if (sectionElObj) {
        if (e.metaKey) {
          quickAddPlugin.executeChoice("Copy To Section", { section: sectionElObj.md, content: this.removeTagFromString(contentAsList, tag) + "\n" });
          this.editTag(this.getTagElement(paragraph, tag));
          const notice = new import_obsidian2.Notice("Copied to " + section + " and " + tag + " removed.\n\u{1F517} Open source note.", 5e3);
          this.registerDomEvent(notice.noticeEl, "click", (e2) => {
            this.app.workspace.openLinkText(filePath, "");
          });
        } else {
          quickAddPlugin.executeChoice("Copy To Section", { section: sectionElObj.md, content: contentAsList });
          new import_obsidian2.Notice("Copied to " + section + ".");
        }
      } else {
        new import_obsidian2.Notice("Tag Buddy can't find " + section + ". Might not be rendered. Use \u274F to copy paragraph.");
      }
    });
    button.title = "Copy paragraph to " + section + ".\n(CTRL+CLICK to remove tag and copy.";
    return button;
  }
  makeCopyButton(content) {
    const button = this.makeButton(" \u274F ", (e) => {
      e.stopPropagation();
      navigator.clipboard.writeText(content);
      new import_obsidian2.Notice("Copied to clipboard.");
    });
    button.title = "Copy paragraph to clipboard.";
    return button;
  }
  makeRemoveTagButton(paragraph, tag, filePath) {
    const button = this.makeButton(" \u2317\u02E3 ", (e) => {
      e.stopPropagation();
      const notice = new import_obsidian2.Notice("\u{1F516} " + tag + " removed from paragraph.\n\u{1F517} Open source note.", 5e3);
      this.editTag(this.getTagElement(paragraph, tag));
      this.registerDomEvent(notice.noticeEl, "click", (e2) => {
        this.app.workspace.openLinkText(filePath, "");
      });
    });
    button.title = "Remove " + tag + " from paragraph.";
    return button;
  }
  makeButton(lable, clickFn, classId = "tagsummary-button") {
    const button = document.createElement("button");
    button.innerText = lable;
    button.className = classId;
    this.registerDomEvent(button, "click", clickFn.bind(this));
    return button;
  }
  removeTagFromString(inputText, hashtagToRemove) {
    const regex = new RegExp("\\s?" + hashtagToRemove + "\\b", "gi");
    return inputText.replace(regex, "").trim();
  }
  getSectionTitleWithHashes(sectionTitle) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian2.MarkdownView);
    if (!activeView) {
      console.log("No active markdown view found.");
      return null;
    }
    const contentEl = activeView.contentEl;
    const headings = contentEl.querySelectorAll("h1, h2, h3, h4, h5, h6");
    for (const heading of headings) {
      if (heading.textContent.trim() === sectionTitle.trim()) {
        const level = parseInt(heading.tagName.substr(1), 10);
        const hashes = "#".repeat(level);
        return { md: `${hashes} ${sectionTitle}`, el: heading };
      }
    }
    console.log(`Section "${sectionTitle}" not found.`);
    return null;
  }
  async readFiles(listFiles) {
    let list = [];
    for (let t = 0; t < listFiles.length; t += 1) {
      const file = listFiles[t];
      let content = await this.app.vault.cachedRead(file);
      list.push([file, content]);
    }
    return list;
  }
  isValidText(listTags, tags, include, exclude) {
    let valid = true;
    if (tags.length > 0) {
      valid = valid && tags.some((value) => listTags.includes(value));
    }
    if (include.length > 0) {
      valid = valid && include.every((value) => listTags.includes(value));
    }
    if (valid && exclude.length > 0) {
      valid = !exclude.some((value) => listTags.includes(value));
    }
    return valid;
  }
  async validateFilePath(filePath) {
    const matchingFiles = await app.vault.getFiles().filter((file) => file.name === filePath);
    if (matchingFiles.length === 1) {
      const filePath2 = matchingFiles[0].path;
      const file = await this.app.vault.getAbstractFileByPath(filePath2);
      return file;
    } else if (matchingFiles.length > 1) {
      new import_obsidian2.Notice("Tag Buddy: Multiple files found with the same name. Can't safely edit tag.");
      return null;
    } else {
      new import_obsidian2.Notice("Tag Buddy: No file found. Try again, or this tag might be in an unsupported embed type.");
      return null;
    }
  }
  contentChangedTooMuch(original, modified, tag, buffer = 5) {
    const expectedChange = tag.length;
    const threshold = expectedChange + buffer;
    const actualChange = Math.abs(original.length - modified.length);
    return actualChange > threshold;
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // fuck.this.function
  /*cleanString(input) {
  		let cleanedStr;
  
  		// Check if input is a DOM element
  		if (input instanceof Element) {
  			//console.log('input is: Element');
  			cleanedStr = input.outerHTML.trim();
  		} else {
  			//console.log('input is: String');
  			cleanedStr = input.trim();
  		}
  
  		// Whitespace normalization
  		//cleanedStr = cleanedStr.replace(/\s+/g, ' ');
  
  		// Remove <br> elements
  		//cleanedStr = cleanedStr.replace(/<br>/g, ' ');
  
  		// Remove blockquote tags but keep their content
  		//cleanedStr = cleanedStr.replace(/<\/?blockquote>/g, '');
  
  		// Remove blockquote tags but keep their content
  		//cleanedStr = cleanedStr.replace(/<\/?div>/g, '');
  
  		// Remove spaces between tags
  		//cleanedStr = cleanedStr.replace(/>\s+</g, '><');
  
  		// Whitespace normalization
  		cleanedStr = cleanedStr.replace(/\s+/g, ' ');
  
  		// HTML entity decoding
  		const textArea = document.createElement('textarea');
  		textArea.innerHTML = cleanedStr;
  		cleanedStr = textArea.value.trim();
  
  		// Optional: convert to lowercase
  		// cleanedStr = cleanedStr.toLowerCase();
  
  		return cleanedStr;
  	}*/
  async refreshView() {
    new import_obsidian2.Notice("Refresh view.");
    await app.workspace.activeLeaf.rebuildView();
  }
  injectStyles() {
    const styles = `
        .tagsummary-button {

            color: var(--text-primary);
            border: 1px solid var(--text-quote);  // Assuming this is the block quote color
            border-radius: var(--border-radius);
            padding: 2.5px 5px;  // Reduced padding
            font-size: 50%;  // Reduced font size
            transition: background-color 0.3s;
            margin: 0px 3px 0px 0px;
            min-width: 40px !important;

	       color: var(--link-color) !important;
	       border: 1px solid var(--link-color) !important; 
		   background-color: var(--background-primary) !important;
        }

        .tagsummary-button:hover {
            background-color: var(--link-color) !important;
            color: var(--background-secondary) !important;
        }

        .tagsummary-item-title {
            margin: 5px 0px
        }

        .tagsummary-buttons {
            /*float: right;*/
            text-align: right;
        }

	   @media only screen and (max-device-width: 480px), 
	       only screen and (max-width: 480px) and (orientation: landscape),
	       only screen and (max-device-width: 1024px), 
	       only screen and (min-width: 481px) and (max-width: 1024px) and (orientation: landscape) {
		   .tagsummary-button {
		       display: inline-block !important;
		       font-size: 12px !important;
		       padding: 5px 5px;
		       box-shadow: none;  /* remove shadows if they look off */
		       border-radius: 4px;
		       color: var(--link-color) !important;
		       border: 1px solid var(--link-color); 
		       width: auto !important;            /* auto adjusts width based on content */
    		   /*max-width: 60px !important;  */  
    		   max-height: 30px !important;
    		   min-width: 40px !important;
    		   white-space: nowrap;
    		   /*text-align: left !important;*/
    		   overflow: hidden;
    		   background-color: var(--background-primary) !important;
		   }
		}

    `;
    const styleSheet = document.createElement("style");
    styleSheet.type = "text/css";
    styleSheet.innerText = styles;
    styleSheet.id = "my-plugin-styles";
    document.head.appendChild(styleSheet);
  }
  getTagElement(paragraph, tagText) {
    const elements = paragraph.querySelectorAll(".tag");
    for (let element of elements) {
      if (element.innerText.trim() === tagText) {
        return element;
      }
    }
    console.warn(`Element with text "${tagText}" not found`);
    return null;
  }
  ctrlCmdKey(event) {
    const isMac = navigator.platform.toUpperCase().indexOf("MAC") >= 0;
    if (isMac)
      return event.metaKey;
    else
      return event.ctrlKey;
  }
};
var TempComponent = class extends import_obsidian2.Component {
  onload() {
  }
  onunload() {
  }
};
var DoubleTapHandler = class {
  constructor(plugin, element, callback) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.lastTap = 0;
    this.plugin.registerDomEvent(this.element, "touchend", this.handleTouchEnd.bind(this), true);
  }
  handleTouchEnd(event) {
    const currentTime = new Date().getTime();
    const tapLength = currentTime - this.lastTap;
    clearTimeout(this.timeout);
    if (tapLength < 500 && tapLength > 0) {
      this.callback(event);
    } else {
      this.timeout = setTimeout(() => {
        clearTimeout(this.timeout);
      }, 500);
    }
    this.lastTap = currentTime;
  }
};
var PressAndHoldHandler = class {
  constructor(plugin, element, callback, duration = 600) {
    this.plugin = plugin;
    this.element = element;
    this.callback = callback;
    this.duration = duration;
    this.timeout = null;
    this.plugin.registerDomEvent(this.element, "touchstart", this.handleTouchStart.bind(this), true);
    this.plugin.registerDomEvent(this.element, "touchend", this.handleTouchEnd.bind(this), true);
  }
  handleTouchStart(event) {
    this.timeout = setTimeout(() => {
      this.callback(event);
      this.timeout = null;
    }, this.duration);
  }
  handleTouchEnd(event) {
    if (this.timeout) {
      clearTimeout(this.timeout);
      this.timeout = null;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzZXR0aW5ncy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgVEJTZXR0aW5nc1RhYiB9IGZyb20gXCIuL3NldHRpbmdzXCI7XG5pbXBvcnQgeyBBcHAsIGRlYm91bmNlLCBFZGl0b3IsIE1hcmtkb3duUmVuZGVyZXIsIENvbXBvbmVudCwgVEZpbGUsIGdldEFsbFRhZ3MsIE1hcmtkb3duVmlldywgTW9kYWwsIE5vdGljZSwgUGx1Z2luLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5cbmludGVyZmFjZSBUQlNldHRpbmdzIHtcblx0cmVtb3ZlT25DbGljazogYm9vbGVhbjsgLy8gY3RybFxuXHRyZW1vdmVDaGlsZFRhZ3NGaXJzdDsgLy8gXG5cdG9wdFRvQ29udmVydDogYm9vbGVhbjsgLy9hbHRcblx0bW9iaWxlVGFnU2VhcmNoOiBib29sZWFuOyBcblx0bW9iaWxlTm90aWNlczogYm9vbGVhbjsgXG5cdGRlYnVnTW9kZTogYm9vbGVhbjtcbn1cblxuY29uc3QgREVGQVVMVF9TRVRUSU5HUzogUGFydGlhbDxUQlNldHRpbmdzPiA9IHtcblx0cmVtb3ZlT25DbGljazogdHJ1ZSwgLy8gd2hlbiB0cnVlLCBjbWQgaXMgbmVlZGVkIHdoZW4gY2xpY2tpbmcgdG8gcmVtb3ZlIHRoZSB0YWdcblx0cmVtb3ZlQ2hpbGRUYWdzRmlyc3Q6IHRydWUsIC8vIHVzZSBzaGlmdCB3aGVuIGZhbHNlXG5cdG9wdFRvQ29udmVydDogdHJ1ZSwgLy8gd2hlbiBmYWxzZSwgY2xpY2tpbmcgdGFnIHdpbGwgZG8gbm90aGluZ1xuXHRtb2JpbGVUYWdTZWFyY2g6IGZhbHNlLCAvLyB0b2dnbGUgb24gdXNlIGRvdWJsZSB0YXAgZm9yIHNlYXJjaC4gcHJlc3MraG9sZCB3aWxsIHRoZW4gcmVtb3ZlLlxuXHRtb2JpbGVOb3RpY2VzOiB0cnVlLFxuXHRkZWJ1Z01vZGU6IGZhbHNlLFxufTsgXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVGFnQnVkZHkgZXh0ZW5kcyBQbHVnaW4geyAgXG5cdHNldHRpbmdzOiBUQlNldHRpbmdzO1xuXG5cdG9udW5sb2FkKCkge31cblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFRCU2V0dGluZ3NUYWIodGhpcy5hcHAsIHRoaXMpKTtcdFxuXHRcdFxuXHRcdGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgUGx1Z2luIGxvYWRlZCBvbiAnICsgKHRoaXMuYXBwLmlzTW9iaWxlPydtb2JpbGUgYXQgJzonZGVza3RvcCBhdCAnKSArIG5ldyBEYXRlKCkudG9VVENTdHJpbmcoKS5zdWJzdHJpbmcoMTcpKTtcblxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KGFzeW5jICgpID0+IHtcblx0XHRcdFxuXHRcdFx0Ly8gdGhpcy5yZWxvYWQoKTsgLy8gbm8gbmVlZCBmb3IgdGhpcyBhdG0uXG5cdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCAxMDAwKVxuXHRcdFx0XG5cdFx0XHQvLyBEb24ndCBuZWVkIHRoaXMgZXZlbnQgYmVjYXVzZSB3ZSdsbCBhbHdheXMgbmVlZCB0byBzd2l0Y2ggYmV0d2VlbiB2aWV3cyB0byBlZGl0IG5vdGUgYW5kIGFmZmVjdCB0aGUgdGFnIGluZGljZXMuXG5cdFx0XHQvLyB0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAud29ya3NwYWNlLm9uKCdlZGl0b3ItY2hhbmdlJywgZGVib3VuY2UoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZygnZWRpdG9yIGNoYW5nZScpOyB0aGlzLnByb2Nlc3NUYWdzKCk7IH0sIDMwMDAsIHRydWUpKSk7XG5cdFx0XHQvLyBEb24ndCBuZWVkIHRoaXMgZXZlbnQgYmVjYXVzZSBsZWFmIGNoYW5nZXMgZG9uJ3QgZWZmZWN0IHRoZSByYXcgY29udGVudC5cblx0XHRcdC8vIHRoaXMucmVnaXN0ZXJFdmVudCggdGhpcy5hcHAud29ya3NwYWNlLm9uKCdhY3RpdmUtbGVhZi1jaGFuZ2UnLCBkZWJvdW5jZShhc3luYyAoKSA9PiB7IGNvbnNvbGUubG9nKCdhY3RpdmUgbGVhZiBjaGFuZ2UnKTsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCAzMDAsIHRydWUpKSApO1xuXHRcdFx0Ly8gQnV0IG9uZSBvZiB0aGVzZSBtaWdodCBiZSB1c2VmdWwgd2hlbiB3ZSBjbGljayB0YWdzIGluIG90aGVyIHBsdWdpbnMgbGlrZSByZXBlYXQgb3IgY2hlY2tsaXN0XG5cdFx0XHQvLyBUaGlzIGV2ZW50IGlzIGJlc3QgYmVjYXVzZSB3ZSBhbHdheXMgbmVlZCB0byBzd2l0Y2ggbW9kZXMgdG8gZWRpdCBub3RlIG9yIGludGVyYWN0IHdpdGggdGFnIChyZWFkaW5nIG1vZGUpLlxuXHRcdFx0XG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQoIHRoaXMuYXBwLm9uKCdsYXlvdXQtY2hhbmdlJywgKGV2ZW50OiBFZGl0b3JFdmVudCkgPT4geyBcblx0XHRcdFx0c2V0VGltZW91dChhc3luYyAoKSA9PiB7IFxuXHRcdFx0XHRcdC8vIGNvbnNvbGUubG9nKCdsYXlvdXQgY2hhbmdlJyk7IFxuXHRcdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ3MoKTsgXG5cdFx0XHRcdH0sIDMwMCk7IFxuXHRcdFx0fSkpO1xuXHRcdFx0XG5cdFx0XHQvLyBUaGVyZSBpcyBhIGxpdHRsZSByZWR1bmRhbmN5IGhlcmUgYmVjYXVzZSB3ZSBhbHNvIGdldCBsYXlvdXQgZXZlbnRzIHdoZW4gc3dpdGNoaW5nIGZpbGVzXG5cdFx0XHR0aGlzLnJlZ2lzdGVyRXZlbnQodGhpcy5hcHAub24oJ2ZpbGUtb3BlbicsIGFzeW5jIChldmVudDogRWRpdG9yRXZlbnQpID0+IHsgXG5cdFx0XHRcdHNldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRcdFx0XHQvLyBjb25zb2xlLmxvZygnZmlsZSBvcGVuJyk7IFxuXHRcdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ3MoKTsgXG5cdFx0XHRcdH0sIDEwMDApOyBcblx0XHRcdH0pKTtcblxuXHRcdFx0dGhpcy5pbmplY3RTdHlsZXMoKTtcblxuXHRcdFx0aWYgKCF0aGlzLmFwcC5pc01vYmlsZSkge1xuXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgaGFuZGxlcyBhbGwgdGhlIGludGVyYWN0aW9ucyBvbiBkZXNrdG9wXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2NsaWNrJywgdGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSwgdHJ1ZSk7XG5cblx0XHRcdH0gZWxzZSB7IC8vIE1vYmlsZSBpbnRlcmFjdGlvblxuXG5cdFx0XHRcdC8vIFRoaXMgZXZlbnQgY2F0Y2hlcyBhbGwgdGFwcyBvbiBtb2JpbGUgYmVjYXVzZSB3ZSBoYXZlIGN1c3RvbSBkb3VibGUtdGFwIGFuZCBwcmVzcy1ob2xkIGV2ZW50cy5cblx0XHRcdFx0dGhpcy5yZWdpc3RlckRvbUV2ZW50KGRvY3VtZW50LCAnY2xpY2snLCAoZSkgPT4geyBcblx0XHRcdFx0XHRjb25zdCBpc1RhZyA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygndGFnJyk7XG5cdFx0XHRcdFx0aWYgKGlzVGFnICYmICF0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCkge1xuXHRcdFx0XHRcdFx0Ly9uZXcgTm90aWNlICgnc3RvcCBwcm9wJylcblx0XHRcdFx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9LCB0cnVlKTtcblxuXHRcdFx0XHRuZXcgUHJlc3NBbmRIb2xkSGFuZGxlcih0aGlzLCBkb2N1bWVudCwgdGhpcy5vbkNsaWNrRXZlbnQuYmluZCh0aGlzKSk7XG5cdFx0XHRcdG5ldyBEb3VibGVUYXBIYW5kbGVyKHRoaXMsIGRvY3VtZW50LCB0aGlzLm9uQ2xpY2tFdmVudC5iaW5kKHRoaXMpKTtcblx0XHRcdH1cdFxuXHRcdFx0XG5cdFx0fSk7XG5cblx0XHQvLyBUYWcgc3VtbWFyeSBjb2RlIGJsb2NrXG5cdFx0dGhpcy5yZWdpc3Rlck1hcmtkb3duQ29kZUJsb2NrUHJvY2Vzc29yKFwidGFnLXN1bW1hcnlcIiwgdGhpcy5zdW1tYXJ5Q29kZUJsb2NrUHJvY2Vzc29yLmJpbmQodGhpcykpO1xuXHR9XG5cblx0YXN5bmMgZ2V0Q2xpY2tlZFdvcmQoZSkge1xuXHRcdC8vR2V0IHRoZSBjbGljayBwb3NpdGlvblxuXHQgICAgbGV0IHggPSBlLmNsaWVudFgsIHkgPSBlLmNsaWVudFk7XG5cblx0ICAgIC8vIFN0ZXAgMzogR2V0IHRoZSB3b3JkIHVuZGVyIHRoZSBjbGljayBwb3NpdGlvblxuXHQgICAgbGV0IHJhbmdlLCB0ZXh0Tm9kZSwgb2Zmc2V0O1xuXG5cdCAgICAvLyBUaGlzIG1ldGhvZCBpcyBiZXR0ZXIgc3VwcG9ydGVkIGFuZCBnaXZlcyB1cyBhIHJhbmdlIG9iamVjdFxuXHQgICAgaWYgKGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQpIHtcblx0ICAgICAgICByYW5nZSA9IGRvY3VtZW50LmNhcmV0UmFuZ2VGcm9tUG9pbnQoeCwgeSk7XG5cdCAgICAgICAgdGV4dE5vZGUgPSByYW5nZS5zdGFydENvbnRhaW5lcjtcblx0ICAgICAgICBvZmZzZXQgPSByYW5nZS5zdGFydE9mZnNldDtcblx0ICAgIH1cblx0ICAgIC8vY29uc29sZS5sb2codGV4dE5vZGUpXG5cblx0ICAgIC8vIExBVEVSLCBkb3VibGUgY2hlY2sgZGlmZmVyZW50IG5vdGVzIHR5cGVzIGFuZCBhcm91bmQgdGhlIGludGVyZmFjZVxuXG5cdCAgICAvLyBDaGVjayBpZiB3ZSBoYXZlIGEgdmFsaWQgdGV4dCBub2RlXG5cdCAgICBpZiAodGV4dE5vZGUgJiYgdGV4dE5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XG5cdCAgICAgICAgLy8gR2V0IHRoZSB3aG9sZSB0ZXh0IG9mIHRoZSBjbGlja2VkIG5vZGVcblx0ICAgICAgICBsZXQgZnVsbFRleHQgPSB0ZXh0Tm9kZS50ZXh0Q29udGVudDtcblxuXHQgICAgICAgIC8vIExBVEVSOiBpZiB0aGUgd29yZCBlbmQgaW4gdmFsaWQgcHVuY3R1YXRpb24sIGFkZCBhIHNwYWNlIGJldHdlZW4gd29yZCBhbmQgcHVuY3R1YXRpb24gaXQgd2hlbiBhZGRpbmcgdGhlIGhhc2guXG5cdCAgICAgICAgLy8gTEFURVIsIGhhdmUgcHJlZGVmaW5lZCB0YWdzIHdlIGNhbiBpbnNlcnQgd2l0aCBkaWZmZXJlbnQga2V5IG1vZGlmaWVycyBvbiBjbGlja1xuXHQgICAgICAgIC8vIGxpa2UsICN0b2RvIG9yICNpbmJveCAjbGF0ZXJcblxuXHQgICAgICAgIGxldCB3b3JkUmVnZXggPSAvW15cXHNdKyg/PVsuLDohP10/KFxcc3wkKSkvZztcblx0XHRcdGxldCBtYXRjaDtcblx0XHRcdGxldCBjbGlja2VkV29yZCA9IG51bGw7XG5cdCAgICAgICAgd2hpbGUgKChtYXRjaCA9IHdvcmRSZWdleC5leGVjKGZ1bGxUZXh0KSkgIT09IG51bGwpIHtcblx0ICAgICAgICAgICAgaWYgKG1hdGNoLmluZGV4IDw9IG9mZnNldCAmJiBvZmZzZXQgPD0gbWF0Y2guaW5kZXggKyBtYXRjaFswXS5sZW5ndGgpIHtcblx0ICAgICAgICAgICAgICAgIC8vIFRoaXMgaXMgb3VyIHdvcmRcblx0ICAgICAgICAgICAgICAgIGlmICghL15bXlxccHtMfVxccHtOfV0vdS50ZXN0KG1hdGNoWzBdKSAmJiAgICAgICAgLy8gTm90IHN0YXJ0aW5nIHdpdGggYW55IG5vbi1hbHBoYW51bWVyaWNcblx0ICAgICAgICAgICAgICAgICAgICAhL1teXFxwe0x9XFxwe059XFxzLiw6IT9dL3UudGVzdChtYXRjaFswXSkgJiZcdC8vIE5vdCBjb250YWluaW5nIG90aGVyIHRoYW4gYWxsb3dlZCBjaGFyc1xuXHQgICAgICAgICAgICAgICAgICAgICEvWy4sOiE/XSg/PVteXFxzJF0pL3UudGVzdChtYXRjaFswXSkpIHsgICAgIC8vIElmIGVuZHMgd2l0aCBwdW5jdHVhdGlvbiwgZm9sbG93aW5nIGNoYXJhY3RlciBtdXN0IGJlIHdoaXRlc3BhY2Ugb3IgZW5kIG9mIHN0cmluZ1xuXHQgICAgICAgICAgICAgICAgICAgIGNsaWNrZWRXb3JkID0gbWF0Y2hbMF07XG5cdCAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cblxuXHRcdFx0bGV0IGFjdGl2ZVZpZXcgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXG5cdFx0XHRcblx0XHQgICAgbGV0IGVkaXRvciA9IGFjdGl2ZVZpZXcuc291cmNlTW9kZS5jbUVkaXRvcjsgIC8vIEdldCB0aGUgQ29kZU1pcnJvciBpbnN0YW5jZVxuXHRcdCAgICBsZXQgZnVsbE5vdGUgPSBlZGl0b3IuZ2V0VmFsdWUoKTsgXG5cblx0XHRcdGNvbnN0IGdsb2JhbFN0YXJ0UG9zaXRpb24gPSBmdWxsTm90ZS5pbmRleE9mKHRleHROb2RlLnRleHRDb250ZW50KTtcblxuXHRcdFx0aWYgKGdsb2JhbFN0YXJ0UG9zaXRpb24gIT09IC0xKSB7XG5cdFx0XHQgICAgLy8gQXNzdW1pbmcgdGhlIGNsaWNrIHdhcyByaWdodCBhdCB0aGUgZW5kIG9mIHRoZSB3b3JkXG5cdFx0XHQgICAgbGV0IHdvcmRFbmRQb3NpdGlvbiA9IGdsb2JhbFN0YXJ0UG9zaXRpb24gKyBvZmZzZXQ7XG5cblx0XHRcdCAgICAvLyBUcmF2ZXJzZSBiYWNrd2FyZCB1bnRpbCBhIHNwYWNlIG9yIHN0YXJ0XG5cdFx0XHQgICAgd2hpbGUgKHdvcmRFbmRQb3NpdGlvbiA+IDAgJiYgZnVsbE5vdGVbd29yZEVuZFBvc2l0aW9uXSAhPT0gJyAnICYmIGZ1bGxOb3RlW3dvcmRFbmRQb3NpdGlvbl0gIT09ICdcXG4nKSB7XG5cdFx0XHQgICAgICAgIHdvcmRFbmRQb3NpdGlvbi0tO1xuXHRcdFx0ICAgIH1cblxuXHRcdFx0ICAgIHdvcmRFbmRQb3NpdGlvbisrO1xuXG5cdFx0XHQgICAgLy8gSW5zZXJ0IGhhc2ggYXQgd29yZEVuZFBvc2l0aW9uXG5cdFx0XHQgICAgY29uc3QgdXBkYXRlZE5vdGUgPSBbZnVsbE5vdGUuc2xpY2UoMCwgd29yZEVuZFBvc2l0aW9uKSwgJyMnLCBmdWxsTm90ZS5zbGljZSh3b3JkRW5kUG9zaXRpb24pXS5qb2luKCcnKTtcblx0XHRcdCAgICBjb25zb2xlLmxvZyh1cGRhdGVkTm90ZSk7XG5cdFx0XHR9XG5cblxuXHRcdH1cblxuXHRcdC8vIExBVEVSLCB0byBtYWtlIHRoaXMgd29yayBpbiBlbWJlZHMgYW5kIHN1bW1hcmllc1xuXHRcdC8vIGFuZCBhdm9pZCBhZGRpbmcgd2hlbiBpbiB0aGUgc3VtbWFyeSBlbXB0eSBibG9jay4gb3Igb3RoZXIgY29kZSBibG9ja3MuIG1heWJlIHRoaXMgY2hlY2sgaXMgZWFybGllci5cblxuXHR9XG5cblx0YXN5bmMgb25DbGlja0V2ZW50IChldmVudCkge1xuXHRcdFxuXHRcdC8vIFN1cHBvcnQgZm9yIGRpZmZlcmVudCB2aWV3cz8gXG5cdFx0Ly8gSWYgdGFnIGhhcyBubyBjb250ZXh0IHByb3BlcnRpZXMsIHRoZW4gdHJ5IHRvIGZpZ3VyZSBvdXQgd2hlcmUgaXQgaXM/XG5cdFx0Ly8gT3IgbWF5YmUgdGhlcmUncyBhIHdheSB0byBoYXZlIG9ic2lkaWFuIGFkZCB0aGUgcHJvcGVydGllcyBnbG9iYWxseS5cblx0XHQvL25ldyBOb3RpY2UgKCdUYWcgQnVkZHkgZXZlbnQgdHlwZTogJyArIGV2ZW50LnR5cGUpO1xuXG5cdFx0Ly9jb25zb2xlLmxvZygobmF2aWdhdG9yLnBsYXRmb3JtLnRvVXBwZXJDYXNlKCkuaW5kZXhPZignTUFDJykgPj0gMCk/J1RoaXMgaXMgYSBNYWMnOidUaGlzIGlzIG5vdCBhIE1hYycpXG5cblx0XHRjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0Y29uc3QgdmlldyA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG5cblx0XHQvLyBUaGlzIGNvbmRpdGlvbiBpdCBpbiBjYXNlIHdlIGNsaWNrIG9uIGEgdGFnIGluIGFub3RoZXIgcGx1Z2luIGxpa2UgcmVwZWF0IG9yIGNoZWNrbGlzdFxuXHRcdC8vIGNhbid0IGVkaXQgdGFncyBpbiB0aGVzZSBjYXNlcy4gRm9yIG5vdy5cblx0XHRpZiAoIXZpZXcgJiYgdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSkgeyBcblx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeTogQ2FuXFwndCBlZGl0IHRhZy4gVW5zdXBwb3J0ZWQgdmlldyB0eXBlLiBUcnkgYWdhaW4gd2l0aGluIHRoYXQgbm90ZS4nKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHRpZiAodmlldykgeyBcblx0XHRcdGlmICh2aWV3LmdldE1vZGUoKSAhPSAncHJldmlldycpIHJldHVybjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly9pZiAoZG9jdW1lbnQuY29udGFpbnMoJ3JlcGVhdC1lbWJlZGRlZF9ub3RlJykpXG5cdFx0fVxuXHRcdFxuXHRcdGlmICghdGhpcy5hcHAuaXNNb2JpbGUpIHtcblx0XHRcdC8vbmV3IE5vdGljZSAoJ1RhZyBCdWRkeSBldmVudCB0eXBlOiAnICsgZXZlbnQudHlwZSk7XG5cblxuXG5cdFx0XHQvLyBBREQgdGFnIGZ1bmN0aW9uYWxpdHlcblx0XHRcdC8vY29uc29sZS5sb2codGhpcy5jdHJsQ21kS2V5KGV2ZW50KSlcblx0XHRcdC8qaWYgKHRhcmdldCAmJiAhdGFyZ2V0Lm1hdGNoZXMoJy50YWcnKSBcblx0XHRcdCYmIHRhcmdldC50YWdOYW1lICE9PSAnQScgXG5cdFx0XHQmJiB0YXJnZXQudGFnTmFtZSAhPT0gJ0lNRydcblx0XHRcdCYmIHRoaXMuY3RybENtZEtleShldmVudCkpIHtcblxuXHRcdFx0XHQvL2NvbnNvbGUubG9nKGF3YWl0IHRoaXMuZ2V0Q2xpY2tlZFdvcmQoZXZlbnQpKTtcblx0XHRcdFx0YXdhaXQgdGhpcy5nZXRDbGlja2VkV29yZChldmVudCk7XG5cblx0XHRcdFx0cmV0dXJuO1xuXG5cdFx0XHR9Ki9cblxuXG5cblxuXHRcdFx0aWYgKCh0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgdGhpcy5jdHJsQ21kS2V5KGV2ZW50KSkgfHwgKCF0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgIXRoaXMuY3RybENtZEtleShldmVudCkpKSB7IFxuXHRcdFx0XHRyZXR1cm47IFxuXHRcdFx0fSBlbHNlIGlmIChldmVudC5hbHRLZXkgJiYgIXRoaXMuc2V0dGluZ3Mub3B0VG9Db252ZXJ0KSB7ICBcblx0XHRcdFx0cmV0dXJuOyBcblx0XHRcdH1cblxuXHRcdH0gZWxzZSB7XG5cdFx0XHRcblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaCAmJiBldmVudC50eXBlID09ICd0b3VjaGVuZCcpIHtcblx0XHRcdFx0Ly8gaWYgd2UgZ2V0IHRoaXMgZmFyLCB0aGlzIGlzIGEgZG91YmxlIHRhcFxuXHRcdFx0XHRyZXR1cm47XG5cdFx0XHR9XG5cdFx0fVxuXG5cblx0XHRcblx0XHQvL2lmICh2aWV3ICYmIHRhcmdldCAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7XHRcblx0XHRpZiAodGFyZ2V0ICYmIHRhcmdldC5tYXRjaGVzKCcudGFnJykpIHtcdFxuXHRcdFx0Ly8gY29uc3Qgc2Nyb2xsU3RhdGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5jdXJyZW50TW9kZT8uZ2V0U2Nyb2xsKCk7XG5cblx0XHRcdGlmICh0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgfHwgKCF0aGlzLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2sgJiYgdGhpcy5jdHJsQ21kS2V5KGV2ZW50KSkpIHtcblx0XHRcdFx0ZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRcdGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGNsaWNrZWRUYWcgPSB0YXJnZXQuY2xvc2VzdCgnLnRhZycpOyAvL2V2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcblx0XHRcdGNvbnN0IHRhZyA9IGNsaWNrZWRUYWcuaW5uZXJUZXh0O1xuXG5cdFx0XHRsZXQgdGFnSW5kZXggPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnbWQtaW5kZXgnKTtcblx0XHRcdGxldCB0YWdGaWxlID0gY2xpY2tlZFRhZy5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cblx0XHRcdGlmICh0YWdGaWxlKSB7XG5cdFx0XHRcdC8vIFRyeVxuXHRcdFx0XHQvL3RoaXMuZWRpdFRhZyAoZXZlbnQsIHRhZ0luZGV4LCB0YWdGaWxlKTtcblx0XHRcdFx0dGhpcy5lZGl0VGFnICh0YXJnZXQsIGV2ZW50KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFRyeSBhZ2FpblxuXHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHR0YWdJbmRleCA9IGNsaWNrZWRUYWcuZ2V0QXR0cmlidXRlKCdtZC1pbmRleCcpO1xuXHRcdFx0XHRcdHRhZ0ZpbGUgPSBjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgnZmlsZS1zb3VyY2UnKTtcblx0XHRcdFx0XHQvL3RoaXMuZWRpdFRhZyAoZXZlbnQsIHRhZ0luZGV4LCB0YWdGaWxlKTtcblx0XHRcdFx0XHR0aGlzLmVkaXRUYWcgKHRhcmdldCwgZXZlbnQpO1xuXHRcdFx0XHR9LCAzMDApO1xuXHRcdFx0fVxuXHRcdFx0Ly9jb25zb2xlLmxvZyhjbGlja2VkVGFnLmdldEF0dHJpYnV0ZSgndHlwZScpKVxuXG5cdFx0XHRcblx0XHQvL30gZWxzZSBpZiAodmlldyA9PSBudWxsICYmIHRhcmdldCAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7XG5cdFx0fSBlbHNlIGlmICghdmlldyAmJiB0YXJnZXQubWF0Y2hlcygnLnRhZycpKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IENhblxcJ3QgZWRpdCB0YWcuIE1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIHZpZXcgdHlwZS4nKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBlZGl0VGFnICh0YWdFbCwgZXZlbnQpIHtcblxuXG5cdFx0Y29uc3QgaW5kZXggPSB0YWdFbC5nZXRBdHRyaWJ1dGUoJ21kLWluZGV4Jyk7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSB0YWdFbC5nZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJyk7XG5cblx0XHQvL2lmICh0aGlzLnNldHRpbmdzLmRlYnVnTW9kZSkgY29uc29sZS5sb2coJ1RhZyBCdWRkeSBlZGl0IHRhZzogJyArIGV2ZW50LnRhcmdldC5pbm5lclRleHQgKyAnXFxuSW4gZmlsZTogJyArIGZpbGVQYXRoKTtcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5kZWJ1Z01vZGUpIGNvbnNvbGUubG9nKCdUYWcgQnVkZHkgZWRpdCB0YWc6ICcgKyB0YWdFbC5pbm5lclRleHQgKyAnXFxuSW4gZmlsZTogJyArIGZpbGVQYXRoKTtcblxuXHRcdGlmIChmaWxlUGF0aCkge1xuXG5cdFx0XHRjb25zdCBmaWxlOiBURmlsZSA9IGF3YWl0IHRoaXMudmFsaWRhdGVGaWxlUGF0aChmaWxlUGF0aCk7IC8vYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XG5cdFx0XHRsZXQgZmlsZUNvbnRlbnQ6IFN0cmluZztcblx0XHRcdGxldCBmaWxlQ29udGVudEJhY2t1cDogU3RyaW5nO1xuXHRcdFx0Ly9jb25zdCB0YWc6IFN0cmluZyA9IGV2ZW50LnRhcmdldC5pbm5lclRleHQudHJpbSgpO1xuXHRcdFx0Y29uc3QgdGFnOiBTdHJpbmcgPSB0YWdFbC5pbm5lclRleHQudHJpbSgpO1xuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRcblx0XHRcdFx0ZmlsZUNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0XHRmaWxlQ29udGVudEJhY2t1cCA9IGZpbGVDb250ZW50O1xuXG5cdFx0XHR9IGNhdGNoIChlcnJvcikge1xuXG5cdFx0XHRcdG5ldyBOb3RpY2UoJ1RhZyBCdWRkeSBmaWxlIHJlYWQgZXJyb3I6XFxuJyArIGVycm9yLm1lc3NhZ2UpO1xuXHRcdFx0XHRyZXR1cm47XG5cblx0XHRcdH1cblxuXHRcdFx0Ly8gY2hlY2sgaWYgdGhlIGZpbGUgaGFzIG9ubHkgb25lIHRhZyBsZWZ0IChhbmQgdGhhdCdzIGFsbCB0aGF0cyBsZWZ0IGluIHRoZSBmaWxlKVxuXHRcdFx0bGV0IHNhZmVUb0VtcHR5RmlsZSA9IGZhbHNlO1xuXHRcdFx0Y29uc3QgdGFnUmVnZXggPSAvXlxccyojKFxcdyspXFxzKiQvO1xuXHRcdFx0aWYgKHRhZ1JlZ2V4LnRlc3QoZmlsZUNvbnRlbnQudHJpbSgpKSkge1xuXHRcdCAgICBcdHNhZmVUb0VtcHR5RmlsZSA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGxldCBiZWZvcmVUYWcgPSBmaWxlQ29udGVudC5zdWJzdHJpbmcoMCwgaW5kZXgpO1xuXHRcdFx0bGV0IGFmdGVyVGFnID0gZmlsZUNvbnRlbnQuc3Vic3RyaW5nKChOdW1iZXIoaW5kZXgpK051bWJlcih0YWcubGVuZ3RoKSsxKSk7XG5cblx0XHRcdGlmIChmaWxlQ29udGVudFtpbmRleF0gPT09ICdcXG4nKSB7XG4gICAgXHRcdFx0YmVmb3JlVGFnICs9ICdcXG4nOyAvLyBhcHBlbmRpbmcgdGhlIG5ld2xpbmUgY2hhcmFjdGVyIHRvIGJlZm9yZVRhZ1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdGaWxlIGNvbnRlbnQ6ICcsIEpTT04uc3RyaW5naWZ5KGZpbGVDb250ZW50KSk7XG5cdFx0XHQvL2NvbnNvbGUubG9nICgnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJyk7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdCZWZvcmUgVGFnOiAnLCBKU09OLnN0cmluZ2lmeShiZWZvcmVUYWcpKTtcblx0XHRcdC8vY29uc29sZS5sb2cgKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcblx0XHRcdC8vY29uc29sZS5sb2coJ1RoZSBUYWc6ICcsIEpTT04uc3RyaW5naWZ5KHRhZykpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZyAoJy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnQWZ0ZXIgVGFnOiAnLCBKU09OLnN0cmluZ2lmeShhZnRlclRhZykpO1xuXHRcblx0XHRcdGxldCBuZXdDb250ZW50ID0gJyc7XG5cblx0XHRcdC8vaWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSB7XG5cblx0XHRcdFx0Ly8gbmV3Q29udGVudCA9IGJlZm9yZVRhZyArICcgXHUyNkEwXHVGRTBGLS0tXHVEODNFXHVERUY4JyArIHRhZyArICdcdUQ4M0VcdURFRjctLS1cdTI2QTBcdUZFMEYgJyArIGFmdGVyVGFnO1xuXHRcdFx0XHQvL25ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyAnIFx1MjZBMFx1RkUwRi0tLVx1MjdBMVx1RkUwRicgKyB0YWcgKyBhZnRlclRhZztcblxuXHRcdFx0Ly99IGVsc2VcblxuXHRcdFx0aWYgKCFldmVudCkgeyAvLyB0aGVuIHdlJ3JlIGNhbGxpbmcgdGhpcyBtZXRob2QgZnJvbSBhbm90aGVyIGJ1dHRvbi4gbmVlZCB0byByZXRoaW5rIGhvdyB0aGlzIGlzIG9yZ2FuaXplZC5cblx0XHRcdFx0XG5cdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZztcblxuXHRcdFx0fSBlbHNlIGlmIChldmVudC5hbHRLZXkgfHwgKChldmVudC50eXBlID09ICd0b3VjaHN0YXJ0JykgJiYgIXRoaXMuc2V0dGluZ3MubW9iaWxlVGFnU2VhcmNoKSkgeyBcblxuXHRcdFx0XHQvLyBSZW1vdmUgdGhlIGhhc2ggb25seVxuXG5cdFx0XHRcdGNvbnN0IG5vSGFzaCA9IHRhZy5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyAoIWJlZm9yZVRhZy5lbmRzV2l0aCgnICcpPycgJzonJykgKyBub0hhc2ggKyBhZnRlclRhZztcblx0XHRcdFx0XG5cdFx0XHRcdGlmICh0aGlzLmFwcC5pc01vYmlsZSAmJiB0aGlzLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpIHsgbmV3IE5vdGljZSAoJ1RhZyBCdWRkeTogJyArIHRhZyArICcgY29udmVydGVkIHRvIHRleHQuJyk7IH1cblx0XHRcdFx0Ly8gU2V0dGluZzogbWFrZSB0aGlzIGEgc2V0dGluZyB0byBzaG93IG5vdGljZXMgb24gbW9iaWxlXG5cdFx0XHRcblx0XHRcdH0gZWxzZSBpZiAoKChldmVudC50eXBlID09ICd0b3VjaGVuZCcpIHx8IHRoaXMuc2V0dGluZ3MubW9iaWxlVGFnU2VhcmNoKSB8fCAodGhpcy5jdHJsQ21kS2V5KGV2ZW50KSAmJiAhdGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKSB8fCAoIXRoaXMuY3RybENtZEtleShldmVudCkgJiYgdGhpcy5zZXR0aW5ncy5yZW1vdmVPbkNsaWNrKSkge1xuXG5cdFx0XHRcdC8vIFJlbW92ZSB0YWcgKG9yIGNoaWxkIGZpcnN0LCBpZiBleGlzdHMpXG5cblx0XHRcdFx0bGV0IHBhcmVudFRhZyA9ICcnO1xuXG5cdFx0XHRcdGlmICh0YWcuaW5jbHVkZXMoJy8nKSAmJiAodGhpcy5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdCB8fCAoZXZlbnQuc2hpZnRLZXkgJiYgIXRoaXMuc2V0dGluZ3MucmVtb3ZlQ2hpbGRUYWdzRmlyc3QpKSkge1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGxldCBwYXJ0cyA9IHRhZy5zcGxpdCgnLycpO1xuXHRcdFx0XHRcdGNvbnN0IHJlbW92ZWRDaGlsZCA9IHBhcnRzLnBvcCgpO1xuXHRcdFx0XHRcdHBhcmVudFRhZyA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdFx0XHRuZXdDb250ZW50ID0gYmVmb3JlVGFnICsgKCFiZWZvcmVUYWcuZW5kc1dpdGgoJyAnKT8nICc6JycpICsgcGFyZW50VGFnICsgYWZ0ZXJUYWc7XG5cblx0XHRcdFx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUgJiYgdGhpcy5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKSB7IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6IFxcJycgKyByZW1vdmVkQ2hpbGQgKyAnXFwnIHJlbW92ZWQgZnJvbSBwYXJlbnQgdGFnLicpOyB9XG5cdFx0XHRcdFxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdG5ld0NvbnRlbnQgPSBiZWZvcmVUYWcgKyBhZnRlclRhZztcblx0XHRcdFx0XHRpZiAodGhpcy5hcHAuaXNNb2JpbGUgJiYgdGhpcy5zZXR0aW5ncy5tb2JpbGVOb3RpY2VzKSB7IG5ldyBOb3RpY2UgKCdUYWcgQnVkZHk6ICcgKyB0YWcgKyAnIHJlbW92ZWQuJyk7IH1cblx0XHRcdFx0fVxuXHRcdFx0fSBcblx0XHRcdC8vIEZpbGUgc2FmZXR5IGNoZWNrc1xuXHRcdFx0aWYgKChuZXdDb250ZW50ID09ICcnICYmICFzYWZlVG9FbXB0eUZpbGUpIHx8IHRoaXMuY29udGVudENoYW5nZWRUb29NdWNoKGZpbGVDb250ZW50QmFja3VwLCBuZXdDb250ZW50LCB0YWcsIDIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoZXJlIHdhcyBvbmx5IG9uZSB0YWcgaW4gdGhlIGZpbGUsIGlmIHNvLCBkb24ndCByZXN0b3JlIGJhY2t1cDtcblx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBGaWxlIGNoYW5nZSBlcnJvci4nKTtcblx0XHRcdFx0bmV3Q29udGVudCA9IGZpbGVDb250ZW50QmFja3VwO1xuXHRcdFx0fSBlbHNlIGlmIChuZXdDb250ZW50ID09ICcnICYmIHNhZmVUb0VtcHR5RmlsZSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IFRhZyByZW1vdmVkLiBUaGUgbm90ZSBpcyBlbXB0eS4nKTtcblx0XHRcdH1cblxuXHRcdFx0dHJ5IHtcblx0XHRcdFxuXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XG5cblx0XHRcdFx0Ly8gV2hlbiBlZGl0aW5nIGNvbnRlbnQgaW4gdGhlIGFjdGl2ZSBub3RlLCBpdCdzIHJlY29tbWVuZGVkIHRvIG5vdCB1c2UgdGhlIG1vZGlmeSBiZWNhdXNlIHRoZSBmb2xkcyBhbmQgb3RoZXIgc3RhdGUgc3R1ZmYgaXMgbG9zdFxuXHRcdFx0XHQvLyBzZWUgdGhpcyBsaW5rOiBodHRwczovL2RvY3Mub2JzaWRpYW4ubWQvUGx1Z2lucy9FZGl0b3IvRWRpdG9yXG5cblx0XHRcdFx0aWYgKHRhZ0VsLmdldEF0dHJpYnV0ZSgndHlwZScpID09ICdwbHVnaW4tc3VtbWFyeScpIHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdHRoaXMudXBkYXRlU3VtbWFyeVBhcmFncmFwaCh0YWdFbCk7XG5cblx0XHRcdFx0XHQgICAgc2V0VGltZW91dChhc3luYyAoKSA9PiB7IHRoaXMucHJvY2Vzc1RhZ3MoKTsgfSwgMjAwKTtcblxuXHRcdFx0XHRcdFx0Ly8gdGhpcy5yZWZyZXNoVmlldygpOyAvLyBubyBuZWVkIGZvciB0aGlzIGF0bVxuXG5cdFx0XHRcdFx0fSwgMTUwKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRzZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCA1MClcblx0XHRcdFx0fVx0XG5cblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cblx0XHRcdFx0dHJ5IHtcblxuXHRcdFx0XHRcdGNvbnN0IGJhY2t1cEZpbGVOYW1lID0gU3RyaW5nKGZpbGUubmFtZS5zdWJzdHJpbmcoMCwgZmlsZS5uYW1lLmluZGV4T2YoJy5tZCcpKSArICcgQkFDS1VQLm1kJyk7XG5cdFx0XHRcdFx0dmF1bHQuY3JlYXRlKCcnLCBiYWNrdXBGaWxlTmFtZSwgZmlsZUNvbnRlbnRCYWNrdXApO1xuXG5cdFx0XHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5IG5vdGUgZWRpdGluZyBlcnJvcjogJyArIGVycm9yLm1lc3NhZ2UgKyAnXFxuJyArIGJhY2t1cEZpbGVOYW1lICsgJyBzYXZlZCB0byB2YXVsdCByb290LicpO1xuXHRcdFx0XHRcblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblxuXHRcdFx0XHRcdG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGZpbGVDb250ZW50QmFja3VwKTtcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHkgbm90ZSBlZGl0aW5nIGVycm9yOiAnICsgZXJyb3IubWVzc2FnZSArICdcXG5Ob3RlIGNvbnRlbnQgY29waWVkIHRvIGNsaXBib2FyZC4nKTtcblxuXHRcdFx0XHR9XG5cdFx0XHR9IFxuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHkgZXJyb3I6IENhblxcJ3QgaWRlbnRpZnkgdGFnIGxvY2F0aW9uLicpO1xuXHRcdH1cblx0fVxuXG5cdHVwZGF0ZVN1bW1hcnlQYXJhZ3JhcGggKHRhZ0VsKSB7XG5cdFx0Y29uc3Qgc3VtbWFyeUNvbnRhaW5lciA9IHRhZ0VsLmNsb3Nlc3QoJy5zdW1tYXJ5Jyk7XG5cdFx0Y29uc3QgdGFnc1N0ciA9IHN1bW1hcnlDb250YWluZXIuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncycpO1xuXHRcdGNvbnN0IHRhZ3MgPSB0YWdzU3RyID8gdGFnc1N0ci5zcGxpdCgnLCcpIDogW107XG5cblx0XHRjb25zdCB0YWdzSW5jbHVkZVN0ciA9IHN1bW1hcnlDb250YWluZXIuZ2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJyk7XG5cdFx0Y29uc3QgdGFnc0luY2x1ZGUgPSB0YWdzSW5jbHVkZVN0ciA/IHRhZ3NJbmNsdWRlU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdGNvbnN0IHRhZ3NFeGNsdWRlU3RyID0gc3VtbWFyeUNvbnRhaW5lci5nZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzLWV4Y2x1ZGUnKTtcblx0XHRjb25zdCB0YWdzRXhjbHVkZSA9IHRhZ3NFeGNsdWRlU3RyID8gdGFnc0V4Y2x1ZGVTdHIuc3BsaXQoJywnKSA6IFtdO1xuXG5cdFx0Y29uc3Qgc2VjdGlvbnNTdHIgPSBzdW1tYXJ5Q29udGFpbmVyLmdldEF0dHJpYnV0ZSgnY29kZWJsb2NrLXNlY3Rpb25zJyk7XG5cdFx0Y29uc3Qgc2VjdGlvbnMgPSBzZWN0aW9uc1N0ciA/IHNlY3Rpb25zU3RyLnNwbGl0KCcsJykgOiBbXTtcblxuXHRcdC8vIFJlY3JlYXRlIHN1bW1hcnkgYWZ0ZXIgd2UndmUgZWRpdGVkIHRoZSBmaWxlXG5cdFx0dGhpcy5jcmVhdGVTdW1tYXJ5KHN1bW1hcnlDb250YWluZXIsIHRhZ3MsIHRhZ3NJbmNsdWRlLCB0YWdzRXhjbHVkZSwgc2VjdGlvbnMpO1xuXG5cdFx0Ly9zZXRUaW1lb3V0KGFzeW5jICgpID0+IHsgdGhpcy5wcm9jZXNzVGFncygpOyB9LCAyMDApO1xuXHR9XG5cblx0YXN5bmMgcHJvY2Vzc1RhZ3MgKCkge1xuXG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuZGVidWdNb2RlKSBjb25zb2xlLmxvZygnVGFnIEJ1ZGR5OiBQcm9jZXNzaW5nIHRhZ3MuJyk7XG5cblx0XHRjb25zdCB2aWV3ID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHQvL3NldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBcblx0XHRjb25zdCBhY3RpdmVOb3RlQ29udGFpbmVyID0gYXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYuY29udGFpbmVyRWw7XG5cdFx0Ly9jb25zdCBhY3RpdmVOb3RlQ29udGFpbmVyID0gYXdhaXQgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZXctY29udGVudCcpO1xuXHRcdC8vfSwgMjAwKVxuXHRcdC8vc2V0VGltZW91dChhc3luYyAoKSA9PiB7IC8vIEFsbCB0aGVzZSB0aW1lb3V0cyB3ZXJlIGZvciB0ZXN0aW5nLiBJc3N1ZXMgc2VlbXMgdG8gYmUgcmVzb2x2ZWQgbm93LlxuXHRcdGNvbnN0IGFjdGl2ZUZpbGUgPSBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xuXHRcdGNvbnN0IGZpbGVDb250ZW50ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoYWN0aXZlRmlsZSk7XG5cdFx0Y29uc3QgYWN0aXZlRmlsZVRhZ0VsZW1lbnRzID0gYXdhaXQgYWN0aXZlTm90ZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubW9kLWFjdGl2ZSAudGFnOm5vdCgubWFya2Rvd24tZW1iZWQgLnRhZyk6bm90KC5zdW1tYXJ5IC50YWcpJyk7XG5cblx0XHQvL3NldFRpbWVvdXQoYXN5bmMgKCkgPT4geyBjb25zb2xlLmxvZyhhY3RpdmVGaWxlVGFnRWxlbWVudHMpfSwgMTAwMClcblx0XHRjb25zdCBhY3RpdmVGaWxlVGFncyA9IGF3YWl0IHRoaXMuZ2V0TWFya2Rvd25UYWdzKGFjdGl2ZUZpbGUsIGZpbGVDb250ZW50KTtcblx0XHRpZiAoYWN0aXZlRmlsZVRhZ3MubGVuZ3RoID4gMCkgdGhpcy5hc3NpZ25NYXJrZG93blRhZ3MoYWN0aXZlRmlsZVRhZ3MsIGFjdGl2ZUZpbGVUYWdFbGVtZW50cywgMCwgJ2FjdGl2ZScpO1xuXHRcdHRoaXMucHJvY2Vzc0VtYmVkcyhhY3RpdmVOb3RlQ29udGFpbmVyKTtcblx0XHQvL30sIDUwMClcblx0fVxuXG5cdGFzeW5jIGdldE1hcmtkb3duVGFncyAoZmlsZSwgZmlsZUNvbnRlbnQpIHtcblx0XHRjb25zdCB0YWdQb3NpdGlvbnMgPSBbXTtcblx0XHRsZXQgbWF0Y2g7XG5cdFx0Y29uc3QgcmVnZXggPSAvKD86XnxcXHMpI1teXFxzI10rfGBgYC9nOyAvLyBBZGp1c3RlZCB0aGUgcmVnZXggdG8gYWxzbyBtYXRjaCBjb2RlIGJsb2NrIGRlbGltaXRlcnNcblx0XHRsZXQgaW5zaWRlQ29kZUJsb2NrID0gZmFsc2U7XG5cblx0XHR3aGlsZSAoKG1hdGNoID0gcmVnZXguZXhlYyhmaWxlQ29udGVudCkpICE9PSBudWxsKSB7XG5cdFx0ICAgIGlmIChtYXRjaFswXS50cmltKCkgPT09IFwiYGBgXCIpIHtcblx0XHQgICAgICAgIGluc2lkZUNvZGVCbG9jayA9ICFpbnNpZGVDb2RlQmxvY2s7IFxuXHRcdCAgICAgICAgY29udGludWU7XG5cdFx0ICAgIH1cblx0XHQgICAgXG5cdFx0ICAgIGlmIChpbnNpZGVDb2RlQmxvY2spIGNvbnRpbnVlO1xuXG5cdFx0ICAgIGNvbnN0IHRhZyA9IG1hdGNoWzBdLnRyaW0oKTtcblx0XHQgICAgLy8gTG9vayBhaGVhZCBmcm9tIHRoZSBjdXJyZW50IG1hdGNoIGFuZCBzZWUgaWYgaXQncyBmb2xsb3dlZCBieSBdXVxuXHRcdCAgICBpZiAoZmlsZUNvbnRlbnQuc2xpY2UobWF0Y2guaW5kZXgsIG1hdGNoLmluZGV4ICsgdGFnLmxlbmd0aCArIDIpLmVuZHNXaXRoKFwiXV1cIikpIHtcblx0XHQgICAgICAgIGNvbnRpbnVlOyAvLyBTa2lwIHRoaXMgbWF0Y2ggYXMgaXQncyBwYXJ0IG9mIGEgd2lraWxpbmtcblx0XHQgICAgfVxuXHRcdCAgICB0YWdQb3NpdGlvbnMucHVzaCh7dGFnOnRhZywgaW5kZXg6bWF0Y2guaW5kZXgsIHNvdXJjZTpmaWxlLm5hbWV9KTsgXG5cdFx0fVxuXHRcdC8vY29uc29sZS5sb2coJ21hcmtkb3duIHRhZyBjb3VudDogJyArIHRhZ1Bvc2l0aW9ucy5sZW5ndGgpXG5cblx0XHRyZXR1cm4gdGFnUG9zaXRpb25zO1xuXHR9XG5cblx0YXNzaWduTWFya2Rvd25UYWdzICh0YWdQb3NpdGlvbnMsIHRhZ0VsZW1lbnRzLCBzdGFydEluZGV4LCB0eXBlKSB7XG5cdFx0Ly9jb25zb2xlLmxvZygnLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tJylcblx0XHRsZXQgdGFnRWw7XG5cdFx0Y29uc3QgdGFnRWxBcnJheSA9IEFycmF5LmZyb20odGFnRWxlbWVudHMpO1xuXHRcdGxldCB0YWdFbEluZGV4ID0gMDtcblx0XHQvL3RhZ1Bvc2l0aW9ucy5mb3JFYWNoKGl0ZW0gPT4gY29uc29sZS5sb2coaXRlbS5pbmRleCkpO1xuXHRcdHRhZ1Bvc2l0aW9ucy5mb3JFYWNoKCh0YWdQb3MsIGluZGV4KSA9PiB7XG5cdFx0XHRpZiAodGFnUG9zaXRpb25zW2luZGV4XS5pbmRleCA+PSBzdGFydEluZGV4KSB7XG5cdFx0XHRcdHRhZ0VsID0gdGFnRWxBcnJheVt0YWdFbEluZGV4XSBhcyBIVE1MRWxlbWVudDtcblx0XHRcdFx0aWYgKHRhZ0VsKSB7XG4gICAgICAgIFx0XHRcdC8vY29uc29sZS5sb2codGFnUG9zaXRpb25zW2luZGV4XS5pbmRleCArICc+PScgKyBzdGFydEluZGV4ICsgJyA9ICcgKyAodGFnUG9zaXRpb25zW2luZGV4XS5pbmRleCA+PSBzdGFydEluZGV4KSArICcgOiAnICsgdGFnUG9zaXRpb25zW2luZGV4XS5zb3VyY2UpXG4gICAgICAgIFx0XHRcbiAgICAgICAgXHRcdFx0dGFnRWwuc2V0QXR0cmlidXRlKCdtZC1pbmRleCcsIHRhZ1Bvc2l0aW9uc1tpbmRleF0uaW5kZXgpO1xuICAgICAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJywgdGFnUG9zaXRpb25zW2luZGV4XS5zb3VyY2UpO1xuICAgICAgICBcdFx0XHR0YWdFbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCB0eXBlKTtcbiAgICAgICAgXHRcdFx0dGFnRWxJbmRleCsrO1xuICAgICAgICBcdFx0fSBcbiAgICBcdFx0fSBcblx0XHR9KTsgXG5cdFx0Ly9jb25zb2xlLmxvZygndGFnIGVsZW1lbnQgYXJyYXkgbGVuZ3RoOiAnICsgdGFnRWxBcnJheS5sZW5ndGgpO1xuXHRcdC8vY29uc29sZS5sb2codGFnRWxBcnJheSlcblx0XHRyZXR1cm4gdGFnRWxBcnJheTsgLy9BcnJheS5mcm9tKHRhZ0VsZW1lbnRzKTsgXG5cdH1cblxuXHRhc3luYyBwcm9jZXNzRW1iZWRzIChlbGVtZW50KSB7XG4gXHRcdC8vY29uc3QgYWN0aXZlRmlsZVRhZ0VsZW1lbnRzID0gYXdhaXQgYWN0aXZlTm90ZUNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubW9kLWFjdGl2ZSAudGFnOm5vdCgubWFya2Rvd24tZW1iZWQgLnRhZyk6bm90KC5zdW1tYXJ5IC50YWcpJyk7XG5cdFx0XG5cdFx0Y29uc3QgZW1iZWRzID0gYXdhaXQgZWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3VtbWFyeSwgLm1hcmtkb3duLWVtYmVkJyk7XG5cdFx0Ly9sZXQgZW1iZWRlZFRhZ0ZpbGVzID0gW107XG5cblx0XHRlbWJlZHMuZm9yRWFjaChhc3luYyAoZW1iZWQpID0+IHtcblx0XHRcdGlmIChlbWJlZC5jbGFzc0xpc3QuY29udGFpbnMoJ3N1bW1hcnknKSkge1xuXG5cdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ1N1bW1hcnkoZW1iZWQpO1x0XG5cblx0XHRcdH0gZWxzZSBpZiAoZW1iZWQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtYXJrZG93bi1lbWJlZCcpKSB7XG5cblx0XHRcdFx0dGhpcy5wcm9jZXNzTmF0aXZlRW1iZWQoZW1iZWQpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKEFycmF5LmZyb20oZW1iZWQucXVlcnlTZWxlY3RvckFsbCgnLnN1bW1hcnknKSkubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdHRoaXMucHJvY2Vzc1RhZ1N1bW1hcnkoZW1iZWQpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly9uZXcgTm90aWNlKCdUYWcgQnVkZHk6IFRhZyBlbWJlZCBpbiB1bnN1cHBvcnRlZCBlbGVtZW50LicpO1xuXHRcdFx0XHQvLyBIYW5kbGUgdGhpcyBpc3N1ZSBvbiBjbGljay5cblx0XHRcdH1cblx0XHR9KTtcblx0XHQvL3JldHVybiBlbWJlZGVkVGFnRmlsZXM7XG5cdH1cblxuXHRhc3luYyBwcm9jZXNzTmF0aXZlRW1iZWQgKGVtYmVkKSB7XG5cblx0XHRjb25zdCBsaW5rRWxlbWVudCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnc3JjJyk7IC8vdGhpcy5maW5kQW5jZXN0b3IoY2xpY2tlZFRhZywgJ3NwYW4nKVxuXHRcdGxldCBmaWxlUGF0aCA9IGVtYmVkLmdldEF0dHJpYnV0ZSgnc3JjJyk7XG5cdFx0Y29uc3QgbGlua0FycmF5ID0gZmlsZVBhdGguc3BsaXQoJyMnKTtcblx0XHRmaWxlUGF0aCA9IGxpbmtBcnJheVswXS50cmltKCkgKyAnLm1kJztcblx0XHRjb25zdCBmaWxlID0gYXdhaXQgdGhpcy52YWxpZGF0ZUZpbGVQYXRoKGZpbGVQYXRoKVxuXHRcdGlmIChmaWxlKSB7XG5cdFx0XHRjb25zdCBmaWxlQ29udGVudCA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xuXHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudClcblx0XHRcdC8vZW1iZWRlZFRhZ0ZpbGVzLnB1c2goZW1iZWRlZFRhZ0ZpbGUpO1xuXHRcdFx0XG5cdFx0XHRjb25zdCB0ZW1wQ29tcG9uZW50ID0gbmV3IFRlbXBDb21wb25lbnQoKTtcblx0XHRcdGNvbnN0IHRlbXBDb250YWluZXJIVE1MID0gY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0XHRcblx0XHRcdGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oZmlsZUNvbnRlbnQsIHRlbXBDb250YWluZXJIVE1MLCBmaWxlLnBhdGgsIHRlbXBDb21wb25lbnQpO1xuXHRcdFx0XG5cdFx0XHQvL2NvbnN0IGlubmVyVGV4dCA9IHRoaXMuY2xlYW5TdHJpbmcoZW1iZWQucXVlcnlTZWxlY3RvcignLm1hcmtkb3duLWVtYmVkLWNvbnRlbnQnKS5pbm5lclRleHQpO1xuXHRcdFx0Ly9jb25zdCBzdGFydEluZGV4ID0gdGhpcy5jbGVhblN0cmluZyh0ZW1wQ29udGFpbmVySFRNTC5pbm5lclRleHQpLmluZGV4T2YoaW5uZXJUZXh0KTtcblx0XHRcdGNvbnN0IGlubmVyVGV4dCA9IGVtYmVkLnF1ZXJ5U2VsZWN0b3IoJy5tYXJrZG93bi1lbWJlZC1jb250ZW50JykuaW5uZXJUZXh0O1xuXHRcdFx0Y29uc3Qgc3RhcnRJbmRleCA9IHRlbXBDb250YWluZXJIVE1MLmlubmVyVGV4dC5pbmRleE9mKGlubmVyVGV4dCk7XG5cdFx0XHRcblx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICduYXRpdmUtZW1iZWQnKTtcblx0XHR9XG5cdH1cblxuXHRhc3luYyBwcm9jZXNzVGFnU3VtbWFyeSAoZW1iZWQpIHtcblxuXG5cdFx0bGV0IHN1bW1hcnlCbG9ja3MgPSBlbWJlZC5xdWVyeVNlbGVjdG9yQWxsKCdibG9ja3F1b3RlJyk7IFxuXHRcdHN1bW1hcnlCbG9ja3MuZm9yRWFjaChhc3luYyAoYmxvY2ssIGluZGV4KSA9PiB7XG5cblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gYmxvY2suZ2V0QXR0cmlidXRlKCdmaWxlLXNvdXJjZScpOyAvLyBsaW5rRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtaHJlZicpXG5cdFx0XHRjb25zdCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuXHRcdFx0aWYgKGZpbGUpIHtcblx0XHRcdFx0Y29uc3QgZmlsZUNvbnRlbnQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKTtcblx0XHRcdFx0Y29uc3QgZW1iZWRlZFRhZ0ZpbGUgPSBhd2FpdCB0aGlzLmdldE1hcmtkb3duVGFncyhmaWxlLCBmaWxlQ29udGVudCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBDcmVhdGUgYSB0ZW1wb3J0eSBlbGVtZW50IGJsb2NrIHNvIHdlIGNhbiBtYXRjaCBtYXRjaCB0ZXh0IG9ubHkgY29udGVudCBvZiB0aGlzIGVsZW1lbnQgd2l0aCBpdCdzIHNvdXJjZSBub3RlXG5cdFx0XHRcdGNvbnN0IHRlbXBCbG9jayA9IGJsb2NrLmNsb25lTm9kZSh0cnVlKTtcblx0XHRcdFx0Ly90ZW1wQmxvY2sucXVlcnlTZWxlY3RvcignYnInKT8ucmVtb3ZlKCk7XG5cdFx0XHRcdC8vdGVtcEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJ3N0cm9uZycpPy5yZW1vdmUoKTsgXG5cdFx0XHRcdHRlbXBCbG9jay5xdWVyeVNlbGVjdG9yKCcudGFnc3VtbWFyeS1pdGVtLXRpdGxlJyk/LnJlbW92ZSgpOyBcblx0XHRcdFx0dGVtcEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy50YWdzdW1tYXJ5LWJ1dHRvbnMnKT8ucmVtb3ZlKCk7IFxuXHRcdFx0XHQvL2NvbnN0IGJsb2NrVGV4dCA9IHRoaXMuY2xlYW5TdHJpbmcodGVtcEJsb2NrLmlubmVyVGV4dCk7IC8vIGZ1Y2sgdGhpcyBidWchXG5cdFx0XHRcdC8vY29uc3Qgc3RhcnRJbmRleCA9IHRoaXMuY2xlYW5TdHJpbmcoZmlsZUNvbnRlbnQpLmluZGV4T2YoYmxvY2tUZXh0KTtcblx0XHRcdFx0Y29uc3QgYmxvY2tUZXh0ID0gdGVtcEJsb2NrLmlubmVyVGV4dDtcblx0XHRcdFx0Y29uc3Qgc3RhcnRJbmRleCA9IGZpbGVDb250ZW50LmluZGV4T2YoYmxvY2tUZXh0KTtcblxuXG5cdFx0XHRcdHRoaXMuYXNzaWduTWFya2Rvd25UYWdzKGVtYmVkZWRUYWdGaWxlLCBibG9jay5xdWVyeVNlbGVjdG9yQWxsKCcudGFnJyksIHN0YXJ0SW5kZXgsICdwbHVnaW4tc3VtbWFyeScpO1xuXHRcdFx0fVxuXHRcdH0pO1x0XHRcblx0fVxuXG5cdC8vLy8vLy8vLy8vLy8vLy8gQ1VTVE9NIFRBRy1TVU1NQVJZIElNUExFTUVOVEFUSU9OIC8vLy8vLy8vLy8vLy8vXG5cdC8vIE9SSUdJTkFMIENPREUgQlkgaHR0cHM6Ly9naXRodWIuY29tL21hY3JvamQvdGFnLXN1bW1hcnkgLy8vLy8vXG5cdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cdGFzeW5jIHN1bW1hcnlDb2RlQmxvY2tQcm9jZXNzb3IgKHNvdXJjZSwgZWwsIGN0eCkge1xuXHRcdC8vIEluaXRpYWxpemUgdGFnIGxpc3Rcblx0XHRsZXQgdGFnczogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdGxldCBpbmNsdWRlOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0bGV0IGV4Y2x1ZGU6IHN0cmluZ1tdID0gQXJyYXkoKTtcblx0XHRsZXQgc2VjdGlvbnM6IHN0cmluZ1tdID0gQXJyYXkoKTtcblxuXHRcdC8vIFByb2Nlc3Mgcm93cyBpbnNpZGUgY29kZWJsb2NrXG5cdFx0Y29uc3Qgcm93cyA9IHNvdXJjZS5zcGxpdChcIlxcblwiKS5maWx0ZXIoKHJvdykgPT4gcm93Lmxlbmd0aCA+IDApO1xuXHRcdHJvd3MuZm9yRWFjaCgobGluZSkgPT4ge1xuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIGxpbmUgc3BlY2lmaWVzIHRoZSB0YWdzIChPUilcblx0XHRcdGlmIChsaW5lLm1hdGNoKC9eXFxzKnRhZ3M6W1xccHtMfTAtOV9cXC0vIyBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqdGFnczovLCBcIlwiKS50cmltKCk7XG5cblx0XHRcdFx0Ly8gR2V0IHRoZSBsaXN0IG9mIHZhbGlkIHRhZ3MgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSB0YWdzIHZhcmlhYmxlXG5cdFx0XHRcdGxldCBsaXN0ID0gY29udGVudC5zcGxpdCgvXFxzKy8pLm1hcCgodGFnKSA9PiB0YWcudHJpbSgpKTtcblx0XHRcdFx0bGlzdCA9IGxpc3QuZmlsdGVyKCh0YWcpID0+IHtcblx0XHRcdFx0XHRpZiAodGFnLm1hdGNoKC9eI1tcXHB7TH1dK1teI10qJC91KSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHR0YWdzID0gbGlzdDtcblx0XHRcdH1cblx0XHRcdC8vIENoZWNrIGlmIHRoZSBsaW5lIHNwZWNpZmllcyB0aGUgdGFncyB0byBpbmNsdWRlIChBTkQpXG5cdFx0XHRpZiAobGluZS5tYXRjaCgvXlxccyppbmNsdWRlOltcXHB7TH0wLTlfXFwtLyMgXSskL2d1KSkge1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gbGluZS5yZXBsYWNlKC9eXFxzKmluY2x1ZGU6LywgXCJcIikudHJpbSgpO1xuXG5cdFx0XHRcdC8vIEdldCB0aGUgbGlzdCBvZiB2YWxpZCB0YWdzIGFuZCBhc3NpZ24gdGhlbSB0byB0aGUgaW5jbHVkZSB2YXJpYWJsZVxuXHRcdFx0XHRsZXQgbGlzdCA9IGNvbnRlbnQuc3BsaXQoL1xccysvKS5tYXAoKHRhZykgPT4gdGFnLnRyaW0oKSk7XG5cdFx0XHRcdGxpc3QgPSBsaXN0LmZpbHRlcigodGFnKSA9PiB7XG5cdFx0XHRcdFx0aWYgKHRhZy5tYXRjaCgvXiNbXFxwe0x9XStbXiNdKiQvdSkpIHtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9KTtcblx0XHRcdFx0aW5jbHVkZSA9IGxpc3Q7XG5cdFx0XHR9XG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgdGhlIHRhZ3MgdG8gZXhjbHVkZSAoTk9UKVxuXHRcdFx0aWYgKGxpbmUubWF0Y2goL15cXHMqZXhjbHVkZTpbXFxwe0x9MC05X1xcLS8jIF0rJC9ndSkpIHtcblx0XHRcdFx0Y29uc3QgY29udGVudCA9IGxpbmUucmVwbGFjZSgvXlxccypleGNsdWRlOi8sIFwiXCIpLnRyaW0oKTtcblxuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2YgdmFsaWQgdGFncyBhbmQgYXNzaWduIHRoZW0gdG8gdGhlIGV4Y2x1ZGUgdmFyaWFibGVcblx0XHRcdFx0bGV0IGxpc3QgPSBjb250ZW50LnNwbGl0KC9cXHMrLykubWFwKCh0YWcpID0+IHRhZy50cmltKCkpO1xuXHRcdFx0XHRsaXN0ID0gbGlzdC5maWx0ZXIoKHRhZykgPT4ge1xuXHRcdFx0XHRcdGlmICh0YWcubWF0Y2goL14jW1xccHtMfV0rW14jXSokL3UpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSk7XG5cdFx0XHRcdGV4Y2x1ZGUgPSBsaXN0O1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbGluZSBzcGVjaWZpZXMgc2VjdGlvbnMgb2YgYSBub3RlXG5cdFx0XHRpZiAobGluZS5tYXRjaCgvXlxccypzZWN0aW9uczpbXFxwe0x9MC05X1xcLS8jLCBdKyQvZ3UpKSB7XG5cdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBsaW5lLnJlcGxhY2UoL15cXHMqc2VjdGlvbnM6LywgXCJcIikudHJpbSgpO1xuXHRcdFx0XHQvLyBHZXQgdGhlIGxpc3Qgb2Ygc2VjdGlvbnMgYW5kIGFzc2lnbiB0aGVtIHRvIHRoZSBzZWN0aW9ucyB2YXJpYWJsZVxuXHRcdFx0XHRsZXQgbGlzdCA9IGNvbnRlbnQuc3BsaXQoJywnKS5tYXAoKHNlYykgPT4gc2VjLnRyaW0oKSk7XG5cdFx0XHRcdHNlY3Rpb25zID0gbGlzdDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIENyZWF0ZSBzdW1tYXJ5IG9ubHkgaWYgdGhlIHVzZXIgc3BlY2lmaWVkIHNvbWUgdGFnc1xuXHRcdGlmICh0YWdzLmxlbmd0aCA+IDAgfHwgaW5jbHVkZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZVN1bW1hcnkoZWwsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUsIHNlY3Rpb25zLCBjdHguc291cmNlUGF0aCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHRoaXMuY3JlYXRlRW1wdHlTdW1tYXJ5KGVsKTtcblx0XHR9IFxuXHR9OyBcblxuXHRjcmVhdGVFbXB0eVN1bW1hcnkoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcblx0XHRjb25zdCBjb250YWluZXIgPSBjcmVhdGVFbChcImRpdlwiKTtcblx0XHRjb250YWluZXIuc2V0QXR0cmlidXRlKCdjbGFzcycsICdzdW1tYXJ5Jyk7XG5cdFx0Y29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7XG5cdFx0XHRhdHRyOiB7IHN0eWxlOiAnY29sb3I6IHZhcigtLXRleHQtZXJyb3IpICFpbXBvcnRhbnQ7JyB9LFxuXHRcdFx0dGV4dDogXCJUaGVyZSBhcmUgbm8gZmlsZXMgd2l0aCBibG9ja3MgdGhhdCBtYXRjaCB0aGUgc3BlY2lmaWVkIHRhZ3MuXCIgXG5cdFx0fSk7XG5cdFx0ZWxlbWVudC5yZXBsYWNlV2l0aChjb250YWluZXIpO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlU3VtbWFyeShlbGVtZW50OiBIVE1MRWxlbWVudCwgdGFnczogc3RyaW5nW10sIGluY2x1ZGU6IHN0cmluZ1tdLCBleGNsdWRlOiBzdHJpbmdbXSwgc2VjdGlvbnM6IHN0cmluZ1tdLCBmaWxlUGF0aDogc3RyaW5nKSB7XG5cdFx0XG5cdFx0Y29uc3QgYWN0aXZlRmlsZSA9IGF3YWl0IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cdFx0Y29uc3QgdmFsaWRUYWdzID0gdGFncy5jb25jYXQoaW5jbHVkZSk7IC8vIEFsbCB0aGUgdGFncyBzZWxlY3RlZCBieSB0aGUgdXNlclxuXHRcdGNvbnN0IHRlbXBDb21wb25lbnQgPSBuZXcgVGVtcENvbXBvbmVudCgpO1xuXHRcdGNvbnN0IHN1bW1hcnlDb250YWluZXIgPSBjcmVhdGVFbCgnZGl2Jyk7XG5cdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3N1bW1hcnknKTtcblx0XHRcblx0XHQvLyBHZXQgZmlsZXNcblx0XHRsZXQgbGlzdEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuXG5cdFx0Ly8gRmlsdGVyIGZpbGVzXG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLmZpbHRlcigoZmlsZSkgPT4ge1xuXHRcdFx0Ly8gUmVtb3ZlIGZpbGVzIHRoYXQgZG8gbm90IGNvbnRhaW4gdGhlIHRhZ3Mgc2VsZWN0ZWQgYnkgdGhlIHVzZXJcblx0XHRcdGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0Y29uc3QgdGFnc0luRmlsZSA9IGdldEFsbFRhZ3MoY2FjaGUpO1xuXG5cdFx0XHRpZiAodmFsaWRUYWdzLnNvbWUoKHZhbHVlKSA9PiB0YWdzSW5GaWxlLmluY2x1ZGVzKHZhbHVlKSkpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuXG5cdFx0Ly8gU29ydCBmaWxlcyBhbHBoYWJldGljYWxseVxuXHRcdC8vIGNoYW5nZSB0byBzb3J0IGJ5IGxhc3QgbW9kaWZpZWQ/XG5cdFx0bGlzdEZpbGVzID0gbGlzdEZpbGVzLnNvcnQoKGZpbGUxLCBmaWxlMikgPT4ge1xuXHRcdFx0aWYgKGZpbGUxLnBhdGggPCBmaWxlMi5wYXRoKSB7XG5cdFx0XHRcdHJldHVybiAtMTtcblx0XHRcdH0gZWxzZSBpZiAoZmlsZTEucGF0aCA+IGZpbGUyLnBhdGgpIHtcblx0XHRcdFx0cmV0dXJuIDE7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gMDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIEdldCBmaWxlcyBjb250ZW50XG5cdFx0bGV0IGxpc3RDb250ZW50czogW1RGaWxlLCBzdHJpbmddW10gPSBhd2FpdCB0aGlzLnJlYWRGaWxlcyhsaXN0RmlsZXMpO1xuXG5cdFx0Ly8gQ3JlYXRlIHN1bW1hcnlcblx0XHRsZXQgc3VtbWFyeTogc3RyaW5nID0gXCJcIjtcblx0XHRsaXN0Q29udGVudHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuXG5cdFx0XHQvLyBHZXQgZmlsZXMgbmFtZVxuXHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBpdGVtWzBdLm5hbWUucmVwbGFjZSgvLm1kJC9nLCBcIlwiKTtcblx0XHRcdGNvbnN0IGZpbGVQYXRoID0gaXRlbVswXS5wYXRoO1xuXHRcdFx0XG5cdFx0XHQvLyBEbyBub3QgYWRkIHRoaXMgaXRlbSBpZiBpdCdzIGluIHRoZSBzYW1lIGZpbGUgd2UncmUgY3JlYXRpbmcgdGhlIHN1bW1hcnlcblx0XHRcdGlmIChhY3RpdmVGaWxlLm5hbWUgPT0gaXRlbVswXS5uYW1lKSB7XG5cdFx0XHRcdC8vY29uc29sZS5sb2coJ3NhbWUgZmlsZScpXG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblxuXHRcdFx0Ly8gR2V0IHBhcmFncmFwaHNcblx0XHRcdGxldCBsaXN0UGFyYWdyYXBoczogc3RyaW5nW10gPSBBcnJheSgpO1xuXHRcdFx0Y29uc3QgYmxvY2tzID0gaXRlbVsxXS5zcGxpdCgvXFxuXFxzKlxcbi8pLmZpbHRlcigocm93KSA9PiByb3cudHJpbSgpLmxlbmd0aCA+IDApO1xuXG5cdFx0XHQvLyBHZXQgbGlzdCBpdGVtc1xuXHRcdFx0YmxvY2tzLmZvckVhY2goKHBhcmFncmFwaCkgPT4ge1xuXHRcdFx0XHRcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIHBhcmFncmFwaCBpcyBhbm90aGVyIHBsdWdpblxuXHRcdFx0XHRsZXQgdmFsaWQgPSBmYWxzZTtcblx0XHRcdFx0bGV0IGxpc3RUYWdzID0gcGFyYWdyYXBoLm1hdGNoKC8jW1xccHtMfTAtOV9cXC0vI10rL2d1KTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChsaXN0VGFncyAhPSBudWxsICYmIGxpc3RUYWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKCdwYXJhZ3JhcGguY29udGFpbnMoXCJgYGBcIikgOiAnICsgcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpKVxuXHRcdFx0XHRcdGlmICghcGFyYWdyYXBoLmNvbnRhaW5zKFwiYGBgXCIpKSB7XG5cdFx0XHRcdFx0XHQvL2NvbnNvbGUubG9nKGluY2x1ZGUpXG5cdFx0XHRcdFx0XHR2YWxpZCA9IHRoaXMuaXNWYWxpZFRleHQobGlzdFRhZ3MsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUpO1xuXHRcdFx0XHRcdFx0Ly9jb25zb2xlLmxvZyh2YWxpZClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBSZW1vdmVkIGxpc3QgcGFyYWdyYXBocyBmdW5jdGlvbmFsaXR5XG5cdFx0XHRcdGlmICh2YWxpZCkge1xuXG5cdFx0XHRcdFx0Ly8gQWRkIHBhcmFncmFwaHMgYW5kIHRoZSBpdGVtcyBvZiBhIGxpc3Rcblx0XHRcdFx0XHRsZXQgbGlzdEl0ZW1zOiBzdHJpbmdbXSA9IEFycmF5KCk7XG5cdFx0XHRcdFx0bGV0IGl0ZW1UZXh0ID0gXCJcIjtcblxuXHRcdFx0XHRcdHBhcmFncmFwaC5zcGxpdCgnXFxuXFxzKlxcbicpLmZvckVhY2goKGxpbmUpID0+IHtcblx0XHRcdFx0XHRcdGxldCBpc0xpc3QgPSBmYWxzZTtcblx0XHRcdFx0XHRcdGlzTGlzdCA9IGxpbmUuc2VhcmNoKC8oXFxzKltcXC1cXCtcXCpdKXsxfXwoWzAtOV1cXC4pezF9XFxzKy8pICE9IC0xXG5cblx0XHRcdFx0XHRcdGlmICghaXNMaXN0KSB7XG5cdFx0XHRcdFx0XHRcdC8vIEFkZCBub3JtYWwgcGFyYWdyYXBoc1xuXHRcdFx0XHRcdFx0XHRsaXN0UGFyYWdyYXBocy5wdXNoKGxpbmUpO1xuXHRcdFx0XHRcdFx0XHRpdGVtVGV4dCA9IFwiXCI7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRsaW5lLnNwbGl0KCdcXG4nKS5mb3JFYWNoKChpdGVtTGluZSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdC8vIEdldCB0aGUgaXRlbSdzIGxldmVsXG5cdFx0XHRcdFx0XHRcdFx0bGV0IGxldmVsID0gMDtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBlbmRJbmRleCA9IGl0ZW1MaW5lLnNlYXJjaCgvW1xcLVxcK1xcKl17MX18KFswLTldXFwuKXsxfVxccysvKTtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB0YWJUZXh0ID0gaXRlbUxpbmUuc2xpY2UoMCwgZW5kSW5kZXgpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IHRhYnMgPSB0YWJUZXh0Lm1hdGNoKC9cXHQvZyk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRhYnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGxldmVsID0gdGFicy5sZW5ndGg7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdC8vIEdldCBpdGVtcyB0cmVlXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGxldmVsID09IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpdGVtVGV4dCAhPSBcIlwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGxpc3RJdGVtcy5wdXNoKGl0ZW1UZXh0KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aXRlbVRleHQgPSBcIlwiO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbVRleHQgPSBcIlwiICsgaXRlbVRleHQuY29uY2F0KGl0ZW1MaW5lICsgXCJcXG5cIik7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBSZW1vdmVkIGluY2x1ZGUgY2hpbGRyZW4gc2V0dGluZ1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobGV2ZWwgPiAwICYmIGl0ZW1UZXh0ICE9IFwiXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGl0ZW1UZXh0ID0gaXRlbVRleHQuY29uY2F0KGl0ZW1MaW5lICsgXCJcXG5cIik7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KTtcblxuXHRcdFx0XHRcdGlmIChpdGVtVGV4dCAhPSBcIlwiKSB7XG5cdFx0XHRcdFx0XHRsaXN0SXRlbXMucHVzaChpdGVtVGV4dCk7XG5cdFx0XHRcdFx0XHRpdGVtVGV4dCA9IFwiXCI7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgdGFncyBvbiB0aGUgaXRlbXNcblx0XHRcdFx0XHRsaXN0SXRlbXMuZm9yRWFjaCgobGluZSkgPT4ge1xuXHRcdFx0XHRcdFx0bGlzdFRhZ3MgPSBsaW5lLm1hdGNoKC8jW1xccHtMfTAtOV9cXC0vI10rL2d1KTtcblx0XHRcdFx0XHRcdGlmIChsaXN0VGFncyAhPSBudWxsICYmIGxpc3RUYWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuaXNWYWxpZFRleHQobGlzdFRhZ3MsIHRhZ3MsIGluY2x1ZGUsIGV4Y2x1ZGUpKSB7XG5cdFx0XHRcdFx0XHRcdFx0bGlzdFBhcmFncmFwaHMucHVzaChsaW5lKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFxuXHRcdFx0fSlcblxuXHRcdFx0Ly8gUHJvY2VzcyBlYWNoIGJsb2NrIG9mIHRleHRcblx0XHRcdGxpc3RQYXJhZ3JhcGhzLmZvckVhY2goYXN5bmMocGFyYWdyYXBoKSA9PiB7XG5cdFx0XHRcdC8vIFJlc3RvcmUgbmV3bGluZSBhdCB0aGUgZW5kXG5cdFx0XHRcdHBhcmFncmFwaCArPSBcIlxcblwiO1xuXHRcdFx0XHR2YXIgcmVnZXggPSBuZXcgUmVnRXhwO1xuXG5cdFx0XHRcdC8vIENoZWNrIHdoaWNoIHRhZyBtYXRjaGVzIGluIHRoaXMgcGFyYWdyYXBoLlxuXHRcdFx0XHR2YXIgdGFnVGV4dCA9IG5ldyBTdHJpbmc7XG5cdFx0XHRcdHZhciB0YWdTZWN0aW9uID0gbnVsbDtcblx0XHRcdFx0dGFncy5mb3JFYWNoKCh0YWcpID0+IHtcblx0XHRcdFx0XHR0YWdUZXh0ID0gdGFnLnJlcGxhY2UoJyMnLCAnXFxcXCMnKTtcblx0XHRcdFx0XHRyZWdleCA9IG5ldyBSZWdFeHAoYCR7dGFnVGV4dH0oXFxcXFd8JClgLCAnZycpO1xuICAgICAgICAgICAgICBcdFx0aWYgKHBhcmFncmFwaC5tYXRjaChyZWdleCkgIT0gbnVsbCkgeyBcbiAgICAgICAgICAgICAgXHRcdFx0dGFnU2VjdGlvbiA9IHRhZ1xuICAgICAgICAgICAgICBcdFx0fSBcbiAgICAgICAgICAgIFx0fSk7XG4gICAgICAgICAgXHRcdFxuICAgICAgICAgIFx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjcmVhdGVFbCgnZGl2Jyk7XG4gICAgICAgICAgXHRcdGJ1dHRvbkNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3RhZ3N1bW1hcnktYnV0dG9ucycpXG5cbiAgICAgICAgICBcdFx0Y29uc3QgcGFyYWdyYXBoQ29udGVudCA9IGNyZWF0ZUVsKFwiYmxvY2txdW90ZVwiKTtcblx0XHRcdFx0cGFyYWdyYXBoQ29udGVudC5zZXRBdHRyaWJ1dGUoJ2ZpbGUtc291cmNlJywgZmlsZVBhdGgpO1xuXHRcdFx0XHQvL3BhcmFncmFwaENvbnRlbnQuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcblxuXG5cdFx0XHRcdC8qaWYgKHRoaXMuYXBwLnBsdWdpbnMuZ2V0UGx1Z2luKCdxdWlja2FkZCcpKSB7XG5cdFx0XHRcdFx0bGV0IGNvdW50ID0gMDtcblx0XHRcdFx0XHRzZWN0aW9ucy5mb3JFYWNoKChzZWMpID0+IHtcblx0XHRcdFx0XHRcdGlmIChjb3VudCsrID4gMykgcmV0dXJuOyAvLyBsaW1pdCB0byA0IHNlY3Rpb24gYnV0dG9ucyBmb3Igbm93LCBmb3Igc3BhY2UuXG5cdFx0XHRcdFx0XHRidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5tYWtlQ29weVRvQnV0dG9uIChwYXJhZ3JhcGgsIHNlYywgcGFyYWdyYXBoQ29udGVudCwgdGFnU2VjdGlvbiwgZmlsZVBhdGgpKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSovXG5cblx0XHRcdFx0Ly9idXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5tYWtlQ29weUJ1dHRvbihwYXJhZ3JhcGgudHJpbSgpKSk7XG5cdFx0XHRcdC8vYnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMubWFrZVJlbW92ZVRhZ0J1dHRvbihwYXJhZ3JhcGhDb250ZW50LCB0YWdTZWN0aW9uLCBmaWxlUGF0aCkpO1xuXG5cblx0XHRcdFx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXHRcdFx0XHQvLyAgTUVTU1khIExvdHMgb2YgcmVmYWN0b3JpbmcgdG8gYmUgZG9uZSBpbiB0aGlzIGZ1bmN0aW9uXG5cdFx0XHRcdC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0XHRcdFx0XG5cdFx0XHRcdC8vIEFkZCBsaW5rIHRvIG9yaWdpbmFsIG5vdGUuIFRhZyBCdWRkeSBhZGRlZCBkZWVwIGxpbmtpbmcuXG5cdFx0XHRcdGNvbnN0IGJsb2NrTGluayA9IHBhcmFncmFwaC5tYXRjaCgvXFxeW1xccHtMfTAtOV9cXC0vXl0rL2d1KTsgXG5cdFx0XHRcdGxldCBsaW5rO1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKGZpbGVQYXRoLCBmaWxlTmFtZSlcbiAgICAgICAgXHRcdGlmIChibG9ja0xpbmspIHsgXG4gICAgICAgIFx0XHRcdC8vcGFyYWdyYXBoID0gXCIqKltbXCIgKyBmaWxlUGF0aCArIFwiI1wiICsgYmxvY2tMaW5rICsgXCJ8XCIgKyBmaWxlTmFtZSArIFwiXV0qKlwiICsgcGFyYWdyYXBoOyBcbiAgICAgICAgXHRcdFx0bGluayA9ICdbWycgKyBmaWxlUGF0aCArICcjJyArIGJsb2NrTGluayArICd8JyArIGZpbGVOYW1lICsgJ11dJztcblxuICAgICAgICBcdFx0XHRpZiAodGhpcy5hcHAucGx1Z2lucy5nZXRQbHVnaW4oJ3F1aWNrYWRkJykpIHtcblx0XHRcdFx0XHRcdGxldCBjb3VudCA9IDA7XG5cdFx0XHRcdFx0XHRzZWN0aW9ucy5mb3JFYWNoKChzZWMpID0+IHtcblx0XHRcdFx0XHRcdFx0aWYgKGNvdW50KysgPiAzKSByZXR1cm47IC8vIGxpbWl0IHRvIDQgc2VjdGlvbiBidXR0b25zIGZvciBub3csIGZvciBzcGFjZS5cblx0XHRcdFx0XHRcdFx0YnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMubWFrZUNvcHlUb0J1dHRvbiAocGFyYWdyYXBoLCBzZWMsIHBhcmFncmFwaENvbnRlbnQsIHRhZ1NlY3Rpb24sIChmaWxlUGF0aCArICcjJyArIGJsb2NrTGluaykpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLm1ha2VDb3B5QnV0dG9uKHBhcmFncmFwaC50cmltKCkpKTtcbiAgICAgICAgXHRcdFx0YnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMubWFrZVJlbW92ZVRhZ0J1dHRvbihwYXJhZ3JhcGhDb250ZW50LCB0YWdTZWN0aW9uLCAoZmlsZVBhdGggKyAnIycgKyBibG9ja0xpbmspKSk7XG5cbiAgICAgICAgXHRcdH0gZWxzZSB7IFxuICAgICAgICBcdFx0XHQvL3BhcmFncmFwaCA9IFwiKipbW1wiICsgZmlsZVBhdGggKyBcInxcIiArIGZpbGVOYW1lICsgXCJdXSoqXCIgKyBwYXJhZ3JhcGg7IFxuICAgICAgICBcdFx0XHRsaW5rID0gJ1tbJyArIGZpbGVQYXRoICsgJ3wnICsgZmlsZU5hbWUgKyAnXV0nO1xuXG4gICAgICAgIFx0XHRcdGlmICh0aGlzLmFwcC5wbHVnaW5zLmdldFBsdWdpbigncXVpY2thZGQnKSkge1xuXHRcdFx0XHRcdFx0bGV0IGNvdW50ID0gMDtcblx0XHRcdFx0XHRcdHNlY3Rpb25zLmZvckVhY2goKHNlYykgPT4ge1xuXHRcdFx0XHRcdFx0XHRpZiAoY291bnQrKyA+IDMpIHJldHVybjsgLy8gbGltaXQgdG8gNCBzZWN0aW9uIGJ1dHRvbnMgZm9yIG5vdywgZm9yIHNwYWNlLlxuXHRcdFx0XHRcdFx0XHRidXR0b25Db250YWluZXIuYXBwZW5kQ2hpbGQodGhpcy5tYWtlQ29weVRvQnV0dG9uIChwYXJhZ3JhcGgsIHNlYywgcGFyYWdyYXBoQ29udGVudCwgdGFnU2VjdGlvbiwgZmlsZVBhdGgpKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdGJ1dHRvbkNvbnRhaW5lci5hcHBlbmRDaGlsZCh0aGlzLm1ha2VDb3B5QnV0dG9uKHBhcmFncmFwaC50cmltKCkpKTtcbiAgICAgICAgXHRcdFx0YnV0dG9uQ29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMubWFrZVJlbW92ZVRhZ0J1dHRvbihwYXJhZ3JhcGhDb250ZW50LCB0YWdTZWN0aW9uLCAoZmlsZVBhdGgpKSk7XG4gICAgICAgIFx0XHR9XG5cbiAgICAgICAgXHRcdHBhcmFncmFwaCA9ICcqKicgKyBsaW5rICsgJyoqJyArIHBhcmFncmFwaDsgXG5cblxuICAgICAgICBcdFx0Ly8gT3JpZ2luYWwgZm9ybWF0dGluZyBtZXRob2QuIFdpbGwgcmVtb3ZlLlxuICAgICAgICAgICAgXHRwYXJhZ3JhcGggKz0gXCJcXG5cXG5cIjtcbiAgICAgICAgICBcdFx0c3VtbWFyeSArPSBwYXJhZ3JhcGg7XG5cbiAgICAgICAgICBcdFx0YXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihwYXJhZ3JhcGgsIHBhcmFncmFwaENvbnRlbnQsIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk/LnBhdGgsIHRlbXBDb21wb25lbnQpO1xuICAgICAgICAgIFx0XHQvL2NvbnNvbGUubG9nKHBhcmFncmFwaENvbnRlbnQpXG4gICAgICAgICAgXHRcdFxuXG4gICAgICAgICAgXHRcdC8qY29uc3QgdGl0bGVFbCA9IGNyZWF0ZUVsKCdkaXYnKTtcbiAgICAgICAgICBcdFx0dGl0bGVFbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgJ3RhZ3N1bW1hcnktaXRlbS10aXRsZScpO1xuICAgICAgICAgIFx0XHR0aXRsZUVsLmFwcGVuZENoaWxkKHBhcmFncmFwaENvbnRlbnQucXVlcnlTZWxlY3Rvcignc3Ryb25nJykuY2xvbmVOb2RlKHRydWUpKVxuICAgICAgICAgIFx0XHR0aXRsZUVsLmFwcGVuZENoaWxkKGJ1dHRvbkNvbnRhaW5lcik7XG4gICAgICAgICAgXHRcdHBhcmFncmFwaENvbnRlbnQucXVlcnlTZWxlY3Rvcignc3Ryb25nJykucmVwbGFjZVdpdGgodGl0bGVFbCkqL1xuICAgICAgICAgIFx0XHRjb25zdCB0aXRsZUVsID0gY3JlYXRlRWwoJ2RpdicpO1xuICAgICAgICAgIFx0XHR0aXRsZUVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAndGFnc3VtbWFyeS1pdGVtLXRpdGxlJyk7XG4gICAgICAgICAgXHRcdHRpdGxlRWwuYXBwZW5kQ2hpbGQocGFyYWdyYXBoQ29udGVudC5xdWVyeVNlbGVjdG9yKCdzdHJvbmcnKS5jbG9uZU5vZGUodHJ1ZSkpXG4gICAgICAgICAgXHRcdHBhcmFncmFwaENvbnRlbnQuYXBwZW5kQ2hpbGQoYnV0dG9uQ29udGFpbmVyKTtcbiAgICAgICAgICBcdFx0cGFyYWdyYXBoQ29udGVudC5xdWVyeVNlbGVjdG9yKCdzdHJvbmcnKS5yZXBsYWNlV2l0aCh0aXRsZUVsKVxuXG4gICAgICAgICAgXHRcdHN1bW1hcnlDb250YWluZXIuYXBwZW5kQ2hpbGQocGFyYWdyYXBoQ29udGVudCk7XG5cdFx0XHR9KTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBTdW1tYXJ5XG5cdFx0aWYgKHN1bW1hcnkgIT0gXCJcIikge1xuXHRcdFx0Ly8gT3JpZ2luYWwgZm9ybWF0dGluZyBtZXRob2QuIFdpbGwgcmVtb3ZlLlxuXHRcdFx0Ly8gYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihzdW1tYXJ5LCBzdW1tYXJ5Q29udGFpbmVyLCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpPy5wYXRoLCB0ZW1wQ29tcG9uZW50KTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncycsIHRhZ3Muam9pbignLCcpKTtcblx0XHRcdHN1bW1hcnlDb250YWluZXIuc2V0QXR0cmlidXRlKCdjb2RlYmxvY2stdGFncy1pbmNsdWRlJywgKChpbmNsdWRlLmxlbmd0aD4wKT9pbmNsdWRlLmpvaW4oJywnKTonJykpO1xuXHRcdFx0c3VtbWFyeUNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2NvZGVibG9jay10YWdzLWV4Y2x1ZGUnLCAoKGV4Y2x1ZGUubGVuZ3RoPjApP2V4Y2x1ZGUuam9pbignLCcpOicnKSk7XG5cdFx0XHRzdW1tYXJ5Q29udGFpbmVyLnNldEF0dHJpYnV0ZSgnY29kZWJsb2NrLXNlY3Rpb25zJywgKChzZWN0aW9ucy5sZW5ndGg+MCk/c2VjdGlvbnMuam9pbignLCcpOicnKSk7XG5cdFx0XHRlbGVtZW50LnJlcGxhY2VXaXRoKHN1bW1hcnlDb250YWluZXIpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0aGlzLmNyZWF0ZUVtcHR5U3VtbWFyeShlbGVtZW50KTtcblx0XHR9XG5cdH1cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblx0Ly8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuXG5cdG1ha2VDb3B5VG9CdXR0b24gKGNvbnRlbnQsIHNlY3Rpb24sIHBhcmFncmFwaCwgdGFnLCBmaWxlUGF0aCkge1xuXHRcdFxuXG5cdFx0Y29uc3QgcXVpY2tBZGRQbHVnaW4gPSB0aGlzLmFwcC5wbHVnaW5zLnBsdWdpbnMucXVpY2thZGQuYXBpOyAvLyBuZWVkIHRvIGNoZWNrIGlmIHRoaXMgcGx1Z2luIGlzIGluc3RhbGxlZC4gYW5kIHNldHRpbmdzLlxuXHRcdFxuXHRcdGNvbnN0IGJ1dHRvbiA9IHRoaXMubWFrZUJ1dHRvbiAoKCcgXHUyNzRGICAgJyArIHNlY3Rpb24pLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjb25zdCBzZWN0aW9uRWxPYmogPSB0aGlzLmdldFNlY3Rpb25UaXRsZVdpdGhIYXNoZXMoc2VjdGlvbik7XG5cdFx0XHRjb25zdCBjb250ZW50QXNMaXN0ID0gJy0gJyArIGNvbnRlbnQudHJpbSgpICsgJ1xcbic7XG5cdFx0XHRpZiAoc2VjdGlvbkVsT2JqKSB7XG5cdFx0XHRcdGlmIChlLm1ldGFLZXkpIHtcblx0XHRcdFx0XHRxdWlja0FkZFBsdWdpbi5leGVjdXRlQ2hvaWNlKCdDb3B5IFRvIFNlY3Rpb24nLCB7c2VjdGlvbjpzZWN0aW9uRWxPYmoubWQsIGNvbnRlbnQ6KHRoaXMucmVtb3ZlVGFnRnJvbVN0cmluZyhjb250ZW50QXNMaXN0LCB0YWcpKydcXG4nKX0pO1xuXHRcdFx0XHRcdC8vIGlkZWFsbHkgd2UgY2FuIHJlcGxpY2F0ZSB0aGlzIFF1aWNrQWRkIGZ1bmN0aW9uYWxpdHkuLi5cblx0XHRcdFx0XHR0aGlzLmVkaXRUYWcgKHRoaXMuZ2V0VGFnRWxlbWVudChwYXJhZ3JhcGgsIHRhZykpO1xuXG5cdFx0XHRcdFx0Ly8gZGVlcCBsaW5rIHRvIHRoaXMgcGFyYWdyYXBoXG5cblx0XHRcdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnQ29waWVkIHRvICcgKyBzZWN0aW9uICsgJyBhbmQgJyArIHRhZyArICcgcmVtb3ZlZC5cXG5cdUQ4M0RcdUREMTcgT3BlbiBzb3VyY2Ugbm90ZS4nLCA1MDAwKTtcblx0XHRcdFx0XHR0aGlzLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0IFx0XHRcdC8vY29uc3QgZmlsZVRvT3BlbiA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0XHRcdFx0Ly9pZiAoZmlsZVRvT3BlbiBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgXHRcdFx0XHRcdFx0Ly90aGlzLmFwcC53b3Jrc3BhY2UuYWN0aXZlTGVhZi5vcGVuRmlsZShmaWxlVG9PcGVuKTtcbiAgICBcdFx0XHRcdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGZpbGVQYXRoLCAnJyk7XG5cdFx0XHRcdFx0XHQvL31cblx0XHRcdCBcdFx0fSk7XG5cdFx0XHQgXHRcdC8vY29uc29sZS5sb2codGhpcy5yZW1vdmVUYWdGcm9tU3RyaW5nKGNvbnRlbnRBc0xpc3QsIHRhZykpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHF1aWNrQWRkUGx1Z2luLmV4ZWN1dGVDaG9pY2UoJ0NvcHkgVG8gU2VjdGlvbicsIHtzZWN0aW9uOnNlY3Rpb25FbE9iai5tZCwgY29udGVudDpjb250ZW50QXNMaXN0fSk7XG5cdFx0XHRcdFx0Ly8gaWRlYWxseSB3ZSBjYW4gcmVwbGljYXRlIHRoaXMgUXVpY2tBZGQgZnVuY3Rpb25hbGl0eS4uLlxuXHRcdFx0XHRcdG5ldyBOb3RpY2UgKCdDb3BpZWQgdG8gJyArIHNlY3Rpb24gKyAnLicpO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0XG5cdFx0XHR9IGVsc2UgeyBcblx0XHRcdFx0bmV3IE5vdGljZSAoJ1RhZyBCdWRkeSBjYW5cXCd0IGZpbmQgJyArIHNlY3Rpb24gKyAnLiBNaWdodCBub3QgYmUgcmVuZGVyZWQuIFVzZSBcdTI3NEYgdG8gY29weSBwYXJhZ3JhcGguJyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0YnV0dG9uLnRpdGxlID0gJ0NvcHkgcGFyYWdyYXBoIHRvICcgKyBzZWN0aW9uICsgJy5cXG4oQ1RSTCtDTElDSyB0byByZW1vdmUgdGFnIGFuZCBjb3B5Lic7XG5cdFx0Ly9lbGVtZW50LmFwcGVuZENoaWxkKGJ1dHRvbik7XG5cdFx0cmV0dXJuIGJ1dHRvbjtcblx0fVxuXG5cdG1ha2VDb3B5QnV0dG9uIChjb250ZW50KSB7XG5cdFx0XG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uICgnIFx1Mjc0RiAnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChjb250ZW50KTtcblx0XHRcdG5ldyBOb3RpY2UgKCdDb3BpZWQgdG8gY2xpcGJvYXJkLicpO1xuXHRcdH0pO1xuXHRcdC8vZWxlbWVudC5hcHBlbmRDaGlsZChidXR0b24pO1xuXHRcdGJ1dHRvbi50aXRsZSA9ICdDb3B5IHBhcmFncmFwaCB0byBjbGlwYm9hcmQuJztcblx0XHRyZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0bWFrZVJlbW92ZVRhZ0J1dHRvbiAocGFyYWdyYXBoLCB0YWcsIGZpbGVQYXRoKSB7XG5cdFx0XG5cdFx0Y29uc3QgYnV0dG9uID0gdGhpcy5tYWtlQnV0dG9uICgnIFx1MjMxN1x1MDJFMyAnLCAoZSkgPT4geyBcblx0XHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdFx0XHRjb25zdCBub3RpY2UgPSBuZXcgTm90aWNlICgnXHVEODNEXHVERDE2ICcgKyB0YWcgKyAnIHJlbW92ZWQgZnJvbSBwYXJhZ3JhcGguXFxuXHVEODNEXHVERDE3IE9wZW4gc291cmNlIG5vdGUuJywgNTAwMCk7XG5cblx0XHRcdC8vY29uc29sZS5sb2cocGFyYWdyYXBoKVxuXHRcdFx0Ly9jb25zb2xlLmxvZyh0aGlzLmdldFRhZ0VsZW1lbnQocGFyYWdyYXBoLCB0YWcpKVxuXG5cblx0XHRcdHRoaXMuZWRpdFRhZyAodGhpcy5nZXRUYWdFbGVtZW50KHBhcmFncmFwaCwgdGFnKSk7XG5cblx0XHRcdCB0aGlzLnJlZ2lzdGVyRG9tRXZlbnQobm90aWNlLm5vdGljZUVsLCAnY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0XHQvL2lmIChmaWxlVG9PcGVuIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICBcdFx0XHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLmFjdGl2ZUxlYWYub3BlbkZpbGUoZmlsZVRvT3Blbik7XG5cdFx0XHQgXHQgXHR0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KGZpbGVQYXRoLCAnJyk7XG5cdFx0XHRcdC8vfVxuXHRcdFx0IH0pO1xuXG5cdFx0fSk7XG5cdFx0YnV0dG9uLnRpdGxlID0gJ1JlbW92ZSAnICsgdGFnICsgJyBmcm9tIHBhcmFncmFwaC4nO1xuXHRcdC8vZWxlbWVudC5hcHBlbmRDaGlsZChidXR0b24pO1xuXHRcdHJldHVybiBidXR0b247XG5cdH1cblxuXHRtYWtlQnV0dG9uIChsYWJsZSwgY2xpY2tGbiwgY2xhc3NJZD0ndGFnc3VtbWFyeS1idXR0b24nKSB7XG5cdFx0Y29uc3QgYnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7XG5cdCAgICBidXR0b24uaW5uZXJUZXh0ID0gbGFibGU7XG5cdCAgICBidXR0b24uY2xhc3NOYW1lID0gY2xhc3NJZDtcblx0ICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChidXR0b24sICdjbGljaycsIGNsaWNrRm4uYmluZCh0aGlzKSk7XG5cdCAgICByZXR1cm4gYnV0dG9uO1xuXHR9XG5cblx0cmVtb3ZlVGFnRnJvbVN0cmluZyhpbnB1dFRleHQsIGhhc2h0YWdUb1JlbW92ZSkge1xuXHQgICAgLy8gVXNlIGEgcmVndWxhciBleHByZXNzaW9uIHRvIGdsb2JhbGx5IHJlcGxhY2UgdGhlIGhhc2h0YWcgd2l0aCBhbiBlbXB0eSBzdHJpbmdcblx0ICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChcIlxcXFxzP1wiICsgaGFzaHRhZ1RvUmVtb3ZlICsgXCJcXFxcYlwiLCBcImdpXCIpO1xuXHQgICAgcmV0dXJuIGlucHV0VGV4dC5yZXBsYWNlKHJlZ2V4LCAnJykudHJpbSgpO1xuXHR9XG5cblx0Z2V0U2VjdGlvblRpdGxlV2l0aEhhc2hlcyhzZWN0aW9uVGl0bGUpIHtcblx0ICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHQgICAgaWYgKCFhY3RpdmVWaWV3KSB7XG5cdCAgICAgICAgY29uc29sZS5sb2coJ05vIGFjdGl2ZSBtYXJrZG93biB2aWV3IGZvdW5kLicpO1xuXHQgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfVxuXG5cdCAgICBjb25zdCBjb250ZW50RWwgPSBhY3RpdmVWaWV3LmNvbnRlbnRFbDtcblxuXHQgICAgLy8gR2V0IGFsbCBoZWFkaW5nIGVsZW1lbnRzXG5cdCAgICAvLyBUaGlzIGRvZXNuJ3Qgd29yayB3aXRoIHN1cGVyIGxvbmcgbm90ZXMuIFxuXHQgICAgY29uc3QgaGVhZGluZ3MgPSBjb250ZW50RWwucXVlcnlTZWxlY3RvckFsbCgnaDEsIGgyLCBoMywgaDQsIGg1LCBoNicpO1xuXHQgICAgLy9jb25zdCBoZWFkaW5ncyA9IGF3YWl0IGNvbnRlbnRFbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdoMSwgaDIsIGgzLCBoNCwgaDUsIGg2Jyk7XG5cdCAgICBcblx0ICAgIC8vY29uc29sZS5sb2coaGVhZGluZ3MpXG5cdCAgICBmb3IgKGNvbnN0IGhlYWRpbmcgb2YgaGVhZGluZ3MpIHtcblx0ICAgICAgICBpZiAoaGVhZGluZy50ZXh0Q29udGVudC50cmltKCkgPT09IHNlY3Rpb25UaXRsZS50cmltKCkpIHtcblx0ICAgICAgICAgICAgLy8gRGV0ZXJtaW5lIHRoZSBudW1iZXIgb2YgaGFzaGVzIGJhc2VkIG9uIHRoZSBoZWFkaW5nIGxldmVsXG5cdCAgICAgICAgICAgIGNvbnN0IGxldmVsID0gcGFyc2VJbnQoaGVhZGluZy50YWdOYW1lLnN1YnN0cigxKSwgMTApOyAgLy8gZS5nLiwgXCJIMlwiIC0+IDJcblx0ICAgICAgICAgICAgY29uc3QgaGFzaGVzID0gJyMnLnJlcGVhdChsZXZlbCk7XG5cdCAgICAgICAgICAgIC8vY29uc29sZS5sb2coaGVhZGluZyk7XG5cdCAgICAgICAgICAgIHJldHVybiB7bWQ6YCR7aGFzaGVzfSAke3NlY3Rpb25UaXRsZX1gLCBlbDpoZWFkaW5nfTtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGNvbnNvbGUubG9nKGBTZWN0aW9uIFwiJHtzZWN0aW9uVGl0bGV9XCIgbm90IGZvdW5kLmApO1xuXHQgICAgcmV0dXJuIG51bGw7XG5cdH1cblxuXHRhc3luYyByZWFkRmlsZXMobGlzdEZpbGVzOiBURmlsZVtdKTogUHJvbWlzZTxbVEZpbGUsIHN0cmluZ11bXT4ge1xuXHRcdGxldCBsaXN0OiBbVEZpbGUsIHN0cmluZ11bXSA9IFtdO1xuXHRcdGZvciAobGV0IHQgPSAwOyB0IDwgbGlzdEZpbGVzLmxlbmd0aDsgdCArPSAxKSB7XG5cdFx0XHRjb25zdCBmaWxlID0gbGlzdEZpbGVzW3RdO1xuXHRcdFx0bGV0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jYWNoZWRSZWFkKGZpbGUpO1xuXHRcdFx0bGlzdC5wdXNoKFtmaWxlLCBjb250ZW50XSk7XG5cdFx0fVxuXHRcdHJldHVybiBsaXN0O1xuXHR9XG5cblx0aXNWYWxpZFRleHQobGlzdFRhZ3M6IHN0cmluZ1tdLCB0YWdzOiBzdHJpbmdbXSwgaW5jbHVkZTogc3RyaW5nW10sIGV4Y2x1ZGU6IHN0cmluZ1tdKTogYm9vbGVhbiB7XG5cdFx0bGV0IHZhbGlkID0gdHJ1ZTtcblxuXHRcdC8vIENoZWNrIE9SICh0YWdzKVxuXHRcdGlmICh0YWdzLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhbGlkID0gdmFsaWQgJiYgdGFncy5zb21lKCh2YWx1ZSkgPT4gbGlzdFRhZ3MuaW5jbHVkZXModmFsdWUpKTtcblx0XHR9XG5cdFx0Ly8gQ2hlY2sgQU5EIChpbmNsdWRlKVxuXHRcdGlmIChpbmNsdWRlLmxlbmd0aCA+IDApIHtcblx0XHRcdHZhbGlkID0gdmFsaWQgJiYgaW5jbHVkZS5ldmVyeSgodmFsdWUpID0+IGxpc3RUYWdzLmluY2x1ZGVzKHZhbHVlKSk7XG5cdFx0fVxuXHRcdC8vIENoZWNrIE5PVCAoZXhjbHVkZSlcblx0XHRpZiAodmFsaWQgJiYgZXhjbHVkZS5sZW5ndGggPiAwKSB7XG5cdFx0XHR2YWxpZCA9ICFleGNsdWRlLnNvbWUoKHZhbHVlKSA9PiBsaXN0VGFncy5pbmNsdWRlcyh2YWx1ZSkpO1xuXHRcdH1cblx0XHRyZXR1cm4gdmFsaWQ7XHRcdFxuXHR9XG5cblx0YXN5bmMgdmFsaWRhdGVGaWxlUGF0aCAoZmlsZVBhdGgpIHtcblx0XHRjb25zdCBtYXRjaGluZ0ZpbGVzID0gYXdhaXQgYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5uYW1lID09PSBmaWxlUGF0aCk7XG5cdFx0aWYgKG1hdGNoaW5nRmlsZXMubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRjb25zdCBmaWxlUGF0aCA9IG1hdGNoaW5nRmlsZXNbMF0ucGF0aDtcblx0XHRcdGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnVmFsaWRhdGUgZmlsZTogJyArIGVtYmVkRmlsZS5uYW1lKTtcblx0XHRcdHJldHVybiBmaWxlO1xuXHRcdH0gZWxzZSBpZiAobWF0Y2hpbmdGaWxlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRuZXcgTm90aWNlKCdUYWcgQnVkZHk6IE11bHRpcGxlIGZpbGVzIGZvdW5kIHdpdGggdGhlIHNhbWUgbmFtZS4gQ2FuXFwndCBzYWZlbHkgZWRpdCB0YWcuJyk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZSgnVGFnIEJ1ZGR5OiBObyBmaWxlIGZvdW5kLiBUcnkgYWdhaW4sIG9yIHRoaXMgdGFnIG1pZ2h0IGJlIGluIGFuIHVuc3VwcG9ydGVkIGVtYmVkIHR5cGUuJyk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRjb250ZW50Q2hhbmdlZFRvb011Y2gob3JpZ2luYWwsIG1vZGlmaWVkLCB0YWcsIGJ1ZmZlciA9IDUpIHtcblx0ICBjb25zdCBleHBlY3RlZENoYW5nZSA9IHRhZy5sZW5ndGg7IC8vIGluY2x1ZGluZyB0aGUgJyMnIHN5bWJvbFxuXHQgIGNvbnN0IHRocmVzaG9sZCA9IGV4cGVjdGVkQ2hhbmdlICsgYnVmZmVyOyAvLyBhbGxvdyBmb3Igc29tZSBtaW5vciB1bmludGVuZGVkIG1vZGlmaWNhdGlvbnNcblx0ICBjb25zdCBhY3R1YWxDaGFuZ2UgPSBNYXRoLmFicyhvcmlnaW5hbC5sZW5ndGggLSBtb2RpZmllZC5sZW5ndGgpO1xuXG5cdCAgcmV0dXJuIGFjdHVhbENoYW5nZSA+IHRocmVzaG9sZDtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0Ly8gZnVjay50aGlzLmZ1bmN0aW9uXG5cdC8qY2xlYW5TdHJpbmcoaW5wdXQpIHtcblx0XHRsZXQgY2xlYW5lZFN0cjtcblxuXHRcdC8vIENoZWNrIGlmIGlucHV0IGlzIGEgRE9NIGVsZW1lbnRcblx0XHRpZiAoaW5wdXQgaW5zdGFuY2VvZiBFbGVtZW50KSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdpbnB1dCBpczogRWxlbWVudCcpO1xuXHRcdFx0Y2xlYW5lZFN0ciA9IGlucHV0Lm91dGVySFRNTC50cmltKCk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vY29uc29sZS5sb2coJ2lucHV0IGlzOiBTdHJpbmcnKTtcblx0XHRcdGNsZWFuZWRTdHIgPSBpbnB1dC50cmltKCk7XG5cdFx0fVxuXG5cdFx0Ly8gV2hpdGVzcGFjZSBub3JtYWxpemF0aW9uXG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC9cXHMrL2csICcgJyk7XG5cblx0XHQvLyBSZW1vdmUgPGJyPiBlbGVtZW50c1xuXHRcdC8vY2xlYW5lZFN0ciA9IGNsZWFuZWRTdHIucmVwbGFjZSgvPGJyPi9nLCAnICcpO1xuXG5cdFx0Ly8gUmVtb3ZlIGJsb2NrcXVvdGUgdGFncyBidXQga2VlcCB0aGVpciBjb250ZW50XG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC88XFwvP2Jsb2NrcXVvdGU+L2csICcnKTtcblxuXHRcdC8vIFJlbW92ZSBibG9ja3F1b3RlIHRhZ3MgYnV0IGtlZXAgdGhlaXIgY29udGVudFxuXHRcdC8vY2xlYW5lZFN0ciA9IGNsZWFuZWRTdHIucmVwbGFjZSgvPFxcLz9kaXY+L2csICcnKTtcblxuXHRcdC8vIFJlbW92ZSBzcGFjZXMgYmV0d2VlbiB0YWdzXG5cdFx0Ly9jbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC8+XFxzKzwvZywgJz48Jyk7XG5cblx0XHQvLyBXaGl0ZXNwYWNlIG5vcm1hbGl6YXRpb25cblx0XHRjbGVhbmVkU3RyID0gY2xlYW5lZFN0ci5yZXBsYWNlKC9cXHMrL2csICcgJyk7XG5cblx0XHQvLyBIVE1MIGVudGl0eSBkZWNvZGluZ1xuXHRcdGNvbnN0IHRleHRBcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTtcblx0XHR0ZXh0QXJlYS5pbm5lckhUTUwgPSBjbGVhbmVkU3RyO1xuXHRcdGNsZWFuZWRTdHIgPSB0ZXh0QXJlYS52YWx1ZS50cmltKCk7XG5cblx0XHQvLyBPcHRpb25hbDogY29udmVydCB0byBsb3dlcmNhc2Vcblx0XHQvLyBjbGVhbmVkU3RyID0gY2xlYW5lZFN0ci50b0xvd2VyQ2FzZSgpO1xuXG5cdFx0cmV0dXJuIGNsZWFuZWRTdHI7XG5cdH0qL1xuXG5cdGFzeW5jIHJlZnJlc2hWaWV3ICgpe1xuXHRcdC8vY29uc29sZS5sb2coJ1JlZnJlc2ggdmlldy4nKTtcblx0XHRuZXcgTm90aWNlICgnUmVmcmVzaCB2aWV3LicpO1xuXHRcdC8vIGlmIHVzaW5nIHJlcmVuZGVyLFxuXHRcdC8vY29uc3Qgc2Nyb2xsU3RhdGUgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpPy5jdXJyZW50TW9kZT8uZ2V0U2Nyb2xsKCk7XG5cdFx0Ly9hd2FpdCB2aWV3LnByZXZpZXdNb2RlLnJlcmVuZGVyKHRydWUpO1xuXG5cdFx0YXdhaXQgYXBwLndvcmtzcGFjZS5hY3RpdmVMZWFmLnJlYnVpbGRWaWV3KCk7XG5cdFx0Ly8gb25seSBuZWVkZWQgaWYgd2UgdXNlIHJlcmVuZGVyIGFib3ZlLiBkbyB0aGlzIG9uIGEgdGltZW91dFxuXHRcdC8vdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KS5wcmV2aWV3TW9kZS5hcHBseVNjcm9sbChzY3JvbGxTdGF0ZSk7XG5cdH1cblxuICAgIGluamVjdFN0eWxlcygpIHtcbiAgICAvLyBDaGVjayBpZiB0aGUgc3R5bGVzIGhhdmUgYWxyZWFkeSBiZWVuIGluamVjdGVkIHRvIGF2b2lkIGR1cGxpY2F0aW9uXG4gICAgLy9pZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ215LXBsdWdpbi1zdHlsZXMnKSkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc3R5bGVzID0gYFxuICAgICAgICAudGFnc3VtbWFyeS1idXR0b24ge1xuXG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tdGV4dC1wcmltYXJ5KTtcbiAgICAgICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLXRleHQtcXVvdGUpOyAgLy8gQXNzdW1pbmcgdGhpcyBpcyB0aGUgYmxvY2sgcXVvdGUgY29sb3JcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IHZhcigtLWJvcmRlci1yYWRpdXMpO1xuICAgICAgICAgICAgcGFkZGluZzogMi41cHggNXB4OyAgLy8gUmVkdWNlZCBwYWRkaW5nXG4gICAgICAgICAgICBmb250LXNpemU6IDUwJTsgIC8vIFJlZHVjZWQgZm9udCBzaXplXG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBiYWNrZ3JvdW5kLWNvbG9yIDAuM3M7XG4gICAgICAgICAgICBtYXJnaW46IDBweCAzcHggMHB4IDBweDtcbiAgICAgICAgICAgIG1pbi13aWR0aDogNDBweCAhaW1wb3J0YW50O1xuXG5cdCAgICAgICBjb2xvcjogdmFyKC0tbGluay1jb2xvcikgIWltcG9ydGFudDtcblx0ICAgICAgIGJvcmRlcjogMXB4IHNvbGlkIHZhcigtLWxpbmstY29sb3IpICFpbXBvcnRhbnQ7IFxuXHRcdCAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSkgIWltcG9ydGFudDtcbiAgICAgICAgfVxuXG4gICAgICAgIC50YWdzdW1tYXJ5LWJ1dHRvbjpob3ZlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saW5rLWNvbG9yKSAhaW1wb3J0YW50O1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLWJhY2tncm91bmQtc2Vjb25kYXJ5KSAhaW1wb3J0YW50O1xuICAgICAgICB9XG5cbiAgICAgICAgLnRhZ3N1bW1hcnktaXRlbS10aXRsZSB7XG4gICAgICAgICAgICBtYXJnaW46IDVweCAwcHhcbiAgICAgICAgfVxuXG4gICAgICAgIC50YWdzdW1tYXJ5LWJ1dHRvbnMge1xuICAgICAgICAgICAgLypmbG9hdDogcmlnaHQ7Ki9cbiAgICAgICAgICAgIHRleHQtYWxpZ246IHJpZ2h0O1xuICAgICAgICB9XG5cblx0ICAgQG1lZGlhIG9ubHkgc2NyZWVuIGFuZCAobWF4LWRldmljZS13aWR0aDogNDgwcHgpLCBcblx0ICAgICAgIG9ubHkgc2NyZWVuIGFuZCAobWF4LXdpZHRoOiA0ODBweCkgYW5kIChvcmllbnRhdGlvbjogbGFuZHNjYXBlKSxcblx0ICAgICAgIG9ubHkgc2NyZWVuIGFuZCAobWF4LWRldmljZS13aWR0aDogMTAyNHB4KSwgXG5cdCAgICAgICBvbmx5IHNjcmVlbiBhbmQgKG1pbi13aWR0aDogNDgxcHgpIGFuZCAobWF4LXdpZHRoOiAxMDI0cHgpIGFuZCAob3JpZW50YXRpb246IGxhbmRzY2FwZSkge1xuXHRcdCAgIC50YWdzdW1tYXJ5LWJ1dHRvbiB7XG5cdFx0ICAgICAgIGRpc3BsYXk6IGlubGluZS1ibG9jayAhaW1wb3J0YW50O1xuXHRcdCAgICAgICBmb250LXNpemU6IDEycHggIWltcG9ydGFudDtcblx0XHQgICAgICAgcGFkZGluZzogNXB4IDVweDtcblx0XHQgICAgICAgYm94LXNoYWRvdzogbm9uZTsgIC8qIHJlbW92ZSBzaGFkb3dzIGlmIHRoZXkgbG9vayBvZmYgKi9cblx0XHQgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuXHRcdCAgICAgICBjb2xvcjogdmFyKC0tbGluay1jb2xvcikgIWltcG9ydGFudDtcblx0XHQgICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGluay1jb2xvcik7IFxuXHRcdCAgICAgICB3aWR0aDogYXV0byAhaW1wb3J0YW50OyAgICAgICAgICAgIC8qIGF1dG8gYWRqdXN0cyB3aWR0aCBiYXNlZCBvbiBjb250ZW50ICovXG4gICAgXHRcdCAgIC8qbWF4LXdpZHRoOiA2MHB4ICFpbXBvcnRhbnQ7ICAqLyAgXG4gICAgXHRcdCAgIG1heC1oZWlnaHQ6IDMwcHggIWltcG9ydGFudDtcbiAgICBcdFx0ICAgbWluLXdpZHRoOiA0MHB4ICFpbXBvcnRhbnQ7XG4gICAgXHRcdCAgIHdoaXRlLXNwYWNlOiBub3dyYXA7XG4gICAgXHRcdCAgIC8qdGV4dC1hbGlnbjogbGVmdCAhaW1wb3J0YW50OyovXG4gICAgXHRcdCAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgXHRcdCAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWJhY2tncm91bmQtcHJpbWFyeSkgIWltcG9ydGFudDtcblx0XHQgICB9XG5cdFx0fVxuXG4gICAgYDtcblxuICAgIGNvbnN0IHN0eWxlU2hlZXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7XG4gICAgc3R5bGVTaGVldC50eXBlID0gXCJ0ZXh0L2Nzc1wiO1xuICAgIHN0eWxlU2hlZXQuaW5uZXJUZXh0ID0gc3R5bGVzO1xuICAgIHN0eWxlU2hlZXQuaWQgPSAnbXktcGx1Z2luLXN0eWxlcyc7IC8vIElEIHRvIHByZXZlbnQgaW5qZWN0aW5nIHRoZSBzdHlsZXMgbXVsdGlwbGUgdGltZXNcbiAgICBkb2N1bWVudC5oZWFkLmFwcGVuZENoaWxkKHN0eWxlU2hlZXQpO1xuXHR9XG5cblx0Z2V0VGFnRWxlbWVudChwYXJhZ3JhcGgsIHRhZ1RleHQpIHtcblx0ICAgIGNvbnN0IGVsZW1lbnRzID0gcGFyYWdyYXBoLnF1ZXJ5U2VsZWN0b3JBbGwoJy50YWcnKTsgXG5cdCAgICBmb3IgKGxldCBlbGVtZW50IG9mIGVsZW1lbnRzKSB7XG5cdCAgICAgICAgaWYgKGVsZW1lbnQuaW5uZXJUZXh0LnRyaW0oKSA9PT0gdGFnVGV4dCkge1xuXHQgICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcblx0ICAgICAgICB9XG5cdCAgICB9XG5cdCAgICBjb25zb2xlLndhcm4oYEVsZW1lbnQgd2l0aCB0ZXh0IFwiJHt0YWdUZXh0fVwiIG5vdCBmb3VuZGApO1xuXHQgICAgcmV0dXJuIG51bGw7XG5cdH1cblxuXHRjdHJsQ21kS2V5IChldmVudCkge1xuXHRcdGNvbnN0IGlzTWFjID0gKG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpID49IDApO1xuXG5cdFx0aWYgKGlzTWFjKSByZXR1cm4gZXZlbnQubWV0YUtleTtcblx0XHRlbHNlIHJldHVybiBldmVudC5jdHJsS2V5O1xuXG5cdH1cblxuXG59XG5cblxuXG5jbGFzcyBUZW1wQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcblx0b25sb2FkKCkge31cblx0b251bmxvYWQoKSB7fVxufVxuXG5jbGFzcyBEb3VibGVUYXBIYW5kbGVyIHtcbiAgY29uc3RydWN0b3IocGx1Z2luLCBlbGVtZW50LCBjYWxsYmFjaykge1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luOyAvLyBTdG9yZSB0aGUgcGx1Z2luIGluc3RhbmNlXG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5sYXN0VGFwID0gMDtcbiAgICAvL25ldyBOb3RpY2UoJ2RvdWJsZSB0YXAgY3JlYXRlZCcpXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJEb21FdmVudCh0aGlzLmVsZW1lbnQsICd0b3VjaGVuZCcsIHRoaXMuaGFuZGxlVG91Y2hFbmQuYmluZCh0aGlzKSwgdHJ1ZSk7XG4gIH1cblxuICBoYW5kbGVUb3VjaEVuZChldmVudCkge1xuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG4gICAgY29uc3QgdGFwTGVuZ3RoID0gY3VycmVudFRpbWUgLSB0aGlzLmxhc3RUYXA7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCk7XG4gICAgXG4gICAgaWYgKHRhcExlbmd0aCA8IDUwMCAmJiB0YXBMZW5ndGggPiAwKSB7XG4gICAgICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAvL2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgLy9uZXcgTm90aWNlKCdkb3VibGUgdGFwIGZpcmVkJyk7XG4gICAgICB0aGlzLmNhbGxiYWNrKGV2ZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpO1xuICAgICAgfSwgNTAwKTtcbiAgICB9XG4gICAgdGhpcy5sYXN0VGFwID0gY3VycmVudFRpbWU7XG4gIH1cbn1cblxuY2xhc3MgUHJlc3NBbmRIb2xkSGFuZGxlciB7XG4gIGNvbnN0cnVjdG9yKHBsdWdpbiwgZWxlbWVudCwgY2FsbGJhY2ssIGR1cmF0aW9uID0gNjAwKSB7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5lbGVtZW50ID0gZWxlbWVudDtcbiAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgdGhpcy5kdXJhdGlvbiA9IGR1cmF0aW9uOyAvLyBkdXJhdGlvbiBpbiBtaWxsaXNlY29uZHMgdG8gY29uc2lkZXIgYXMgXCJob2xkXCJcbiAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuXG4gICAgLy9uZXcgTm90aWNlICgncHJlc3NBbmRIb2xkIGNyZWF0ZWQuJylcblxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRG9tRXZlbnQodGhpcy5lbGVtZW50LCAndG91Y2hzdGFydCcsIHRoaXMuaGFuZGxlVG91Y2hTdGFydC5iaW5kKHRoaXMpLCB0cnVlKTtcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckRvbUV2ZW50KHRoaXMuZWxlbWVudCwgJ3RvdWNoZW5kJywgdGhpcy5oYW5kbGVUb3VjaEVuZC5iaW5kKHRoaXMpLCB0cnVlKTtcbiAgfVxuXG4gIGhhbmRsZVRvdWNoU3RhcnQoZXZlbnQpIHtcbiAgICAvL2V2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy9ldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICBcdC8vbmV3IE5vdGljZSAoJ3ByZXNzQW5kSG9sZCBldmVudCBmaXJlZC4nKVxuICAgICAgdGhpcy5jYWxsYmFjayhldmVudCk7XG4gICAgICB0aGlzLnRpbWVvdXQgPSBudWxsO1xuICAgIH0sIHRoaXMuZHVyYXRpb24pO1xuICB9XG5cbiAgaGFuZGxlVG91Y2hFbmQoZXZlbnQpIHtcbiAgICBpZiAodGhpcy50aW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy50aW1lb3V0KTtcbiAgICAgIHRoaXMudGltZW91dCA9IG51bGw7XG4gICAgfVxuICB9XG59XG4iLCAiXG5pbXBvcnQgVGFnQnVkZHkgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgY2xhc3MgVEJTZXR0aW5nc1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuICAgIHBsdWdpbjogVGFnQnVkZHk7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBUYWdCdWRkeSkge1xuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBsZXQgeyBjb250YWluZXJFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIk92ZXJyaWRlIG5hdGl2ZSB0YWcgc2VhcmNoIG9uIGNsaWNrXCIpXG4gICAgICAgIC5zZXREZXNjKFwiVG9nZ2xlIG9mZiB0byB1c2UgY21kK2NsaWNrIHRvIHJlbW92ZSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnJlbW92ZU9uQ2xpY2spXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucmVtb3ZlT25DbGljayA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiQ29udmVydCB0byB0YWcgdGV4dCB3aXRoIG9wdCtjbGljayAocmVtb3ZlcyAjKVwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBvZmYgdG8gdXNlIG9wdCtjbGljayB0byBwZXJmb3JtIG5hdGl2ZSB0YWcgc2VhcmNoLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5vcHRUb0NvbnZlcnQpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3B0VG9Db252ZXJ0ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgLnNldE5hbWUoXCJSZW1vdmUgY2hpbGQgdGFncyBmaXJzdFwiKVxuICAgICAgICAuc2V0RGVzYyhcIlRvZ2dsZSBvZmYgdG8gdXNlIHNoaWZ0K2NsaWNrIHRvIHJlbW92ZSBjaGlsZCB0YWdzIGZpdHN0LlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5yZW1vdmVDaGlsZFRhZ3NGaXJzdCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiTW9iaWxlIHRhZyBzZWFyY2hcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgb24gdG8gcmVzdG9yZSBtb2JpbGUgbmF0aXZlIHRhZyBzZWFyY2ggb24gdGFwLiBUYWcgcmVtb3ZhbCB3aWxsIHRoZW4gdXNlIHByZXNzK2hvbGQuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZVRhZ1NlYXJjaClcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5tb2JpbGVUYWdTZWFyY2ggPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICk7XG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAuc2V0TmFtZShcIlNob3cgbW9iaWxlIG5vdGljZXNcIilcbiAgICAgICAgLnNldERlc2MoXCJUb2dnbGUgb2ZmIHRvIGhpZGUgbm90aWNlcyB3aGVuIGVkaXRpbmcgb3IgcmVtb3ZpbmcgYSB0YWcuXCIpXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cbiAgICAgICAgICAgIHRvZ2dsZVxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1vYmlsZU5vdGljZXMpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubW9iaWxlTm90aWNlcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgKTtcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgIC5zZXROYW1lKFwiRGVidWcgbW9kZVwiKVxuICAgICAgICAuc2V0RGVzYyhcIk91dHB1dCB0byBjb25zb2xlLlwiKVxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG4gICAgICAgICAgICB0b2dnbGVcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWJ1Z01vZGUpXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVidWdNb2RlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuICAgIH1cbn1cblxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FDRUEsc0JBQStDO0FBRXhDLElBQU0sZ0JBQU4sY0FBNEIsaUNBQWlCO0FBQUEsRUFHaEQsWUFBWUEsTUFBVSxRQUFrQjtBQUNwQyxVQUFNQSxNQUFLLE1BQU07QUFDakIsU0FBSyxTQUFTO0FBQUEsRUFDbEI7QUFBQSxFQUNBLFVBQWdCO0FBQ1osUUFBSSxFQUFFLFlBQVksSUFBSTtBQUV0QixnQkFBWSxNQUFNO0FBRWxCLFFBQUksd0JBQVEsV0FBVyxFQUN0QixRQUFRLHFDQUFxQyxFQUM3QyxRQUFRLDRDQUE0QyxFQUNwRDtBQUFBLE1BQVUsQ0FBQyxXQUNSLE9BQ0MsU0FBUyxLQUFLLE9BQU8sU0FBUyxhQUFhLEVBQzNDLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLGFBQUssT0FBTyxTQUFTLGdCQUFnQjtBQUNyQyxjQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsTUFDbkMsQ0FBQztBQUFBLElBQ0w7QUFDQSxRQUFJLHdCQUFRLFdBQVcsRUFDdEIsUUFBUSxnREFBZ0QsRUFDeEQsUUFBUSwyREFBMkQsRUFDbkU7QUFBQSxNQUFVLENBQUMsV0FDUixPQUNDLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxFQUMxQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixhQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLGNBQU0sS0FBSyxPQUFP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
